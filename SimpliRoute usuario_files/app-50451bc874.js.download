!function(){"use strict";angular.module("icarus",["ngAnimate","ngMessages","angular-storage","duScroll","ngCsv","cgBusy","pascalprecht.translate","stripe.checkout","ui.bootstrap","ui.router","ui.tree","ngDialog","countrySelect","ngCookies","icarus.bulk","icarus.shared","icarus.authentication","icarus.settings","icarus.planner","bcPhoneNumber","angularPayments","tmh.dynamicLocale","angular-stripe","ngFileSaver","internationalPhoneNumber","icarus.extraFieldDefinition","icarus.tour","icarus.log","rzModule","nvd3","icarus.dashboard","ngTagsInput"])}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){a.getUser().then(function(e){h.user=e,g(),c.fbq("track","InitiateCheckout"),n.list().then(function(e){h.minVehicle=e.length,0===e.length?(h.planQuantity=1,h.minVehicle=1):h.planQuantity=e.length,h.user.account.plan_quantity>h.planQuantity&&"trialing"!==h.user.account.status&&(h.planQuantity=h.user.account.plan_quantity)})})}function u(){i.go("^")}function p(){l.open({template:"app/uprofile/payment/payment-success-modal.html",scope:r})}function m(){var e=angular.element(document.querySelector("#loadScript"));e.empty(),e.append(' <noscript> <div style=display:inline;><img height=1 width=1 style=border-style:none;src="//www.googleadservices.com/pagead/conversion/944253981/?label=93uVCOv7k20QndigwgM&amp;guid=ON&amp;script=0/></div></noscript>')}function v(){var e={type:"ecommerce:addTransaction",ecommerce:{id:h.user.id,affiliation:"SimpliRoute",revenue:h.planQuantity*h.AMOUNT_PER_VEHICLE,shipping:"0",tax:"0",currency:"USD"}};s.sendEcommerceGoogle(e),e.type="ecommerce:addItem",e.ecommerce={id:h.user.id,name:"Suscripci√≥n a SR",sku:h.discount_code?h.discount_code:"SRFULL",category:"Vehiculos",price:"40",quantity:h.planQuantity,currency:"USD"},s.sendEcommerceGoogle(e),e.type="ecommerce:send",e.ecommerce=null,s.sendEcommerceGoogle(e)}function g(){"uprofile.info.add-payment"===i.current.name&&s.callGoogleTrackConversion("DBn0CL_umG0QndigwgM"),"uprofile.info"===i.current.name&&s.callGoogleTrackConversion("93uVCOv7k20QndigwgM")}var h=this;h.errorPayment=!1,h.errorCoupon=!1,h.successPayment=!1,h.expiry_invalid=!1,h.enable_discount_code=!1,h.discount_code=null,h.goBack=u,h.AMOUNT_PER_VEHICLE=o,d(),t.stripeCallback=function(t,s){m(),s.error?h.expiry_invalid=!0:(c.fbq("track","Purchase",{value:h.planQuantity*h.AMOUNT_PER_VEHICLE,currency:"USD"}),r.isLoading=!0,h.user.account.plan_quantity=h.planQuantity,h.enable_discount_code||(h.discount_code=null),a.setSubscription(h.user.account.plan_quantity,s.id,h.discount_code).then(function(){if(h.successPayment=!0,h.user.account.plan_quantity<h.minVehicle)for(var e=h.minVehicle+1;e<h.user.account.plan_quantity+1;e++)n.create({name:"Vehicle "+e,capacity:1});r.isLoading=!1,h.successPayment=!1,h.errorPayment=!1,h.errorCoupon=!1,r.showTrial=!1,a.changeStatusAccount(),i.go("^"),p(),v()})["catch"](function(t){r.isLoading=!1,e.info(t),-1!==String(t).toLowerCase().indexOf(String("No such coupon").toLowerCase())||-1!==String(t).toLowerCase().indexOf(String("This coupon is not valid").toLowerCase())?h.errorCoupon=!0:h.errorPayment=!0}))}}e.$inject=["$log","$scope","$state","sessionService","vehicleService","marketingService","AMOUNT_PER_VEHICLE","$rootScope","ngDialog","$window"],angular.module("icarus").controller("UprofilePaymentController",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){s.isLoading=!0,a.cancelSubscription()["catch"](function(e){s.isLoading=!1,t.info(e)})["finally"](function(){n.dismiss("close"),s.isLoading=!1})}var r=this;r.cancelSubscription=o}e.$inject=["$scope","$log","$state","sessionService","$uibModalInstance","$rootScope"],angular.module("icarus").controller("UprofileSubscriptionController",e)}(),function(){"use strict";function e(e,t,i){function a(){t.getUser().then(function(e){r.user=e,angular.extend(r.password,l),angular.extend(r.new_password,l),angular.extend(r.confirm_password,l)})}function n(){e.go("^")}function s(e){"password"===e.type?e.type="text":e.type="password"}function o(){r.new_password.value===r.confirm_password.value?t.changePassword(r.new_password.value,r.password.value).then(function(){r.success_change_password=!0})["catch"](function(){r.error_invalid_password=!0})["finally"](function(){i(function(){},2e3).then(function(){r.error_invalid_password=!1,r.success_change_password&&(r.success_change_password=!1,e.go("^"))})}):(r.error_match_password=!0,i(function(){},2e3).then(function(){r.error_match_password=!1}))}var r=this;r.error_match_password=!1,r.error_invalid_password=!1,r.user={},r.password={},r.new_password={},r.confirm_password={},r.goBack=n,r.saveData=o,r.changeTypeInput=s,a();var l={value:"",type:"password",error:null,error_txt:null,success_txt:null}}e.$inject=["$state","sessionService","$timeout"],angular.module("icarus").controller("UprofileChangePassController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l){function c(){k.vehicles=t.trackingVehicles,k.vehiclesFilters=t.trackingVehicles,t.trackingVehicles.length>0?(y(I),e.$emit(r.MAP.LOAD_VEHICLES_LAST_POSITION,{date:I,fitboundsFlag:!0})):t.trackingVehicles=[]}function d(){null!==k.selectedVehicleId&&(k.selectedVehicleId=null,a.go("^")),k.vehiclesFilters=l("trackingSearchVehicles")(k.vehicles,k.searchKeyword)}function u(e){k.searchKeyword?13===e.keyCode&&d():p()}function p(){k.searchKeyword="",k.vehiclesFilters=k.vehicles}function m(t){if(t.id===k.selectedVehicleId)k.selectedVehicleId=null,e.$emit(r.MAP.FIT_BOUNDS_VEHICLES_LAST_POSITION),e.$emit(r.MAP.SET_DEFAULT_TIME_FILTER),a.go("^");else{var i={vehicleId:t.id,driverId:t.driver instanceof Object?t.driver.id:null};s.selectVehicle(t),a.go("tracking.vehicles.driver-dispatchs",i)}}function v(i,a){k.vehiclesFilters=t.trackingVehicles,k.vehicles=t.trackingVehicles,y(a.date),e.$emit(r.MAP.LOAD_VEHICLES_LAST_POSITION,{date:a.date,fitboundsFlag:!0})}function g(e,i){v("dateChange",i),t.$broadcast(r.REFRESH.DATE_CHANGED_REFRESH_VISITS,{vehicles:k.vehicles,date:i.date})}function h(){_(),f()}function _(){e.$emit(r.MAP.CLEAR_VEHICLE_MARKERS),k.selectedVehicleId=null}function f(){S(),E(),C(),D(),P()}function b(e){return e.total?Math.round((e.completed+e.failed)/e.total*100):0}function y(e){angular.forEach(k.vehicles,function(t){var i=angular.isObject(t.driver)?t.driver.id:null;t.hasFailedVisits=!1,o.getProgressVehicleByDriverAndDate(e,t.id,i).then(function(e){t.countAlertedVisits=x(e.data),t.hasAlertedVisits=!!e.data.alerts||!!e.data.failed,t.progress=b(e.data),t.totalVisits=e.data.total,t.madeVisits=e.data.completed+e.data.failed+e.data.canceled,t.progress>0&&(t.isActive=!0)})})}function w(e,t){var i=t.vehicleId;k.selectedVehicleId=i}function A(){e.$emit(r.VEHICLES.RETURN_VEHICLE_DRIVER_ACTIVE,{})}function x(e){return parseInt(e.alerts+e.failed)>0?parseInt(e.alerts+e.failed):""}var k=this,I=n.trackingDate;k.loadingData=!1,k.vehiclesFilters=[],k.vehicles=[],k.activeVehicles=[],k.inactiveVehicles=[],k.drivers=[],k.selectedVehicleId=null,k.searchKeyword="",k.checkKey=u,k.filterVehicles=d,k.clearFilter=p,k.toogleListVehicleDriver=m,c();var S=e.$on(r.REFRESH.GENERAL_PROGRESS_CHANGED,v),E=e.$on(r.REFRESH.CHANGE_VEHICLE_SELECTED,w),C=e.$on(r.REFRESH.DATE_CHANGED,g),D=e.$on(r.VEHICLES.VEHICLES_READY,v),P=e.$on(r.VEHICLES.GET_VEHICLE_DRIVER_ACTIVE,A);e.$on("$destroy",h)}e.$inject=["$scope","$rootScope","$log","$state","$stateParams","trackingService","planService","TRACKING_EVENTS","$filter"],angular.module("icarus").controller("VehiclesController",e)}(),function(){"use strict";function e(e,t,i,a){function n(e){this.id=e,this.title=null,this.address=null,this.latitude=null,this.longitude=null,this.reference=null,this.status=null,this.plannedDate=null,this.estimatedTimeArrival=null,this.checkinTime=null,this.checkoutTime=null,this.checkoutComment=null,this.checkoutObservations=null,this.windowStart=null,this.windowEnd=null,this.windowStart2=null,this.windowEnd2=null,this.timeService=null,this.signature=null,this.pictures=null,this.vehicle=null,this.showEta=!1,this.created=null,this.orderInVehicle=null,this.visible=!1,this.marker=null,this.order=null,this.route=null}var s=100;return n.prototype.updateData=function(e){var t="",a="",n=null;if(i(e.checkin_time).isValid()&&(a=i(e.checkin_time).format("HH:mm")),i(e.checkout_time).isValid()&&(t=i(e.checkout_time).format("HH:mm")),i(e.checkin_time).isValid()&&i(e.checkout_time).isValid()){var s=i(e.checkout_time).diff(i(e.checkin_time)),o=i.duration(s),r=Math.floor(o.asHours())+i.utc(s).format(":mm:ss");n=r}this.title=e.title,this.address=e.address,this.latitude=parseFloat(e.latitude),this.longitude=parseFloat(e.longitude),this.reference=e.reference,this.status=e.status,this.plannedDate=e.planned_date,this.estimatedTimeArrival=angular.isString(e.estimated_time_arrival)&&e.estimated_time_arrival.length>=5?e.estimated_time_arrival.substring(0,5):"",this.checkinTime=a,this.checkoutTime=t,this.checkoutComment=e.checkout_comment,this.timeService=n,this.signature=e.signature,this.pictures=e.pictures,this.created=e.created,this.order=e.order,this.windowStart=e.window_start,this.windowEnd=e.window_end,this.windowStart2=e.window_start2,this.windowEnd2=e.window_end2},n.prototype.updateMapObject=function(e){this.marker&&(this.marker.getMap()!==e&&this.marker.setMap(e),this.marker.setTitle(this.title),this.marker.setVisible(this.visible),this.marker.setPosition({lat:this.latitude,lng:this.longitude}),"completed"===this.status?this.marker.setIcon(angular.extend(this.marker.getIcon(),{fillColor:"#41D3BD",strokeColor:tinycolor("#41D3BD").darken(15).toString()})):"failed"===this.status?this.marker.setIcon(angular.extend(this.marker.getIcon(),{fillColor:"#FF5252",strokeColor:tinycolor("#FF5252").darken(15).toString()})):"pending"===this.status?this.marker.setIcon(angular.extend(this.marker.getIcon(),{fillColor:tinycolor("#607D8B").lighten(15).toString(),strokeColor:tinycolor("#607D8B").lighten(5).toString()})):"canceled"===this.status&&this.marker.setIcon(angular.extend(this.marker.getIcon(),{fillColor:"#607D8B",strokeColor:tinycolor("#607D8B").darken(15).toString()})),this.marker&&("tracking.all-dispatchs"===t.current.name&&this.marker.setVisible(!0),("tracking.driver-dispatchs"===t.current.name||"tracking.driver-dispatchs.detail"===t.current.name)&&this.vehicle&&(t.params.driverId!==this.vehicle.id?this.marker.setVisible(!1):this.marker.setVisible(!0))))},n.prototype.clearMapObject=function(){this.marker&&this.marker.setMap(null)},n.prototype.setVisible=function(e){this.visible=!!e,this.marker&&this.marker.setVisible(this.visible)},n.prototype.setLabel=function(e){if(this.marker){var t=e.toString().length;switch(t){case 1:this.marker.labelAnchor=a.createPoint(-2.7,26);break;case 2:this.marker.labelAnchor=a.createPoint(.5,26);break;case 3:this.marker.labelAnchor=a.createPoint(4,26);break;default:this.marker.labelAnchor=a.createPoint(-2.7,26)}this.marker.labelContent=e,this.marker.label.setContent()}},n.prototype.createMarker=function(e,i){if(!this.latitude||!this.longitude||!e)return null;this.visible=!0;var n=null,o=null,r=null;"completed"===this.status?(n="#41D3BD",o=tinycolor("#41D3BD").darken(15).toString()):"failed"===this.status?(n="#FF5252",o=tinycolor("#FF5252").darken(15).toString()):"pending"===this.status?(n=tinycolor("#607D8B").lighten(15).toString(),o=tinycolor("#607D8B").lighten(5).toString()):"canceled"===this.status&&(n="#607D8B",o=tinycolor("#607D8B").darken(15).toString());var l=i.toString().length;switch(l){case 1:r=a.createPoint(-2.7,26);break;case 2:r=a.createPoint(.5,26);break;case 3:r=a.createPoint(4,26);break;default:r=a.createPoint(-2.7,26)}var c=new MarkerWithLabel({position:{lat:this.latitude,lng:this.longitude},map:e,icon:{path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z",fillColor:n,fillOpacity:1,strokeColor:o,strokeWeight:1,anchor:{x:10,y:31},size:a.createMapSize(24,34)},animation:a.googleMapsAnimationDrop(),labelClass:"sp-marker-label",labelAnchor:r,labelContent:i,visible:!0,zIndex:s,originalIndex:s});return s+=3,c.addListener("click",function(){t.go(".detail",{dispatchsId:this.id})}.bind(this)),c},n}e.$inject=["$log","$state","moment","googleService"],angular.module("icarus").factory("TrackingVisitModel",e)}(),function(){"use strict";function e(e,t,i,a){function n(e){this.id=e,this.name=null,this.driver=null,this.color=h[_++],this.locations=[],this.visits=[],this.routes=[],this.alerts=[{id:0,description:g("Visits.visits_failed")}],this.totalVisitsDone=0,this.totalVisitsFailed=0,this.totalVisitsDonePercentage=0,this.visibleMarker=!1,this.visibleMarkerOrigin=!1,this.visiblePolyline=!1,this.marker=null,this.markerOrigin=null,this.polyline=null,this.polylinesArray=[],this.locationsArray=[],this.clusterVisits=null,this.hasVisits=!1,_===h.length-1&&(_=0)}function s(e){var i="Conductor",n=[];if(this.driver&&(i=this.driver.name),0===this.locationsArray.length||!e)return null;n=this.locationsArray;for(var s=o(this.locationsArray),l=0;l<s.length;l++)if(this.polylinesArray[l])this.polylinesArray[l].setPath(s[l]);else{var c=a.createPolyline({map:e,path:s[l],geodesic:!0,strokeColor:this.color,strokeOpacity:.8,strokeWeight:4,draggable:!1,visible:this.visiblePolyline});c.addListener("click",function(e){for(var s=Number.MAX_VALUE,o=0,l=0,c=this.getMap(),u=r(n,this.getPath()),p=0;p<this.getPath().getLength();p++){var m=a.geometryComputeDistanceBetween(e.latLng,this.getPath().getAt(p));s>m&&(s=m,o=p)}if(u[o]&&u[o+1]){var v=a.getGoogleMapsLatLng(u[o].latitude,u[o].longitude),g=a.getGoogleMapsLatLng(u[o+1].latitude,u[o+1].longitude);l=a.geometryComputeHeading(v,g)}var h=d(l),_=h.direction,f=h.icon,b='<b><i class="sp-icon-vehiculos"></i> '+i+'</b><br><i class="sp-icon-tiempo-servicio"></i> '+t(u[o].timestamp).format("HH:mm:ss")+'<br><i class="sp-icon-rutas"></i> '+_+' <i class="'+f+'"></i> <br>Lat:  '+u[o].latitude+"<br>Lng: "+u[o].longitude+"<br>";y.setContent(b),y.setPosition(e.latLng),y.open(c)}),y=a.createInfoWindow(),this.polylinesArray.push(c)}}function o(e){var t=[],i=[];return e.forEach(function(e){i=[],e.length>3&&(e.forEach(function(e){i.push({lat:e.latitude,lng:e.longitude})}),t.push(i))}),t}function r(e,t){var i=!0,a=[],n=null;t.forEach(function(e){a.push({lat:e.lat(),lng:e.lng()})});for(var s=0;s<e.length;s++){if(i=!0,e[s].length===t.getLength())for(var o=0;o<e[s].length&&e[s][o].latitude===a[o].lat;o++)i=!1,n=s;if(!i)break}return e[n]}function l(t){if(!this.latitude||!this.longitude||!t)return null;var i=a.createMarker({position:{lat:this.latitude,lng:this.longitude},map:t,icon:{path:a.symbolMapCircle(),strokeColor:this.color,scale:10},animation:a.googleMapsAnimationDrop(),visible:!0});return i.addListener("click",function(){e.go("tracking.driver-dispatchs",{driverId:this.id})}.bind(this)),i}function c(e){if(!this.latitude||!this.longitude||!e)return null;var t=a.createMarker({position:{lat:this.locations[0].latitude,lng:this.locations[0].longitude},map:e,icon:{path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z M21.851,12.096c-0.178,0.178-0.467,0.179-0.644,0.001l-0.646-0.642l-0.009,6.894,c0,0.251-0.204,0.455-0.455,0.455h-2.476c-0.251,0-0.455-0.204-0.455-0.455v-4.111h-2.319v4.111c0,0.251-0.204,0.455-0.456,0.455,h-2.496c-0.251,0-0.455-0.204-0.455-0.455v-6.902l-0.649,0.649c-0.088,0.089-0.205,0.133-0.322,0.133,c-0.116,0-0.232-0.044-0.321-0.133c-0.178-0.177-0.178-0.465,0-0.643l5.514-5.516c0.178-0.178,0.465-0.178,0.643-0.001l5.542,5.516,C22.026,11.63,22.027,11.918,21.851,12.096z",strokeColor:this.color,strokeWeight:2},animation:a.googleMapsAnimationDrop(),visible:!1,title:"Inicio"});return t}function d(e){var t=null,i="",a={direction:t,icon:i};switch(!0){case e>-22.5&&22.5>e:a.direction="Norte ",a.icon="fa fa-long-arrow-up";break;case e>22.5&&67.5>e:a.direction="Noreste ",a.icon="fa fa-long-arrow-up rotate-noreste";break;case e>67.5&&112.5>e:a.direction="Este ",a.icon="fa fa-long-arrow-right";break;case e>112.5&&157.5>e:a.direction="Sureste ",a.icon="fa fa-long-arrow-up rotate-sureste";break;case e>157.5&&180>e||e>=-180&&-157.5>e:a.direction="Sur ",a.icon="fa fa-long-arrow-down";break;case e>-157.5&&-112.5>e:a.direction="Suroeste ",a.icon="fa fa-long-arrow-up rotate-suroeste";break;case e>-112.5&&167.5>e:a.direction="Oeste ",a.icon="fa fa-long-arrow-left";break;case e>-67.5&&-22.5>e:a.direction="Noroeste ",a.icon="fa fa-long-arrow-up rotate-noroeste";break;default:a.direction="Sin Orientacion "}return a}function u(e){return 1e3*e/3600}function p(e,t){var i=6371,a=m(t.latitude-e.latitude),n=m(t.longitude-e.longitude),s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(m(e.latitude))*Math.cos(m(t.latitude))*Math.sin(n/2)*Math.sin(n/2),o=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),r=i*o;return 1e3*r}function m(e){return e*(Math.PI/180)}function v(e,i){var a=t(i.timestamp).diff(t(e.timestamp)),n=t.duration(a).asSeconds();return n}var g=i("translate"),h=["#4F609A","#DF482B","#49B037","#E3BA32","#593870","#D64285","#65D5C4","#D0E440","#DB7867","#8C612D","#A8DF73","#CE75DC","#5D84E0","#556177","#8D3180","#61E079","#DD79B8","#87A92F","#D2CC67","#D98836","#8C6BE7","#61DFA7","#983521","#8B8430","#428130","#CF49DF","#75E43A","#AF92D6","#3F5122","#DA415E","#79C8DA","#532916","#6C4FAB","#D83DB1","#D3B9D9","#659DCB","#2C362D","#C1E0A6","#822F59","#679E6B","#8F3442","#CEDBCD","#4E2633","#CBB17A","#2F2B4A","#DFA69A","#467B71","#B57391","#896B5B","#999996"],_=0,f=null,b=u(100),y=null,w=2e3;return n.prototype.updateData=function(e){this.name=e.name},n.prototype.addLocation=function(e){var i=null,a=null;if(!f||f.latitude!==e.latitude){f={latitude:e.latitude,longitude:e.longitude};for(var n=0;n<this.locations.length;n++)if(this.locations[n].timestamp===e.timestamp||this.locations[n].latitude===e.latitude||this.locations[n].longitude===e.longitude)return;if(0===this.locations.length)return this.locations.push(e),void this.locationsArray.push([e]);if(this.locations.length>0){var s=t(this.locations[this.locations.length-1].timestamp),o=t(e.timestamp);i=p(this.locations[this.locations.length-1],e),t.duration(o.diff(s)).asSeconds()>20&&(w>i?(a=v(this.locations[this.locations.length-1],e),this.locations.push(e),b>i/a&&this.locationsArray[this.locationsArray.length-1].push(e)):(this.locations.push(e),this.locationsArray.push([e])))}}},n.prototype.sortAndCalculate=function(){var e=0,t=0;this.clusterVisits?(this.visits.sort(function(e,t){return e.route&&t.route&&e.route.date!==t.route.date?e.route.date<t.route.date?-1:1:void 0}),this.visits.sort(function(e,t){return e.order&&t.order&&e.route&&t.route&&e.route.id===t.route.id?e.order<t.order?-1:1:void 0})):this.visits.sort(function(e,t){return e.estimatedTimeArrival!==t.estimatedTimeArrival?e.estimatedTimeArrival<t.estimatedTimeArrival?-1:1:void 0});for(var i=0;i<this.visits.length;i++)"pending"!==this.visits[i].status&&e++,"failed"===this.visits[i].status&&t++;this.totalVisitsDone=e,this.totalVisitsFailed=t,0===this.visits.length?this.totalVisitsDonePercentage=this.visits.length:this.totalVisitsDonePercentage=Math.floor(this.totalVisitsDone/this.visits.length*100),this.alerts[0].id=this.totalVisitsFailed,this.locations.sort(function(e,t){return e.timestamp<t.timestamp?-1:1}),this.locations.length>0&&(this.latitude=this.locations[this.locations.length-1].latitude,this.longitude=this.locations[this.locations.length-1].longitude)},n.prototype.updateMapObjects=function(t,i){this.marker=this.marker||l.call(this,t),this.markerOrigin=this.markerOrigin||c.call(this,t),this.marker&&(this.marker.getMap()!==t&&this.marker.setMap(t),this.marker.setTitle(this.name),this.marker.setVisible(this.visibleMarker),this.marker.setPosition({lat:this.latitude,lng:this.longitude})),s.call(this,t),("tracking.driver-dispatchs"===e.current.name||"tracking.driver-dispatchs.detail"===e.current.name)&&(e.params.driverId===this.id?(this.setVisiblePolyline(!0),this.setVisibleMarkerOrigin(!0)):(this.setVisiblePolyline(!1),this.setVisibleMarkerOrigin(!1)))},n.prototype.clearMapObjects=function(){this.marker&&this.marker.setMap(null),this.polyline&&this.polyline.setMap(null),this.polylinesArray.forEach(function(e){e.setMap(null)})},n.prototype.setVisibleMarker=function(e){this.visibleMarker=!!e,this.marker&&this.marker.setVisible(this.visibleMarker)},n.prototype.setVisibleMarkerOrigin=function(e){this.visibleMarkerOrigin=!!e,this.markerOrigin&&this.markerOrigin.setVisible(this.visibleMarkerOrigin)},n.prototype.setVisiblePolyline=function(e){this.visiblePolyline=!!e,this.polyline&&this.polyline.setVisible(this.visiblePolyline),this.polylinesArray.forEach(function(t){t.setVisible(!!e)})},n.prototype.createMarker=function(e){if(!this.latitude||!this.longitude||!e)return null;this.visibleMarker=!0;var t=a.createMarker({position:{lat:this.latitude,lng:this.longitude},map:e,icon:{path:a.symbolMapCircle(),strokeColor:this.color,scale:10},animation:a.googleMapsAnimationDrop(),visible:!0});return t},n}e.$inject=["$state","moment","$filter","googleService"],angular.module("icarus").factory("TrackingVehicleModel",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v){function g(){Ce=null,Ae.length=0}function h(e){Ce=e}function _(e){De=e}function f(e){var t={params:{date:e}};return i.get(fe,t)}function b(){function e(e){e.data.forEach(function(e){var t=new c(e.id);t.updateData(e.name),Se.push(t)}),n.resolve(Se)}function a(e){n.reject(e)}var n=t.defer();return i.get(ge).then(e,a),n.promise}function y(){function e(e){e.data.forEach(function(e){var t=new l(e.id);t.updateData(e),Ee.push(t)}),n.resolve(Ee)}function a(e){n.reject(e)}var n=t.defer();return i.get(ve).then(e,a),n.promise}function w(e){Te=e}function A(){ie(),te()}function x(){return Re||(Re=V()),Re}function k(){var e=t.defer();return i.get(s.MAP_OPTIONS).then(function(t){e.resolve(t.data)})["catch"](function(t){e.reject(t)}),e.promise}function I(e){Oe&&Oe.setCenter(m.getGoogleMapsLatLng(e.latitude,e.longitude))}function S(e,i){return p.trackingDate!==n.trackingDate&&(Ce=null),Ce&&Ce.id===e?t.when(Ce):(i=i?i:"null",v.getVehicleByIDAndDriverAndDate(p.trackingDate,e,i))}function E(e){function i(i){if(i.status&&500===i.status)return n={status:i.status},t.reject(n);for(var a=0;a<i.vehicles.length;a++)if(i.vehicles[a].id===e)return t.when(xe[a]);return n={status:404},t.reject(n)}function a(e){return t.reject(e)}var n=null;return x().then(i,a)}function C(e,i,a){return De&&De.id===parseInt(a)?t.when(De):v.getVisitDetailByID(e,i,a)}function D(e){function i(i){if(i.status&&500===i.status)return n={status:i.status},t.reject(n);for(var a=0;a<i.visits.length;a++)if(i.visits[a].id===e)return t.when(Ae[a]);var n={status:404};return t.reject(n)}function a(e){return t.reject(e)}return x().then(i,a)}function P(){return ie(),Ve?Ve.then(function(){ee()}):t.when(ee())}function L(e){Oe=e}function O(){var e=m.getLatLngBounds();xe.forEach(function(t){t.visibleMarker&&t.marker&&e.extend(t.marker.getPosition()),t.visiblePolyline&&(t.polyline&&t.polyline.getPath().forEach(function(t){e.extend(t)}),t.polylinesArray.forEach(function(t){t.getPath().forEach(function(t){e.extend(t)})}))}),Ae.forEach(function(t){t.visible&&t.marker&&e.extend(t.marker.getPosition())}),!e.isEmpty()&&Oe&&Oe.fitBounds(e)}function T(e){var i=t.defer(),a=new JSZip,n=0,s=null,o="jpg",r=null;return e.pictures&&(s=e.pictures,s.forEach(function(t,s,l){r=null;var c=t.lastIndexOf(".");r=t.slice(c,t.length),r||(r=o);var d=e.id+"_"+e.title+"_"+(s+1)+r;JSZipUtils.getBinaryContent(t,function(e,t){e&&i.reject(e),a.file(d,t,{binary:!0}),n++,n===l.length&&i.resolve(a)})})),i.promise}function V(){var t=r();if(Ve)return Ve;if(!Te)throw new Error("_update was called before setting trackingDate");return Ve=z().then(R).then(N).then(j).then(H).then(G).then(J).then(W).then(function(){return Z(),K(),{drivers:we,vehicles:xe,routes:ye,visits:Ae,totals:Pe}},function(t){return e.info(t),t})["finally"](function(){var i=r(),a=parseInt(r.duration(i.diff(t)).asSeconds());de=Math.max(a+ue,ce),Ve=null,e.debug("UPDATED",new Date)})}function R(){function e(e){return e.data.forEach(function(e){M(e)}),ke}function a(e){return t.reject(e)}return i.get(_e).then(e,a)}function M(e){for(var t=null,i=e.id.toString(),a=0;a<ke.length;a++)if(ke[a].id===i){t=ke[a];break}t||ke.push(e)}function z(){function e(e){return e.data.forEach(function(e){F(e)}),we}function a(e){return t.reject(e)}return i.get(ve).then(e,a)}function F(e){for(var t=null,i=e.id.toString(),a=0;a<we.length;a++)if(we[a].id===i){t=we[a];break}t||(t=new l(i),we.push(t)),t.updateData(e)}function N(){function e(e){e.data.forEach(function(e){$(e)})}function a(e){return t.reject(e)}return i.get(ge).then(e,a)}function $(e){for(var t=null,i=e.id.toString(),a=0;a<xe.length;a++)if(xe[a].id===i){t=xe[a];break}t||(t=new c(i),xe.push(t)),t.updateData(e)}function j(){function e(e){e.data.forEach(function(e){B(e)})}function a(e){return t.reject(e)}return i.get(pe,{params:{plan_date:Te}}).then(e,a)}function B(e){for(var t=null,i=e.id,a=0;a<be.length;a++)if(be[a].id===i){t=be[a];break}t||be.push(e)}function H(){function e(e){e.data.forEach(function(e){U(e)})}function a(e){return t.reject(e)}if(Te)return i.get(pe+Te+"/routes/").then(e,a)}function U(e){for(var t=null,i=e.id,a=0;a<ye.length;a++)if(ye[a].id===i){t=ye[a];break}t||(t={id:i,date:e.estimated_time_start},ye.push(t)),q(t,e)}function q(e,t){var i,a=t.vehicle.toString(),n=t.driver&&t.driver.toString();for(i=0;i<be.length;i++)if(be[i].id===t.plan){e.showEta=be[i].is_cluster;break}for(i=0;i<xe.length;i++)if(xe[i].id===a){e.vehicle=xe[i];break}for(i=0;i<we.length;i++)if(we[i].id===n){e.driver=we[i],e.vehicle.driver=e.driver;break}}function G(){function e(e){return e}function a(e){return t.reject(e)}return i.get(he,{params:{min_timestamp:r(Te).startOf("day").toISOString(),max_timestamp:r(Te).endOf("day").toISOString()}}).then(e,a)}function J(e){var i=t.defer();return e.data.length>0?(e.data.forEach(function(e){Y(e)}),i.resolve()):he===s.API_URL+"tracking/locations/"?(he=s.API_URL+"tracking/locations-driver/",Le="drivers",G().then(function(e){e.data.forEach(function(e){Y(e)}),i.resolve()})):i.resolve(),i.promise}function Y(e){var t=0,i=null,a=null;if(e.vehicle){var n=e.vehicle.toString();for(t=0;t<xe.length;t++)if(xe[t].id===n){i=xe[t];break}}if(e.driver){var s=e.driver.toString();for(t=0;t<xe.length;t++)xe[t].driver&&xe[t].driver.id===s&&(a=xe[t],a.addLocation({timestamp:e.timestamp,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude)},Le))}i&&i.addLocation({timestamp:e.timestamp,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude)},Le)}function W(e){function a(e){e.data.forEach(function(e){e.route&&Q(e)})}function n(e){return t.reject(e)}return i.get(me,{params:{planned_date:e}}).then(a,n)}function Q(e){for(var t=null,i=e.id.toString(),a=e.created,n=0;n<Ae.length;n++)if(Ae[n].id===i){t=Ae[n];break}if(t||(t=new d(i),Ae.push(t),t.updateData(e)),t.checkoutObservations=X(e.checkout_observation),(r(t.created).isBefore(r(a))||r(t.created).isSame(r(a)))&&t.updateData(e),!t.vehicle)for(n=0;n<ye.length;n++)if(ye[n].id===e.route){t.vehicle=ye[n].vehicle,ye[n].vehicle.visits.push(t);break}for(n=0;n<ye.length;n++)if(ye[n].id===e.route){t.showEta=ye[n].showEta,t.route=ye[n],t.vehicle.clusterVisits=ye[n].showEta;break}}function Z(){var e=0,t=0;xe.forEach(function(i){i.sortAndCalculate(),e+=i.totalVisitsDone,t+=i.totalVisitsFailed}),Pe.done=e,Pe.failed=t,Pe.total=Ae.length,0===Pe.total?Pe.donePercentage=Pe.total:Pe.donePercentage=Math.floor(Pe.done/Pe.total*100),Ae.sort(function(e,t){if("failed"===e.status&&"failed"!==t.status)return-1;if("canceled"===e.status&&"canceled"!==t.status)return 1;if("pending"===e.status){if("failed"===t.status)return 1;if("completed"===t.status||"canceled"===t.status)return-1}else if("completed"===e.status){if("failed"===t.status||"pending"===t.status)return 1;if("canceled"===t.status)return-1}return e.checkoutTime&&t.checkoutTime?e.checkoutTime<t.checkoutTime?-1:1:e.title<t.title?-1:1})}function K(){xe.forEach(function(e){e.marker&&!e.marker.getMap()&&Oe&&e.marker.setMap(Oe),e.updateMapObjects(Oe,Le)}),Ae.forEach(function(e){e.marker&&!e.marker.getMap()&&Oe&&e.marker.setMap(Oe),e.updateMapObject(Oe)})}function X(e){if(e)for(var t=0;t<ke.length;t++)if(ke[t].id===e)return ke[t]}function ee(){Re=null,Te=null,Se.length=0,xe.forEach(function(e){e.clearMapObjects(),e.visits.length=0,e.locations.length=0,e.locationsArray.length=0,e.polylinesArray.length=0,e.marker=null,e.polyline=null,e.longitude=null,e.latitude=null,e.driver=null}),Ae.forEach(function(e){e.clearMapObject()}),be.length=0,we.length=0,ye.length=0,Ae.length=0,Pe.done=0,Pe.failed=0,Pe.total=0,Pe.donePercentage=0,he=s.API_URL+"tracking/locations/",Le="vehicles"}function te(){Re=null,Te=null,xe.forEach(function(e){e.clearMapObjects()}),Ae.forEach(function(e){e.clearMapObject()}),be.length=0,Ae.length=0,ye.length=0,we.length=0,xe.length=0,Se.length=0,Pe.done=0,Pe.total=0,Pe.failed=0,Pe.donePercentage=0,he=s.API_URL+"tracking/locations/",Le="vehicles"}function ie(){Me&&o.cancel(Me)}function ae(){return ze?ze:ze=function(){var e=t.defer();return p.$on("mapLoaded",function(){e.resolve()}),e.promise}()}function ne(e,t,a){var n={};return t&&a?n={driver_id:a,vehicle_id:t}:a?n={driver_id:a}:t&&(n={vehicle_id:t}),i.get(he+e+"/",{params:n})}function se(e){return i.get(me+e+"/download-attachment/",{responseType:"arraybuffer",headers:{"Content-Type":"application/zip"}})}function oe(e,t,i){var a=r(t,"HH:mm"),n=r(i,"HH:mm"),s=[];return e.forEach(function(e){var t=r(e.estimated_time_arrival,"HH:mm");t.isBetween(a,n,null,"[]")&&s.push(e.id)}),s}function re(e,t,i){var a=r(t,"HH:mm"),n=r(i,"HH:mm"),s=[];return e.forEach(function(e){var t=r(e.timeStamp).format("HH:mm"),i=r(t,"HH:mm");i.isBetween(a,n,null,"[]")&&s.push({vehicle:e.vehicleId,driver:e.driverId})}),s}var le=u("translate"),ce=30,de=30,ue=10,pe=s.API_URL+"routes/plans/",me=s.API_URL+"routes/visits/",ve=s.API_URL+"accounts/drivers/",ge=s.API_URL+"routes/vehicles/",he=s.API_URL+"tracking/locations/",_e=s.API_URL+"routes/observations/",fe=s.API_URL+"tracking/locations/latest/",be=(s.API_URL+"plans/",[]),ye=[],we=[],Ae=[],xe=[],ke=[],Ie=[],Se=[],Ee=[],Ce=null,De=null,Pe=([{id:0,description:le("Visits.visits_failed")}],{failed:0,donePercentage:0}),Le="vehicles",Oe=null,Te=r().format("YYYY-MM-DD"),Ve=null,Re=null,Me=null,ze=null,Fe={startTracking:w,stopTracking:A,getPlan:x,getVehicle:E,getVehicleByIdAndDriver:S,getVisit:D,getVisitDetailById:C,getLocationsByVehicleOrDriver:ne,selectVehicle:h,selectVisit:_,clear:P,setMap:L,setMapCenterOn:I,getMapOptions:k,fitBoundsToVisibles:O,getDownloadPictures:T,loadMap:ae,vehicles:xe,vehiclesFilter:Ie,totals:Pe,getListVehicles:b,getListDrivers:y,vehiclesList:Se,clearData:g,loadLastVehicleLocationByDate:f,downloadAttachment:se,filterVisits:oe,filterVehicleLastPosition:re};return Fe}e.$inject=["$log","$q","$http","$state","$stateParams","__env","$interval","moment","TrackingDriverModel","TrackingVehicleModel","TrackingVisitModel","$filter","$rootScope","googleService","planService"],angular.module("icarus").factory("trackingService",e)}(),function(){"use strict";function e(e,t,i,a){function n(t,i,n){var s,o,r,l,c={},d=e.createMapSize(24,34),u=e.googleMapsAnimationDrop();if(!t||!i)throw new Error("Can't create a marker if map or data doesn't exist");return r=void 0===n||n?i.order:"",l=i.order?i.order:1,o=h(l),a.merge(c,O,g(i.status)),a.merge(c,{size:d}),a.merge(c,{anchor:{x:10,y:31}}),s={id:i.id,map:t,position:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)},icon:c,animation:u,labelClass:C,labelAnchor:o,labelContent:r,labelStyle:{zIndex:"pending"!==i.status?P+2*i.order+1:D+2*i.order+1},visible:!0,zIndex:"pending"!==i.status?P+2*i.order:D+2*i.order},new MarkerWithLabel(s)}function s(t,i){var a,n=e.googleMapsAnimationDrop();
if(!t||!i)throw new Error("Can't create a marker if map or data doesn't exist");return V.strokeColor=i.color,V.path=e.symbolMapCircle(),a={vehicleId:i.vehicleId,driverId:i.driverId,map:t,position:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)},icon:V,animation:n,visible:!1,zIndex:L},new MarkerWithLabel(a)}function o(i,a,n,s){var o=e.createInfoWindow(),r=[],l=s?s.name:"Conductor";return a.forEach(function(s){var c=f(s),d=e.createPolyline({map:i,path:c,geodesic:!0,strokeColor:n,strokeOpacity:.8,strokeWeight:4,draggable:!1,visible:!0});d.locations=a,d.addListener("click",function(i){for(var a=Number.MAX_VALUE,n=0,s=0,r=this.getMap(),c=b(this.locations,this.getPath()),d=0;d<this.getPath().getLength();d++){var u=e.geometryComputeDistanceBetween(i.latLng,this.getPath().getAt(d));a>u&&(a=u,n=d)}if(c[n]&&c[n+1]){var p=e.getGoogleMapsLatLng(c[n].latitude,c[n].longitude),m=e.getGoogleMapsLatLng(c[n+1].latitude,c[n+1].longitude);s=e.geometryComputeHeading(p,m)}var v=y(s),g=v.direction,h=v.icon,_='<b><i class="sp-icon-vehiculos"></i> '+l+'</b><br><i class="sp-icon-tiempo-servicio"></i> '+t(c[n].timestamp).format("HH:mm:ss")+'<br><i class="sp-icon-rutas"></i> '+g+' <i class="'+h+'"></i> <br>Lat:  '+c[n].latitude+"<br>Lng: "+c[n].longitude+"<br>";o.setContent(_),o.setPosition(i.latLng),o.open(r)}),r.push(d)}),r}function r(e,t,i){if(!e||!t||!i)throw new Error("Can't update marker if any of this objects doesn't exist: map, marker, data");t.setMap(e),i.title&&t.setTitle(i.title),i.position&&i.position.latitude&&i.position.longitude&&t.setPosition({lat:parseFloat(i.position.latitude),lng:parseFloat(i.position.longitude)}),"undefined"!=typeof i.visible&&t.setVisible(i.visible),"undefined"!=typeof i.status&&_(t,i.status)}function l(e,t){var i;for(var a in e)e[a].setVisible(!1);t.forEach(function(t){i=t.id.toString(),e.hasOwnProperty(i)&&e[i].setVisible(!0)})}function c(t,i,a){i.bounds||(i.bounds=e.getLatLngBounds());for(var n in a)a[n].getVisible()&&i.bounds.extend(a[n].getPosition());!i.bounds.isEmpty()&&t&&t.fitBounds(i.bounds)}function d(t,i,a){i.bounds||(i.bounds=e.getLatLngBounds());for(var n in a)a[n].marker&&(a[n].marker.setMap(t),i.bounds.extend(a[n].marker.getPosition()));!i.bounds.isEmpty()&&t&&t.fitBounds(i.bounds)}function u(t,i,a){i.bounds||(i.bounds=e.getLatLngBounds());for(var n in a)a[n].forEach(function(e){e.getPath().forEach(function(e){i.bounds.extend(e)})});!i.bounds.isEmpty()&&t&&t.fitBounds(i.bounds)}function p(e){for(var t in e)e[t].setVisible(!1)}function m(e){for(var t in e)e[t].setVisible=!1,e[t].setMap(null),delete e[t]}function v(e,t,i,a,n){if(this.locations=i,i.length>t.length)for(var s=t.length;s<=i.length-1;s++)t.push(o(e,i[s],a,n));else{var r=f(i[i.length-1]);r.length>0&&t[t.length-1].setPath(r[0])}}function g(e){var t,a;switch(e){case"completed":t=I,a=i(I).darken(15).toString();break;case"failed":t=S,a=i(S).darken(15).toString();break;case"canceled":t=E,a=i(canceled).darken(15).toString();break;default:t=k,a="#324376"}return{strokeColor:a,fillColor:t}}function h(t){var i;switch(t.toString().length){case 1:i=e.createPoint(-2,25);break;case 2:i=e.createPoint(1,25);break;case 3:i=e.createPoint(3,25);break;default:i=e.createPoint(-2,25)}return i}function _(e,t){switch(t){case"completed":e.setIcon(angular.extend(e.getIcon(),{fillColor:"#41D3BD",strokeColor:i("#41D3BD").darken(15).toString()}));break;case"failed":e.setIcon(angular.extend(e.getIcon(),{fillColor:"#FF5252",strokeColor:i("#FF5252").darken(15).toString()}));break;case"canceled":e.setIcon(angular.extend(e.getIcon(),{fillColor:"#607D8B",strokeColor:i("#607D8B").darken(15).toString()}));break;default:e.setIcon(angular.extend(e.getIcon(),{fillColor:i("#607D8B").lighten(15).toString(),strokeColor:i("#607D8B").lighten(5).toString()}))}}function f(t){var i=[];return t.length>3&&t.forEach(function(t){i.push(e.getGoogleMapsLatLng(parseFloat(t.latitude).toFixed(6),parseFloat(t.longitude).toFixed(6)))}),i}function b(e,t){var i=!0,a=[],n=null;t.forEach(function(e){a.push({lat:e.lat(),lng:e.lng()})});for(var s=0;s<e.length;s++){if(i=!0,e[s].length===t.getLength())for(var o=0;o<e[s].length&&e[s][o].latitude===a[o].lat.toFixed(6).toString();o++)i=!1,n=s;if(!i)break}return e[n]}function y(e){var t=null,i="",a={direction:t,icon:i};switch(!0){case e>-22.5&&22.5>e:a.direction="Norte ",a.icon="fa fa-long-arrow-up";break;case e>22.5&&67.5>e:a.direction="Noreste ",a.icon="fa fa-long-arrow-up rotate-noreste";break;case e>67.5&&112.5>e:a.direction="Este ",a.icon="fa fa-long-arrow-right";break;case e>112.5&&157.5>e:a.direction="Sureste ",a.icon="fa fa-long-arrow-up rotate-sureste";break;case e>157.5&&180>e||e>=-180&&-157.5>e:a.direction="Sur ",a.icon="fa fa-long-arrow-down";break;case e>-157.5&&-112.5>e:a.direction="Suroeste ",a.icon="fa fa-long-arrow-up rotate-suroeste";break;case e>-112.5&&167.5>e:a.direction="Oeste ",a.icon="fa fa-long-arrow-left";break;case e>-67.5&&-22.5>e:a.direction="Noroeste ",a.icon="fa fa-long-arrow-up rotate-noroeste";break;default:a.direction="Sin Orientacion "}return a}function w(e){for(var t in e)e.hasOwnProperty(t)&&(e[t].forEach(function(e){e.setMap(null)}),delete e[t])}function A(){T=e.createInfoWindow()}function x(e){for(var t in e){var i=e[t].marker;i&&i.setVisible(!1)}}var k="#868da5",I="#41D3BD",S="#FF5252",E="#607D8B",C="sp-marker-label",D=100,P=9999,L=999999,O={path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z",fillOpacity:1,strokeWeight:1,anchor:{x:10,y:31}},T=null,V={path:null,strokeColor:null,scale:10};return{createMarker:n,createVehicleMarker:s,updateMarker:r,clearMarkers:m,hideUnusedMarkers:l,fitBoundsToMarkers:c,fitBoundsToVehicleMarkers:d,fitBoundsToPolylines:u,hideAllMarkers:p,createPolyline:o,updatePolyline:v,clearPolylines:w,instanciateInfoWindow:A,hideAllMarkersLastPosition:x}}e.$inject=["googleService","moment","tinycolor","lodash"],angular.module("icarus").factory("TrackingMapService",e)}(),function(){"use strict";function e(){function e(e){this.id=e,this.username=null,this.name=null}return e.prototype.updateData=function(e){this.username=e.username,this.name=e.name},e}angular.module("icarus").factory("TrackingDriverModel",e)}(),function(){"use strict";function e(e,t){function i(i){i&&e.go("planner"),t.dismiss("close")}var a=this;a.state=e,a.redirect=i}e.$inject=["$state","$uibModalInstance"],angular.module("icarus").controller("TrackingInfoController",e)}(),function(){"use strict";function e(e){return function(t,i){if(!i)return t;var a=[];return i=i.toLowerCase(),angular.forEach(t,function(e){-1!==e.reference.toLowerCase().indexOf(i)?a.push(e):-1!==e.title.toLowerCase().indexOf(i)?a.push(e):-1!==e.address.toLowerCase().indexOf(i)&&a.push(e)}),e.$broadcast("visitsFilters",a),a}}e.$inject=["$rootScope"],angular.module("icarus").filter("trackingSearchVisits",e)}(),function(){"use strict";angular.module("icarus.shared",[])}(),function(){"use strict";function e(e){return function(t,i){var a=i.toLowerCase();return e.filter(t,function(e){var t=e.name.toLowerCase(),i=e.driver&&e.driver.name?e.driver.name.toLowerCase():"";return-1!==t.indexOf(a)||-1!==i.indexOf(a)})}}e.$inject=["lodash"],angular.module("icarus.shared").filter("trackingSearchVehicles",e)}(),function(){"use strict";function e(){function e(e,t){return e.name<t.name?-1:1}return function(t){var i=[],a=[];return angular.forEach(t,function(e){e.routes.length&&i.push(e),e.routes.length||a.push(e)}),i.sort(e),a.sort(e),[].concat(i).concat(a)}}angular.module("icarus").filter("trackingOrderVehicles",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(){c(g)}function c(e){v.loadingData=!0,n.getEventsByDate(e).then(function(e){m(e)},function(e){t.error(e),v.events.length=0})["finally"](function(){v.loadingData=!1})}function d(e,t){v.events.length=0,v.eventsFilter.length=0;var i=a(t.date),n=i.format(s);c(n)}function u(){p()}function p(){v.events.length=0,v.eventsFilter.length=0,h(),_()}function m(e){e.forEach(function(e){for(var t=!1,i=0;i<v.events.length;i++)if(v.events[i].aggregate_id===e.aggregate_id&&v.events[i].version===e.version){t=!0;break}t||(r.trackingVehiclesColor&&(e.data.vehicle_color=r.trackingVehiclesColor[e.data.vehicle_id]),v.events.push(e))}),v.eventsFilters=v.events}var v=this,g=i.trackingDate;v.loadingData=!1,v.eventsFilter=[],v.events=[],l();var h=e.$on(o.REFRESH.GENERAL_PROGRESS_CHANGED,d),_=e.$on(o.REFRESH.DATE_CHANGED,d);e.$on("$destroy",u)}e.$inject=["$scope","$log","$stateParams","moment","planService","DATE_FORMAT","TRACKING_EVENTS","$rootScope"],angular.module("icarus").controller("EventsController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){e.$emit(l.REFRESH.VEHICLE_SELECTED_CHANGE,{vehicleId:a.vehicleId}),e.$emit(l.MAP.HIDE_MARKERS),e.$emit(l.MAP.CLEAR_POLYLINES),u()}function u(){F.loadingData=!0,F.vehicleId=a.vehicleId,F.driverId=a.driverId,o.getVehicleByIdAndDriver(a.vehicleId,a.driverId).then(p)["catch"](function(){F.loadingData=!1})}function p(i,a){var n;return a=a||!0,i&&0!==i.length?(N.forEach(function(e){e.id===i.id&&(i.color=e.color)}),F.vehicleWithoutRoute=!1,F.vehicle=i,v(i).then(function(t){w(t),F.recalculateVisitsETA(),e.$emit(l.MAP.DRAW_VISITS,t,a),e.$emit(l.MAP.DRAW_ROUTE_POLYLINE,F.vehicle,F.vehicle.driver,a),e.$emit(l.VISITS.CALL_VISIT_FILTER),E()})["catch"](function(e){t.error(e),F.vehicleWithoutRoute=!0,r.isLoading=!1})["finally"](function(){r.isLoading=!1,F.loadingData=!1}),n=i.driver?i.driver.id:null,void e.$emit("showLastPositionVehicleById",{vehicleId:F.vehicle.id,driverId:n})):(F.vehicleWithoutRoute=!0,r.isLoading=!1,void(F.loadingData=!1))}function m(e){i.go("tracking.vehicles.driver-dispatchs.detail",{dispatchsId:e.id},{notify:!1})}function v(e){var t=[];F.routes=[];var i=n.defer();return e.routes.forEach(function(e){t.push(s.getRouteByID(e.id))}),n.all(t).then(function(e){var t=[];e.forEach(function(e){F.routes.push(e),t.push(s.getVisitsByRouteID(e.id))}),I(),P(F.routes),g(e).then(function(e){A(e),n.all(t).then(function(e){i.resolve([].concat.apply([],e))})})}),i.promise}function g(e){F.events=[];var t={routes:[]};return e.forEach(function(e){t.routes.push(e.id)}),s.getEventsByRoutes(t)}function h(){_(),f()}function _(){F.visits.length=0,F.events.length=0,e.$emit(l.MAP.CLEAR_MARKERS),e.$emit(l.MAP.CLEAR_POLYLINES),e.$emit(l.VEHICLES.CLEAR_VEHICLE_DRIVER_ACTIVE),F.vehicleId=null,F.driverId=null}function f(){j(),B(),H(),U(),q(),G()}function b(e,t){N=t.vehicles,_(),u()}function y(){a.vehicleId&&v(F.vehicle).then(function(t){w(t),F.recalculateVisitsETA(),e.$emit(l.MAP.DRAW_VISITS,t,!1),e.$emit(l.MAP.CALL_POLYLINES_FILTER,F.vehicle,F.vehicle.driver)})["catch"](function(e){t.error(e),F.vehicleWithoutRoute=!0})}function w(e){F.visits=e,F.vehicleWithoutRoute=0===F.visits.length,F.visits.sort(function(e,t){return e.order-t.order})}function A(e){F.events=e}function x(e){"visits"===e?(F.eventsTabSelected=!1,F.visitsTabSelected=!0):"events"===e&&(F.visitsTabSelected=!1,F.eventsTabSelected=!0)}function k(){var t,i=a.vehicleId;t=a.driverId?a.driverId:null,e.$emit("showLastPositionVehicleById",{vehicleId:i,driverId:t})}function I(){F.routes.sort(function(e,t){return e.estimatedTimeStart<t.estimatedTimeStart?-1:e.estimatedTimeStart>t.estimatedTimeStart?1:0})}function S(t,i){var a=o.filterVisits(F.visits,i.startDate,i.endDate);e.$emit(l.MAP.UPDATE_FILTERED_VISIT_MARKERS,{visitIds:a})}function E(){var t={vehicleId:F.vehicleId,driverId:F.driverId};e.$emit(l.VEHICLES.RETURN_VEHICLE_DRIVER_ACTIVE,t)}function C(t,i){e.$emit(l.MAP.CALL_POLYLINES_FILTER,F.vehicle,F.vehicle.driver)}function D(e){var t=0;if(e.startTime){var i=e.startTime.split(" "),a=i[0],n=c.createTimeUTC(e.startTime,"YYYY/MM/DD HH:mm:ssZ").diff(c.createTime(a+" "+e.estimatedTimeStart,"YYYY/MM/DD HH:mm:ss")),s=c.duration(n);t=c.asSeconds(s)}return t}function P(e){e.map(function(e){e.diffTimeInSeconds=D(e)})}function L(){for(var e=0;e<F.routes.length&&F.routes[e].startTime;e++){if(e+1<F.routes.length&&!F.routes[e+1].startTime){T(e);break}O(F.routes[e])}}function O(e){V(e.id,e.diffTimeInSeconds)}function T(e){var t=F.routes[e].diffTimeInSeconds;for(e;e<F.routes.length;e++)V(F.routes[e].id,t)}function V(e,t){F.visits.map(function(i){if(i.route_id===e){var a=c.createTime(i.estimated_time_arrival,$);i.ETARecalculated=a.add(t,"s").format($),i.isDeliveryDelayed=z(i)}})}function R(e){e.expandedIndicators=!e.expandedIndicators}function M(e){F.orderVisitsProperty=e}function z(e){var t=!1;if(e.ETARecalculated){var i=c.createTime(e.ETARecalculated,$);if(e.windowStart&&e.windowStart2){var a=c.createTime(e.windowStart,$),n=c.createTime(e.windowEnd,$);t=!c.isBetween(i,a,n)}if(e.windowStart2&&e.windowEnd2){var s=c.createTime(e.windowStart2,$),o=c.createTime(e.windowEnd2,$);t=t&&!c.isBetween(i,s,o)}}return t}var F=this,N=[],$="HH:mm:ss";F.visits=[],F.events=[],F.routes=[],F.vehicle=null,F.loadingData=!1,F.visitsTabSelected=!0,F.eventsTabSelected=!1,F.orderVisitsProperty="order",F.openModal=m,F.selectTab=x,F.getRouteDiffTime=D,F.recalculateVisitsETA=L,F.setRoutesDiffTimeSeconds=P,F.showRouteIndicators=R,F.orderVisitsBy=M;var j=e.$on(l.REFRESH.DATE_CHANGED_REFRESH_VISITS,b);e.$on("$destroy",h);var B=e.$on(l.REFRESH.GENERAL_PROGRESS_CHANGED,y),H=e.$on(l.READY.VEHICLES_MARKERS_CREATED,k),U=e.$on(l.VISITS.FILTER_VISIT_MARKERS_BY_TIME,S),q=e.$on(l.MAP.FILTER_POLYLINES_BY_TIME,C),G=e.$on(l.VEHICLES.GET_VEHICLE_DRIVER_ACTIVE,E);d()}e.$inject=["$scope","$log","$state","$stateParams","$q","planService","trackingService","$rootScope","TRACKING_EVENTS","timeUtils"],angular.module("icarus").controller("TrackingDriverDispatchListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(){o&&((o.notes||o.load||o.load2||o.load3)&&(o.notes=o.notes.replace(/&#10;/g,"\n"),k.enableMoreData=!0),k.extraFieldsValue=o.extra_field_values,k.enableMoreData=v(),g(),y(),w())}function p(){return i(f,1e3*I)}function m(e){e.id&&r.downloadAttachment(k.visit.id).then(function(t){var i=new Blob([t.data],{type:"application/zip"}),a=e.id+"_"+e.title+".zip";n.saveAs(i,a)})["catch"](function(e){s.error("status: %d, response: %o ",e.status,e.data)})}function v(){return k.enableMoreData?k.enableMoreData:a.some(k.extraFieldsValue,function(e){return e})}function g(){k.visit&&(k.visit.window_start_2!==S||k.visit.window_end_2!==S)&&(k.hasSecondTimeWindow=!0)}function h(){_(E)}function _(e){i.cancel(e)}function f(){b(t.dispatchsId)}function b(e){r.getVisitDetailById(e).then(function(e){r.selectVisit(e),e.notes&&(e.notes=e.notes.replace(/&#10;/g,"\n")),k.visit=e})}function y(){if(x()){var e=l.getGoogleMapsLatLng(o.latitude,o.longitude),t=l.getGoogleMapsLatLng(o.checkout_latitude,o.checkout_longitude);k.distanceCheckoutVisit=(l.geometryComputeDistanceBetween(e,t)/1e3).toFixed(2)+" Km"}}function w(){if(o.checkout_time&&(!o.checkout_latitude||!o.checkout_longitude))return void(k.infoNotCheckoutLatLng=!0);var e=c.getStringStyleOfOptions(),t="https://maps.googleapis.com/maps/api/staticmap?",i="size=350x560&format=png",a="&key="+C,n=A(o.status),s="&markers=color:"+n+"%7C"+o.latitude+","+o.longitude+"&markers=color:black%7C"+o.checkout_latitude+","+o.checkout_longitude;x()?(k.urlMap=t+i+e+s+a,k.showMap=!0):k.infoNotCheckout=!0}function A(e){var t,i="0x868da5",a="0x41D3BD",n="0xFF5252";switch(e){case"completed":t=a;break;case"failed":t=n;break;default:t=i}return t}function x(){return o.latitude&&o.longitude&&o.checkout_latitude&&o.checkout_longitude}var k=this,I=60,S="23:59",E=p(),C=d.GOOGLE_MAPS_KEY_PAY;k.visit=o,k.interval=null,k.enableMoreData=!1,k.extraFieldsValue={},k.hasSecondTimeWindow=!1,k.download=m,u(),e.$on("$destroy",h)}e.$inject=["$scope","$stateParams","$interval","lodash","FileSaver","$log","visit","trackingService","googleService","mapService","__env"],angular.module("icarus").controller("TrackingDispatchDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){k=o("translate"),x.placeHolderSearchVisit=k("Visits.search"),u(n.trackingDate,!1)}function u(e,i){i=!i,x.loadingData=i,s.getAllVisitsByDate(e).then(function(a){x.visits=a,I=x.visits,0===a.length?x.withoutVisits=!0:x.withoutVisits=!1,t.$emit(r.MAP.DRAW_ALL_VISITS,a,i),t.$emit(r.MAP.LOAD_VEHICLES_LAST_POSITION,{date:e,fitboundsFlag:!0}),t.$emit(r.VISITS.CALL_VISIT_FILTER)})["catch"](function(e){x.withoutVisits=!0,a.go("^",{},{notify:!1,reload:!1})})["finally"](function(){x.loadingData=!1})}function p(e,i){t.$emit(r.MAP.CLEAR_ALL_VISITS),u(i.date,!1)}function m(){y(),t.$emit(r.MAP.CLEAR_VEHICLE_MARKERS),t.$emit(r.MAP.CLEAR_ALL_VISITS)}function v(e,t){u(t.date,!0)}function g(e){a.go(".detail",{dispatchsId:e})}function h(){x.loadingData=!0,x.visitsFiltersEmpty=!1,s.searchVisit(x.searchKeyword,n.trackingDate).then(function(e){x.visits=[],0===e.length?x.visitsFiltersEmpty=!0:x.visitsFiltersEmpty=!1,e.forEach(function(e){x.visits.push(e)}),t.$emit(r.MAP.FIT_BOUNDS_VISITS_MARKERS,x.visits)})["finally"](function(){x.loadingData=!1})}function _(){b()}function f(){""===x.searchKeyword&&b()}function b(){x.visits=I,x.searchKeyword="",x.visitsFiltersEmpty=!1,t.$emit(r.MAP.FIT_BOUNDS_VISITS_MARKERS,x.visits)}function y(){S(),E(),C(),D()}function w(e,i){var a=c.filterVisits(x.visits,i.startDate,i.endDate);t.$emit(r.MAP.UPDATE_FILTERED_VISIT_MARKERS,{visitIds:a})}function A(){t.$emit(r.VEHICLES.RETURN_VEHICLE_DRIVER_ACTIVE,{})}var x=this,k=null,I=[];x.withoutVisits=!0,t.searchKeyword="",x.visits=[],x.loadingData=!1,x.openModal=g,x.searchVisit=h,x.clearInputVisit=_,x.checkClearKeyWord=f;var S=t.$on(r.REFRESH.DATE_CHANGED,p);t.$on("$destroy",m);var E=t.$on(r.REFRESH.GENERAL_PROGRESS_CHANGED,v),C=t.$on(r.VISITS.FILTER_VISIT_MARKERS_BY_TIME,w),D=t.$on(r.VEHICLES.GET_VEHICLE_DRIVER_ACTIVE,A);d()}e.$inject=["$log","$scope","$rootScope","$state","$stateParams","planService","$filter","TRACKING_EVENTS","Toasts","trackingService"],angular.module("icarus").controller("TrackingDispatchListController",e)}(),function(){"use strict";angular.module("icarus.tour",[])}(),function(){"use strict";function e(e,i,a,n,s,o,r){function l(o,r,l){function c(t,i){h&&h.destroy(),v(e.getTour(i.tourName).getCurrentStep())}function d(e,t){h&&h.destroy(),t.steps.prev.el=null,v(t.steps.current)}function u(e,t){h&&h.destroy(),r.empty()}function p(e,t){r.removeClass("tour-visible")}function m(e,t){r.addClass("tour-visible")}function v(e){var a=null,l="",c=null;if(e&&e.url===s.path()&&e.tour.active){var d=e.tour;if(r.removeClass("tour-visible"),e.options=e.options?e.options:{},o.step=e.number,o.totalSteps=d.totalSteps(),o.isTitleHtml=!!e.titleHtml,o.isBodyHtml=!!e.bodyHtml,o.title=e.titleText,o.body=e.bodyText,i(e.titleText).then(function(e){o.title=e}),i(e.bodyText).then(function(e){o.body=e}),e.options.nextBtnText?(o.nextBtnText=e.options.nextBtnText,i(e.options.nextBtnText).then(function(e){o.nextBtnText=e})):(o.nextBtnText=d.options.defaultBtnNextText,i(d.options.defaultBtnNextText).then(function(e){o.nextBtnText=e})),e.options.previousBtnText?(o.backBtnText=e.options.previousBtnText,i(e.options.previousBtnText).then(function(e){o.backBtnText=e})):(o.backBtnText=d.options.defaultBtnBackText,i(d.options.defaultBtnBackText).then(function(e){o.backBtnText=e})),e.options.dismissBtnText?(o.dismissBtnText=e.options.dismissBtnText,i(e.options.dismissBtnText).then(function(e){o.dismissBtnText=e})):(o.dismissBtnText=d.options.defaultBtnDismissText,i(d.options.defaultBtnDismissText).then(function(e){o.dismissBtnText=e})),o.allowCloseBtn=e.options.allowCloseBtn||void 0===e.options.allowCloseBtn,o.close=function(){e.dismiss()},r.empty(),a=n(t)(o),l+='<div class="tour-footer row"><div class="optional-buttons">',e.options.enableDismissBtn&&(l+='<button type="button" class="btn btn-primary tour-dismiss-btn" ng-click="dismiss()">{{dismissBtnText}}</button>',o.dismiss=function(){e.dismiss()}),e.options&&angular.isArray(e.options.allowOverrideFunctions)&&-1!==e.options.allowOverrideFunctions.indexOf("back")?e.options.buttons&&e.options.buttons.back?(l+='<button type="button" class="btn btn-default tour-back-btn" ng-click="back()">{{backBtnText}}</button>',o.back=function(){e.options.buttons.back()}):l+='<button type="button" class="btn btn-default tour-back-btn">{{backBtnText}}</button>':(e.previousStepId||e.tour.options.previousTour)&&(l+='<button type="button" class="btn btn-default tour-back-btn" ng-click="back()">{{backBtnText}}</button>',o.back=function(){e.back()}),l+="</div>",e.options&&e.options.enumerate){var u=e.getEnumeration();l+='<div class="enumerate">'+u.current+" / "+u.total+"</div>"}e.options&&angular.isArray(e.options.allowOverrideFunctions)&&-1!==e.options.allowOverrideFunctions.indexOf("next")?e.options.buttons&&e.options.buttons.next?(l+='<button type="button" class="btn btn-success tour-next-btn" ng-click="next()">{{nextBtnText}}</button>',o.next=function(){e.options.buttons.next()}):l+='<button type="button" class="btn btn-success tour-next-btn">{{nextBtnText}}</button>':(e.nextStepId||e.tour.options.nextTour)&&(l+='<button type="button" class="btn btn-success tour-next-btn" ng-click="next()">{{nextBtnText}}</button>',o.next=function(){e.next()}),l+="</div>",c=n(l)(o),a.append(c),r.prepend(a),e.el=angular.element(r[0]).children().eq(0),g(e,r)}}function g(e,t){if(e.attachTo){t.removeClass("tour-center");var i=document.getElementById(e.attachTo.target);h=new Tether({element:t,target:i,attachment:e.attachTo.attachment,targetAttachment:e.attachTo.targetAttachment,offset:e.attachTo.offset||"0 0"})}else t.addClass("tour-center"),h=new Tether({classPrefix:"tour",element:t,target:document.body,attachment:"middle left",targetAttachment:"middle center",offset:"0 100px"});t.addClass("tour-visible")}var h=null;a.$on("TOUR:START",c),a.$on("TOUR:STEP_CHANGED",d),a.$on("TOUR:END_ALL_TOURS",u),a.$on("TOUR:HIDE_STEP",p),a.$on("TOUR:SHOW_STEP",m)}return{restrict:"E",scope:{},link:l}}e.$inject=["TourManager","$translate","$rootScope","$compile","$location","store","$timeout"];var t='<div class="tour-popup"><div class="tour-title"><span ng-if="!isTitleHtml">{{title}}</span><div class="fa fa-times pull-right btn-close-tour" ng-if="allowCloseBtn" ng-click="close()"></div><div ng-if="isTitleHtml"></div></div><div class="tour-body"><span ng-if="!isBodyHtml">{{body}}</span><div ng-if="isBodyHtml"></div></div></div>';angular.module("icarus.tour").directive("tourPopup",e)}(),function(){"use strict";function e(e){function t(e,t){this.name=e,this.steps=[],this.currentStep=null,this.options=t,this.active=!1}function i(e,t,i){for(var a=null,n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]===i){a=e[n];break}return a}function a(t,a){try{JSON.stringify(a)}catch(n){throw new Error("Tour: can't register a step if data provided isn't in JSON format")}var s=i(this.steps,"id",this.name+"."+t);return s||(a.id=t,a.tour=this,this.steps.push(e.prototype.fromJson(a))),this}function n(){return this.currentStep}function s(){return this.steps.length}return t.prototype.registerStep=a,t.prototype.getCurrentStep=n,t.prototype.totalSteps=s,t}e.$inject=["TourStep"],angular.module("icarus.tour").factory("Tour",e)}(),function(){"use strict";function e(e,t,i){for(var a=null,n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]===i){a=e[n];break}return a}function t(t,i,a){function n(e){var a=l(e);return a.active=!0,i.set("activeTour",a.name),t.onTour=!0,t.$broadcast("TOUR:START",{tourName:e}),a}function s(e){var a=l(e);a.active=!1,i.remove("activeTour"),t.onTour=!1,t.$broadcast("TOUR:END",{tourName:e})}function o(){var t=i.get("activeTour"),a=e(c,"active",!0);return t&&!a&&(a=n(t)),a}function r(){var e=o();e.currentStep=e.steps[0],e.currentStep.hide(),e.active=!1,t.onTour=!1,i.remove("activeTour"),i.set("activatedTour",!1),t.$broadcast("TOUR:END_TOUR",{tourName:e.name}),t.$broadcast("TOUR:END_ALL_TOURS")}function l(t){return e(c,"name",t)}var c=a;return{startTour:n,endTour:s,getTour:l,getActiveTour:o,endTours:r}}function i(){function i(t,i){try{JSON.stringify(i)}catch(a){throw new Error("Tour: can't register a step if data provided isn't in JSON format")}var n=e(this.steps,"id",this.name+"."+t);return n||this.steps.push({id:t,data:i}),this}var a=[];this.$get=["$rootScope","store","Tour",function(e,i,n){var s=[];return angular.forEach(a,function(e){var t=new n(e.name,e.options);t._tours=s,angular.forEach(e.steps,function(e){t.registerStep(e.id,e.data)}),s.push(t)}),t(e,i,s)}],this.registerTour=function(t,n){var s=e(a,"name",t),o={};if(s)throw new Error("Tour: tour name '"+t+"' its already taken.");return o={name:t,steps:[],options:n},a.push(o),o.step=i,o}}angular.module("icarus.tour").provider("TourManager",i)}(),function(){"use strict";function e(e,t){function i(e,t,i,a,n,s,o,r,l,c,d,u,p){this.number=c.steps.length+1,this.id=c.name+"."+e,this.templateUrl=t,this.template=i,this.titleText=a,this.titleHtml=n,this.bodyText=s,this.bodyHtml=o,this.previousStepId=r,this.nextStepId=l,this.isRender=!1,this.tour=c,this.options=p,this.url=d,this.attachTo=u,this.nextBtnElement=null,1===this.number&&(c.currentStep=this)}function a(e,t,i){for(var a=null,n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]===i){a=e[n];break}return a}function n(e){var t=0;return e.steps.forEach(function(e){e.options&&e.options.enumerate&&t++}),t}function s(e,t){var i=t?"nextTour":"previousTour";if(e&&e.options[i]){var o=a(e._tours,"name",e.options[i]);return n(e)+s(o,t)}return e?n(e):0}function o(e,t){for(var i=0,n=0,o=0;o<t.steps.length;o++){var r=t.steps[o];if(r.options&&r.options.enumerate&&n++,r.id===e.id)break}if(t&&t.options.setGlobalEnumeration&&t.options.previousTour){var l=a(t._tours,"name",t.options.previousTour);i=s(l,!1)}return i+n}function r(e,t,i){var n=!!e.options.nextTour;if(e[t]=i,n){var s=a(e._tours,"name",e.options.nextTour);r(s,t,i)}}function l(e){if(e.template&&e.templateUrl)throw new Error("TourStep: template or templateUrl field required");if((e.template||e.templateUrl)&&(e.titleText||e.titleHtml||e.bodyText||e.bodyHtml))throw new Error("TourStep: can't set template or templateUrl and others template options like title or body together");if(!e.titleText&&!e.titleHtml)throw new Error("TourStep: without template or templateUrl, title are required set titleText or titleHtml");if(e.titleText&&e.titleHtml)throw new Error("TourStep: can't set titleText and titleHtml together just choose one option");if(!e.bodyText&&!e.bodyHtml)throw new Error("TourStep: without template or templateUrl, body are required set bodyText or bodyHtml");if(e.bodyText&&e.bodyHtml)throw new Error("TourStep: can't set bodyText and bodyHtml together just choose one option");if(!e.url)throw new Error("TourStep: url field required");return new i(e.id,e.templateUrl,e.template,e.titleText,e.titleHtml,e.bodyText,e.bodyHtml,e.previousStep,e.nextStep,e.tour,e.url,e.attachTo,e.options)}function c(){return this.isRender=!1,e.$broadcast("TOUR:HIDE_STEP"),this}function d(){return this.isRender=!0,e.$broadcast("TOUR:SHOW_STEP"),this}function u(){var i=null;if(this.hide(),this.nextStepId){if(i=a(this.tour.steps,"id",this.tour.name+"."+this.nextStepId))return this.tour.currentStep=i,e.$broadcast("TOUR:STEP_CHANGED",{tourName:this.tour.name,steps:{prev:this,current:i}}),i.show(),i;throw new Error("TourStep '"+this.nextStepId+"' doesn't exist")}if(this.tour.currentStep=this.tour.steps[0],this.tour.active=!1,t.remove("activeTour"),e.$broadcast("TOUR:END_TOUR",{tourName:this.tour.name}),this.tour.options.nextTour){var n=a(this.tour._tours,"name",this.tour.options.nextTour);if(!n)throw e.onTour=!1,new Error("TOUR: can't find next tour '"+this.tour.options.nextTour+"'");n.active=!0,t.set("activeTour",n.name),n.currentStep=n.steps[0],n.currentStep.show(),e.$broadcast("TOUR:STEP_CHANGED",{tourName:n.name,steps:{prev:this,current:n.currentStep}})}else e.onTour=!1,e.$broadcast("TOUR:END_ALL_TOURS");return this}function p(){var i=null;if(this.previousStepId){if(this.hide(),i=a(this.tour.steps,"id",this.tour.name+"."+this.previousStepId))return this.tour.currentStep=i,e.$broadcast("TOUR:STEP_CHANGED",{tourName:this.tour.name,steps:{prev:this,current:i}}),i.show(),i;throw new Error("TourStep '"+this.previousStepId+"' doesn't exist")}if(this.tour.currentStep=this.tour.steps[0],this.tour.active=!1,t.remove("activeTour"),this.tour.options&&this.tour.options.previousTour){var n=a(this.tour._tours,"name",this.tour.options.previousTour);if(!n)throw e.onTour=!1,new Error("TOUR: can't find previous tour '"+this.tour.options.previousTour+"'");n.active=!0,t.set("activeTour",n.name),n.currentStep=n.steps[n.steps.length-1],n.currentStep.show(),e.$broadcast("TOUR:STEP_CHANGED",{tourName:n.name,steps:{prev:this,current:n.currentStep}})}return this}function m(){this.hide(),this.tour.currentStep=this.tour.steps[0],this.tour.active=!1,e.onTour=!1,t.remove("activeTour"),e.$broadcast("TOUR:END_TOUR",{tourName:this.tour.name}),e.$broadcast("TOUR:END_ALL_TOURS")}function v(e,t){if("string"!=typeof e||"string"==typeof e&&!e.match(/^(next|back)$/))throw new Error("TOUR: can't override custom actions. Available actions to override are (next|back).");if(!angular.isArray(this.options.allowOverrideFunctions)||angular.isArray(this.options.allowOverrideFunctions)&&-1===this.options.allowOverrideFunctions.indexOf(e))throw new Error("TOUR: can't only override methods allowed.");if(this.el)for(var i=this.el.children().eq(2),a=i.children(),n=0;n<a.length;n++){var s=angular.element(a[n]);if("next"===e&&s.hasClass("tour-next-btn")){s.on("click",t.bind(this));break}if("back"===e&&s.hasClass("optional-buttons")){var o=s.children(),r=2===o.length?1:0,l=angular.element(o[r]);l.on("click",t.bind(this));break}}else this.options.buttons=this.options.buttons instanceof Object?this.options.buttons:{},this.options.buttons[e]=t.bind(this)}function g(){var e,t;return this.tour.options.setGlobalEnumeration&&this.tour.options.nextTour&&!this.tour._totalGlobalSteps?(e=s(this.tour,!0),r(this.tour,"_totalGlobalSteps",e)):e=this.tour.options.setGlobalEnumeration&&this.tour._totalGlobalSteps?this.tour._totalGlobalSteps:n(this.tour),t=o(this,this.tour),{current:t,total:e}}function h(e,t){return!!this.id.match(t+"."+e)}return i.prototype.fromJson=l,i.prototype.next=u,i.prototype.back=p,i.prototype.hide=c,i.prototype.show=d,i.prototype.dismiss=m,i.prototype.overrideAction=v,i.prototype.getEnumeration=g,i.prototype.is=h,i}e.$inject=["$rootScope","store"],angular.module("icarus.tour").factory("TourStep",e)}(),function(){"use strict";function e(e,t){function i(i,a,n){function s(){var e=t.getActiveTour();l(!!e)}function o(){l(!0)}function r(e,t){l()}function l(e){e?c():d()}function c(){var e;e=angular.element(a.children()).eq(0),(e&&!e.hasClass("tour-overlay-layer")||!e)&&(p=a.css("position"),a.css("position","relative"),e=angular.element(u),e.addClass("tour-active"),a.prepend(e))}function d(){var e=angular.element(a.children()).eq(0);e.hasClass("tour-overlay-layer")&&(e.removeClass("tour-active"),setTimeout(function(){e.remove(),a.css("position",p)},300))}var u='<div class="tour-overlay-layer"></div>',p=null;e.$on("$viewContentLoaded",s),e.$on("TOUR:START",o),e.$on("TOUR:END_ALL_TOURS",r)}return{restrict:"A",link:i}}e.$inject=["$rootScope","TourManager"],angular.module("icarus.tour").directive("onTourHide",e)}(),function(){"use strict";function e(e){function t(t,i,a){function n(t){var i=e.getActiveTour();i&&t&&l(i.getCurrentStep(),t)}function s(e,i){t.onTourBlock instanceof Object&&t.onTourBlock.hasOwnProperty(i.tourName)&&u()}function o(e,t){u()}function r(e,i){i.steps.current&&t.onTourBlock&&l(i.steps.current,t.onTourBlock)}function l(e,t){c(e,t)?d():u()}function c(e,t){var i=!1;if(t instanceof Object)for(var a in t)if(a===e.tour.name&&-1!==t[a].indexOf(e.id.split(".")[1])){i=!0;break}return i}function d(){i.hasClass(m)||(i.addClass(m),h=i.children().eq(0),(h&&!h.hasClass(v)||!h)&&i.prepend(g))}function u(){i.hasClass(m)&&(i.removeClass(m),h=i.children().eq(0),h&&h.hasClass(v)&&h.remove());
}function p(){_(),u()}var m="tour-visible-layer",v="tour-block-layer",g='<div class="tour-block-layer"></div>',h=null,_=null;_=t.$watchCollection("onTourBlock",n),t.$on("$destroy",p),t.$on("TOUR:STEP_CHANGED",r),t.$on("TOUR:END_TOUR",s),t.$on("TOUR:END_ALL_TOURS",o)}return{restrict:"A",scope:{onTourBlock:"="},link:t}}e.$inject=["TourManager"],angular.module("icarus.tour").directive("onTourBlock",e)}(),function(){"use strict";function e(e,t){function i(i,a,n,s){angular.isUndefined(s)&&(s=!1);var o={type:i,message:a,dismiss:n};return e.toasts.push(o),n||s||t(function(){e.toasts.splice(e.toasts.indexOf(o),1)},4e3),o}function a(t){e.toasts.splice(e.toasts.indexOf(t),1)}function n(){e.toasts.length=0}function s(){return e.toasts}function o(t){return e.toasts.indexOf(t)>-1}function r(t){var i=[],a=0,n=0;if(t instanceof Object){for(var s in t)a++;if(a){for(var o=0;o<e.toasts.length;o++){for(var r in t)"type"===r&&e.toasts[o].type===t[r]?n++:"message"===r&&-1!==e.toasts[o].message.search(t[r])?n++:"dismiss"===r&&e.toasts[o].dismiss===t[r]&&n++;n===a&&i.push(e.toasts[o]),n=0}return i.length>0?i:[]}}}e.toasts=[];var l={push:i,remove:a,stillAlive:o,removeAll:n,get:r,getCurrents:s};return l}e.$inject=["$rootScope","$timeout"],angular.module("icarus").factory("Toasts",e)}(),function(){"use strict";function e(e){e.translations("es",{Toast:{accept:"aceptar",error_unauthorized:"Error en su autenticacion",error_path_tracking:"Error para acceder a la ruta",error_permissions:"Usted no posee permisos para acceder",error_get_options_map_1:"Error en sintaxis del mapa.",error_get_options_map_2:"Error mapa no encontrado.",error_get_map_offline:"Error al visualizar el mapa, por favor revise su conexi√≥n a Internet",error_connection_internet:"No es posible conectarse con SimpliRoute, por favor revise su conexi√≥n a Internet y recargue la p√°gina"}}),e.translations("en",{Toast:{accept:"accept",error_unauthorized:"Authentication error",error_path_tracking:"Failed to access the route",error_permissions:"You do not have permission to access",error_get_options_map_1:"Error: Syntax map, Please review options map",error_get_options_map_2:"Error: map not found.",error_get_map_offline:"Failed to view the map, please check your Internet connection",error_connection_internet:"Could not connect to SimpliRoute, please check your Internet connection and reload page"}}),e.translations("pt",{Toast:{accept:"anos",error_unauthorized:"Error en su autenticacion",error_path_tracking:"Error para acceder a la ruta",error_permissions:"Usted no posee permisos para acceder",error_get_options_map_1:"Error en sintaxis del mapa.",error_get_options_map_2:"Error mapa no encontrado.",error_get_map_offline:"Error al visualizar el mapa, por favor revise su conexi√≥n a Internet",error_connection_internet:"N√£o foi poss√≠vel conectar ao SimpliRoute, verifique a sua liga√ß√£o √† Internet e Recarregar p√°gina "}})}e.$inject=["$translateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e){function t(t){t.toasts=e.toasts,t.getIcon=function(e){switch(e){case"error":return"fa-ban";case"message":return"fa-comment";case"warning":return"fa-warning";case"success":return"fa-check"}},t.remove=function(t){e.toasts.splice(e.toasts.indexOf(t),1)}}var i={restrict:"EA",link:t,replace:!0,templateUrl:"app/shared/toast/toast.html",scope:{}};return i}e.$inject=["$rootScope"],angular.module("icarus").directive("toast",e)}(),function(){"use strict";function e(e){function t(t,i){var a;return a=i?e(t,i):e(t)}function i(t,i){return e(t).format(i)}function a(e,t,i){return e.isBetween(t,i,null,"[]")}function n(e,t){return e.isAfter(t)}function s(){return e().toDate()}function o(t,i){return t=e(t),i=e(i),t.isSameOrBefore(i)}function r(t,i,a){return t=e(t),i=e(i),e.duration(i.diff(t)).asDays()<=a}function l(t,i){return e(t).subtract(i,"month").format("YYYY-MM")}function c(){return e().toISOString()}function d(t){return e(t).toISOString()}function u(t,i){var a;return a=i?e.utc(t,i):e.utc(t)}function p(t){return e.duration(t)}function m(e){return e.asSeconds()}function v(e){return e.asHours()}function g(e){return e.asDays()}function h(e){return e.getTime()}function _(){return(new Date).getTime()}function f(e){return e.toDate()}function b(t,i){return e(t).diff(e(i))}function y(t){return e(t).isValid()}function w(e){return new Date(e)}return{createTime:t,formatTime:i,isBetween:a,isAfter:n,today:s,validateStartDate:o,validateDateRange:r,lastDateByMonth:l,toIsoString:c,toIsoStringByDate:d,createTimeUTC:u,duration:p,asSeconds:m,asHours:v,asDays:g,getTime:h,getTimeDate:_,todayByDate:f,diff:b,isValidMoment:y,newDate:w}}e.$inject=["moment"],angular.module("icarus").factory("timeUtils",e)}(),function(){"use strict";function e(e,t){function i(e){return e*(Math.PI/180)}function a(e,t){var a=6371,n=i(t.latitude-e.latitude),s=i(t.longitude-e.longitude),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(i(e.latitude))*Math.cos(i(t.latitude))*Math.sin(s/2)*Math.sin(s/2),r=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),l=a*r;return 1e3*l}function n(t,i){var a=e(i.timestamp).diff(e(t.timestamp)),n=e.duration(a).asSeconds();return n}function s(e){return 1e3*e/3600}function o(e,t){var i=null,a=[];return e.forEach(function(e){var n={latitude:e.latitude,longitude:e.longitude,timestamp:e.timestamp};if(!i||i.timestamp!==n.timestamp){if(0===a.length)return a.push([n]),void(i={latitude:n.latitude,longitude:n.longitude,timestamp:n.timestamp});t(a,n,i),i={latitude:n.latitude,longitude:n.longitude,timestamp:n.timestamp}}}),a}function r(t,i,s){var o,r,l=e(i.timestamp),c=e(s.timestamp);o=a(s,i),e.duration(l.diff(c)).asSeconds()>20&&(p>o?(r=n(i,s),m>o/r&&t[t.length-1].push(i)):t.push([i]))}function l(e,t){e[e.length-1].push(t)}function c(e){var i=t.clone(e);i.sort(function(e,t){return e.timestamp<t.timestamp?-1:e.timestamp>t.timestamp?1:0});var n=[];return i.forEach(function(e,t){if(i[t+1]){var s=a(i[t],i[t+1]);s>p&&n.push(t)}}),n=t.uniq(n),n.forEach(function(e){delete i[e]}),i=i.filter(function(e){return e})}function d(e){var t,i=[],a=r,n=l,s=c(e);return t=s.length>0?s[0].type:null,i=t===u?o(s,a):o(s,n)}var u="simpli",p=2500,m=s(100);return{calculatePolylines:d}}e.$inject=["moment","lodash"],angular.module("icarus").factory("polylineService",e)}(),function(){"use strict";function e(e,t){function i(t,i){return e.get(a,{params:{loc:t,uturns:i},headers:{Authorization:void 0}})}var a=t.OSRM_URL+"viaroute",n={callOsrmViaroute:i};return n}e.$inject=["$http","__env"],angular.module("icarus.shared").factory("osrmService",e)}(),function(){"use strict";function e(e,t){function i(e){s(ga,e)}function a(e){s(ga,e)}function n(){var t=angular.element(document.createElement("script"));try{var i=" (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-51845510-3', 'auto');ga('send', 'pageview');ga('require', 'ecommerce');";t.empty(),t.type="text/javascript",t.text(i),angular.element(document.getElementsByTagName("head")).append(t)}catch(a){e.info(a)}}function s(t,i){try{i.ecommerce?t(i.type,i.ecommerce):i.events?t(i.type,i.events.name,i.events.category,i.events.action,i.events.label):t(i.type)}catch(a){e.info(a)}}function o(i){try{t.google_trackConversion({google_conversion_id:944253981,google_conversion_language:t.translateAdwords,google_conversion_format:3,google_conversion_color:"ffffff",google_conversion_label:i,google_remarketing_only:!1})}catch(a){e.error("Cannot log in Google Track Conversion")}}var r={sendEventGoogle:i,sendEcommerceGoogle:a,googleAnalyticsHeader:n,callGoogleTrackConversion:o};return r}e.$inject=["$log","$window"],angular.module("icarus.shared").factory("marketingService",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){return i.API_URL+"logs/"}function o(i){var a={account:i.accountId,user_id:i.userId,username:i.username,json:JSON.stringify(i.json),type_action:i.typeAction};t.post(s(),a).then(function(){e.info("Saved successful")})["catch"](function(t){e.error("failed save log",t)})}function r(e,t){n.getUser().then(function(i){var n={account_id:i.account.id,user_id:i.id,username:i.username,type_action:t,json:{plan_id:e.id,username:i.username,name_plan:e.name,start_date_plan:e.startDate,end_date_plan:e.endDate}},s=a.fromJson(n);o(s)})}var l={createLogForPlan:r};return l}e.$inject=["$log","$http","__env","Log","sessionService"],angular.module("icarus.shared").factory("LogService",e)}(),function(){"use strict";function e(e){function t(e){return 0!==e.length}function i(e){return 0!==e.length}function a(e,t){return e.map(function(e){return t[e].toString().trim()})}function n(e){return e.map(function(e){var t=Object.keys(e);return a(t,e)})}function s(t,i){return e.every(t,function(e){return Object.keys(e).length===i.length})}function o(e,t){return s(e,t)}function r(e,a){if(!i(e)||!t(a))throw new Error("Empty input");if(!o(e,a))throw new Error("Keys do not match")}function l(e,t){r(e,t);var i=n(e);return{headers:t,data:i}}function c(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=e%26,a=t[i],n=parseInt(e/26);return n>0?c(n-1)+a:a}function d(e){for(var t="",i={},a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++){var s="";s=c(n),t=s+(a+2),e[a][n]&&"object"==typeof e[a][n]&&e[a][n].hasOwnProperty("v")&&e[a][n].hasOwnProperty("t")?i[t]={v:angular.isUndefined(e[a][n].v)||null===e[a][n].v?"":e[a][n].v,t:e[a][n].t}:i[t]={v:angular.isUndefined(e[a][n])||null===e[a][n]?"":e[a][n].toString(),t:"s"}}return{data:i,lastCell:t}}function u(e){for(var t={},i="",a=0;a<e.length;a++){var n=c(a);i=n+1,t[i]={v:e[a],t:"s"}}return{data:t,lastCell:i}}function p(e,t){var i={},a=u(t.headers);i[e]=a.data;var n=d(t.data);return i[e]=Object.assign(i[e],n.data),a.lastCell&&(i[e]["!ref"]="A1:"+(n.lastCell?n.lastCell:a.lastCell)),i}function m(e,t){var i=[],a=e.trim().replace(/ /g,"_"),n=p(a,t);return i.push(a),{Sheets:n,SheetNames:i}}function v(e){var t={bookType:"xlsx",bookSST:!1,type:"binary"};return XLSX.write(e,t)}function g(e){function t(e,t){t&&(e+=1462);var i=Date.parse(e);return(i-new Date(Date.UTC(1899,11,30)))/864e5}for(var i={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!==e.length;++n)for(var s=0;s!==e[n].length;++s){a.s.r>n&&(a.s.r=n),a.s.c>s&&(a.s.c=s),a.e.r<n&&(a.e.r=n),a.e.c<s&&(a.e.c=s);var o={v:e[n][s]};if(null!==o.v){var r=XLSX.utils.encode_cell({c:s,r:n});angular.isNumber(o.v)?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=t(o.v)):o.t="s",i[r]=o}}return a.s.c<1e7&&(i["!ref"]=XLSX.utils.encode_range(a)),i}return{listToGrid:l,createWorkbook:m,writeWorkbook:v,insertValues:d,sheetFromMatrix:g}}e.$inject=["lodash"],angular.module("icarus.bulk",[]).factory("xlsWriterService",e)}(),function(){"use strict";function e(e){function t(t,a){e.saveAs(new Blob([i(t)],{type:""}),a)}function i(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0;a!==e.length;++a)i[a]=255&e.charCodeAt(a);return t}function a(t,i){e.saveAs(t,i)}return{downloadXLSX:t,donwloadFile:a}}e.$inject=["FileSaver"],angular.module("icarus.bulk").factory("fileDownloaderService",e)}(),function(){"use strict";function e(e,t,i,a){function n(){e.$index=(l.currentPage-1)*l.itemsPerPage}function s(){i.closeAll(),t.go(l.data.callActionUrl)}function o(e){e?++l.data.itemsSelected:--l.data.itemsSelected}function r(e){return function(t){return a.naturalValue(t[e])}}var l=this;l.itemsPerPage=12,l.currentPage=1,l.maxSize=3,l.data.itemsSelected=l.itemsSelected,l.listFilter=[],l.pageChanged=n,l.goToAction=s,l.updateItemSelected=o,l.naturalSort=r,this.$onChanges=function(e){angular.isDefined(e.itemsSelected)&&(l.data.itemsSelected=e.itemsSelected.currentValue)}}var t={templateUrl:"app/shared/components/selectableItemsList.html",controller:["$scope","$state","ngDialog","naturalService",e],bindings:{data:"<",itemsSelected:"<"}};angular.module("icarus.shared").component("selectableItemsList",t)}(),function(){"use strict";angular.module("icarus.settings",["ngSanitize","ui.select","icarus.shared"])}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(){p(),g()}function p(){m(),v()}function m(){return a.isLoading=!0,e.listZones().then(function(e){a.isLoading=!1,G.zones=e})["catch"](function(e){i.error(e),a.isLoading=!1})}function v(){return a.isLoading=!0,e.listVehicles().then(function(e){a.isLoading=!1,G.vehicles=e})}function g(){e.isEnableZonesProperty(Y,J).then(function(e){P(e)})["catch"](function(e){i.error(e)})}function h(){n.open({template:"app/settings/zones/zone-edit.html",controller:"ZoneEditController",controllerAs:"vm",className:"ngdialog-theme-default custom-width-800 zone-modal",resolve:{zoneObj:function(){return null}}})}function _(e){n.open({template:"app/settings/zones/zone-edit.html",controller:"ZoneEditController",controllerAs:"vm",className:"ngdialog-theme-default custom-width-800 zone-modal",resolve:{zoneObj:function(){return e}}})}function f(t,i){e.removeCache(),i.data.coordinates=e.parseFromStringToArray(i.data.coordinates);var a=e.createZone(i.data),n=b(a.id);n?angular.extend(n,a):G.zones.push(a)}function b(e){return G.zones.find(function(t){return t.id===e})}function y(e){return G.zones.findIndex(function(t){return t.id===e})}function w(e){n.openConfirm({template:"app/settings/zones/zone-delete-modal.html"}).then(function(){k(e)})}function A(t){a.isLoading=!1,G.zones.splice(y(t),1),e.removeCache(),o.push("success",q("Zones.Delete.delete_success"))}function x(){a.isLoading=!1,i.error("Error on delete request"),o.push("error",q("Zones.Delete.delete_fail"))}function k(t){a.isLoading=!0,e.deleteZone(t).then(A.bind(null,t))["catch"](x)}function I(){a.isLoading=!0;var e=L();G.actionUseZones.id?E(e):S(e)}function S(t){e.createZoneProperties(t).then(function(e){C(e)})["catch"](function(e){D(e)})}function E(t){e.updateZoneProperties(t).then(function(){C()})["catch"](function(e){D(e)})}function C(e){a.isLoading=!1,o.push("success",q("Zones.Actions.success_zone_property")),e&&e.id&&(G.actionUseZones.id=e.id)}function D(e){i.error(e),o.push("error",q("Zones.Actions.error_zone_property")),a.isLoading=!1}function P(e){G.actionUseZones.zonesAddonId=e.addonId,G.actionUseZones.id=e.id,G.actionUseZones.value=e.useZones}function L(){return{id:G.actionUseZones.id,title:G.actionUseZones.title,key:G.actionUseZones.key,value:String(G.actionUseZones.value),description:G.actionUseZones.description,add_on_id:parseInt(G.actionUseZones.zonesAddonId)}}function O(e){var t=G.zones.filter(function(t){return-1!==t.vehicles.indexOf(e.id)}).map(function(e){return e.name}).join();return t}function T(e){var t=[];return e.forEach(function(e){var i={vehicle:e.name,zones:O(e)};t.push(i)}),t}function V(e){var t=G.vehicles.find(function(t){return t.name===e});return t?t.id:-1}function R(e){var t=G.zones.find(function(t){return t.name===e});return t?t.id:-1}function M(e){return e.split(",").map(function(e){return e.trim()})}function z(e){var t={zonesIds:[],errors:[]},i=M(e);return i.forEach(function(e){if(e){var i=R(e);if(-1!==i)t.zonesIds.push(i);else{var a={value:e,desc:X};t.errors.push(a)}}}),t}function F(e){var t={vehicleId:-1,errors:[]},i=V(e);return-1!==i?t.vehicleId=i:t.errors.push({value:e,desc:K}),t}function N(e){var t={rowData:{},rowErrors:[]},i=F(e.vehicle),a=z(e.zones);return t.rowData.vehicle=i.vehicleId,t.rowData.zones=a.zonesIds,t.rowErrors=i.errors.concat(a.errors),t}function $(e){var t={validRequest:W,requestData:[],rowErrors:[]};return e.forEach(function(e){var i=N(e),a={validRow:!0,rowNumber:e["!row"],errors:i.rowErrors};i.rowErrors.length&&(t.validRequest=Z),-1!==i.rowData.vehicle?t.requestData.push(i.rowData):a.validRow=!1,t.rowErrors.push(a)}),t.requestData.length||(t.validRequest=Q),t}function j(e,t){s.errorInfo=e,s.validRequest=t;var i=n.open({template:"app/settings/zones/zones-bulk-modal.html",className:"ngdialog-theme-default custom-width-800 zone-modal",scope:s});i.closePromise.then(function(){p()})}function B(t){a.isLoading=!0,e.updateAssignations(t.requestData).then(function(){e.removeCache(),a.isLoading=!1,j(t.rowErrors,t.validRequest)})["catch"](function(e){i.error(e),a.isLoading=!1,o.push("error",q("Zones.Bulk.error_upload_failure"))})}function H(){var e=[q("Zones.Bulk.excel_header_vehicles"),q("Zones.Bulk.excel_header_zones")],i=t.listToGrid(T(G.vehicles),e),a=t.createWorkbook("Zones",i),n=t.writeWorkbook(a);l.downloadXLSX(n,"zones.xlsx")}function U(e){c.handleFile(e[0]).then(function(e){var t=["vehicle","zones"],i=d.createGrid(e,t),a=d.gridToList(i),n=$(a);n.requestData.length?B(n):o.push("error",q("Zones.Bulk.error_no_data"))})}var q=r("translate"),G=this,J="use_zones_to_optimization",Y="zones",W="OK",Q="NO_DATA",Z="WITH_ERRORS",K="VEHICLE_NOT_FOUND",X="ZONE_NOT_FOUND";G.zones=[],G.vehicles=[],G.actionUseZones={id:null,title:q("Zones.Actions.use_zones.title"),btn1:{title:q("Zones.Actions.use_zones.use_zones")},btn2:{title:q("Zones.Actions.use_zones.hide_zones")},key:J,value:!1,description:"Usar zonas en optimizacion",zonesAddonId:null},G.addZone=h,G.editZone=_,G.confirmDelete=w,G.deleteZone=k,G.saveZoneProperties=I,G.downloadZones=H,G.importZones=U;var ee=s.$on("ZONE:UPDATELIST",f);s.$on("$destroy",function(){ee()}),u()}e.$inject=["zoneService","xlsWriterService","$log","$rootScope","ngDialog","$scope","Toasts","$filter","fileDownloaderService","xlsUploaderService","xlsParserService"],angular.module("icarus.settings").controller("ZonesController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(){o&&(angular.extend(f.zone,o),w=angular.copy(o),A=f.zone.vehicles),r.all([i.listZones(),i.listVehicles()]).then(function(e){y=e[0],c(e[1])})["catch"](function(e){t.error(e)})}function c(e){f.zone.vehicles=e,f.dataSelectableItemsList.items=f.zone.vehicles.map(function(e){return d(e.id)&&(e.activate=!0,f.dataSelectableItemsSelected++),e})}function d(e){return-1!==A.indexOf(e)}function u(){var e=_(f.zone.name);!e||e&&w&&e.name===w.name?(s.isLoading=!0,f.nameError=!1,f.zone.id?m(f.zone):p(f.zone)):f.nameError=!0}function p(e){i.saveZone(e).then(v)["catch"](g)}function m(e){i.updateZone(e).then(v)["catch"](g)}function v(t){s.isLoading=!1,a.push("success",b("Zones.Edit.save_success")),e.closeAll(),s.$broadcast("ZONE:UPDATELIST",t)}function g(e){s.isLoading=!1,t.error(e),a.push("error",b("Zones.Edit.save_fail"))}function h(){e.closeAll()}function _(e){return y.find(function(t){return t.name===e})}var f=this,b=n("translate");f.zone={coordinates:null,name:null,vehicles:[]},f.nameError=!1;var y=[],w=null,A=[];f.dataSelectableItemsList={items:f.zone.vehicles,title:b("Zones.Items_list.title"),icon:"sp-icon-vehiculos",msgItemsEmpty:b("Zones.Items_list.msg_items_empty"),callAction:b("Zones.Items_list.call_action"),callActionUrl:"settings.vehicles.create",itemsSelected:0},f.dataSelectableItemsSelected=0,f.saveZone=u,f.closeModal=h,l()}e.$inject=["ngDialog","$log","zoneService","Toasts","$filter","$rootScope","zoneObj","$q"],angular.module("icarus.settings").controller("ZoneEditController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v){function g(){N.promiseLoading=o.list().then(h,_),s.getUser().then(function(e){e.subscription&&(N.maxVehicles=e.subscription.quantity)})}function h(e){r.list().then(function(t){N.drivers=t,N.vehicles=e,l.list().then(f,b)})}function _(e){N.ready=!0,t.info(e),403===e.status&&i.go("uprofile.info"),404===e.status&&(N.errorPath=!0,c.push("error",$("Toast_vehicles.error_path_vehicles")))}function f(e){N.skills=e,N.ready=!0}function b(e){t.info(e),c.push("error",$("Toast_vehicles.error_path_skills"))}function y(e){var t="";return n.every(e,function(e){return-1===n.findIndex(N.vehicles,{name:e.name})?!0:(t=e.name,!1)}),t}function w(e,t){if(!e["!ref"])return!1;var i=XLSX.utils.decode_range(e["!ref"]).e.c+1;return i!==t.length?!1:!0}function A(e){return e=m.convertToArray(e,["skills"]),e.map(function(e){var t=[];return e.skills.forEach(function(e){var i=n.find(N.skills,{skill:e});i&&t.push(i.id)}),e.skills=t,e})}function x(e){return n.every(e,function(e){return!(e.capacity&&isNaN(e.capacity)||e.capacity_2&&isNaN(e.capacity_2)||e.capacity_3&&isNaN(e.capacity_3))})}function k(e){return n.every(e,function(e){return e.location_start_address})}function I(e){return n.every(e,function(e){var t=/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])?$/;return!e.shift_start&&!e.shift_end||e.shift_start&&t.test(e.shift_start)&&e.shift_end&&t.test(e.shift_end)})}function S(e){return e.map(function(e){return e.location_end_address=e.location_end_address?e.location_end_address:e.location_start_address,e})}function E(e){var t={error:!1},i=N.bulkCreate?y(e):"";return i?(t.error=!0,t.type=H,t.vehicleName=i):x(e)&&k(e)&&I(e)||(t.error=!0,t.type=j),t.error&&L(t),t}function C(e){var t;p.handleFile(e[0]).then(function(e){if(t=N.bulkCreate?["name","capacity","capacity_2","capacity_3","location_start_address","location_end_address","shift_start","shift_end","default_driver","skills"]:["id","name","capacity","capacity_2","capacity_3","location_start_address","location_end_address","shift_start","shift_end","default_driver","skills"],w(e.Sheets[e.SheetNames[0]],t)){var i=m.createGrid(e,t),a=m.gridToList(i),n=E(a);if(!n.error){var s=P(a);s=A(s),s=S(s),N.ready=!1,N.bulkCreate?N.promiseLoading=v.uploadVehicles(s).then(D,L):N.promiseLoading=v.updateVehicles(s).then(D,L)}}else L({error:!0,type:j})})}function D(e){N.ready=!0,c.push("success",$("Toast_vehicles.success_import_vehicles")),o.clear(),N.promiseLoading=o.list().then(h,_)}function P(e){for(var t=[],i=0;i<e.length;i++)if(e[i].default_driver){var a=n.find(N.drivers,{name:e[i].default_driver});a?(e[i].default_driver=a.id,t.push(e[i])):(e[i].default_driver=null,t.push(e[i]))}else e[i].default_driver=null,t.push(e[i]);return t}function L(e){N.ready=!0;var t;switch(e.type){case B:t=$("Toast_vehicles.error_invalid_address_1")+' "'+e.location.address+'" '+$("Toast_vehicles.error_invalid_address_2");break;case j:t=$("Toast_vehicles.error_data_format");break;case H:t=$("Toast_vehicles.error_duplicate_vehicle_name_1")+' "'+e.vehicleName+'" '+$("Toast_vehicles.error_duplicate_vehicle_name_2");break;default:t=$("Toast_vehicles.error_import")}c.push("error",t)}function O(){N.state.go("settings.vehicles.create")}function T(){var e=[$("General.excel_headers_id"),$("Vehicles.title_table_header"),$("Vehicles.capacity_table_header"),$("Vehicles.capacity_2_table_header"),$("Vehicles.capacity_3_table_header"),$("Vehicles.origin_table_header"),$("Vehicles.destination_table_header"),$("Vehicles.shift_start_table_header"),$("Vehicles.shift_end_table_header"),$("Vehicles.driver_table_header"),$("Vehicles.skills_table_header")];if(0===N.vehicles.length)c.push("error",$("Toast_vehicles.error_empty_vehicles_list"));else{var t=d.listToGrid(R(),e),i=d.createWorkbook("Vehicles",t),a=d.writeWorkbook(i);u.downloadXLSX(a,"vehicles.xlsx")}}function V(e){if(e.length>0){for(var t="",i=0;i<e.length;i++){"string"==typeof e[i]&&(e[i]=parseInt(e[i]));var a=n.find(N.skills,{id:e[i]});t+=i<e.length-1?a.skill+", ":a.skill}return t}return""}function R(){for(var e=[],t=0;t<N.vehicles.length;t++){var i={id:N.vehicles[t].id,name:N.vehicles[t].name?N.vehicles[t].name:"",capacity:N.vehicles[t].capacity?N.vehicles[t].capacity:"",capacity_2:N.vehicles[t].capacity_2?N.vehicles[t].capacity_2:"",capacity_3:N.vehicles[t].capacity_3?N.vehicles[t].capacity_3:"",location_start_address:N.vehicles[t].location_start_address?N.vehicles[t].location_start_address:"",location_end_address:N.vehicles[t].location_end_address?N.vehicles[t].location_end_address:"",shift_start:N.vehicles[t].shift_start?N.vehicles[t].shift_start.slice(0,-3):"",shift_end:N.vehicles[t].shift_end?N.vehicles[t].shift_end.slice(0,-3):"",default_driver:N.vehicles[t].default_driver?N.getDriverName(N.vehicles[t].default_driver):"",skills:V(N.vehicles[t].skills)};e.push(i)}return e}function M(e){var t=n.find(N.drivers,{name:e});return t?t.id:""}function z(e){var t=n.find(N.drivers,{id:e});return t?t.name:""}function F(){e.$index=(N.currentPage-1)*N.itemsPerPage}var N=this,$=a("translate"),j="DATA_FORMAT_ERROR",B="LOCATION_ERROR",H="VEHICLE_NAME_DUPLICATE";N.creating=!1,N.errorPath=!1,N.bulkCreate=!0,N.index=0,N.maxSize=3,N.currentPage=1,N.itemsPerPage=15,N.vehicles=[],N.newVehicle={capacity:1},N.drivers=[],N.skills=[],N.state=i,N.pageChanged=F,N.createVehicle=O,N.getDriverName=z,N.getDriverId=M,N.downloadList=T,N.importVehicles=C,g();var U=e.$on("$stateChangeStart",function(e,t){"settings.vehicles.list"!==t.name&&c.removeAll()});e.$on("$destroy",U)}e.$inject=["$scope","$log","$state","$filter","lodash","sessionService","vehicleService","driverService","skillsService","Toasts","xlsWriterService","fileDownloaderService","xlsUploaderService","xlsParserService","bulkService"],angular.module("icarus.settings").controller("VehiclesListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b){function y(){v.removeAll(),z(),G.vehicleId?G.getVehicle(G.vehicleId):(G.vehicle.skills=[],G.vehicle.location_end_latitude=0,G.vehicle.location_end_longitude=0,G.vehicle.location_start_latitude=0,G.vehicle.location_start_longitude=0,c.list().then(function(e){G.skills=e},function(t){e.info(t),404===t.status&&v.push("error",J("Toast_vehicles.error_path_skills"))})),G.drivers||l.list().then(function(e){G.drivers=e},function(t){e.info(t),404===t.status&&v.push("error",J("Toast_vehicles.error_path_drivers"))})}function w(e){var t=a.defer();return q.getPlacePredictions({input:e,types:["address"]},function(e,i){return i!==_.placesServiceStatusOk()?t.reject(i):void t.resolve(e)}),t.promise}function A(t){r.getVehicleById(Number(t)).then(function(t){j(t),G.vehicle=angular.copy(t),G.vehicle.capacity=V(G.vehicle.capacity),G.vehicle.capacity2=V(G.vehicle.capacity_2),G.vehicle.capacity3=V(G.vehicle.capacity_3),G.vehicle.shift_start?(G.vehicle.shift_start=G.vehicle.shift_start.split(":"),G.vehicle.shift_start=G.vehicle.shift_start[0]+":"+G.vehicle.shift_start[1]):G.vehicle.shift_start=null,G.vehicle.shift_end?(G.vehicle.shift_end=G.vehicle.shift_end.split(":"),G.vehicle.shift_end=G.vehicle.shift_end[0]+":"+G.vehicle.shift_end[1]):G.vehicle.shift_end=null,G.vehicle.default_driver&&O(G.vehicle.default_driver).then(function(e){G.vehicle.default_driver=e}),c.list().then(function(e){G.skills=e;for(var t=0;t<G.vehicle.skills.length;t++){var i=G.vehicle.skills[t],a=g.find(G.skills,function(e){return parseInt(e.id)===parseInt(i)});a&&(G.skills_vehicle[a.id]=!0)}},function(t){e.info(t),v.push("error",J("Toast_vehicles.error_path_skills"))})},function(t){return 404===t.status?(e.info(t),v.push("error",J("Toast_vehicles.vehicle_not_found")),void s.go("^")):void 0})}function x(){if(!G.form.$valid){var t=F();if(!t)return}if(G.vehicle.capacity=T(G.vehicle.capacity),G.vehicle.capacity_2=G.vehicle.capacity2?T(G.vehicle.capacity2):1,G.vehicle.capacity_3=G.vehicle.capacity3?T(G.vehicle.capacity3):1,G.vehicle.capacity2=G.vehicle.capacity_2,G.vehicle.capacity3=G.vehicle.capacity_3,G.vehicle.default_driver?G.vehicle.default_driver=G.vehicle.default_driver.id:G.vehicle.default_driver=null,S(),document.getElementById("location_start_address").value!==G.vehicle.location_start_address){if(""===document.getElementById("location_start_address").value)return void(G.form.originAddress.$error.required=!0);G.vehicle.location_start_address=document.getElementById("location_start_address").value}document.getElementById("location_end_address").value!==G.vehicle.location_end_address&&(""===document.getElementById("location_end_address").value?G.vehicle.location_end_address=G.vehicle.location_start_address:G.vehicle.location_end_address=document.getElementById("location_end_address").value),G.vehicle.location_end_address&&""!==G.vehicle.location_end_address||(G.vehicle.location_end_address=G.vehicle.location_start_address),G.vehicleId?r.update(G.vehicle).then(function(t){e.info(t),G.state.go("^")},function(t){e.info(t),"ZERO_RESULTS"===t&&v.push("error",J("Toast_vehicles.error_set_address")),400===t.status&&(t.data.capacity&&(G.form.capacity.$error.invalid=!0,G.vehicle.capacity=V(G.vehicle.capacity)),t.data.capacity_2&&(G.form.capacity_2.$error.invalid=!0,G.vehicle.capacity2=V(G.vehicle.capacity2)),t.data.capacity_3&&(G.form.capacity_3.$error.invalid=!0,G.vehicle.capacity3=V(G.vehicle.capacity3)),t.data.default_driver&&(G.form.default_driver.$error.invalid=!0,G.vehicle.default_driver=null),t.data.non_field_errors&&(G.form.title.$error.invalid=!0)),t.indexOf("Diferente pais")>-1&&(t.indexOf("origen")>-1&&v.push("error",J("Toast_vehicles.error_set_address_origin_country")),t.indexOf("destino")>-1&&v.push("error",J("Toast_vehicles.error_set_address_destiny_country"))),t.indexOf("lat lng 0")>-1&&(t.indexOf("origen")>-1&&v.push("error",J("Toast_vehicles.error_set_address_origin_latlng0")),t.indexOf("destino")>-1&&v.push("error",J("Toast_vehicles.error_set_address_destiny_latlng0"))),p(function(){},3e3).then(function(){G.form.capacity.$error.invalid=!1,G.form.capacity_2.$error.invalid=!1,G.form.capacity_3.$error.invalid=!1,G.form.default_driver.$error.invalid=!1,G.form.title.$error.invalid=!1})}):r.list().then(function(t){Y=0===t.length?!0:!1,r.create(G.vehicle).then(function(t){e.info(t),Y&&v.push("success",'<a class="sp-link-white" href="#/planner">'+J("Toast_vehicles.can_create_routes")+"</a>",!1,!0),G.state.go("^")},function(t){e.info(t),"ZERO_RESULTS"===t&&v.push("error",J("Toast_vehicles.error_set_address")),400===t.status&&(t.data.capacity&&(G.form.capacity.$error.invalid=!0),t.data.capacity_2&&(G.form.capacity_2.$error.invalid=!0),t.data.capacity_3&&(G.form.capacity_3.$error.invalid=!0),t.data.non_field_errors&&(G.form.title.$error.invalid=!0)),t.indexOf("Diferente pais")>-1&&(t.indexOf("origen")>-1&&v.push("error",J("Toast_vehicles.error_set_address_origin_country")),t.indexOf("destino")>-1&&v.push("error",J("Toast_vehicles.error_set_address_destiny_country"))),t.indexOf("lat lng 0")>-1&&(t.indexOf("origen")>-1&&v.push("error",J("Toast_vehicles.error_set_address_origin_latlng0")),t.indexOf("destino")>-1&&v.push("error",J("Toast_vehicles.error_set_address_destiny_latlng0"))),G.vehicle.capacity=V(G.vehicle.capacity),G.vehicle.capacity2=V(G.vehicle.capacity2),G.vehicle.capacity3=V(G.vehicle.capacity3),G.invalidLocations=!0,p(function(){},4e3).then(function(){G.invalidLocations=!1,G.form.capacity.$error.invalid=!1,G.form.capacity_2.$error.invalid=!1,G.form.capacity_3.$error.invalid=!1,G.form.title.$error.invalid=!1})})})}function k(){r["delete"](G.vehicle).then(function(){s.go("^")},function(t){e.info(t)})}function I(){n.deleteVehicle=k,u.open({template:"app/settings/vehicles/vehicle-delete-modal.html",scope:n})}function S(){if(G.vehicle.skills.length=0,Object.keys(G.skills_vehicle).length>0)for(var e in G.skills_vehicle)G.skills_vehicle[e]&&G.vehicle.skills.push(parseInt(e))}function E(e){G.shouldMirrorAddresses&&(G.vehicle.location_end_address=e)}function C(){G.state.go("^")}function D(e){var t=null,i=null;return G.addressOrigin.marker&&"end"===e&&!G.addressEnd.marker?(t=G.addressOrigin.marker.getMap(),G.addressOrigin.marker.setVisible(!1),void(G.addressEnd.marker=r.createMarker(t,!1))):("end"===e&&(G.addressOrigin.marker&&G.addressOrigin.marker.setVisible(!1),G.addressEnd.marker&&(G.addressEnd.marker.setVisible(!0),t=G.addressEnd.marker.getMap(),i=_.getLatLngBounds(),i.extend(G.addressEnd.marker.getPosition()))),"origin"===e&&(G.addressOrigin.marker&&(G.addressOrigin.marker.setVisible(!0),t=G.addressOrigin.marker.getMap(),i=_.getLatLngBounds(),i.extend(G.addressOrigin.marker.getPosition())),G.addressEnd.marker&&G.addressEnd.marker.setVisible(!1)),void(i&&!i.isEmpty()&&t&&t.fitBounds(i)))}function P(e){G.vehicle.location_start_address===e&&r.getGeocoder(G.addressOrigin.marker,e),G.vehicle.location_end_address===e&&r.getGeocoder(G.addressEnd.marker,e)}function L(){var e=/^([0-1]?[0-9]|2[0-3])(:[0-5][0-9])?$/;
if(G.vehicle.shift_start){if(!G.vehicle.shift_start.match(e))return G.form.$valid=!1,void(G.invalidDate=!0);G.form.$valid=!0,G.invalidDate=!1}else G.form.$valid=!0,G.invalidDate=!1,G.vehicle.shift_start=null;if(G.vehicle.shift_end){if(!G.vehicle.shift_end.match(e))return G.form.$valid=!1,void(G.invalidDate=!0);G.form.$valid=!0,G.invalidDate=!1}else G.form.$valid=!0,G.invalidDate=!1,G.vehicle.shift_end=null;return G.vehicle.shift_start&&(G.vehicle.shift_start=h(G.vehicle.shift_start,"HH:mm").format("HH:mm")),G.vehicle.shift_end&&(G.vehicle.shift_end=h(G.vehicle.shift_end,"HH:mm").format("HH:mm")),G.vehicle.shift_start||G.vehicle.shift_end?G.vehicle.shift_start>G.vehicle.shift_end||G.vehicle.shift_start===G.vehicle.shift_end?(G.form.$valid=!1,void(G.timeBetweenDate=!0)):(G.form.$valid=!0,G.timeBetweenDate=!1,void(!G.vehicle.shift_start&&G.vehicle.shift_end||G.vehicle.shift_start&&!G.vehicle.shift_end?(G.form.$valid=!1,G.emptyDate=!0):(G.form.$valid=!0,G.emptyDate=!1))):(G.emptyDate=!1,void(G.timeBetweenDate=!1))}function O(e){return l.getDriverById(e)}function T(e){e=String(e);var t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return"es"===t.substring(0,2).toLowerCase()?(e=e.split(".").join("").replace(",","."),parseFloat(e)):(e=e.split(",").join(""),parseFloat(e))}function V(e){e=String(e);var t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return"es"===t.substring(0,2).toLowerCase()?e.replace(".",","):e}function R(t){if(G.vehicle.location_start_latitude&&G.vehicle.location_start_longitude){var i={icon:"origin",location:{lat:G.vehicle.location_start_latitude,lng:G.vehicle.location_start_longitude}};try{var a=[];r.setMap(t),G.addressOrigin.marker=r.createMarker(i),a.push(G.addressOrigin.marker),i.icon="end",i.location={lat:G.vehicle.location_end_latitude,lng:G.vehicle.location_end_longitude},G.addressEnd.marker=r.createMarker(i),a.push(G.addressEnd.marker),r.fitBounds(a,t)}catch(n){e.error(n)}}}function M(t){var i={icon:"origin"};f.fbq("track","ViewContent");try{r.setMap(t),G.addressOrigin.marker=r.createMarker(i)}catch(a){e.info(a)}}function z(){d.getMapOptions().then(function(a){G.map=a;try{var n=_.createMap(document.getElementById("map"),G.map.options);return n.setCenter(_.getGoogleMapsLatLng(G.map.center.latitude,G.map.center.longitude)),q=_.createAutoCompleteService(),U=_.createPlacesService(i[0].createElement("div")),G.vehicleId?R(n):M(n)}catch(s){e.info(s),t.online?v.push("error",s):(e.info("Offline Internet"),v.push("error",J("Toast.error_get_map_offline")))}},function(t){e.info(t),t.message&&v.push("error",J("Toast.error_get_options_map_1")),404===t.status&&v.push("error",J("Toast.error_get_options_map_2"))})}function F(){var e=!0;return(G.invalidDate||G.timeBetweenDate||G.emptyDate)&&(e=!1),G.vehicle.name||(G.form.title.$error.required=!0,e=!1),G.vehicle.capacity?G.vehicle.capacity=String(G.vehicle.capacity):(G.form.capacity.$error.required=!0,e=!1),G.vehicle.originAddress||""!==document.getElementById("location_start_address").value||(G.form.originAddress.$error.required=!0,e=!1),e}function N(e){function t(e,t){var i=this;i.changeStateVehicle=e,i.state=t,g.includes(t,"skills")&&(i.skillsMessageLeave=!0),g.includes(t,"drivers")&&(i.driverMessageLeave=!0)}G.form.$dirty?u.openConfirm({template:"app/settings/vehicles/vehicles-confirm-leave.html",controller:t,controllerAs:"vm",resolve:{changeStateVehicle:function(){return $},state:function(){return e}}}):s.go(e)}function $(e){s.go(e)}function j(e){(1!==e.capacity_3||1!==e.capacity_2||e.location_end_address!==e.location_start_address)&&(G.moreLoads=!1)}function B(e){return function(t){return b.naturalValue(t[e])}}function H(){W()}var U,q,G=this,J=m("translate"),Y=!1,W=null;G.form={},G.vehicle={shift_start:null,shift_end:null},G.skills_vehicle={},G.drivers={type:"select",name:"",value:"",values:[]},G.state=s,G.stateParams=o,G.vehicleId=null,angular.isUndefined(o.vehicleId)||(G.vehicleId=o.vehicleId),G.skills=null,G.drivers=null,G.ready=!1,G.invalidLocations=!1,G.moreLoads=!0,G.shouldMirrorAddresses=!1,G.save=x,G.cancel=C,G.getPlaces=w,G.getVehicle=A,G.validateTime=L,G.changeMarker=D,G.deleteVehicle=k,G.showDeleteModal=I,G.setPositionMarker=P,G.changeState=N,G.naturalSort=B,G.mirrorAddresses=E,G.addressEnd={marker:null,focus:!0},G.addressOrigin={marker:null,focus:!0},W=n.$watch("vm.vehicle.location_start_address",E),n.$on("$destroy",H),y(),t.$on("positionNavigator",function(){t.mapInitCoord&&r.setMapCenterOn(t.mapInitCoord)})}e.$inject=["$log","$rootScope","$document","$q","$scope","$state","$stateParams","vehicleService","driversService","skillsService","mapService","ngDialog","$timeout","$filter","Toasts","lodash","moment","googleService","$window","naturalService"],angular.module("icarus.settings").controller("VehiclesDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l){function c(){function t(e){v.ready=!0;for(var t=0;t<e.length;t++)if(e[t].is_admin||e[t].is_owner)v.justDriver=!1;else if(e[t].is_driver){v.justDriver=!0;break}return e}function s(t){v.ready=!0,v.showNotUsersMessage=!0,e.info(t),403===t.status&&i.go("uprofile.info")}function l(e){var t={};return t.id=e.id,e.is_owner?t.role=0:e.is_admin?t.role=1:t.role=2,t}function c(t){e.info(t)}v.promiseLoading=a.listUsers().then(t,s);var d=n.getUser().then(l,c);r.all([v.promiseLoading,d]).then(function(e){v.users=o(e[0],e[1]),v.showNotUsersMessage=!v.users.length})}function d(){v.state.go("settings.users.create")}function u(e,t){v.users.push(t),p(t),v.showNotUsersMessage=!v.users.length}function p(e){e.isDriver&&l.updateListDriver(e)}function m(e,t){for(var i=0;i<v.users.length;i++)if(v.users[i].id===t.id){v.users.splice(i,1),l.returnDrivers().then(function(e){for(var i=0;i<e.length;i++)e[i].id===String(t.id)&&e.splice(i,1)});break}v.showNotUsersMessage=!v.users.length}var v=this;v.users=[],v.errorMsg=null,v.user={},v.creating=!1,v.showMore=!1,v.showErrorPassword=!1,v.state=i,v.maxSize=3,v.currentPage=1,v.itemsPerPage=15,v.justDriver=!0,v.showNotUsersMessage=!1,v.appLink=s.APP_MOBILE_GOOGLEPLAY_LINK,v.createUser=d,c(),t.$on("SAVE_USER",u),t.$on("DELETE_USER",m)}e.$inject=["$log","$scope","$state","userService","sessionService","__env","orderUsersSettingsFilter","$q","plannerService"],angular.module("icarus.settings").controller("UsersListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(){angular.extend(A.user.newPassword,x),angular.extend(A.user.confirmNewPassword,x),A.stateParams.userId&&A.getUser(Number(A.stateParams.userId)),o.getUser().then(function(e){e.is_owner?(A.isOwner.value=!0,A.isOwner.id=e.id):e.is_admin&&(A.isAdmin.id=e.id,A.isAdmin.value=!0)},function(t){e.info(t)})}function p(a){s.getUserById(a).then(function(e){A.user=angular.copy(e),A.user.newPassword={},A.user.confirmNewPassword={},angular.extend(A.user.newPassword,x),angular.extend(A.user.confirmNewPassword,x),e.isAdmin?A.user.typeUser="admin":e.isDriver?A.user.typeUser="driver":A.user.typeUser="monitor",""!==A.user.phone?(t.formattedNumber=l.format(A.user.phone),t.isValid=l.isValid(t.formattedNumber),A.user.phoneIsValid=t.isValid):A.user.phoneIsValid=!0},function(t){e.info(t),c.push("error","Usuario no existe"),i.go("^")})}function m(){(A.form.$valid||b())&&(A.user.phoneIsValid=!0,A.user.phoneIsValid||(A.user.phone=""),A.stateParams.userId?w():y())}function v(e){"password"===e.type?e.type="text":e.type="password"}function g(e){function t(e){e.data.exist?A.user.usernameDuplicated=!0:A.user.usernameDuplicated=!1}function i(){}e.username?d.checkUsername(e).then(t)["catch"](i):A.user.usernameDuplicated=!1}function h(){return A.user.isOwner?void(A.errorDeleteOwner=!0):void s.removeUser(A.user).then(function(e){t.$emit("DELETE_USER",e),i.go("^")},function(t){e.info(t)})}function _(){t.deleteUser=h,r.open({template:"app/settings/users/users-delete-modal.html",scope:t})}function f(){A.state.go("^")}function b(){var i=!0;if(A.user.phone&&(t.formattedNumber=l.format(A.user.phone),t.isValid=l.isValid(t.formattedNumber),A.user.phoneIsValid=t.isValid,!t.isValid)){var a=A.user.phone.split("+")[1];try{var n=bcCountries.getDialCodeByDigits(a);n===a?(A.form.$valid=!0,A.form.$invalid=!1):(A.form.$valid=!1,A.form.$invalid=!0),A.user.phoneIsValid=A.form.$valid,i=A.form.$valid}catch(s){e.info(s),A.form.$invalid=!0,i=!1}}return A.user.username||(A.user.usernameRequired=!0,i=!1),A.user.name||(A.user.nameRequired=!0,i=!1),A.changePassword&&(A.user.newPassword.value&&A.user.confirmNewPassword.value||(A.user.passwordRequired=!0,i=!1)),i}function y(){A.user.newPassword.value===A.user.confirmNewPassword.value?(A.user.password=A.user.newPassword.value,s.createUser(A.user).then(function(e){A.state.go("^"),t.$emit("SAVE_USER",e)},function(e){400===e.status&&(e.data.email&&(A.user.emailError=!0),e.data.username&&(A.user.usernameError=!0))})["finally"](function(){n(function(){},4e3).then(function(){A.user.usernameError=!1,A.user.emailError=!1})})):(A.errorMatchPassword=!0,n(function(){},4e3).then(function(){A.errorMatchPassword=!1}))}function w(){if(A.changePassword&&A.user.newPassword.value===A.user.confirmNewPassword.value)A.user.password=A.user.newPassword.value;else if(A.changePassword&&A.user.newPassword.value!==A.user.confirmNewPassword.value)return A.errorMatchPassword=!0,void n(function(){},3e3).then(function(){A.errorMatchPassword=!1});s.updateUser(A.user).then(function(e){t.$emit("SAVE_USER",e),A.state.go("^")},function(e){e.data.email&&(A.user.emailError=!0),e.data.username&&(A.user.usernameError=!0)})["finally"](function(){n(function(){},3e3).then(function(){A.errorUpdate=!1,A.user.usernameError=!1,A.user.emailError=!1})})}var A=this;A.userOwner=!1,A.showViewAdmin=!1,A.changePassword=!1,A.moreInfo=!1,A.user={typeUser:"driver"},A.user.password={},A.user.newPassword={},A.user.confirmNewPassword={},A.user.phoneIsValid=!0,A.state=i,A.stateParams=a,A.save=m,A.cancel=f,A.getUser=p,A.deleteUser=h,A.checkUsername=g,A.changeTypeInput=v,A.showDeleteModal=_,A.isAdmin={value:!1,id:""},A.isDriver={value:!1,id:""},A.isOwner={value:!1,id:""};var x={value:null,type:"password",error:null,error_txt:null,success_txt:null};u(),t.$watch("vm.user.username",function(){angular.isDefined(A.user.username)&&null!==A.user.username&&(A.user.username=A.user.username.toLowerCase())})}e.$inject=["$log","$scope","$state","$stateParams","$timeout","userService","sessionService","ngDialog","bcPhoneNumber","Toasts","driversService"],angular.module("icarus.settings").controller("UsersDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){i.list().then(function(e){t.isLoading=!1,v.skills=e},function(i){t.isLoading=!1,e.info("error con la lista de skills",i),s.push("error",g("Toast_vehicles.error_path_skills"))})}function r(){if(v.skill){for(var t=!1,n=0;n<v.skills.length;n++)if(v.skills[n].skill===v.skill.name){t=!0;break}t?(v.formSkills.name.$error.invalid=!0,a(function(){},3e3).then(function(){v.formSkills.name.$error.invalid=!1})):i.create(v.skill.name).then(function(){v.skill.name="",v.formSkills.$setPristine(),v.formSkills.$setUntouched()},function(t){e.info("error creando skill",t)})}}function l(){for(var e=!0,t=0;t<v.skills.length;t++)v.skills_vehicle[v.skills[t].id]=v.skills[t].isChecked,v.skills[t].isChecked||(e=!1);e&&(v.select_all_skills=!0)}function c(){for(var e=0;e<v.skills.length;e++)v.skills_vehicle[v.skills[e].id]=v.select_all_skills,v.skills[e].isChecked=v.select_all_skills}function d(){v.select_all_skills=!0;for(var e=0;e<v.skills.length;e++)v.skills_vehicle[v.skills[e].id]=v.select_all_skills,v.skills[e].isChecked=v.select_all_skills}function u(){var t=!1;return v.skills.forEach(function(a){a.isChecked&&(t=!0,i.remove(a).then(function(){v.editing=!1},function(t){e.info("error eliminado skill",t)}))}),t?void 0:void s.push("error",g("Toast_skill.unselected_skill"))}function p(){for(var e in v.skills_vehicle)for(var t=0;t<v.skills.length;t++)if(v.skills[t].id===parseInt(e)){v.skills[t].isChecked=v.skills_vehicle[e];break}}function m(){v.editing=!1;for(var e=0;e<v.skills.length;e++)v.skills_vehicle[v.skills[e].id]=!1,v.skills[e].isChecked=!1;v.select_all_skills=!1}var v=this,g=n("translate");t.isLoading=!0,v.editing=!1,v.select_all_skills=!1,v.formSkillsform={},v.skills_vehicle={},v.skills_checkbox={},v.cancel=m,v.saveSkills=r,v.deletSkills=u,v.selectSkill=l,v.activeCheckbox=p,v.selectAllSkills=c,v.selectAllSkillsHref=d,o()}e.$inject=["$log","$rootScope","skillsService","$timeout","$filter","Toasts"],angular.module("icarus.settings").controller("SkillsListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u){function p(){function t(e){var t=[];return angular.forEach(e.data,function(e){var i=r.fromJson(e);t.push(i)}),t}return C(e.get,[E(),{cache:T}],t)}function m(e){var i=t.defer(),n=[];return p().then(function(t){t.forEach(function(t){(e&&e.id!==t.id||!e)&&n.push(t.coordinates)}),i.resolve(n)})["catch"](function(e){a.error(e),i.reject(n)}),i.promise}function v(){var e=t.defer(),i=[];return l.list().then(function(t){t.forEach(function(e){i.push({id:e.id,name:e.name,activate:!1})}),e.resolve(i)})["catch"](function(t){e.reject(t)}),e.promise}function g(t){return e.post(O,D(t))}function h(e){return r.fromJson(e)}function _(){o.get("zones")&&o.get("zones").removeAll()}function f(e){var t=JSON.parse(e.replace(/'/g,'"'));return t.forEach(function(e){e.lat=parseFloat(e.lat),e.lng=parseFloat(e.lng)}),t}function b(e,t,i){return c.getZonesIntoVisit(e,t,i)}function y(){var e=t.defer();return x("zones","use_zones_to_optimization").then(function(t){t.useZones?p().then(function(t){e.resolve(t)})["catch"](function(){e.resolve([])}):e.resolve([])})["catch"](function(){e.resolve([])}),e.promise}function w(t){return e.put(O+t.id,P(t))}function A(t){return e["delete"](O+t)}function x(e,i){var a=t.defer(),n={id:null,useZones:!1,addonId:null};return u.getInfoAddonAndPropertiesByKey(e).then(function(e){var t=L(e.properties,i);n.addonId=e.addon.id,t&&(n.id=t.id,n.useZones="true"===t.value||"True"===t.value),a.resolve(n)})["catch"](function(e){a.reject(e)}),a.promise}function k(e){var i=t.defer();return u.createAddonProperty(e).then(function(e){i.resolve(e)})["catch"](function(e){i.reject(e)}),i.promise}function I(e){var i=t.defer();return u.updateAddonProperty(e).then(function(e){i.resolve(e)})["catch"](function(e){i.reject(e)}),i.promise}function S(t){return e.post(E()+"bulk/",t)}function E(){return O}function C(e,i,a,n){var s=t.defer();return n||(n=function(e){var t=angular.isObject(e)?e.data:e;s.reject(t)}),e.apply(this,i).then(function(e){t.when(a(e)).then(function(e){s.resolve(e)})})["catch"](n),s.promise}function D(e){var t={name:e.name,coordinates:e.coordinates,vehicles:[]};return e.vehicles.forEach(function(e){e.activate&&t.vehicles.push(e.id)}),t}function P(e){var t={name:e.name,coordinates:e.coordinates,vehicles:[]};return e.vehicles.forEach(function(e){e.activate&&t.vehicles.push(e.id)}),t}function L(e,t){return n.find(e,function(e){return e.key===t})}var O=i.API_URL+"zones/",T=o("zones"),V={listZones:p,getCoordinatesOfAllZones:m,listVehicles:v,saveZone:g,createZone:h,removeCache:_,parseFromStringToArray:f,getZonesIntoVisit:b,getZonesIfProceed:y,updateZone:w,deleteZone:A,isEnableZonesProperty:x,createZoneProperties:k,updateZoneProperties:I,updateAssignations:S};return s.zoneService=V,V}e.$inject=["$http","$q","__env","$log","lodash","$window","$cacheFactory","ZoneModel","vehicleService","zoneMapService","accountConfigsService","addonsService"],angular.module("icarus.settings").factory("zoneService",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){var e=n.defer();return t.getMapOptions().then(function(t){var i=o(t);e.resolve(i)})["catch"](function(t){e.reject(t),a.error(t)}),e.promise}function o(e){var t;return e=r(e),t=i.createMap(document.getElementById("map"),e.options),t.setCenter(i.getGoogleMapsLatLng(e.center.latitude,e.center.longitude)),t}function r(e){return e.options.streetViewControl=!1,e}function l(e){var t;return v(),t=i.createDrawing(e,g,h,_,!0)}function c(e,t){i.listenerLimitDrawingPolygon(e,t)}function d(e,t){i.googleMapsAddListener(e.getPath(),"set_at",t),i.googleMapsAddListener(e.getPath(),"insert_at",t),i.googleMapsAddListener(e.getPath(),"remove_at",t)}function u(e,t){var i={paths:[],draggable:!1,editable:!1,strokeColor:"gray",strokeOpacity:0,strokeWeight:0,fillColor:"#999999",fillOpacity:.5};e.forEach(function(e){p(e,i,t)})}function p(e,t,a){var n=e.map(function(e){return i.getGoogleMapsLatLng(e.lat,e.lng)});t.path=n;var s=i.createPolygon(t);return s.setMap(a),s}function m(e,t,a){for(var n,s=i.getGoogleMapsLatLng(t,a),o=null,r=[],l=[],c=0;c<e.length;c++)if(n=e[c],r=n.coordinates.map(function(e){return i.getGoogleMapsLatLng(e.lat,e.lng)}),o=i.createPolygon({path:r}),o.contains(s)){l.push({id:n.id,name:n.name});break}return l}function v(){g={polygonOptions:{fillColor:"#335F72",fillOpacity:.5,strokeWeight:1,strokeOpacity:0,clickable:!0,editable:!0,draggable:!1,zIndex:1}},h=["polygon"],_=null}var g,h,_,f={initializeMap:s,setDrawing:l,listenerZoneCompleted:c,drawingAdjacentZones:u,getZonesIntoVisit:m,drawZone:p,listenersPolygonChanged:d};return e.drawingMapService=f,f}e.$inject=["$window","mapService","googleService","$log","$q"],angular.module("icarus.settings").factory("zoneMapService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m){function v(){return B?B:B=y()}function g(){l.getUser().then(function(e){j=e},function(e){i.info(e)})}function h(){return H?H:H=v()}function _(){var i=e.defer();return t.get(a.MAP_OPTIONS).then(function(e){i.resolve(e.data)})["catch"](function(e){i.reject(e)}),i.promise}function f(i){var a=e.defer();return(angular.isUndefined(j)||!j)&&g(),L(i).then(function(){t.post(R,i).then(function(e){M.push(e.data),T();var t=new o(e.data.id.toString()),i=P(e.data);t.shift.start=e.data.shift_start,t.shift.end=e.data.shift_end,r.returnVehicles().then(function(a){e.data.default_driver?s.getDriverById(e.data.default_driver).then(function(e){var n={id:String(e.id),name:e.name,username:e.username};i.driver=JSON.stringify(n),m.merge(t,i),a.push(t)}):(m.merge(t,i),a.push(t))}),a.resolve(e)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise}function b(i){var a=e.defer();return(angular.isUndefined(j)||!j)&&g(),L(i).then(function(){t.put(R+i.id+"/",i).then(function(e){M.map(function(t,i){t.id===e.data.id&&(M[i]=e.data)}),T(),r.getVehicle(String(i.id)).then(function(t){var i=P(e.data);e.data.default_driver?s.getDriverById(e.data.default_driver).then(function(e){var a={id:String(e.id),name:e.name,username:e.username};i.driver=JSON.stringify(a),m.merge(t,i)}):m.merge(t,i)}),a.resolve(e)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise}function y(){if(0!==M.length)return e.when(M);var i=e.defer();return t.get(R).then(function(e){M.length=0;for(var t=e.data.length-1;t>=0;t--){var a=e.data[t];a.active=!0,M.push(a)}T(),i.resolve(M)},function(e){i.reject(e)}),i.promise}function w(i){var a=e.defer();return t["delete"](R+i.id+"/").then(function(e){for(var t=0;t<M.length;t++){var n=M[t];if(n.id===i.id){M.splice(t,1),r.returnVehicles().then(function(e){for(var t=0;t<e.length;t++)e[t].id===String(i.id)&&(r.removeVehicle(e[t]),e.splice(t,1))});break}}a.resolve(e)},function(e){a.reject(e)}),a.promise}function A(t){return h().then(function(i){for(var a=0;a<i.length;a++)if(i[a].id===t)return i[a];var n={status:404};return e.reject(n)},function(t){return e.reject(t)})}function x(){var t=e.defer(),i=!1;return y().then(function(e){s.list().then(function(a){for(var n=[],s=0;s<a.length;s++)if(!a[s].is_owner){for(var o=0;o<e.length;o++)if(e[o].default_driver===a[s].id){if(e[o].id!==parseInt(c.vehicleId)){i=!0;break}}else i=!1;i||n.push(a[s])}t.resolve(n)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise}function k(){M.length=0,z.length=0,j=null,B=null,H=null}function I(e){var t=null,i={id:null},a={lat:F.getCenter().lat,lng:F.getCenter().lng},n={lat:null,lng:null};if(!F)return null;"origin"===e.icon?(t="M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z M21.851,12.096c-0.178,0.178-0.467,0.179-0.644,0.001l-0.646-0.642l-0.009,6.894,c0,0.251-0.204,0.455-0.455,0.455h-2.476c-0.251,0-0.455-0.204-0.455-0.455v-4.111h-2.319v4.111c0,0.251-0.204,0.455-0.456,0.455,h-2.496c-0.251,0-0.455-0.204-0.455-0.455v-6.902l-0.649,0.649c-0.088,0.089-0.205,0.133-0.322,0.133,c-0.116,0-0.232-0.044-0.321-0.133c-0.178-0.177-0.178-0.465,0-0.643l5.514-5.516c0.178-0.178,0.465-0.178,0.643-0.001l5.542,5.516,C22.026,11.63,22.027,11.918,21.851,12.096z",i.id="origin"):(t="M16.13,2.005c-5.753,0-10.434,4.681-10.434,10.433c0,5.225,8.104,15.585,9.025,16.748,c0.342,0.433,0.855,0.681,1.408,0.681s1.066-0.248,1.405-0.678c0.924-1.162,9.027-11.499,9.027-16.751,C26.563,6.686,21.883,2.005,16.13,2.005z M13.005,4.479c0,1.223,0,2.344,0,3.874c2.426-0.674,3.639-1.349,6.063-2.021,c0-0.76,0-1.374,0-1.938c1.108,0.406,2.11,1.032,2.951,1.83c-0.884-0.104-1.774-0.023-2.951,0.107c0,2.111,0,3.262,0,5.588,c-2.392,0.82-3.669,1.892-6.063,2.715c0-2.346,0-3.634,0-6.282c-1.752,0.194-2.875,0.275-4.275-0.198,C9.694,6.492,11.198,5.191,13.005,4.479z M7.878,14.252c1.803,1.455,2.986,1.205,4.992,0.543c0,2.385,0,3.596,0,5.697,c-0.701,0.076-1.307,0.13-1.867,0.136C9.618,18.368,8.421,16.084,7.878,14.252z M17.976,25.529c-1.347,0-2.371,0-3.688,0,c0,0-0.531-0.723-1.283-1.817c0-0.924,0-1.807,0-3.086c2.394-0.678,3.671-1.354,6.063-2.032c0,2.096,0,3.439,0,5.396,C18.384,24.976,17.976,25.529,17.976,25.529z M19.202,18.442c0-2.68,0-4.026,0-6.428c2.172-0.719,3.38-0.955,5.456,0.939,c0.021-0.177-0.855,3.163-2.119,5.483C21.511,18.229,20.534,18.297,19.202,18.442z",i.id="end"),e.location&&(a=p.getGoogleMapsLatLng(parseFloat(e.location.lat),parseFloat(e.location.lng)));var s=new MarkerWithLabel({position:{lat:a.lat(),lng:a.lng()},map:F,icon:{path:t,fillOpacity:1,fillColor:"#41D3BD",strokeWeight:0,anchor:p.createPoint(10,31)},animation:p.googleMapsAnimationDrop(),labelAnchor:p.createPoint(10,26),labelClass:"sp-marker-label",labelContent:"",labelStyle:{},visible:!0,draggable:!0});return s.metadata=i,p.googleMapsAddListener(s,"dragend",function(){n.lat=this.getPosition().lat(),n.lng=this.getPosition().lng(),O(n,this.metadata.id)}),"origin"===e.icon?N=s:$=s,s}function S(e,t){var i=p.getLatLngBounds();e.forEach(function(e){e&&i.extend(e.getPosition())}),i.isEmpty()||t.fitBounds(i)}function E(e,t){var i=null,a=p.getLatLngBounds(),n=p.createGeocode();e&&(i=e.getMap()),n.geocode({address:t},function(t,n){n===p.geocoderStatusOK()?(e.setPosition(t[0].geometry.location),a.extend(e.getPosition()),a.isEmpty()||i.fitBounds(a)):alert("Geocode was not successful for the following reason: "+n)})}function C(e){F=e}function D(e){F.setCenter(p.getGoogleMapsLatLng(e.latitude,e.longitude)),N&&N.setPosition(p.getGoogleMapsLatLng(e.latitude,e.longitude)),$&&$.setPosition(p.getGoogleMapsLatLng(e.latitude,e.longitude))}function P(e){for(var t=r.getShift(),i={start:null,end:null},a=t.start,n=t.end,s=0;s<e.skills.length;s++)e.skills[s]=String(e.skills[s]);var o={address:e.location_start_address,latitude:parseFloat(e.location_start_latitude)||0,longitude:parseFloat(e.location_start_longitude)||0},l={address:e.location_end_address,latitude:parseFloat(e.location_end_latitude)||0,longitude:parseFloat(e.location_end_longitude)||0};e.shift_start&&(a=e.shift_start.split(":"),a=a[0]+":"+a[1],i.start=a),e.shift_end&&(n=e.shift_end.split(":"),n=n[0]+":"+n[1],i.end=n);var c={active:!0,backendId:null,capacity:e.capacity,capacity2:e.capacity_2,capacity3:e.capacity_3,collapsed:!0,driver:null,driverId:null,id:String(e.id),initials:"",locationEnd:l,locationEndMarker:null,locationStart:o,locationStartMarker:null,name:e.name,skills:e.skills,color:e.color,shift:{start:a,end:n},shiftDefault:i};return c}function L(t){var i=e.defer(),a=null;return t.location_start_address?(a=p.createGeocode(),a.geocode({address:t.location_start_address},function(e,n){var s=!0;if(n===p.geocoderStatusOK()){if(s=V(e[0]),!s)return i.reject("error: Diferente pais direccion origen"),i.promise;if("0"===e[0].geometry.location.lat()||0===e[0].geometry.location.lat())return i.reject("error: Direccion origen con lat lng 0"),i.promise;t.location_start_latitude=e[0].geometry.location.lat().toFixed(6),t.location_start_longitude=e[0].geometry.location.lng().toFixed(6),t.location_end_address?(a=p.createGeocode(),a.geocode({address:t.location_end_address},function(e,a){var n=!0;if(a===p.geocoderStatusOK()){if(n=V(e[0]),!n)return i.reject("error: Diferente pais direccion destino"),i.promise;if("0"===e[0].geometry.location.lat()||0===e[0].geometry.location.lat())return i.reject("error: Direccion destino con lat lng 0"),i.promise;t.location_end_latitude=e[0].geometry.location.lat().toFixed(6),t.location_end_longitude=e[0].geometry.location.lng().toFixed(6),i.resolve(t)}else i.reject(a)})):i.reject("error: no hay direccion final")}else i.reject(n)})):i.reject("error: no hay direccion inicial"),i.promise}function O(e,t){if(e.lat&&e.lng){var i=null,a=p.createGeocode();a.geocode({location:e},function(e,a){a===p.geocoderStatusOK()?(e.forEach(function(e){e.types.indexOf("street_address")>-1&&(i=e.formatted_address)}),i?("origin"===t&&(document.getElementById("location_start_address").value=i),"end"===t&&(document.getElementById("location_end_address").value=i)):u.push("error",U("Toast_vehicles.error_set_position_marker"))):u.push("error",U("Toast_vehicles.error_set_position_marker"))})}}function T(){M.sort(function(e,t){return e.name<t.name?-1:1})}function V(e){var t=!1,i=!0;return e.address_components.forEach(function(e){t=!1,e.types.forEach(function(e){"country"===e&&(t=!0)}),t&&j.account.country!==e.short_name&&(i=!1)}),i}var R=a.API_URL+"routes/vehicles/",M=[],z=[],F=null,N=null,$=null,j=null,B=null,H=null,U=d("translate"),q={getVehicleById:A,create:f,update:b,list:y,clear:k,setMap:C,createMarker:I,getMapOptions:_,getEnabledDriver:x,fitBounds:S,setMapCenterOn:D,getGeocoder:E,"delete":w};return v(),g(),n.vehicleService=q,q}e.$inject=["$q","$http","$log","__env","$window","driversService","PlannerVehicleModel","plannerService","sessionService","$stateParams","$filter","Toasts","googleService","lodash"],angular.module("icarus.settings").factory("vehicleService",e)}(),function(){"use strict";function e(e,t,i,a){function n(){return t.API_URL+"accounts/users/"}function s(e,t,i,n){var s=a.defer();return n||(n=function(e){var t=angular.isObject(e)?e.data:e;s.reject(t)}),e.apply(this,t).then(function(e){a.when(i(e)).then(function(e){s.resolve(e)})})["catch"](n),s.promise}function o(t,i,n){var s=a.defer();return e.get(t,i).then(function(e){try{s.resolve(n(e.data))}catch(t){s.reject(t.message)}})["catch"](function(e){s.reject(e)}),s.promise}function r(){function t(e){var t=[];return angular.forEach(e.data,function(e){var a=i.fromJson(e);t.push(a)}),t}return s(e.get,[n()],t)}function l(t){var s=a.defer(),o={name:t.name,username:t.username,phone:t.phone?t.phone:"",email:t.email?t.email:"",is_admin:"admin"===t.typeUser,is_driver:"driver"===t.typeUser,is_monitor:"monitor"===t.typeUser,password:t.password};return e.post(n(),o).then(function(e){var t=i.fromJson(e.data);s.resolve(t)},function(e){s.reject(e)}),s.promise}function c(e){return o(n()+e+"/",null,i.fromJson)}function d(t){var s=a.defer(),o={name:t.name,username:t.username,phone:t.phone?t.phone:"",email:t.email?t.email:"",is_admin:"admin"===t.typeUser,is_driver:"driver"===t.typeUser,is_monitor:"monitor"===t.typeUser,password:t.password};return e.put(n()+t.id+"/",o).then(function(e){var t=i.fromJson(e.data);s.resolve(t)},function(e){s.reject(e)}),s.promise}function u(t){var i=a.defer();return e["delete"](n()+t.id+"/").then(function(){i.resolve(t)})["catch"](function(e){i.reject(e)}),i.promise}return{listUsers:r,createUser:l,updateUser:d,removeUser:u,getUserById:c}}e.$inject=["$http","__env","UserModel","$q"],angular.module("icarus.settings").factory("userService",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){return v?v:v=o()}function o(){var i=null;return m.length>0?t.when(m):(i=t.defer(),e.get(p).then(function(e){m=[];for(var t=0;t<e.data.length;t++)m.push(e.data[t]);i.resolve(m)})["catch"](function(e){i.reject(e)}),i.promise)}function r(e){return o().then(function(i){for(var a=0;a<i.length;a++)if(i[a].id===e)return i[a];return t.reject()})}function l(i){var a=t.defer();return e.post(p,{skill:i}).then(function(e){m.push(e.data),n.returnSkills().then(function(t){var i={id:e.data.id,name:e.data.skill};t.push(i)}),a.resolve(e.data)})["catch"](function(e){a.reject(e)}),a.promise}function c(i,a){var n=t.defer();return e.put(p+i.id+"/",a).then(function(e){m.map(function(t,i){t.id===e.data.id&&(m[i]=e.data)}),n.resolve(i)})["catch"](function(e){n.reject(e)}),n.promise}function d(i){var a=t.defer();return e["delete"](p+i.id+"/").then(function(e){for(var t=0;t<m.length;t++)m[t].id===i.id&&m.splice(t,1);a.resolve(e)})["catch"](function(e){a.reject(e)}),a.promise}function u(){m.length=0,v=null}var p=i.API_URL+"routes/skills/",m=[],v=null,g={list:o,get:r,create:l,update:c,remove:d,clear:u};return s(),a.skillsService=g,g}e.$inject=["$http","$q","__env","$window","plannerService"],angular.module("icarus.settings").factory("skillsService",e)}(),function(){"use strict";function e(e,t){function i(e,t,i){return o+"client/"+e+"/"+t+"/"+i+"/"}function a(e,t){return r+e+"/"+t+"/"}function n(t){return e.get(a(c,t.date),{params:{from:t.from,to:t.to}})}function s(t){return e.get(i(t.clientId,l,t.date),{params:{geofense_radius:t.geofenseRadius||d,from:t.from,to:t.to}})}var o=t.API_URL+"routes/reports/",r=t.API_URL+"reports/",l="time-service",c="kilometers",d=500;return{getkilometersTraveling:n,getTimeServiceVisits:s}}e.$inject=["$http","__env"],angular.module("icarus.settings").factory("settingsService",e)}(),function(){"use strict";function e(e,t,i,a){function n(){var i=null;return null!==d?t.when(d):(i=t.defer(),e.get(c).then(function(e){d=[],e.data.forEach(function(e){d.push(e)}),i.resolve(d)})["catch"](function(e){i.reject(e)}),i.promise)}function s(i){var a=t.defer();return e.post(c,i).then(function(e){d.push(e.data),a.resolve(e.data)})["catch"](function(e){a.reject(e)}),a.promise}function o(i,a){var n=t.defer(),s=null;return e.put(c+i.id+"/",a).then(function(e){d.map(function(t,i){t.id===e.data.id&&(d[i]=e.data,s=i)}),n.resolve(e.data)})["catch"](function(e){n.reject(e)}),n.promise}function r(i){var a=t.defer();return e["delete"](c+i.id+"/").then(function(e){for(var t=0;t<d.length;t++)if(d[t].id===i.id){d.splice(t,1);break}a.resolve(e)})["catch"](function(e){a.reject(e)}),a.promise}function l(){d=null}var c=i.API_URL+"routes/observations/",d=null,u={listObservations:n,createObservation:s,updateObservation:o,removeObservation:r,clear:l};return a.mobileGeneralService=u,u}e.$inject=["$http","$q","__env","$window"],angular.module("icarus.settings").factory("mobileGeneralService",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){return f?f:f=r()}function r(){var i=null;return null!==_?t.when(_):(i=t.defer(),e.get(g).then(function(e){_=[],e.data.forEach(function(e){_.push(e)}),i.resolve(_)})["catch"](function(e){i.reject(e)}),i.promise)}function l(e){return r().then(function(i){for(var a=0;a<i.length;a++)if(i[a].id===e)return i[a];return t.reject()})}function c(i){var a=t.defer();return e.post(g,i).then(function(e){_.push(e.data),n.returnDrivers().then(function(t){var i={id:String(e.data.id),name:e.data.name,username:e.data.username,initials:e.data.username.charAt(0)};t.push(i)}),a.resolve(e.data)})["catch"](function(e){a.reject(e)}),a.promise}function d(i,a){var o=t.defer(),r=null;return e.put(g+i.id+"/",a).then(function(e){_.map(function(t,i){t.id===e.data.id&&(_[i]=e.data,r=i,n.getDriver(String(t.id)).then(function(t){var i={id:String(e.data.id),name:e.data.name,
username:e.data.username,initials:e.data.username.charAt(0)};s.merge(t,i)}))}),o.resolve(e.data)})["catch"](function(e){o.reject(e)}),o.promise}function u(i){var a=t.defer();return e["delete"](g+i.id+"/").then(function(e){for(var t=0;t<_.length;t++)if(_[t].id===i.id){_.splice(t,1),n.returnDrivers().then(function(e){for(var t=0;t<e.length;t++)e[t].id===String(i.id)&&e.splice(t,1)});break}a.resolve(e)})["catch"](function(e){a.reject(e)}),a.promise}function p(i){var a=t.defer();return e.get(h,{params:{username:i.username}}).then(function(e){a.resolve(e)})["catch"](function(e){a.reject(e)}),a.promise}function m(){_=null,f=null}function v(){return _}var g=i.API_URL+"accounts/drivers/",h=i.API_URL+"accounts/user-exist/",_=null,f=null,b={list:r,getDriverById:l,clear:m,create:c,update:d,remove:u,checkUsername:p,getDrivers:v};return o(),a.driversService=b,b}e.$inject=["$http","$q","__env","$window","plannerService","lodash"],angular.module("icarus.settings").factory("driversService",e)}(),function(){"use strict";function e(e,t,i,a){function n(t){return e.post(c(),t)}function s(){var t=a.defer();return e.get(c()).then(function(e){var i=e.data.filter(function(e){return e.is_public});t.resolve(d(i))},function(e){i.error("Error retrieving configs"),t.reject(e)}),t.promise}function o(t){var n=a.defer();return e.get(c()).then(function(e){var i=e.data.find(function(e){return e.key===t});n.resolve(i?i.value:null)},function(e){i.error("Error retrieving configs"),n.reject(e)}),n.promise}function r(t){var i=[];for(var n in t)i.push(e.post(c(),{key:n,value:t[n]}));return a.all(i)}function l(){var t=a.defer();return e.get(c()).then(function(e){t.resolve(d(e.data))},function(e){i.error("Error retrieving configs"),t.reject(e)}),t.promise}function c(){return t.API_URL+"accounts/configs/"}function d(e){var t={};return e.forEach(function(e){t[e.key]=e.value}),t}return{createOrSaveConfigs:n,getAllPublicConfigs:s,getConfigByKey:o,saveAllConfigs:r,getAllConfigs:l}}e.$inject=["$http","__env","$log","$q"],angular.module("icarus.settings").factory("accountConfigsService",e)}(),function(){"use strict";function e(e,t,i,a){function n(e,t,i,a,n){this.id=e,this.name=t,this.coordinates=i,this.vehicles=a,this.urlMap=n}function s(e){var t=a.getStringStyleOfOptions(),i="https://maps.googleapis.com/maps/api/staticmap?",n="size=278x180&format=png",s=o(e),l="&path=color:black|weight:1|fillcolor:black|"+s,c="&key="+r;return i+n+t+l+c}function o(e){for(var t="",i=0;i<e.length;i++)t=i===e.length-1?t+e[i].lat+","+e[i].lng+"|"+e[0].lat+","+e[0].lng:t+e[i].lat+","+e[i].lng+"|";return t}var r=e.GOOGLE_MAPS_KEY_PAY;return n.fromJson=function(e){if(!(e&&e.id&&e.name&&e.coordinates&&e.vehicles&&Array.isArray(e.vehicles)))throw new Error("Json is not a valid ZoneModel");var t=s(e.coordinates);return new n(e.id,e.name,e.coordinates,e.vehicles,t)},n.fromStringJson=function(e){var t=angular.fromJson(e);return n.fromJson(t)},n}e.$inject=["__env","$q","$log","mapService"],angular.module("icarus.settings").factory("ZoneModel",e)}(),function(){"use strict";function e(){function e(e,t,i,a,n,s,o,r,l){this.id=e,this.name=t,this.username=i,this.phone=a,this.email=n,this.isAdmin=s,this.isDriver=o,this.isMonitor=r,this.isStaff=l}return e.fromJson=function(t){if(!(t&&t.id&&t.name&&t.username))throw new Error("Json is not a valid UserModel");return new e(t.id,t.name,t.username,t.phone,t.email,t.is_admin,t.is_driver,t.is_monitor,t.is_staff)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.settings").factory("UserModel",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){function e(e){S.observations=e,I()}function i(e){t.info("errorGetObservations",e)}n.listObservations().then(e,i),s.getUser().then(h,_)}function u(){S.form.$invalid||(C={label:S.mobile.label,type:S.mobile.type.id},S.editing?w(C):y(C))}function p(){e.deleteObservation=b,r.open({template:"app/settings/mobile-general/observation-delete-modal.html",scope:e})}function m(e){S.observationEdit=e,S.mobile.label=e.label,S.mobile.type=k(e.type),S.editing=!0}function v(e){if(D){var i={key:e,value:S.accountConfigs[e]};S.accountConfigsLoader=!0,o.createOrSaveConfigs(i).then(function(e){t.info(e.data),s.changeAccountConfigs(i)})["catch"](function(e){t.error(e),l.push("error",E("Mobile_general.Accounts_settings.error_save_configs"))})["finally"](function(){c(function(){S.accountConfigsLoader=!1},3e3)})}}function g(){a.isLoading=!0,o.saveAllConfigs(S.accountConfigs).then(function(e){t.info(e),l.push("success",E("Account.configs_saved_success"))})["catch"](function(e){t.info(e),l.push("error",E("Account.configs_saved_fail"))})["finally"](function(){a.isLoading=!1})}function h(e){D=e.account,o.getAllPublicConfigs().then(function(e){f(e)})}function _(e){t.info(e)}function f(e){S.accountConfigs.enable_signature=e.enable_signature,S.accountConfigs.checkout_similars=e.checkout_similars,angular.isDefined(S.accountConfigs.enable_observations)&&(S.accountConfigs.enable_observations=e.enable_observations)}function b(){n.removeObservation(S.observationEdit).then(function(){S.mobile={},S.form.$setPristine(),S.form.$setUntouched(),S.form.$submitted=!1,I()},function(e){t.info("errorRemoveObservation",e),l.push("error",E("Mobile_general.error_delete_observations"))}),S.editing=!1}function y(){n.createObservation(C).then(A,x)}function w(){n.updateObservation(S.observationEdit,C).then(A,x)}function A(){S.mobile={},S.form.$setPristine(),S.form.$setUntouched(),S.form.$submitted=!1,S.editing=!1,I()}function x(e){t.info("errorCreateObservation",e),400===e.status&&e.data.non_field_errors?l.push("error",E("Mobile_general.error_duplicated_observations")):(S.mobile={},S.form.$setPristine(),S.form.$setUntouched(),S.form.$submitted=!1,l.push("error",E("Mobile_general.error_create_observations")))}function k(e){for(var t=0;t<S.typeObservation.length;t++)if(e===S.typeObservation[t].id)return S.typeObservation[t]}function I(){0===S.observations.length&&delete S.accountConfigs.enable_observations}var S=this,E=i("translate"),C=[],D=null;S.form={},S.mobile={label:null,type:null},S.typeObservation=[{id:"completed",name:E("Mobile_general.completed")},{id:"failed",name:E("Mobile_general.failed")}],S.maxSize=3,S.currentPage=1,S.itemsPerPage=15,S.accountConfigs={enable_observations:!1,checkout_similars:!1,enable_signature:!1},S.save=u,S.showDeleteModal=p,S.editObservation=m,S.saveAccountConfig=v,S.saveConfigsMobile=g,d()}e.$inject=["$scope","$log","$filter","$rootScope","mobileGeneralService","sessionService","accountConfigsService","ngDialog","Toasts","$timeout"],angular.module("icarus.settings").controller("MobileGeneralsListController",e)}(),function(){"use strict";function e(e,t,i){function a(){i.getConfigByKey("optimize_cluster").then(function(e){e||delete r.optimizationOptions.big_cluster,n()})}function n(){angular.forEach(e.optimizationOptions,function(t,i){r.optimizationOptions.hasOwnProperty(i)&&(-1!==e.optimizationOptionsDisplayed.indexOf(i)&&(r.optimizationOptions[i].editable=!0),r.optimizationOptions[i].value=t)});for(var t in r.optimizationOptions)r.checkOptions(t);l=angular.copy(r.optimizationOptions)}function s(e){switch(e){case"balance":r.optimizationOptions.balance.value&&(r.optimizationOptions.big_cluster.value=!1);break;case"all_vehicles":r.optimizationOptions.all_vehicles.value||(r.optimizationOptions.big_cluster.value=!1);break;case"big_cluster":r.optimizationOptions.big_cluster.value&&(r.optimizationOptions.open_ended.value=!1,r.optimizationOptions.balance.value=!1,r.optimizationOptions.all_vehicles.value=!0);break;case"open_ended":r.optimizationOptions.open_ended.value&&(r.optimizationOptions.big_cluster.value=!1)}}function o(i){var a={displayed_options:[]};angular.forEach(i,function(e,t){e.editable&&"fmv"!==t&&a.displayed_options.push(t),a[t]=e.value}),r.optimizationOptionsLoader=!0,t.updateOptimizationOptions(a).then(function(n){r.optimizationOptionsLoader=!1,r.isPressed=!1,angular.forEach(a,function(t,i){e.localOptimizationOptions.hasOwnProperty(i)?"fmv"===i?(e.localOptimizationOptions[i]=parseFloat(t),e.optimizationOptions[i]=parseFloat(t)):(e.localOptimizationOptions[i]=t,e.optimizationOptions[i]=t):e.optimizationOptionsDisplayed=t}),l=i,t.setOptimizationOptions(n.data.optimization_options)})["catch"](function(){r.optimizationOptionsLoader=!1,r.optimizationOptions=angular.copy(l)})}var r=this,l=null;r.optimizationOptions={balance:{editable:!1,value:!1},all_vehicles:{editable:!1,value:!0},big_cluster:{editable:!1,value:!1},open_ended:{editable:!1,value:!1},join:{editable:!1,value:!1},fmv:{editable:!0,value:1.5},single_tour:{editable:!1,value:!1}},r.trafficSlider={options:{floor:3,ceil:0,showSelectionBar:!0,hideLimitLabels:!0,hidePointerLabels:!0,stepsArray:[{value:3},{value:2},{value:1.5},{value:1}]}},r.isPressed=!1,r.optimizationChanged=o,r.checkOptions=s,a()}e.$inject=["plannerService","sessionService","accountConfigsService"],angular.module("icarus.settings").controller("GeneralsListController",e)}(),function(){"use strict";function e(e){return function(t,i){var a=t.filter(function(e){return!(1===i.role&&(e.isAdmin||e.isOwner)||0===i.role&&i.id===e.id)});return e(a,"+name")}}e.$inject=["orderByFilter"],angular.module("icarus.settings").filter("orderUsersSettings",e)}(),function(){"use strict";function e(){return function(e){var t=[],i=[];return angular.forEach(e,function(e){return"completed"===e.type?void i.push(e):"failed"===e.type?void t.push(e):void 0}),t.sort(function(e,t){return e.label<t.label?-1:1}),i.sort(function(e,t){return e.label<t.label?-1:1}),[].concat(i).concat(t)}}angular.module("icarus.settings").filter("orderObservationsSettings",e)}(),function(){"use strict";function e(e){var t=e.TOGGLES;return{restrict:"A",link:function(e,i,a){e.toggle=a.spToggle,e.$watch("toggle",function(e){t[e]?i.show():i.hide()},!0)}}}e.$inject=["__env"],angular.module("icarus").directive("spToggle",["__env",e])}(),function(){"use strict";function e(){return{restrict:"A",link:function(e,t,i){i.$observe("spToggleConfig",function(e){var i="true"===e;i?t.show():t.hide()})}}}angular.module("icarus").directive("spToggleConfig",["__env",e])}(),function(){"use strict";function e(e,t){var i=angular.element(window.document.body),a=angular.element("<textarea/>");a.css({position:"fixed",opacity:"0"}),a.val(t),i.append(a),a[0].select();try{document.execCommand("copy")}catch(n){e.prompt("Copy to clipboard: Ctrl+C, Enter",t)}a.remove()}function t(t){return{restrict:"A",link:function(i,a,n){a.bind("click",function(i){e(t,n.spCopy)})}}}e.$inject=["$window","toCopy"],angular.module("icarus").directive("spCopy",["$window",t])}(),function(){"use strict";function e(e,t){var i="es",a=t.use();return{require:"ngModel",link:function(e,t,n,s){function o(e){if(e){var t=null,n=null;return a===i&&"number"==typeof e&&(e=String(e).replace(".",",")),a===i?(e=String(e).replace(/[^0-9\.,]/g,"").split(".").join(""),t=e.indexOf(",")>-1?","+e.split(",")[1].substring(0,2):"",e=e.split(",")[0],n=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")):(e=String(e).replace(/[^0-9.]/g,""),t=e.indexOf(".")>-1?"."+e.split(".")[1].substring(0,2):"",e=e.split(".")[0],n=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),n+=t,s.$setViewValue(n),s.$render(),n}return void 0}s.$formatters.push(o),s.$parsers.push(o)}}}e.$inject=["$filter","$translate"],angular.module("icarus.settings").directive("capacityInputFormat",["$filter","$translate",e])}(),function(){"use strict";function e(e,t,i,a,n){function s(){o()}function o(){t.isLoading=!1,n.initializeMap().then(function(e){m(e),t.isLoading=!1})["catch"](function(i){e.error(i),t.isLoading=!1})}function r(e){u(),g.polygon=e,p(g.polygon),i.$apply(function(){g.resetAvailable=!0})}function l(){g.drawingManager.setOptions({drawingControl:!0}),g.resetAvailable=!1,g.polygon&&g.polygon.setMap(null),g.data.coordinates=[]}function c(e){g.data.coordinates&&g.data.coordinates.length>0&&(g.polygon=n.drawZone(g.data.coordinates,h,e),p(g.polygon),e.fitBounds(g.polygon.getBounds()),u())}function d(){v(g.polygon)}function u(){g.drawingManager.setOptions({drawingControl:!1,drawingMode:null})}function p(e){v(e),n.listenersPolygonChanged(e,d)}function m(t){g.drawingManager=n.setDrawing(t),n.listenerZoneCompleted(g.drawingManager,r),c(t),a.getCoordinatesOfAllZones(g.data).then(function(e){n.drawingAdjacentZones(e,t)})["catch"](function(t){e.error(t)})}function v(e){var t=e.getPath(),i=[];t.forEach(function(e){i.push({lat:e.lat().toFixed(6),lng:e.lng().toFixed(6)})}),i=JSON.stringify(i).replace(/"/g,"'"),g.data.coordinates=i}var g=this,h={fillColor:"#335F72",fillOpacity:.5,strokeWeight:1,strokeOpacity:0,clickable:!0,editable:!0,draggable:!1,zIndex:1};g.drawingManager=null,g.polygon=null,g.zone={name:""},g.resetAvailable=!1,g.resetZone=l,s()}var t={templateUrl:"app/settings/components/zoneMap.html",controller:["$log","$rootScope","$scope","zoneService","zoneMapService",e],bindings:{data:"<"}};angular.module("icarus.settings").component("zoneMap",t)}(),function(){"use strict";function e(){var e=this;e.edit=function(){e.callToEdit({zoneObj:e.data})},e["delete"]=function(){e.callToDelete({zoneId:e.data.id})}}var t={templateUrl:"app/settings/components/zone.html",controller:e,bindings:{data:"<",callToEdit:"&",callToDelete:"&"}};angular.module("icarus.settings").component("zone",t)}(),function(){"use strict";function e(){}var t={templateUrl:"app/settings/components/actions-zones.html",controller:e,bindings:{data:"<"}};angular.module("icarus.settings").component("actionsZones",t)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){t.getInfoAddonAndPropertiesByKey(w).then(function(e){m(e),y.ready=!0})["catch"](function(e){a.error(e),y.ready=!0}),i.getConfigByKey("custom_tracking_code").then(function(e){y.customTrackingCode=e})}function u(){i.createOrSaveConfigs({key:"custom_tracking_code",value:y.customTrackingCode})}function p(e,t){y.activeRows={},y.state.go("settings.communication.detail",{addonId:e,addonPropertyKey:t}),y.activeRows[t]=!0}function m(e){y.addonProperties.forEach(function(t){t.addonId=e.addon.id,e.properties.forEach(function(e){t.sms.key===e.key?(t.sms.value=e.value,t.sms.id=e.id):t.email.key===e.key&&(t.email.value=e.value,t.email.id=e.id)})})}function v(e,t){t.forEach(function(e){if(e){var t=h(e.key);t&&(y.addonProperties[t.index][t.key].value=e.value,y.addonProperties[t.index][t.key].id=e.id)}})}function g(e,t){var i=h(t);i&&(y.addonProperties[i.index][i.key].value="")}function h(e){for(var t,i=null,a=0;a<y.addonProperties.length;a++)if(e.includes(y.addonProperties[a].propertyKey)){if(e===y.addonProperties[a].sms.key){t="sms",i=a;break}if(e===y.addonProperties[a].email.key){t="email",i=a;break}}var n=null;return!angular.isUndefined(i)&&null!==i&&t&&(n={index:i,key:t}),n}function _(){y.activeRows={}}function f(e){var t=e.toString(16),i=y.customTrackingCode?'"?custom_code=true"':'"?custom_code=false"';return c.trustAsHtml('<div style="width: 300px; text-align: center;"><form style="display: flex;" action="'+k+'" name="sp-tracking-code-search" id="sp-tracking-code-search"><input title="code" id="tracking-code" name="tracking-code" style="width: 250px; box-shadow: 0px 0px 8px -6px black;"><button type="button" style="color: #fff; background-color: #586BA4; border: 0"onclick="sendForm()" id="send" name="send">'+A("Communication.search")+'</button></form><div style="color: black; font-size: 10px"><span>powered by </span><a href="http://simpliroute.com"><img style="width: 80px" src="'+x+"\"/></a></div><script>function sendForm(){var form = document.getElementById('sp-tracking-code-search');var input = document.getElementById('tracking-code');var code = input.value;input.disabled = true;form.action = form.action + '"+t+"/' + code  +"+i+";form.submit();}</script></div>")}function b(){e.getUser().then(function(e){e&&(o.widgetCode=f(e.account.id),r.open({template:"app/settings/communication/widget-code-modal.html",className:"ngdialog-theme-default custom-width-800",scope:o}))})}var y=this,w="live_tracking",A=s("translate"),x=l.URL_ROOT+"assets/images/logo_oficial.png",k=l.UMBIKO_URL+"widget/";y.state=n,y.activeRows={},y.ready=!1,y.addonProperties=[{label:A("Communication.visit_scheduled"),propertyKey:"visit_scheduled",addonId:"",sms:{id:"",value:"",key:"visit_scheduled_sms_body"},email:{id:"",value:"",key:"visit_scheduled_email_body"}},{label:A("Communication.route_started"),propertyKey:"route_started",addonId:"",sms:{id:"",value:"",key:"route_started_sms_body"},email:{id:"",value:"",key:"route_started_email_body"}},{label:A("Communication.checkout_success"),propertyKey:"checkout_success",addonId:"",sms:{id:"",value:"",key:"checkout_success_sms_body"},email:{id:"",value:"",key:"checkout_success_email_body"}},{label:A("Communication.checkout_failed"),propertyKey:"checkout_failed",addonId:"",sms:{id:"",value:"",key:"checkout_failed_sms_body"},email:{id:"",value:"",key:"checkout_failed_email_body"}}],y.changeStateToDetail=p,y.showWidgetModal=b,y.saveCustomTrackingConfig=u,y.customTrackingCode=!1,d(),o.$on("UPDATE_PROPERTIES",v),o.$on("DELETE_PROPERTY",g),o.$on("DEACTIVATE_ROWS",_)}e.$inject=["sessionService","addonsService","accountConfigsService","$log","$state","$filter","$scope","ngDialog","__env","$sce"],angular.module("icarus.settings").controller("CommunicationController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(){D.addonPropertyKey=a.addonPropertyKey;var e=a.addonId,t=D.addonPropertyKey+"_sms_body",i=D.addonPropertyKey+"_email_subject",n=D.addonPropertyKey+"_email_body",s=D.addonPropertyKey+"_email_attachment_images",r=[t,i,n,s];S(a.addonPropertyKey),o.getAddonByIdAndPropertiesByKeys(e,r).then(function(t){A(e,t)})}function c(){i.go("^"),e.$emit("DEACTIVATE_ROWS")}function d(){var n=[],o=parseInt(a.addonId);Object.keys(D.properties).forEach(function(e){var t=D.properties[e];t.add_on_id=o,t.value=k(t),t.id?g(n,t):h(n,t)}),t.all(n).then(function(t){s.info(t),e.$emit("UPDATE_PROPERTIES",t)})["catch"](function(e){s.error(e)})["finally"](function(){i.go("^"),e.$emit("DEACTIVATE_ROWS")})}function u(t){e.addonProperties=f(t),e.deleteAddonProperty=_,n.open({template:"app/settings/communication/communication-delete-modal.html",scope:e})}function p(e){"emailBody"===e?D.textEmailPreview=b(D.properties[e].value,"email"):"smsBody"===e&&(D.textSmsPreview=b(D.properties[e].value,"sms")),D.textSmsPreview=w(D.textSmsPreview),D.textEmailPreview=w(D.textEmailPreview)}function m(e,t){C(e,t),p(e)}function v(e){D.properties.emailSubject.value.search(e)>-1?D.repeatedSubjectTag=!0:(C("emailSubject",e),D.repeatedSubjectTag=!1)}function g(e,t){e.push(o.updateAddonProperty(t)),E(e,t)}function h(e,t){t.title&&t.description&&t.value&&(e.push(o.createAddonProperty(t)),E(e,t))}function _(){var a=[];e.addonProperties.forEach(function(t){a.push(o.deleteProperty(t.addonId,t.id).then(function(){e.$emit("DELETE_PROPERTY",t.key)})["catch"](function(e){s.error(e)}))}),t.all(a).then(function(){i.go("^")})["catch"](function(e){s.error(e)})["finally"](function(){e.$emit("DEACTIVATE_ROWS")})}function f(e){return D.sendAttachment&&D.emailPropertiesAttachment.images.id&&e.push({addonId:D.emailPropertiesAttachment.images.addonId,id:D.emailPropertiesAttachment.images.id,key:D.emailPropertiesAttachment.images.key}),e}function b(e,t){var i=e?e:"";for(var a in D.tags)D.tags[a].values.hasOwnProperty(t)&&(i=i.replace(new RegExp(D.tags[a].id,"g"),D.tags[a].values[t]));return i}function y(e,t){var i=e;for(var a in D.tags)D.tags[a].values.hasOwnProperty(t)&&(i=i.replace(new RegExp(D.tags[a].values[t],"g"),D.tags[a].id));return i}function w(e){return e.replace(/[^A-Za-z0-9^√±^√á^√ß[\] ]/g,function(e){return L[e]||e})}function A(e,t){t.forEach(function(t){x(t.data[0]),Object.keys(D.properties).forEach(function(i){var a=D.properties[i];t.data[0]&&t.data[0].key===a.key&&(a.value=t.data[0].value?I(t.data[0]):t.data[0].value,a.id=t.data[0].id,a.addonId=e,a.title=t.data[0].title,a.description=t.data[0].description,a.key=t.data[0].key),"string"==typeof a.value&&a.value.trim().length>0&&("smsBody"===i?D.smsRequired=!0:D.emailRequired=!0),p(i)})})}function x(e){e&&e.key===D.emailPropertiesAttachment.images.key&&(D.sendAttachment.init=!0,D.sendAttachment.value=!0,D.emailPropertiesAttachment.images.id=e.id)}function k(e){var t=e.value;return e.key.includes("sms")&&(t=y(t,"sms")),t}function I(e){return e.key.includes("sms")&&(e.value=e.value.replace(/(?:https?|ftp):\/\/[\n\S]+/g,"{TRACKING_URL}")),e.value}function S(e){("checkout_success"===e||"checkout_failed"===e)&&(D.enableSendAttachment=!0)}function E(e,t){D.emailPropertiesAttachment.images.add_on_id=D.emailPropertiesAttachment.images.addonId,!D.sendAttachment.value||"checkout_success_email_body"!==t.key&&"checkout_failed_email_body"!==t.key?D.sendAttachment.value||!D.sendAttachment.init||"checkout_success_email_body"!==t.key&&"checkout_failed_email_body"!==t.key||e.push(o.deleteProperty(D.emailPropertiesAttachment.images.addonId,D.emailPropertiesAttachment.images.id)):e.push(o.createAddonProperty(D.emailPropertiesAttachment.images))}function C(e,t){D.properties[e].value=(D.properties[e].value?D.properties[e].value:"")+" "+t+" "}var D=this,P="eyLDgSI6IkEiLCLEgiI6IkEiLCLhuq4iOiJBIiwi4bq2IjoiQSIsIuG6sCI6IkEiLCLhurIiOiJBIiwi4bq0IjoiQSIsIseNIjoiQSIsIsOCIjoiQSIsIuG6pCI6IkEiLCLhuqwiOiJBIiwi4bqmIjoiQSIsIuG6qCI6IkEiLCLhuqoiOiJBIiwiw4QiOiJBIiwix54iOiJBIiwiyKYiOiJBIiwix6AiOiJBIiwi4bqgIjoiQSIsIsiAIjoiQSIsIsOAIjoiQSIsIuG6oiI6IkEiLCLIgiI6IkEiLCLEgCI6IkEiLCLEhCI6IkEiLCLDhSI6IkEiLCLHuiI6IkEiLCLhuIAiOiJBIiwiyLoiOiJBIiwiw4MiOiJBIiwi6pyyIjoiQUEiLCLDhiI6IkFFIiwix7wiOiJBRSIsIseiIjoiQUUiLCLqnLQiOiJBTyIsIuqctiI6IkFVIiwi6py4IjoiQVYiLCLqnLoiOiJBViIsIuqcvCI6IkFZIiwi4biCIjoiQiIsIuG4hCI6IkIiLCLGgSI6IkIiLCLhuIYiOiJCIiwiyYMiOiJCIiwixoIiOiJCIiwixIYiOiJDIiwixIwiOiJDIiwiw4ciOiJDIiwi4biIIjoiQyIsIsSIIjoiQyIsIsSKIjoiQyIsIsaHIjoiQyIsIsi7IjoiQyIsIsSOIjoiRCIsIuG4kCI6IkQiLCLhuJIiOiJEIiwi4biKIjoiRCIsIuG4jCI6IkQiLCLGiiI6IkQiLCLhuI4iOiJEIiwix7IiOiJEIiwix4UiOiJEIiwixJAiOiJEIiwixosiOiJEIiwix7EiOiJEWiIsIseEIjoiRFoiLCLDiSI6IkUiLCLElCI6IkUiLCLEmiI6IkUiLCLIqCI6IkUiLCLhuJwiOiJFIiwiw4oiOiJFIiwi4bq+IjoiRSIsIuG7hiI6IkUiLCLhu4AiOiJFIiwi4buCIjoiRSIsIuG7hCI6IkUiLCLhuJgiOiJFIiwiw4siOiJFIiwixJYiOiJFIiwi4bq4IjoiRSIsIsiEIjoiRSIsIsOIIjoiRSIsIuG6uiI6IkUiLCLIhiI6IkUiLCLEkiI6IkUiLCLhuJYiOiJFIiwi4biUIjoiRSIsIsSYIjoiRSIsIsmGIjoiRSIsIuG6vCI6IkUiLCLhuJoiOiJFIiwi6p2qIjoiRVQiLCLhuJ4iOiJGIiwixpEiOiJGIiwix7QiOiJHIiwixJ4iOiJHIiwix6YiOiJHIiwixKIiOiJHIiwixJwiOiJHIiwixKAiOiJHIiwixpMiOiJHIiwi4bigIjoiRyIsIsekIjoiRyIsIuG4qiI6IkgiLCLIniI6IkgiLCLhuKgiOiJIIiwixKQiOiJIIiwi4rGnIjoiSCIsIuG4piI6IkgiLCLhuKIiOiJIIiwi4bikIjoiSCIsIsSmIjoiSCIsIsONIjoiSSIsIsSsIjoiSSIsIsePIjoiSSIsIsOOIjoiSSIsIsOPIjoiSSIsIuG4riI6IkkiLCLEsCI6IkkiLCLhu4oiOiJJIiwiyIgiOiJJIiwiw4wiOiJJIiwi4buIIjoiSSIsIsiKIjoiSSIsIsSqIjoiSSIsIsSuIjoiSSIsIsaXIjoiSSIsIsSoIjoiSSIsIuG4rCI6IkkiLCLqnbkiOiJEIiwi6p27IjoiRiIsIuqdvSI6IkciLCLqnoIiOiJSIiwi6p6EIjoiUyIsIuqehiI6IlQiLCLqnawiOiJJUyIsIsS0IjoiSiIsIsmIIjoiSiIsIuG4sCI6IksiLCLHqCI6IksiLCLEtiI6IksiLCLisakiOiJLIiwi6p2CIjoiSyIsIuG4siI6IksiLCLGmCI6IksiLCLhuLQiOiJLIiwi6p2AIjoiSyIsIuqdhCI6IksiLCLEuSI6IkwiLCLIvSI6IkwiLCLEvSI6IkwiLCLEuyI6IkwiLCLhuLwiOiJMIiwi4bi2IjoiTCIsIuG4uCI6IkwiLCLisaAiOiJMIiwi6p2IIjoiTCIsIuG4uiI6IkwiLCLEvyI6IkwiLCLisaIiOiJMIiwix4giOiJMIiwixYEiOiJMIiwix4ciOiJMSiIsIuG4viI6Ik0iLCLhuYAiOiJNIiwi4bmCIjoiTSIsIuKxriI6Ik0iLCLFgyI6Ik4iLCLFhyI6Ik4iLCLFhSI6Ik4iLCLhuYoiOiJOIiwi4bmEIjoiTiIsIuG5hiI6Ik4iLCLHuCI6Ik4iLCLGnSI6Ik4iLCLhuYgiOiJOIiwiyKAiOiJOIiwix4siOiJOIiwiw5EiOiJOIiwix4oiOiJOSiIsIsOTIjoiTyIsIsWOIjoiTyIsIseRIjoiTyIsIsOUIjoiTyIsIuG7kCI6Ik8iLCLhu5giOiJPIiwi4buSIjoiTyIsIuG7lCI6Ik8iLCLhu5YiOiJPIiwiw5YiOiJPIiwiyKoiOiJPIiwiyK4iOiJPIiwiyLAiOiJPIiwi4buMIjoiTyIsIsWQIjoiTyIsIsiMIjoiTyIsIsOSIjoiTyIsIuG7jiI6Ik8iLCLGoCI6Ik8iLCLhu5oiOiJPIiwi4buiIjoiTyIsIuG7nCI6Ik8iLCLhu54iOiJPIiwi4bugIjoiTyIsIsiOIjoiTyIsIuqdiiI6Ik8iLCLqnYwiOiJPIiwixYwiOiJPIiwi4bmSIjoiTyIsIuG5kCI6Ik8iLCLGnyI6Ik8iLCLHqiI6Ik8iLCLHrCI6Ik8iLCLDmCI6Ik8iLCLHviI6Ik8iLCLDlSI6Ik8iLCLhuYwiOiJPIiwi4bmOIjoiTyIsIsisIjoiTyIsIsaiIjoiT0kiLCLqnY4iOiJPTyIsIsaQIjoiRSIsIsaGIjoiTyIsIsiiIjoiT1UiLCLhuZQiOiJQIiwi4bmWIjoiUCIsIuqdkiI6IlAiLCLGpCI6IlAiLCLqnZQiOiJQIiwi4rGjIjoiUCIsIuqdkCI6IlAiLCLqnZgiOiJRIiwi6p2WIjoiUSIsIsWUIjoiUiIsIsWYIjoiUiIsIsWWIjoiUiIsIuG5mCI6IlIiLCLhuZoiOiJSIiwi4bmcIjoiUiIsIsiQIjoiUiIsIsiSIjoiUiIsIuG5niI6IlIiLCLJjCI6IlIiLCLisaQiOiJSIiwi6py+IjoiQyIsIsaOIjoiRSIsIsWaIjoiUyIsIuG5pCI6IlMiLCLFoCI6IlMiLCLhuaYiOiJTIiwixZ4iOiJTIiwixZwiOiJTIiwiyJgiOiJTIiwi4bmgIjoiUyIsIuG5oiI6IlMiLCLhuagiOiJTIiwixaQiOiJUIiwixaIiOiJUIiwi4bmwIjoiVCIsIsiaIjoiVCIsIsi+IjoiVCIsIuG5qiI6IlQiLCLhuawiOiJUIiwixqwiOiJUIiwi4bmuIjoiVCIsIsauIjoiVCIsIsWmIjoiVCIsIuKxryI6IkEiLCLqnoAiOiJMIiwixpwiOiJNIiwiyYUiOiJWIiwi6pyoIjoiVFoiLCLDmiI6IlUiLCLFrCI6IlUiLCLHkyI6IlUiLCLDmyI6IlUiLCLhubYiOiJVIiwiw5wiOiJVIiwix5ciOiJVIiwix5kiOiJVIiwix5siOiJVIiwix5UiOiJVIiwi4bmyIjoiVSIsIuG7pCI6IlUiLCLFsCI6IlUiLCLIlCI6IlUiLCLDmSI6IlUiLCLhu6YiOiJVIiwixq8iOiJVIiwi4buoIjoiVSIsIuG7sCI6IlUiLCLhu6oiOiJVIiwi4busIjoiVSIsIuG7riI6IlUiLCLIliI6IlUiLCLFqiI6IlUiLCLhuboiOiJVIiwixbIiOiJVIiwixa4iOiJVIiwixagiOiJVIiwi4bm4IjoiVSIsIuG5tCI6IlUiLCLqnZ4iOiJWIiwi4bm+IjoiViIsIsayIjoiViIsIuG5vCI6IlYiLCLqnaAiOiJWWSIsIuG6giI6IlciLCLFtCI6IlciLCLhuoQiOiJXIiwi4bqGIjoiVyIsIuG6iCI6IlciLCLhuoAiOiJXIiwi4rGyIjoiVyIsIuG6jCI6IlgiLCLhuooiOiJYIiwiw50iOiJZIiwixbYiOiJZIiwixbgiOiJZIiwi4bqOIjoiWSIsIuG7tCI6IlkiLCLhu7IiOiJZIiwixrMiOiJZIiwi4bu2IjoiWSIsIuG7viI6IlkiLCLIsiI6IlkiLCLJjiI6IlkiLCLhu7giOiJZIiwixbkiOiJaIiwixb0iOiJaIiwi4bqQIjoiWiIsIuKxqyI6IloiLCLFuyI6IloiLCLhupIiOiJaIiwiyKQiOiJaIiwi4bqUIjoiWiIsIsa1IjoiWiIsIsSyIjoiSUoiLCLFkiI6Ik9FIiwi4bSAIjoiQSIsIuG0gSI6IkFFIiwiypkiOiJCIiwi4bSDIjoiQiIsIuG0hCI6IkMiLCLhtIUiOiJEIiwi4bSHIjoiRSIsIuqcsCI6IkYiLCLJoiI6IkciLCLKmyI6IkciLCLKnCI6IkgiLCLJqiI6IkkiLCLKgSI6IlIiLCLhtIoiOiJKIiwi4bSLIjoiSyIsIsqfIjoiTCIsIuG0jCI6IkwiLCLhtI0iOiJNIiwiybQiOiJOIiwi4bSPIjoiTyIsIsm2IjoiT0UiLCLhtJAiOiJPIiwi4bSVIjoiT1UiLCLhtJgiOiJQIiwiyoAiOiJSIiwi4bSOIjoiTiIsIuG0mSI6IlIiLCLqnLEiOiJTIiwi4bSbIjoiVCIsIuKxuyI6IkUiLCLhtJoiOiJSIiwi4bScIjoiVSIsIuG0oCI6IlYiLCLhtKEiOiJXIiwiyo8iOiJZIiwi4bSiIjoiWiIsIsOhIjoiYSIsIsSDIjoiYSIsIuG6ryI6ImEiLCLhurciOiJhIiwi4bqxIjoiYSIsIuG6syI6ImEiLCLhurUiOiJhIiwix44iOiJhIiwiw6IiOiJhIiwi4bqlIjoiYSIsIuG6rSI6ImEiLCLhuqciOiJhIiwi4bqpIjoiYSIsIuG6qyI6ImEiLCLDpCI6ImEiLCLHnyI6ImEiLCLIpyI6ImEiLCLHoSI6ImEiLCLhuqEiOiJhIiwiyIEiOiJhIiwiw6AiOiJhIiwi4bqjIjoiYSIsIsiDIjoiYSIsIsSBIjoiYSIsIsSFIjoiYSIsIuG2jyI6ImEiLCLhupoiOiJhIiwiw6UiOiJhIiwix7siOiJhIiwi4biBIjoiYSIsIuKxpSI6ImEiLCLDoyI6ImEiLCLqnLMiOiJhYSIsIsOmIjoiYWUiLCLHvSI6ImFlIiwix6MiOiJhZSIsIuqctSI6ImFvIiwi6py3IjoiYXUiLCLqnLkiOiJhdiIsIuqcuyI6ImF2Iiwi6py9IjoiYXkiLCLhuIMiOiJiIiwi4biFIjoiYiIsIsmTIjoiYiIsIuG4hyI6ImIiLCLhtawiOiJiIiwi4baAIjoiYiIsIsaAIjoiYiIsIsaDIjoiYiIsIsm1IjoibyIsIsSHIjoiYyIsIsSNIjoiYyIsIsOnIjoiYyIsIuG4iSI6ImMiLCLEiSI6ImMiLCLJlSI6ImMiLCLEiyI6ImMiLCLGiCI6ImMiLCLIvCI6ImMiLCLEjyI6ImQiLCLhuJEiOiJkIiwi4biTIjoiZCIsIsihIjoiZCIsIuG4iyI6ImQiLCLhuI0iOiJkIiwiyZciOiJkIiwi4baRIjoiZCIsIuG4jyI6ImQiLCLhta0iOiJkIiwi4baBIjoiZCIsIsSRIjoiZCIsIsmWIjoiZCIsIsaMIjoiZCIsIsSxIjoiaSIsIsi3IjoiaiIsIsmfIjoiaiIsIsqEIjoiaiIsIsezIjoiZHoiLCLHhiI6ImR6Iiwiw6kiOiJlIiwixJUiOiJlIiwixJsiOiJlIiwiyKkiOiJlIiwi4bidIjoiZSIsIsOqIjoiZSIsIuG6vyI6ImUiLCLhu4ciOiJlIiwi4buBIjoiZSIsIuG7gyI6ImUiLCLhu4UiOiJlIiwi4biZIjoiZSIsIsOrIjoiZSIsIsSXIjoiZSIsIuG6uSI6ImUiLCLIhSI6ImUiLCLDqCI6ImUiLCLhursiOiJlIiwiyIciOiJlIiwixJMiOiJlIiwi4biXIjoiZSIsIuG4lSI6ImUiLCLisbgiOiJlIiwixJkiOiJlIiwi4baSIjoiZSIsIsmHIjoiZSIsIuG6vSI6ImUiLCLhuJsiOiJlIiwi6p2rIjoiZXQiLCLhuJ8iOiJmIiwixpIiOiJmIiwi4bWuIjoiZiIsIuG2giI6ImYiLCLHtSI6ImciLCLEnyI6ImciLCLHpyI6ImciLCLEoyI6ImciLCLEnSI6ImciLCLEoSI6ImciLCLJoCI6ImciLCLhuKEiOiJnIiwi4baDIjoiZyIsIselIjoiZyIsIuG4qyI6ImgiLCLInyI6ImgiLCLhuKkiOiJoIiwixKUiOiJoIiwi4rGoIjoiaCIsIuG4pyI6ImgiLCLhuKMiOiJoIiwi4bilIjoiaCIsIsmmIjoiaCIsIuG6liI6ImgiLCLEpyI6ImgiLCLGlSI6Imh2Iiwiw60iOiJpIiwixK0iOiJpIiwix5AiOiJpIiwiw64iOiJpIiwiw68iOiJpIiwi4bivIjoiaSIsIuG7iyI6ImkiLCLIiSI6ImkiLCLDrCI6ImkiLCLhu4kiOiJpIiwiyIsiOiJpIiwixKsiOiJpIiwixK8iOiJpIiwi4baWIjoiaSIsIsmoIjoiaSIsIsSpIjoiaSIsIuG4rSI6ImkiLCLqnboiOiJkIiwi6p28IjoiZiIsIuG1uSI6ImciLCLqnoMiOiJyIiwi6p6FIjoicyIsIuqehyI6InQiLCLqna0iOiJpcyIsIsewIjoiaiIsIsS1IjoiaiIsIsqdIjoiaiIsIsmJIjoiaiIsIuG4sSI6ImsiLCLHqSI6ImsiLCLEtyI6ImsiLCLisaoiOiJrIiwi6p2DIjoiayIsIuG4syI6ImsiLCLGmSI6ImsiLCLhuLUiOiJrIiwi4baEIjoiayIsIuqdgSI6ImsiLCLqnYUiOiJrIiwixLoiOiJsIiwixpoiOiJsIiwiyawiOiJsIiwixL4iOiJsIiwixLwiOiJsIiwi4bi9IjoibCIsIsi0IjoibCIsIuG4tyI6ImwiLCLhuLkiOiJsIiwi4rGhIjoibCIsIuqdiSI6ImwiLCLhuLsiOiJsIiwixYAiOiJsIiwiyasiOiJsIiwi4baFIjoibCIsIsmtIjoibCIsIsWCIjoibCIsIseJIjoibGoiLCLFvyI6InMiLCLhupwiOiJzIiwi4bqbIjoicyIsIuG6nSI6InMiLCLhuL8iOiJtIiwi4bmBIjoibSIsIuG5gyI6Im0iLCLJsSI6Im0iLCLhta8iOiJtIiwi4baGIjoibSIsIsWEIjoibiIsIsWIIjoibiIsIsWGIjoibiIsIuG5iyI6Im4iLCLItSI6Im4iLCLhuYUiOiJuIiwi4bmHIjoibiIsIse5IjoibiIsIsmyIjoibiIsIuG5iSI6Im4iLCLGniI6Im4iLCLhtbAiOiJuIiwi4baHIjoibiIsIsmzIjoibiIsIsOxIjoibiIsIseMIjoibmoiLCLDsyI6Im8iLCLFjyI6Im8iLCLHkiI6Im8iLCLDtCI6Im8iLCLhu5EiOiJvIiwi4buZIjoibyIsIuG7kyI6Im8iLCLhu5UiOiJvIiwi4buXIjoibyIsIsO2IjoibyIsIsirIjoibyIsIsivIjoibyIsIsixIjoibyIsIuG7jSI6Im8iLCLFkSI6Im8iLCLIjSI6Im8iLCLDsiI6Im8iLCLhu48iOiJvIiwixqEiOiJvIiwi4bubIjoibyIsIuG7oyI6Im8iLCLhu50iOiJvIiwi4bufIjoibyIsIuG7oSI6Im8iLCLIjyI6Im8iLCLqnYsiOiJvIiwi6p2NIjoibyIsIuKxuiI6Im8iLCLFjSI6Im8iLCLhuZMiOiJvIiwi4bmRIjoibyIsIserIjoibyIsIsetIjoibyIsIsO4IjoibyIsIse/IjoibyIsIsO1IjoibyIsIuG5jSI6Im8iLCLhuY8iOiJvIiwiyK0iOiJvIiwixqMiOiJvaSIsIuqdjyI6Im9vIiwiyZsiOiJlIiwi4baTIjoiZSIsIsmUIjoibyIsIuG2lyI6Im8iLCLIoyI6Im91Iiwi4bmVIjoicCIsIuG5lyI6InAiLCLqnZMiOiJwIiwixqUiOiJwIiwi4bWxIjoicCIsIuG2iCI6InAiLCLqnZUiOiJwIiwi4bW9IjoicCIsIuqdkSI6InAiLCLqnZkiOiJxIiwiyqAiOiJxIiwiyYsiOiJxIiwi6p2XIjoicSIsIsWVIjoiciIsIsWZIjoiciIsIsWXIjoiciIsIuG5mSI6InIiLCLhuZsiOiJyIiwi4bmdIjoiciIsIsiRIjoiciIsIsm+IjoiciIsIuG1syI6InIiLCLIkyI6InIiLCLhuZ8iOiJyIiwiybwiOiJyIiwi4bWyIjoiciIsIuG2iSI6InIiLCLJjSI6InIiLCLJvSI6InIiLCLihoQiOiJjIiwi6py/IjoiYyIsIsmYIjoiZSIsIsm/IjoiciIsIsWbIjoicyIsIuG5pSI6InMiLCLFoSI6InMiLCLhuaciOiJzIiwixZ8iOiJzIiwixZ0iOiJzIiwiyJkiOiJzIiwi4bmhIjoicyIsIuG5oyI6InMiLCLhuakiOiJzIiwiyoIiOiJzIiwi4bW0IjoicyIsIuG2iiI6InMiLCLIvyI6InMiLCLJoSI6ImciLCLhtJEiOiJvIiwi4bSTIjoibyIsIuG0nSI6InUiLCLFpSI6InQiLCLFoyI6InQiLCLhubEiOiJ0IiwiyJsiOiJ0IiwiyLYiOiJ0Iiwi4bqXIjoidCIsIuKxpiI6InQiLCLhuasiOiJ0Iiwi4bmtIjoidCIsIsatIjoidCIsIuG5ryI6InQiLCLhtbUiOiJ0IiwixqsiOiJ0IiwiyogiOiJ0IiwixaciOiJ0Iiwi4bW6IjoidGgiLCLJkCI6ImEiLCLhtIIiOiJhZSIsIsedIjoiZSIsIuG1tyI6ImciLCLJpSI6ImgiLCLKriI6ImgiLCLKryI6ImgiLCLhtIkiOiJpIiwiyp4iOiJrIiwi6p6BIjoibCIsIsmvIjoibSIsIsmwIjoibSIsIuG0lCI6Im9lIiwiybkiOiJyIiwiybsiOiJyIiwiyboiOiJyIiwi4rG5IjoiciIsIsqHIjoidCIsIsqMIjoidiIsIsqNIjoidyIsIsqOIjoieSIsIuqcqSI6InR6Iiwiw7oiOiJ1Iiwixa0iOiJ1Iiwix5QiOiJ1Iiwiw7siOiJ1Iiwi4bm3IjoidSIsIsO8IjoidSIsIseYIjoidSIsIseaIjoidSIsIsecIjoidSIsIseWIjoidSIsIuG5syI6InUiLCLhu6UiOiJ1IiwixbEiOiJ1IiwiyJUiOiJ1Iiwiw7kiOiJ1Iiwi4bunIjoidSIsIsawIjoidSIsIuG7qSI6InUiLCLhu7EiOiJ1Iiwi4burIjoidSIsIuG7rSI6InUiLCLhu68iOiJ1IiwiyJciOiJ1IiwixasiOiJ1Iiwi4bm7IjoidSIsIsWzIjoidSIsIuG2mSI6InUiLCLFryI6InUiLCLFqSI6InUiLCLhubkiOiJ1Iiwi4bm1IjoidSIsIuG1qyI6InVlIiwi6p24IjoidW0iLCLisbQiOiJ2Iiwi6p2fIjoidiIsIuG5vyI6InYiLCLKiyI6InYiLCLhtowiOiJ2Iiwi4rGxIjoidiIsIuG5vSI6InYiLCLqnaEiOiJ2eSIsIuG6gyI6InciLCLFtSI6InciLCLhuoUiOiJ3Iiwi4bqHIjoidyIsIuG6iSI6InciLCLhuoEiOiJ3Iiwi4rGzIjoidyIsIuG6mCI6InciLCLhuo0iOiJ4Iiwi4bqLIjoieCIsIuG2jSI6IngiLCLDvSI6InkiLCLFtyI6InkiLCLDvyI6InkiLCLhuo8iOiJ5Iiwi4bu1IjoieSIsIuG7syI6InkiLCLGtCI6InkiLCLhu7ciOiJ5Iiwi4bu/IjoieSIsIsizIjoieSIsIuG6mSI6InkiLCLJjyI6InkiLCLhu7kiOiJ5IiwixboiOiJ6Iiwixb4iOiJ6Iiwi4bqRIjoieiIsIsqRIjoieiIsIuKxrCI6InoiLCLFvCI6InoiLCLhupMiOiJ6IiwiyKUiOiJ6Iiwi4bqVIjoieiIsIuG1tiI6InoiLCLhto4iOiJ6IiwiypAiOiJ6IiwixrYiOiJ6IiwiyYAiOiJ6Iiwi76yAIjoiZmYiLCLvrIMiOiJmZmkiLCLvrIQiOiJmZmwiLCLvrIEiOiJmaSIsIu+sgiI6ImZsIiwixLMiOiJpaiIsIsWTIjoib2UiLCLvrIYiOiJzdCIsIuKCkCI6ImEiLCLigpEiOiJlIiwi4bWiIjoiaSIsIuKxvCI6ImoiLCLigpIiOiJvIiwi4bWjIjoiciIsIuG1pCI6InUiLCLhtaUiOiJ2Iiwi4oKTIjoieCJ9",L=JSON.parse(decodeURIComponent(escape(atob(P))));D.emailRequired=!1,D.smsRequired=!1,D.addonPropertyKey="",D.sendAttachment={init:!1,value:!1},D.properties={smsBody:{id:null,addonId:a.addonId,key:a.addonPropertyKey+"_sms_body",value:"",title:"titulo del sms property",description:"descripcion del sms property"
},emailSubject:{id:null,addonId:a.addonId,key:a.addonPropertyKey+"_email_subject",value:"",title:"titulo del email subject property",description:"descripcion del email subject property"},emailBody:{id:null,addonId:a.addonId,key:a.addonPropertyKey+"_email_body",value:"",title:"titulo del email body property",description:"descripcion del email body property"}},D.emailPropertiesAttachment={images:{id:null,addonId:a.addonId,key:a.addonPropertyKey+"_email_attachment_images",title:"Imagenes de la visita",value:"Imagenes",description:"Imagenes"}},D.tags={TRACKING_URL:{id:"{TRACKING_URL}",label:"TrackingUrl",values:{sms:"https://kaduh6.info/QC1pP1X",email:" https://tracking.dev.simpliroute.com/#/tracking/SR12345678910111"},propertyKeys:{visit_scheduled:!0,route_started:!0,checkout_success:!0,checkout_failed:!0},checked:!1},NOTES:{id:"{NOTES}",label:r("translate")("General.notes"),values:{email:r("translate")("General.notes")},propertyKeys:{visit_scheduled:!0,route_started:!0,checkout_success:!0,checkout_failed:!0},checked:!1},CHECKOUT_COMMENT:{id:"{CHECKOUT_COMMENT}",label:r("translate")("Communication.comments"),values:{email:r("translate")("Communication.comments")},propertyKeys:{visit_scheduled:!1,route_started:!1,checkout_success:!0,checkout_failed:!0},checked:!1},ID_REFERENCE:{id:"{ID_REFERENCE}",label:"ID",values:{email:r("translate")("Communication.id_reference")},propertyKeys:{visit_scheduled:!0,route_started:!0,checkout_success:!0,checkout_failed:!0},checked:!1}},D.tagsSubject={ID_REFERENCE:{id:"{ID_REFERENCE}",label:"ID",propertyKeys:{visit_scheduled:!0,route_started:!0,checkout_success:!0,checkout_failed:!0},checked:!1}},D.textSmsPreview="",D.textEmailPreview="",D.cancel=c,D.saveProperty=d,D.showDeleteModal=u,D.addTagToInputValue=m,D.updateTextPreview=p,D.addTagToInputSubjectValue=v,l()}e.$inject=["$scope","$q","$state","$stateParams","ngDialog","$log","addonsService","$filter"],angular.module("icarus.settings").controller("CommunicationDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(){"active"===a.account.status&&i.go("^.info"),u=n.length,d.vehiclesQty=u,0===d.vehiclesQty&&(d.vehiclesQty=1),d.minVehiclesQty=d.vehiclesQty}function c(e){d.upgrading=!0,s.setSubscription(d.vehiclesQty,e.id).then(function(){if(d.upgraded=!0,u<d.vehiclesQty)for(var e=u+1;e<d.vehiclesQty+1;e++)o.create({name:"Vehicle "+e,capacity:1});i.go("^.info")})["catch"](function(e){})["finally"](function(){d.upgrading=!1})}var d=this;d.AMOUNT_PER_VEHICLE=r,d.user=a,d.vehiclesQty=null,d.minVehiclesQty=null,d.upgrading=!1,d.upgraded=!1,d.processUpgrade=c;var u;l()}e.$inject=["$log","$http","$state","user","vehicles","sessionService","Vehicle","AMOUNT_PER_VEHICLE"],angular.module("icarus.settings").controller("BillingUpgradeController",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){c.trialExpireTime=c.user.account.active_until.fromNow(),c.nextBillingCycle=c.user.account.active_until.format("LL")}function r(e){c.changingCard=!0,s.setSubscription(c.user.account.plan_quantity,e.id).then(function(){})["catch"](function(e){})["finally"](function(){c.changingCard=!1})}function l(){c.canceling=!0,s.cancelSubscription()["catch"](function(e){})["finally"](function(){c.canceling=!1})}var c=this;c.user=n,c.trialExpireTime=null,c.processChangeCard=r,c.cancel=l,o()}e.$inject=["$http","$log","$window","moment","user","sessionService"],angular.module("icarus.settings").controller("BillingInfoController",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){r.vehiclesQty=t.account.plan_quantity,r.minVehiclesQty=i.length}function o(t){r.updating=!0,a.setSubscription(t).then(function(){e.go("^.info")})["catch"](function(e){})["finally"](function(){r.updating=!1})}var r=this;r.AMOUNT_PER_VEHICLE=n,r.vehiclesQty=null,r.minVehiclesQty=null,r.updating=!1,r.updatePlan=o,s()}e.$inject=["$state","user","vehicles","sessionService","AMOUNT_PER_VEHICLE"],angular.module("icarus.settings").controller("BillingChangePlanController",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){t.getAllPublicConfigs().then(function(e){l.accountConfigs=e})}function r(){var t=[];a.isLoading=!0;for(var n in l.accountConfigs)t.push({key:n,value:l.accountConfigs[n]});e.saveAccountConfigs(t).then(function(e){i.info(e),s.push("success",c("Account.configs_saved_success"))})["catch"](function(e){i.info(e),s.push("error",c("Account.configs_saved_fail"))})["finally"](function(){a.isLoading=!1})}var l=this,c=n("translate");l.modelSettingsOptions={send_gps:{value:!0},enable_observations:{value:!1},max_distance:{value:150},vehicle_refill_time:{value:0},enable_jdh:{value:!0}},l.accountConfigs={},l.minDistance=1,l.maxDistance=1e4,l.saveAccountConfigs=r,o()}e.$inject=["sessionService","accountConfigsService","$log","$rootScope","$filter","Toasts"],angular.module("icarus.settings").controller("AccountController",e)}(),function(){"use strict";angular.module("icarus.planner",[])}(),function(){"use strict";function e(){function e(e){return i[e]||i.US}var t={getCustomExampleData:e},i={CL:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"SANTA MARIA 2670, PROVIDENCIA, Santiago",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"MARTIN DE ZAMORA 2964, LAS CONDES, Santiago",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Cuidado con el perro",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Am√©rico Vespucio 2680, Pudahuel, Regi√≥n Metropolitana, Chile",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Sergio Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergioaguilera@ejemplo.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"PRESIDENTE RIESCO 5561, LAS CONDES, Santiago",excel_load:"25",excel_hour_start:"10:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"977586912",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"CONGLOM-O",excel_address:"ANDRES BELLO 2711, LAS CONDES, Santiago",excel_load:"35",excel_hour_start:"10:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Alonso Olate",excel_contact_phone:"973625489",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alonsoolate@ejemplo.com"}],PE:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"Av. Nicol√°s de Pi√©rola 262, Lima",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Avenida Uruguay 512, Distrito de Lima",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Cuidado con el perro",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Jir√≥n Joaqu√≠n Capello 2749, Distrito de Lima",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Sergio Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergioaguilera@ejemplo.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"Avenida Sim√≥n Bolivar 1515, Lima",excel_load:"25",excel_hour_start:"10:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"977586912",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"CONGLOM-O",excel_address:"Valdez 621, Lima",excel_load:"35",excel_hour_start:"10:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Alonso Olate",excel_contact_phone:"973625489",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alonsoolate@ejemplo.com"}],IN:[{excel_title:"Saint Patrick Beers",excel_address:"1, Amrita Shergill Marg, Rabindra Nagar, New Delhi",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"Jameson Toys",excel_address:"Rahim Khan Marg, Nizamuddin, Jaipur Estata, Nizamuddin East, New Delhi",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"Mechanics INC",excel_address:"C-178, Doctor Ramlal Verma Marg, New Delhi",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Sergio Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergioaguilera@ejemplo.com"},{excel_title:"Super High Speed Net",excel_address:"E-68, Kalka Devi Marg, Block E, Amar Colony, Lajpat Nagar 4, New Delhi",excel_load:"25",excel_hour_start:"10:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"977586912",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"CONGLOM-O",excel_address:"Tigri Bank Road, Deoli Gaon Nai Basti, Sangam Vihar, New Delhi, Delhi 110044",excel_load:"35",excel_hour_start:"10:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Alonso Olate",excel_contact_phone:"973625489",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alonsoolate@ejemplo.com"}],US:[{excel_title:"Mr Smith",excel_address:"1152 Valencia St, San Francisco, CA 94110",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Pauline Muniz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinemuniz@example.com"},{excel_title:"Red Lantern",excel_address:"5801 Geary Blvd, San Francisco, CA 94121",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Flowers",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"Saru¬†Sushi¬†Bar",excel_address:"3856 24th St, San Francisco, CA 94114",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Wingers",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergewingers@example.com"},{excel_title:"Sushi¬†Zone",excel_address:"1815 Market St, San Francisco, CA 94103",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Urib",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Akiko‚Äôs¬†Restaurant",excel_address:"431 Bush St, San Francisco, CA 94108",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],AU:[{excel_title:"Saint Patrick Beers",excel_address:"417 Pitt St, Sydney",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Pauline Muniz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinemuniz@example.com"},{excel_title:"Jameson Toys",excel_address:"88 Crown St, Woolloomooloo, Sydney",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Flowers",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"Mechanics INC",excel_address:"100/136 Barcom Ave Darlinghurst, Sydney",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Wingers",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergewingers@example.com"},{excel_title:"Super High Speed Net",excel_address:"245 Oxford St, Paddington, Sydney",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Urib",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"189 Jones St, Ultimo, Sydney",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],CO:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"Calle 125 #52A-17, Bogot√°",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Calle 115 #48-1, Bogot√°",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Carrera 13 Bis #109-2, Bogot√°",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergeaguilera@example.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"Calle 2a #69f-2, Bogot√°",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"Calle 39g Sur #68g-1, Bogot√°",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],AR:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"Avenida Juan B. Justo 5556, Buenos Aires",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Balbastro 770, Buenos Aires",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Alta Gracia 3330, Buenos Aires",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergeaguilera@example.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"Elpidio Gonz√°lez 5010, Buenos Aires",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"Figueroa Alcorta 4128, Buenos Aires",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],MX:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"Pintores 129,  Emilio Carranza, Ciudad de Mexico",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Cuauht√©moc 138,  Arag√≥n La Villa(Arag√≥n), Ciudad de Mexico",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Tezonapa 10, San Sebastian, Ciudad de Mexico",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergeaguilera@example.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"Calle Camino a Nextengo 512, Santiago Ahuizotla, Ciudad de Mexico",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"Gumersindo Esquer 80, Asturias, Ciudad de Mexico",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],BR:[{excel_title:"CONFEITARIA SAN RODRIGO",excel_address:"Rua da Mooca  620 - Mooca, S√£o Paulo",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Cuauht√©moc 138,  Arag√≥n La Villa(Arag√≥n), Ciudad de Mexico",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"R. Augusta, 449 - Consola√ß√£o, S√£o Paulo",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergeaguilera@example.com"},{excel_title:"COMPUMUNDO",excel_address:"R. M√°rio, 140 - Vila Romana, S√£o Paulo",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"R. Gomes Nogueira, 462 - Ipiranga, S√£o Paulo",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}],ES:[{excel_title:"CONFITERIA SAN RODRIGO",excel_address:"Calle de Alcal√° 4, Madrid",excel_load:"50",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"20",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Paulina Mu√±oz",excel_contact_phone:"965847147",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"paulinamunoz@ejemplo.com"},{excel_title:"JUGUETES JIMENEZ",excel_address:"Calle San Leonardo 5, Madrid",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"10",excel_notes:"Watch out with the dog!",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"David Rosales",excel_contact_phone:"994345856",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"davidrosales@ejemplo.com"},{excel_title:"INDUMECANICA SA",excel_address:"Calle Juan de la Hoz 17, Madrid",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Serge Aguilera",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"sergeaguilera@example.com"},{excel_title:"COMPUMUNDO HIPER MEGA RED",excel_address:"Calle de Padre Dami√°n 34, Madrid",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"17:00",excel_service_time:"15",excel_notes:"7th floor",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Lucas Uribe",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"lucasuribe@ejemplo.com"},{excel_title:"Conglom-o",excel_address:"Calle √Åguila 3, Madrid¬†",excel_load:"25",excel_hour_start:"9:00",excel_hour_end:"19:00",excel_service_time:"15",excel_notes:"",excel_latitude:"",excel_longitude:"",excel_reference:"",excel_requires_skills:"",excel_optional_skills:"",excel_contact_name:"Al Olatte",excel_contact_phone:"961483569",excel_hour_start_2:"",excel_hour_end_2:"",excel_load_2:"",excel_load_3:"",excel_priority:"",excel_sms:"",excel_contact_email:"alolatte@ejemplo.com"}]};return t}angular.module("icarus.planner").factory("xlsxService",e)}(),function(){"use strict";function e(){function e(e){"REOPTIMIZE_AND_OVERWRITE_PLAN"===a.action?a.removeRoutes(e):"KEEP_PLAN_AND_REOPTIMIZE"===a.action&&a.keepPlanAndReoptimize(e)}function t(e){e(1)}function i(e){e(2)}var a=this;a.action=null,a.executeAction=e,a.removeRoutes=t,a.keepPlanAndReoptimize=i}angular.module("icarus.planner").controller("VisitsRemoveRouteModalController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y,w,A,x,k,I,S,E,C,D,P,L){function O(){function t(e){de(e),b.getUser().then(function(e){Ke.userAccountCountry=e.account.country,I.setConfig(Ke.userAccountCountry),Ne(e.account.configs),Ke.optimizationOptions=angular.copy(p.localOptimizationOptions)}),Ke.planName=p.getPlanName(),T(),Ke.updatePlannerStepsInfo(e)}function i(t){e.info(angular.toJson(t)),
p.visits.length>0&&(Ke.totalVisits=p.visits.length,N())}return k.fbq("track","ViewContent"),w.callGoogleTrackConversion("Cs_oCPL5k20QndigwgM"),Je(),o.page&&p.visits[(parseInt(o.page)-1)*Xe]&&(Ke.currentPage=parseInt(o.page)),p.restoreVehicles(),p.getPlan().then(t,i)}function T(){D.getZonesIfProceed().then(function(e){Ke.listZones=e})}function V(e){u.$emit("Planner:Plan:info",{planDate:e.planDate.start,planName:Ke.planName}),u.$emit("Planner:Plan:steps",{key:"vehicle",value:!0}),u.$emit("Planner:Plan:steps",{key:"visit",value:!0}),u.$emit("Planner:Plan:steps",{key:"route",value:!1})}function R(){Ke.warningVisitsQty=0,Ke.errorVisitsQty=0,p.visits.map(function(e){angular.isUndefined(e.error)||null===e.error||(2===e.error.type||3===e.error.type?Ke.warningVisitsQty++:4===e.error.type&&Ke.errorVisitsQty++)})}function M(e){e.error&&(2===e.error.type||3===e.error.type?Ke.warningVisitsQty--:4===e.error.type&&Ke.errorVisitsQty--),Ke.visits.splice(Ke.visits.indexOf(e),1),p.removeVisit(e),Ae(),Ke.totalVisits=p.visits.length,0===Ke.visits.length&&Ke.currentPage>1&&(Ke.currentPage-=1,N())}function z(e){e.error&&(2===e.error.type||3===e.error.type?Ke.warningVisitsQty--:4===e.error.type&&Ke.errorVisitsQty--),Ke.visits.splice(Ke.visits.indexOf(e),1),p.removeVisit(e),Ke.totalVisits=p.visits.length}function F(){for(var e=p.visits.length-1;e>=0;e--)p.removeVisit(p.visits[e],!1);for(var t=p.routes.length-1;t>=0;t--)p.removeRoute(p.routes[t]);p.resetHeaderStatics(),p.routes.length=0,p.visits.length=0,Ke.visits.length=0,Ke.totalVisits=0,Ke.currentPage=1,R(),p.enableShowLoad.load2=!1,p.enableShowLoad.load3=!1}function N(){p.clearMapVisits(),xe();for(var e=0;e<Ke.visits.length;e++)Ke.visits[e].actionPaintOnMap();Ke.visits.length>0&&ke(Ke.visits)}function $(){Ke.visits&&Ke.visits.length&&(u.deleteAllVisits=F,d.open({template:"app/planner/visits/visits-delete-modal.html",scope:u}))}function j(e,t){e.stopPropagation(),3===t.error.type||2===t.error.type?Ke.warningVisitsQty--:4===t.error.type&&Ke.errorVisitsQty--,t.removeError()}function B(){Ke.checkOptions().then(function(e){p.setlocalOptimizationOptions(Ke.optimizationOptions),s.go("^.routes",{optimize:e})})["catch"](function(e){try{e.hasOwnProperty("message")&&(e=angular.fromJson(e.message))}catch(t){}switch(e.code){case 0:p.restoreVehicles();break;case 1:d.open({template:"app/planner/visits/visits-date-error-visits-modal.html",scope:u});break;case 2:d.open({template:"app/planner/visits/visits-incompleted-vehicles-error-visits-modal.html",scope:u});break;case 3:var i=u.$new();i.vehicles=angular.copy(e.data),d.open({template:"app/planner/visits/visits-workday-exceeded-visits-modal.html",scope:i}),p.restoreVehicles();break;default:m.addAlertNotification(e.data)}})}function H(e){angular.isDefined(e.error)&&(m.removeAlertNotification(),m.addAlertNotification(e.error)),st&&(st.activate=!1),u.$emit("Planner:Visit:showInfoWindow",{visit:e}),p.setMapCenterOn(e),e.activate=!e.activate,st=e}function U(){var e={Sheets:{},SheetNames:[]},t=[{wch:105},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15}],i=[nt("Visits.excel_title"),nt("Visits.excel_address"),nt("Visits.excel_load"),nt("Visits.excel_hour_start"),nt("Visits.excel_hour_end"),nt("Visits.excel_service_time"),nt("Visits.excel_notes"),nt("Visits.excel_latitude"),nt("Visits.excel_longitude"),nt("Visits.excel_reference"),nt("Visits.excel_requires_skills"),nt("Visits.excel_optional_skills"),nt("Visits.excel_contact_name"),nt("Visits.excel_contact_phone"),nt("Visits.excel_hour_start_2"),nt("Visits.excel_hour_end_2"),nt("Visits.excel_load_2"),nt("Visits.excel_load_3"),nt("Visits.excel_priority"),nt("Visits.excel_sms"),nt("Visits.excel_contact_email")],a=[];a.push(i);var n;b.getUser().then(function(i){if(i){n=i.account.country;for(var s=A.use()+"_"+n+"_"+nt("Visits.excel_name"),o=y.getCustomExampleData(n),r=0;r<o.length;r++){var l=o[r],c=[];for(var d in l){var u=l[d];c.push(u)}a.push(c)}e.Sheets.VisitExcel=Ee(a),e.SheetNames.push("VisitExcel"),e["!cols"]=t,Ce(e,s.toLowerCase())}})}function q(e){var t=n.defer(),i=new FileReader,a=!0,s=[];return(angular.isDefined(FileReader)||angular.isDefined(FileReader.prototype)||!angular.isFunction(FileReader.prototype.readAsBinaryString))&&(a=!1),i.onload=function(e){var i,n=e.target.result,o=null;o=a?v.read(n,{type:"binary"}):v.read(btoa(Se(n)),{type:"base64"}),i=o.Sheets[o.SheetNames[0]],s=v.utils.sheet_to_json(i,{header:"A"}),t.resolve(s)},a?i.readAsBinaryString(e[0]):i.readAsArrayBuffer(e[0]),t.promise}function G(t){fe(),Ke.errorAddress=null,Ke.importWarnings.length=0,Ke.importErrors.length=0,Ke.vehicles=p.getActiveVehicles();var a=[];Ke.widthDynamic="0%",Ke.visitsGeoreference=0,i.isLoadingPlanner=!0,tt&&_.cancel(tt),tt=_(Me,it),Ke.getRowsFromExcel(t).then(function(t){return Ke.rows=t,Ke.maxProgressBar=t.length-1,1===t.length?(e.info("Archivo excel vacio"),f.push("warning",nt("Planner_toast.empty_file_excel")),void ze()):(t=t.splice(1,t.length),a=t.length>g.DEFAULT_BATCH?c.chunk(t,g.DEFAULT_BATCH):[t],void De(a,et))})["catch"](function(t){e.error(t),ze()})}function J(e){return e?"true"===e.toLowerCase()||"yes"===e.toLowerCase()||"si"===e.toLowerCase()||"sim"===e.toLowerCase()||e>0:!1}function Y(e){switch(e){case"balance":Ke.optimizationOptions.balance&&Ke.optimizationOptions.big_cluster&&(Ke.optimizationOptions.big_cluster=!1);break;case"all_vehicles":!Ke.optimizationOptions.all_vehicles&&Ke.optimizationOptions.big_cluster&&(Ke.optimizationOptions.big_cluster=!1);break;case"big_cluster":Ke.optimizationOptions.big_cluster&&(Ke.optimizationOptions.balance=!1,Ke.optimizationOptions.all_vehicles=!0);break;case"open_ended":Ke.optimizationOptions.open_ended&&Ke.optimizationOptions.big_cluster&&(Ke.optimizationOptions.big_cluster=!1)}}function W(e){return-1!==p.optimizationOptionsDisplayed.indexOf(e)}function Q(e){var t="";return t=e.replace("ciudad empresarial","huechuraba"),t=e.replace("11 de Septiembre","Nueva Providencia"),t=e.replace("2 avenida","segunda avenida")}function Z(e){return!isNaN(parseFloat(e))&&isFinite(e)}function K(e){for(var t=e.split(/[\s,]+/),i=[],a=0;a<t.length;a++){var n=t[a];n=n.replace("(",""),n=n.replace(")","");var s="^\\b("+n.latinize()+")\\b",o=new RegExp(s,"i");for(var r in ot)if(o.test(r.latinize())){var l={key:r,city:ot[r]};i.push(l)}}return i}function X(){return null!==p.getPlanName()}function ee(){Ke.visits&&Ke.visits.length&&(u.removeWarningVisits=ie,d.open({template:"app/planner/visits/visits-remove-warning-visits-modal.html",scope:u}))}function te(){Ke.visits&&Ke.visits.length&&(u.removeErrorVisits=ae,d.open({template:"app/planner/visits/visits-remove-error-visits-modal.html",scope:u}))}function ie(){var e=p.visits.filter(function(e){return 2===e.status||3===e.status});e.map(function(e){z(e)}),N()}function ae(){var e=p.visits.filter(function(e){return 4===e.status});e.map(function(e){z(e)}),N()}function ne(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function se(){var e=[];if(angular.copy(Ke.visits,e),e.sort(re("title")),Ke.warningVisitsQty>0){for(var t=null,i=0;i<e.length;i++)if(2===e[i].status||3===e[i].status){t=e[i].id;break}t&&r(function(){a(t)})}}function oe(){var e=[];if(angular.copy(Ke.visits,e),e.sort(re("title")),Ke.errorVisitsQty>0){for(var t=null,i=0;i<e.length;i++)if(4===e[i].status){t=e[i].id;break}t&&r(function(){a(t)})}}function re(e){return function(t,i){return t.status<i.status?1:t.status>i.status?-1:t[e]<i[e]?-1:t[e]>i[e]?1:0}}function le(t,n,s){i.isLoading=!0;var c=l(n).format("YYYY-MM-DD");p.loadVisits(c,s).then(function(n){ce(t.visits),ut=p.getSkills(),dt=x.createGeocode(),p.hideRoutes(),p.hideVehicles(),p.resetVisitLook(),0!==t.visits.length&&(p.mapFitBoundAllVisits(),p.showVisits()),Ke.visits=[],Ke.visits.warningsQty=0,Ke.visits.errorsQty=0,r(function(){a(o.recent)}),lt=p.getActiveVehicles();var s={lat:parseFloat(lt[0].locationStart.latitude),lng:parseFloat(lt[0].locationStart.longitude)};dt.geocode({location:s},function(t,i){var a=x.geocoderStatusOK();if(i===a)for(var n=t[0],s=0;s<n.address_components.length;s++)"country"===n.address_components[s].types[0]&&(Ke.location_start={country_code:n.address_components[s].short_name});else e.warn("Error: no se pudo obtener el pa√≠s de los veh√≠culos activos.")}),R(),t.visits.length>0&&(Ke.totalVisits=t.visits.length,N()),i.isLoading=!1,n&&f.push("success",nt("Planner_toast.visits_imported")+n.length)},function(t){e.error(t),i.isLoading=!1})}function ce(e){e.forEach(function(e){e.zones=D.getZonesIntoVisit(Ke.listZones,e.latitude,e.longitude)})}function de(t){ut=p.getSkills(),dt=x.createGeocode(),p.hideRoutes(),p.hideVehicles(),p.resetVisitLook(),t.visits.length>0&&(p.mapFitBoundAllVisits(),p.showVisits()),Ke.visits=[],Ke.visits.warningsQty=0,Ke.visits.errorsQty=0,r(function(){a(o.recent)}),lt=p.getActiveVehicles();var n={lat:parseFloat(lt[0].locationStart.latitude),lng:parseFloat(lt[0].locationStart.longitude)};dt.geocode({location:n},function(t,i){if(i===x.geocoderStatusOK())for(var a=t[0],n=0;n<a.address_components.length;n++)"country"===a.address_components[n].types[0]&&(Ke.location_start={country_code:a.address_components[n].short_name});else e.warn("Error: no se pudo obtener el pa√≠s de los veh√≠culos activos.")}),R(),t.visits.length>0&&(Ke.totalVisits=t.visits.length,N()),i.isLoading=!1}function ue(){Ke.checkOptions().then(function(e){c.merge(p.localOptimizationOptions,Ke.optimizationOptions),s.go("^.routes",{optimize:e,jdh:"1"})})["catch"](function(e){try{e.hasOwnProperty("message")&&(e=angular.fromJson(e.message))}catch(t){}switch(e.code){case 0:p.restoreVehicles();break;case 1:d.open({template:"app/planner/visits/visits-date-error-visits-modal.html",scope:u});break;case 2:d.open({template:"app/planner/visits/visits-incompleted-vehicles-error-visits-modal.html",scope:u});break;case 3:var i=u.$new();i.vehicles=angular.copy(e.data),d.open({template:"app/planner/visits/visits-workday-exceeded-visits-modal.html",scope:i}),p.restoreVehicles();break;default:m.addAlertNotification(e.data)}})}function pe(){Ke.enableJdh?Ke.goNextWithJDH():Ke.goNext()}function me(e,t){fe(),p.getPlan().then(function(i){le(i,e,t)})}function ve(){for(var e in Ke.optimizationOptions)Ke.checkOptionOptimize(e);return Ie()}function ge(){Ke.menuVisitIsOpen=!Ke.menuVisitIsOpen,Ke.popupCalendar=!1}function he(){Ke.popupVisitsIntegrationNotCompleted=!1,Ke.popupVisitsIntegration=!Ke.popupVisitsIntegration,Ke.dataVisitsImport={title:t("translate")("Visits.component_visits_import.title_visits_integration"),checkbox:null,calendar:{model:Ke.dateToGetIntegrationVisits,options:Ke.dateOptions},button:{title:t("translate")("Visits.component_visits_import.button_title")}}}function _e(){Ke.popupVisitsIntegration=!1,Ke.popupVisitsIntegrationNotCompleted=!Ke.popupVisitsIntegrationNotCompleted,Ke.dataVisitsImportNotCompleted={title:t("translate")("Visits.component_visits_import.title_visits_integration_not_completed"),checkbox:null,calendar:{model:Ke.dateToGetIntegrationVisitsNotCompleted,options:Ke.dateOptions},button:{title:t("translate")("Visits.component_visits_import.button_title")},optionsVisitsNotCompleted:[{key:"pending",label:t("translate")("Visits.component_visits_import.visits_pending_label"),value:!1},{key:"failed",label:t("translate")("Visits.component_visits_import.visits_failed_label"),value:!1}]}}function fe(){Ke.popupVisitsIntegration=!1,Ke.popupVisitsIntegrationNotCompleted=!1,Ke.menuVisitIsOpen=!1}function be(e){var t={full_address:"",street_address:"",administrative_area:"",original_address:e,cleaned_array:[]};if("CL"!==Ke.location_start.country_code)return t.full_address=e,t;var i="avenida",a="departamento",n="oficina",s="piso",o="pasaje",r="paseo",l="calle",c="modulo",d="ciudad",u="parque",p="industrial",m="santiago",v="block",g="poblaci√≥n",h={ave:i,av:i,aven:i,aveni:i,avda:i,brdo:"bernardo",blk:v,blck:v,blok:v,cuidad:d,call:l,cale:l,d:a,depto:a,dep:a,dp:a,dpto:a,indus:p,lib:"libertador",mod:c,n:"",of:n,ofna:n,"0ficina":n,ohggins:"O'higgins",p:s,pob:g,pobl:g,pobla:g,poblacion:g,parq:u,parqu:u,pj:o,psj:o,pje:o,psaje:o,ppsje:o,psje:o,pseo:r,stgo:m,santiag:m,prof:"profesor"},_=e.replace("."," ").replace("¬∫"," ").replace("¬∞"," ").replace(/ *\([^)]*\) */g," ").toLowerCase();_=_.replace(/\./g," "),_=_.replace(/\,/g," "),_=_.replace(/\),\(/g," "),_=_.replace(/\s\s+/g," "),_=_.replace(/\),\(/g," "),_=_.replace(/[\])}[{(]/g,""),_=_.replace(/\s\s+/g," "),_=_.replace(/\*/g,"");for(var f=_.split(/[ ,]+/).filter(Boolean),b=[],y=!1,w=0,A=0;A<f.length;A++){var x=f[A].replace(/^.*#/,"");if(x=h[x]||x,f[A]=x,f[A]!==n&&f[A]!==a&&f[A]!==s&&f[A]!==c&&f[A]!==v&&f[A]!==g)if(f[A]===o&&f[A+1]&&!Z(parseInt(f[A+1]))&&f[A+1].length>1)f.splice(A,1),A--;else if(y)if("norte"!==f[A]&&"sur"!==f[A]&&"poniente"!==f[A]&&"oriente"!==f[A]&&!Z(parseInt(f[A]))&&"de"!==f[A]||b.length>0){var k="";if(0===b.length){for(var I=w;A>I;I++)k+=f[I]+" ";b.push(k.trim()),b.push(f[A]),w=A}else b.push(f[A])}else y=!1;else Z(parseInt(f[A]))&&A>0&&(y=!0);else f.splice(A+1,1),f.splice(A,1),A--}for(var S,E=[],C=[],A=1;A<b.length;A++)if(S=b[A],E=K(S),0!==E.length)if(1===E.length){var D=E[0].key.split(" ");if(!(D.length>1)){C.push(E[0]);continue}if(b.length>A+1){var x=b[A]+" "+b[A+1];x=x.replace("(",""),x=x.replace(")","");var P="^\\b("+x.latinize()+")\\b",L=new RegExp(P,"i");if(L.test(E[0].key.latinize())){C.push(E[0]);continue}}}else for(var I=0;I<E.length;I++)if(b.length>A+1){var x=b[A]+" "+b[A+1];x=x.replace("(",""),x=x.replace(")","");var P="^\\b("+x.latinize()+")\\b",L=new RegExp(P,"i");L.test(E[I].key.latinize())&&C.push(E[I])}if(b.length>0){for(var O=b[0].split(/[ ,]+/).filter(Boolean),A=0;A<O.length;A++){var x=O[A];("villa"===x||"poblaci√≥n"===x)&&(O.length>A+1?("el"===O[A+1]||"la"===O[A+1]||"los"===O[A+1]||"las"===O[A+1]||"san"===O[A+1])&&O.length>A+2?(O.splice(A+2,1),O.splice(A+1,1),O.splice(A,1)):(O.splice(A+1,1),O.splice(A,1)):O.splice(A,1))}b[0]=O.join(" ")}var T="";if(C.length>0)return b[0]=Q(b[0]),T="Quilicura"===C[0].key?b[0]+", "+C[0].key:b[0]+", "+C[0].key+", "+C[0].city.city,t.full_address=T,t.street_address=b[0],t.administrative_area=C[0].key,t.administrative_location=C[0].city.location,t;var V=f.join(" ");return t.full_address=Q(V),t.street_address=b[0],t.administrative_area=null,t.administrative_location=null,t}function ye(t){for(var i=[],a=0;a<t.length;a++){var n;try{n=t[a].trim()}catch(s){n=t[a]}for(var o=0;o<ut.length;o++)ut[o].name===n||ut[o].id.toString()===n?i.push(String(ut[o].name)):e.info("Skill no existe en la cuenta")}return i}function we(e){return isNaN(e)||""===e||null===e||!Z(e)}function Ae(){var e=Ke.currentPage*Xe;Ke.totalVisits<e&&(e=Ke.totalVisits),p.visits[e-1]&&(Ke.visits[e-1]=p.visits[e-1],Ke.visits[e-1].actionPaintOnMap()),Ke.visits.length>0&&ke(Ke.visits)}function xe(){Ke.visits&&(Ke.visits.length=0),Ke.visits=[];var e=Ke.currentPage*Xe;Ke.totalVisits<e&&(e=Ke.totalVisits);for(var t=(Ke.currentPage-1)*Xe,i=0;e>t&&p.visits[t];t++)Ke.visits[i]=p.visits[t],i++}function ke(t){try{var i=x.getLatLngBounds(),a=p.getGmap();if(t.map(function(e){var t=x.getGoogleMapsLatLng(e.latitude,e.longitude);i.extend(t)}),a.fitBounds(i),t.length<=3){if(0===t.length)return a.setCenter(x.getGoogleMapsLatLng(-33.45,-70.666667)),void a.setZoom(11);a.setZoom(12)}a.panBy(1,0)}catch(n){e.info(n)}}function Ie(){var e=p.returnPlanMode(),t=n.defer(),i=null;return p.routes.length>0&&e.planId?(i=d.open({template:"app/planner/visits/visits-remove-route-modal.html",controller:"VisitsRemoveRouteModalController",controllerAs:"vm"}),i.closePromise.then(function(e){1===e.value||2===e.value?t.resolve(e.value):t.reject(new Error(0))})):t.resolve(1),t.promise}function Se(e){for(var t="",i=0,a=10240;i<e.byteLength/a;++i)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a,i*a+a)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a)))}function Ee(e){function t(e,t){t&&(e+=1462);var i=Date.parse(e);return(i-new Date(Date.UTC(1899,11,30)))/864e5}for(var i={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!==e.length;++n)for(var s=0;s!==e[n].length;++s){a.s.r>n&&(a.s.r=n),a.s.c>s&&(a.s.c=s),a.e.r<n&&(a.e.r=n),a.e.c<s&&(a.e.c=s);var o={v:e[n][s]};if(null!==o.v){var r=v.utils.encode_cell({c:s,r:n});angular.isNumber(o.v)?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=v.SSF._table[14],o.v=t(o.v)):o.t="s",i[r]=o}}return a.s.c<1e7&&(i["!ref"]=v.utils.encode_range(a)),i}function Ce(e,t){function i(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0;a!==e.length;++a)i[a]=255&e.charCodeAt(a);return t}var a={bookType:"xlsx",bookSST:!1,type:"binary"},n=v.write(e,a);saveAs(new Blob([i(n)],{type:""}),t+".xlsx")}function De(e,t){e.length!==t&&(Le(e[t],[],0),De(e,++t))}function Pe(){return-1!==vt.indexOf(Ke.userAccountCountry)}function Le(a,n,s){if(i.isLoadingPlanner)if(a.length===s)n.length>0&&p.tryPreGeoreferenceBatch(n).then(function(i){for(var n=0;n<i.length;n++){var s=Fe(a,i[n]),o=null,r=0,d=i[n],u=1,m={},v=0,g=0,h="",_={};if(d.found&&"pre_georef"===d.service)e.info("FOUND PRE_GEOREF",d.address),_={lat:parseFloat(d.latitude),lng:parseFloat(d.longitude)},v=parseFloat(d.latitude),g=parseFloat(d.longitude);else if(d.found&&"google_maps"===d.service){if("CL"===Ke.userAccountCountry){var f=[],b=d.address.split(",")[0];d.street_name?f=d.street_name.split(" "):e.info("item sin address",d);for(var y,w=[],A=[],n=0;n<f.length;n++)if(e.info(f),y=f[n],w=K(y),0!==w.length)if(1===w.length){var x=w[0].key.split(" ");if(!(x.length>1)){A.push(w[0]);continue}if(f.length>n+1){var k=f[n]+" "+f[n+1];k=k.replace("(",""),k=k.replace(")","");var I="^\\b("+k.latinize()+")\\b",S=new RegExp(I,"i");if(S.test(w[0].key.latinize())){A.push(w[0]);continue}}}else for(var E=0;E<w.length;E++)if(f.length>n+1){var k=f[n]+" "+f[n+1];k=k.replace("(",""),k=k.replace(")","");var I="^\\b("+k.latinize()+")\\b",S=new RegExp(I,"i");S.test(w[E].key.latinize())&&A.push(w[E])}var C=!1;if(A.length){C=!0;for(var n=0;n<A.length;n++){var P=A[n].key.latinize().toLowerCase();P=P.replace(/'/g,""),(-1!==b.indexOf(P)||-1!==b.indexOf(A[n].key.toLowerCase()))&&(C=!1)}}C&&(e.log("***********************"),e.log("ALERTAAA Nombre comuna calle!!! "),e.log("Calle Original: ",d.address),e.log("Respuesta google",d.street_name),e.log("Coincidencia",A[0].key),e.log("***********************"),u=2,m={type:4,msg:ct})}_={lat:parseFloat(d.latitude),lng:parseFloat(d.longitude)},v=parseFloat(d.latitude),g=parseFloat(d.longitude),h=d.country}else v=0,g=0,u=4,m={type:4,msg:t("translate")("Visits.alert_notification.error_not_found")};var L=s.A||nt("Visits.no_title"),O=s.B||nt("Visits.import_no_address"),T=we(s.C)?0:parseFloat(parseFloat(s.C).toFixed(2)),V=l(s.D,["HH:mm","HH:mm:ss"]),R=l(s.E,["HH:mm","HH:mm:ss"]),M=we(s.F)?10:parseInt(s.F),z=s.G||"",F=s.J||"",N=s.K?s.K.split(","):[],$=s.L?s.L.split(","):[],j=s.M||"",B=s.N||"",H=l(s.O,["HH:mm","HH:mm:ss"]),U=l(s.P,["HH:mm","HH:mm:ss"]),q=we(s.Q)?0:parseFloat(parseFloat(s.Q).toFixed(2)),G=we(s.R)?0:parseFloat(parseFloat(s.R).toFixed(2)),Y=isNaN(parseInt(s.S))?0:parseInt(s.S),W=J(s.T),Q=s.U?Qe(s.U):"",Z=isNaN(parseInt(s.S))?0:parseInt(s.S);we(s.C)&&e.warn("Error en el formato de la capacidad de la visita "+L),we(s.F)&&e.warn("Error en el formato de la duracion de la visita "+L),V=V.isValid()?V.format("HH:mm"):null,R=R.isValid()?R.format("HH:mm"):null,H=H.isValid()?H.format("HH:mm"):null,U=U.isValid()?U.format("HH:mm"):null,N=ye(N),$=ye($);for(var X="",E=0;E<N.length;E++)if("string"==typeof N[E]){X=N[E].trim(),N.splice(E,1);for(var ee=0;ee<ut.length;ee++)ut[ee].name===X&&N.splice(E,0,ut[ee].id)}for(var E=0;E<$.length;E++)if("string"==typeof $[E]){X=$[E].trim(),$.splice(E,1);for(var ee=0;ee<ut.length;ee++)ut[ee].name===X&&$.splice(E,0,ut[ee].id)}var te={title:L,address:O,latitude:v,longitude:g,addressFull:"",load:T,load2:q,load3:G,duration:M,notes:z,reference:F,windowStart:V,windowEnd:R,windowStart2:H,windowEnd2:U,administrative_area:d.administrative_area_level_3,status:u,error:m,country:h,skills_required:N,skills_optional:$,contactName:j,contactPhone:B,priority:Y,sms_enabled:W,contactEmail:Q,priorityLevel:Z};o=p.createVisit(),at++,c.merge(o,d),c.merge(o,te),o.priority=o.getCPriority(),o.priorityLevel=o.getPriority(),o.zones=D.getZonesIntoVisit(Ke.listZones,o.latitude,o.longitude),Te(o).then(Ve,Re),Ke.maxProgressBar>Ke.visitsGeoreference&&(Ke.visitsGeoreference=Ke.visitsGeoreference+1,r=Ke.visitsGeoreference/Ke.maxProgressBar*100,Ke.widthDynamic=String(r)+"%")}},function(t){e.info(t),t.status&&ze()});else{var o=a[s],d=o.A||nt("Visits.no_title"),u=o.B||nt("Visits.import_no_address");if("undefined"==typeof d&&u===nt("Visits.import_no_address")){var m={index:s};return Ke.importErrors.push(m),Ke.maxProgressBar=Ke.maxProgressBar-1,void Le(a,n,++s)}var v=new RegExp(h.latlngPattern),g=we(o.C)?0:parseFloat(parseFloat(o.C).toFixed(2)),_=l(o.D,["HH:mm","HH:mm:ss"]),f=l(o.E,["HH:mm","HH:mm:ss"]),b=we(o.F)?10:parseInt(o.F),y=o.G||"",w=o.H,A=o.I,x=o.J||"",k=o.K?o.K.split(","):[],S=o.L?o.L.split(","):[],E=o.M||"",C=o.N||"",P=l(o.O,["HH:mm","HH:mm:ss"]),L=l(o.P,["HH:mm","HH:mm:ss"]),O=we(o.Q)?0:parseFloat(parseFloat(o.Q).toFixed(2)),T=we(o.R)?0:parseFloat(parseFloat(o.R).toFixed(2)),V=isNaN(parseInt(o.S))?0:parseInt(o.S),R=J(o.T),M=o.U?Qe(o.U):"",z=isNaN(parseInt(o.S))?0:parseInt(o.S);we(o.C)&&e.warn("Error en el formato de la capacidad de la visita "+d),we(o.F)&&e.warn("Error en el formato de la duracion de la visita "+d),_=_.isValid()?_.format("HH:mm"):null,f=f.isValid()?f.format("HH:mm"):null,P=P.isValid()?P.format("HH:mm"):null,L=L.isValid()?L.format("HH:mm"):null,k=ye(k),S=ye(S);for(var F="",N=0;N<k.length;N++)if(angular.isString(k[N])){F=k[N].trim(),k.splice(N,1);for(var $=0;$<ut.length;$++)ut[$].name===F&&k.splice(N,0,ut[$].id)}for(var j=0;j<S.length;j++)if(angular.isString(S[j])){F=S[j].trim(),S.splice(j,1);for(var B=0;B<ut.length;B++)ut[B].name===F&&S.splice(j,0,ut[B].id)}var H={title:d,address:u,addressFull:"",load:g,load2:O,load3:T,priority:V,duration:b,notes:y,reference:x,windowStart:_,windowEnd:f,windowStart2:P,windowEnd2:L,administrative_area:"",status:1,skills_required:k,skills_optional:S,contactName:E,contactPhone:C,sms_enabled:R,contactEmail:M,priorityLevel:z};if(w&&A&&v.test(w+", "+A)){H.latitude=parseFloat(w.trim()),H.longitude=parseFloat(A.trim());var U=p.createVisit();at++,c.merge(U,H),U.priority=U.getCPriority(),U.priorityLevel=U.getPriority();var q=!1,G=!1;2===U.status||3===U.status?q=!0:4===U.status&&(G=!0);var Y=U.areValidVisitWindowTimes();Y||(q&&Ke.warningVisitsQty--,U.procureVisitStatus(),G||Ke.errorVisitsQty++),U.zones=D.getZonesIntoVisit(Ke.listZones,U.latitude,U.longitude),r(function(){if(Le(a,n,++s),Ke.maxProgressBar>Ke.visitsGeoreference){Ke.visitsGeoreference=at;var e=Ke.visitsGeoreference/Ke.maxProgressBar*100;Ke.widthDynamic=String(e)+"%"}},400)}else if("undefined"==typeof u)Ke.errorAddress=!0,Ke.importErrors.push({index:s}),Ke.maxProgressBar=Ke.maxProgressBar-1,Le(a,n,++s);else{Pe()?H.addressFull={full_address:I.cleanAddress(H.address)}:H.addressFull=be(H.address);var W=Oe(H);o.id=W.ref_id,n.push(W),Le(a,n,++s)}}}function Oe(e){var t="";return Pe()&&I.sendDistrictConfig()&&(t=I.getDistrict()),{address:e.addressFull.full_address?e.addressFull.full_address:e.address,ref_id:ne(),district:t}}function Te(t){var i=n.defer(),a=be(t.address);return S.validateVisit(t,a,Ke.vehicles).then(function(){t.error&&4===t.error.type?Ke.errorVisitsQty++:!t.error||2!==t.error.type&&3!==t.error.type||Ke.warningVisitsQty++,i.resolve(t)})["catch"](function(t){e.info(t),i.reject(t)}),i.promise}function Ve(e){var t=!1,i=!1;2===e.status||3===e.status?t=!0:4===e.status&&(i=!0);var a=e.areValidVisitWindowTimes();a||(t&&Ke.warningVisitsQty--,i||Ke.errorVisitsQty++),e.procureVisitStatus(),e.setVisible(!0)}function Re(t){e.info(t)}function Me(){if(i.isLoadingPlanner)if(Ke.maxProgressBar>Ke.visitsGeoreference){if(Ke.lenghtBatchs&&-1===c.indexOf(Ke.lenghtBatchs,Ke.visitsGeoreference)){Ke.visitsGeoreference=Ke.visitsGeoreference+1;var e=Ke.visitsGeoreference/Ke.maxProgressBar*100;Ke.widthDynamic=String(e)+"%"}}else at===Ke.maxProgressBar&&ze();else ze()}function ze(){Ke.errorAddress&&f.push("warning",nt("Planner_toast.wrong_row_excel")),r(function(){Ke.totalVisits=p.visits.length,at=0,p.orderVisitsByStatus(),N(),i.isLoadingPlanner=!1,Ke.visitsGeoreference=0,Ke.widthDynamic="0%",Ke.lenghtBatchs=[],tt&&_.cancel(tt)},10)}function Fe(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t.ref_id)return e[i]}function Ne(e){e.forEach(function(e){"enable_jdh"===e.key&&(Ke.enableJdh=e.value)})}function $e(){Ke.visits=[],"planner-vehicles"===pt.name&&pt.getCurrentStep().next()}function je(){var e,t=C.createFakeVisits();Ke.visits.length=0,angular.forEach(t,function(t,i){Ke.visits.push(t),Ke.visits[i].ifMarkerNotCreatedThenCreate(),5!==t.id||e||(e=t,u.$emit("Planner:Visit:showInfoWindow",{visit:e}))}),Ke.totalVisits=Ke.visits.length,ke(Ke.visits)}function Be(e,t){var i=t.steps.current;i.is("welcome","planner-visits")?(i.overrideAction("next",function(){u.$apply(function(){je()}),this.next()}),i.overrideAction("back",function(){var e=this;s.go("planner.vehicles-list"),setTimeout(function(){e.back()},100)})):i.is("optimize","planner-visits")?(i.overrideAction("next",function(){s.go("^.routes")}),t.steps.prev.is("welcome","planner-routes")&&u.$apply(function(){je()})):i.is("visits-list","planner-visits")&&i.overrideAction("back",function(){u.$emit("Planner:Clear:Map"),Ke.visits.length=0,Ke.totalVisits=0,u.$digest(),this.back()})}function He(){u.$emit("Planner:Clear:Map"),Ke.visits.length=0,Ke.totalVisits=0,s.go("planner.vehicles-list",{},{location:"replace"})}function Ue(e){Ke.visits.map(function(t){return t.checked=e,t}),Ke.allVisitsChecked=e}function qe(e){e.checked||(Ke.allVisitsChecked=!1)}function Ge(){var e=[];Ke.visits.map(function(t){t.checked&&(e.push(t.id),t.checked=!1)}),e.length>0&&s.go("^.visits-bulk-edit",{visitsId:e,page:Ke.currentPage})}function Je(){var e={};e.latin_map={"√Å":"A","ƒÇ":"A","·∫Æ":"A","·∫∂":"A","·∫∞":"A","·∫≤":"A","·∫¥":"A","«ç":"A","√Ç":"A","·∫§":"A","·∫¨":"A","·∫¶":"A","·∫®":"A","·∫™":"A","√Ñ":"A","«û":"A","»¶":"A","«†":"A","·∫†":"A","»Ä":"A","√Ä":"A","·∫¢":"A","»Ç":"A","ƒÄ":"A","ƒÑ":"A","√Ö":"A","«∫":"A","·∏Ä":"A","»∫":"A","√É":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","·∏Ç":"B","·∏Ñ":"B","∆Å":"B","·∏Ü":"B","…É":"B","∆Ç":"B","ƒÜ":"C","ƒå":"C","√á":"C","·∏à":"C","ƒà":"C","ƒä":"C","∆á":"C","»ª":"C","ƒé":"D","·∏ê":"D","·∏í":"D","·∏ä":"D","·∏å":"D","∆ä":"D","·∏é":"D","«≤":"D","«Ö":"D","ƒê":"D","∆ã":"D","«±":"DZ","«Ñ":"DZ","√â":"E","ƒî":"E","ƒö":"E","»®":"E","·∏ú":"E","√ä":"E","·∫æ":"E","·ªÜ":"E","·ªÄ":"E","·ªÇ":"E","·ªÑ":"E","·∏ò":"E","√ã":"E","ƒñ":"E","·∫∏":"E","»Ñ":"E","√à":"E","·∫∫":"E","»Ü":"E","ƒí":"E","·∏ñ":"E","·∏î":"E","ƒò":"E","…Ü":"E","·∫º":"E","·∏ö":"E","Íù™":"ET","·∏û":"F","∆ë":"F","«¥":"G","ƒû":"G","«¶":"G","ƒ¢":"G","ƒú":"G","ƒ†":"G","∆ì":"G","·∏†":"G","«§":"G","·∏™":"H","»û":"H","·∏®":"H","ƒ§":"H","‚±ß":"H","·∏¶":"H","·∏¢":"H","·∏§":"H","ƒ¶":"H","√ç":"I","ƒ¨":"I","«è":"I","√é":"I","√è":"I","·∏Æ":"I","ƒ∞":"I","·ªä":"I","»à":"I","√å":"I","·ªà":"I","»ä":"I","ƒ™":"I","ƒÆ":"I","∆ó":"I","ƒ®":"I","·∏¨":"I","Íùπ":"D","Íùª":"F","ÍùΩ":"G","ÍûÇ":"R","ÍûÑ":"S","ÍûÜ":"T","Íù¨":"IS","ƒ¥":"J","…à":"J","·∏∞":"K","«®":"K","ƒ∂":"K","‚±©":"K","ÍùÇ":"K","·∏≤":"K","∆ò":"K","·∏¥":"K","ÍùÄ":"K","ÍùÑ":"K","ƒπ":"L","»Ω":"L","ƒΩ":"L","ƒª":"L","·∏º":"L","·∏∂":"L","·∏∏":"L","‚±†":"L","Íùà":"L","·∏∫":"L","ƒø":"L","‚±¢":"L","«à":"L","≈Å":"L","«á":"LJ","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","≈É":"N","≈á":"N","≈Ö":"N","·πä":"N","·πÑ":"N","·πÜ":"N","«∏":"N","∆ù":"N","·πà":"N","»†":"N","«ã":"N","√ë":"N","«ä":"NJ","√ì":"O","≈é":"O","«ë":"O","√î":"O","·ªê":"O","·ªò":"O","·ªí":"O","·ªî":"O","·ªñ":"O","√ñ":"O","»™":"O","»Æ":"O","»∞":"O","·ªå":"O","≈ê":"O","»å":"O","√í":"O","·ªé":"O","∆†":"O","·ªö":"O","·ª¢":"O","·ªú":"O","·ªû":"O","·ª†":"O","»é":"O","Íùä":"O","Íùå":"O","≈å":"O","·πí":"O","·πê":"O","∆ü":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","√ï":"O","·πå":"O","·πé":"O","»¨":"O","∆¢":"OI","Íùé":"OO","∆ê":"E","∆Ü":"O","»¢":"OU","·πî":"P","·πñ":"P","Íùí":"P","∆§":"P","Íùî":"P","‚±£":"P","Íùê":"P","Íùò":"Q","Íùñ":"Q","≈î":"R","≈ò":"R","≈ñ":"R","·πò":"R","·πö":"R","·πú":"R","»ê":"R","»í":"R","·πû":"R","…å":"R","‚±§":"R","Íúæ":"C","∆é":"E","≈ö":"S","·π§":"S","≈†":"S","·π¶":"S","≈û":"S","≈ú":"S","»ò":"S","·π†":"S","·π¢":"S","·π®":"S","≈§":"T","≈¢":"T","·π∞":"T","»ö":"T","»æ":"T","·π™":"T","·π¨":"T","∆¨":"T","·πÆ":"T","∆Æ":"T","≈¶":"T","‚±Ø":"A","ÍûÄ":"L","∆ú":"M","…Ö":"V","Íú®":"TZ","√ö":"U","≈¨":"U","«ì":"U","√õ":"U","·π∂":"U","√ú":"U","«ó":"U","«ô":"U","«õ":"U","«ï":"U","·π≤":"U","·ª§":"U","≈∞":"U","»î":"U","√ô":"U","·ª¶":"U","∆Ø":"U","·ª®":"U","·ª∞":"U","·ª™":"U","·ª¨":"U","·ªÆ":"U","»ñ":"U","≈™":"U","·π∫":"U","≈≤":"U","≈Æ":"U","≈®":"U","·π∏":"U","·π¥":"U","Íùû":"V","·πæ":"V","∆≤":"V","·πº":"V","Íù†":"VY","·∫Ç":"W","≈¥":"W","·∫Ñ":"W","·∫Ü":"W","·∫à":"W","·∫Ä":"W","‚±≤":"W","·∫å":"X","·∫ä":"X","√ù":"Y","≈∂":"Y","≈∏":"Y","·∫é":"Y","·ª¥":"Y","·ª≤":"Y","∆≥":"Y","·ª∂":"Y","·ªæ":"Y","»≤":"Y","…é":"Y","·ª∏":"Y","≈π":"Z","≈Ω":"Z","·∫ê":"Z","‚±´":"Z","≈ª":"Z","·∫í":"Z","»§":"Z","·∫î":"Z","∆µ":"Z","ƒ≤":"IJ","≈í":"OE","·¥Ä":"A","·¥Å":"AE"," ô":"B","·¥É":"B","·¥Ñ":"C","·¥Ö":"D","·¥á":"E","Íú∞":"F","…¢":"G"," õ":"G"," ú":"H","…™":"I"," Å":"R","·¥ä":"J","·¥ã":"K"," ü":"L","·¥å":"L","·¥ç":"M","…¥":"N","·¥è":"O","…∂":"OE","·¥ê":"O","·¥ï":"OU","·¥ò":"P"," Ä":"R","·¥é":"N","·¥ô":"R","Íú±":"S","·¥õ":"T","‚±ª":"E","·¥ö":"R","·¥ú":"U","·¥†":"V","·¥°":"W"," è":"Y","·¥¢":"Z","√°":"a","ƒÉ":"a","·∫Ø":"a","·∫∑":"a","·∫±":"a","·∫≥":"a","·∫µ":"a","«é":"a","√¢":"a","·∫•":"a","·∫≠":"a","·∫ß":"a","·∫©":"a","·∫´":"a","√§":"a","«ü":"a","»ß":"a","«°":"a","·∫°":"a","»Å":"a","√†":"a","·∫£":"a","»É":"a","ƒÅ":"a","ƒÖ":"a","·∂è":"a","·∫ö":"a","√•":"a","«ª":"a","·∏Å":"a","‚±•":"a","√£":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","·∏É":"b","·∏Ö":"b","…ì":"b","·∏á":"b","·µ¨":"b","·∂Ä":"b","∆Ä":"b","∆É":"b","…µ":"o","ƒá":"c","ƒç":"c","√ß":"c","·∏â":"c","ƒâ":"c","…ï":"c","ƒã":"c","∆à":"c","»º":"c","ƒè":"d","·∏ë":"d","·∏ì":"d","»°":"d","·∏ã":"d","·∏ç":"d","…ó":"d","·∂ë":"d","·∏è":"d","·µ≠":"d","·∂Å":"d","ƒë":"d","…ñ":"d","∆å":"d","ƒ±":"i","»∑":"j","…ü":"j"," Ñ":"j","«≥":"dz","«Ü":"dz","√©":"e","ƒï":"e","ƒõ":"e","»©":"e","·∏ù":"e","√™":"e","·∫ø":"e","·ªá":"e","·ªÅ":"e","·ªÉ":"e","·ªÖ":"e","·∏ô":"e","√´":"e","ƒó":"e","·∫π":"e","»Ö":"e","√®":"e","·∫ª":"e","»á":"e","ƒì":"e","·∏ó":"e","·∏ï":"e","‚±∏":"e","ƒô":"e","·∂í":"e","…á":"e","·∫Ω":"e","·∏õ":"e","Íù´":"et","·∏ü":"f","∆í":"f","·µÆ":"f","·∂Ç":"f","«µ":"g","ƒü":"g","«ß":"g","ƒ£":"g","ƒù":"g","ƒ°":"g","…†":"g","·∏°":"g","·∂É":"g","«•":"g","·∏´":"h","»ü":"h","·∏©":"h","ƒ•":"h","‚±®":"h","·∏ß":"h","·∏£":"h","·∏•":"h","…¶":"h","·∫ñ":"h","ƒß":"h","∆ï":"hv","√≠":"i","ƒ≠":"i","«ê":"i","√Æ":"i","√Ø":"i","·∏Ø":"i","·ªã":"i","»â":"i","√¨":"i","·ªâ":"i","»ã":"i","ƒ´":"i","ƒØ":"i","·∂ñ":"i","…®":"i","ƒ©":"i","·∏≠":"i","Íù∫":"d","Íùº":"f","·µπ":"g","ÍûÉ":"r","ÍûÖ":"s","Íûá":"t","Íù≠":"is","«∞":"j","ƒµ":"j"," ù":"j","…â":"j","·∏±":"k","«©":"k","ƒ∑":"k","‚±™":"k","ÍùÉ":"k","·∏≥":"k","∆ô":"k","·∏µ":"k","·∂Ñ":"k","ÍùÅ":"k","ÍùÖ":"k","ƒ∫":"l","∆ö":"l","…¨":"l","ƒæ":"l","ƒº":"l","·∏Ω":"l","»¥":"l","·∏∑":"l","·∏π":"l","‚±°":"l","Íùâ":"l","·∏ª":"l","≈Ä":"l","…´":"l","·∂Ö":"l","…≠":"l","≈Ç":"l","«â":"lj","≈ø":"s","·∫ú":"s","·∫õ":"s","·∫ù":"s","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","·µØ":"m","·∂Ü":"m","≈Ñ":"n","≈à":"n","≈Ü":"n","·πã":"n","»µ":"n","·πÖ":"n","·πá":"n","«π":"n","…≤":"n","·πâ":"n","∆û":"n","·µ∞":"n","·∂á":"n","…≥":"n","√±":"n","«å":"nj","√≥":"o","≈è":"o","«í":"o","√¥":"o","·ªë":"o","·ªô":"o","·ªì":"o","·ªï":"o","·ªó":"o","√∂":"o","»´":"o","»Ø":"o","»±":"o","·ªç":"o","≈ë":"o","»ç":"o","√≤":"o","·ªè":"o","∆°":"o","·ªõ":"o","·ª£":"o","·ªù":"o","·ªü":"o","·ª°":"o","»è":"o","Íùã":"o","Íùç":"o","‚±∫":"o","≈ç":"o","·πì":"o","·πë":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","√µ":"o","·πç":"o","·πè":"o","»≠":"o","∆£":"oi","Íùè":"oo","…õ":"e","·∂ì":"e","…î":"o","·∂ó":"o","»£":"ou","·πï":"p","·πó":"p","Íùì":"p","∆•":"p","·µ±":"p","·∂à":"p","Íùï":"p","·µΩ":"p","Íùë":"p","Íùô":"q"," †":"q","…ã":"q","Íùó":"q","≈ï":"r","≈ô":"r","≈ó":"r","·πô":"r","·πõ":"r","·πù":"r","»ë":"r","…æ":"r","·µ≥":"r","»ì":"r","·πü":"r","…º":"r","·µ≤":"r","·∂â":"r","…ç":"r","…Ω":"r","‚ÜÑ":"c","Íúø":"c","…ò":"e","…ø":"r","≈õ":"s","·π•":"s","≈°":"s","·πß":"s","≈ü":"s","≈ù":"s","»ô":"s","·π°":"s","·π£":"s","·π©":"s"," Ç":"s","·µ¥":"s","·∂ä":"s","»ø":"s","…°":"g","·¥ë":"o","·¥ì":"o","·¥ù":"u","≈•":"t","≈£":"t","·π±":"t","»õ":"t","»∂":"t","·∫ó":"t","‚±¶":"t","·π´":"t","·π≠":"t","∆≠":"t","·πØ":"t","·µµ":"t","∆´":"t"," à":"t","≈ß":"t","·µ∫":"th","…ê":"a","·¥Ç":"ae","«ù":"e","·µ∑":"g","…•":"h"," Æ":"h"," Ø":"h","·¥â":"i"," û":"k","ÍûÅ":"l","…Ø":"m","…∞":"m","·¥î":"oe","…π":"r","…ª":"r","…∫":"r","‚±π":"r"," á":"t"," å":"v"," ç":"w"," é":"y","Íú©":"tz","√∫":"u","≈≠":"u","«î":"u","√ª":"u","·π∑":"u","√º":"u","«ò":"u","«ö":"u",
"«ú":"u","«ñ":"u","·π≥":"u","·ª•":"u","≈±":"u","»ï":"u","√π":"u","·ªß":"u","∆∞":"u","·ª©":"u","·ª±":"u","·ª´":"u","·ª≠":"u","·ªØ":"u","»ó":"u","≈´":"u","·πª":"u","≈≥":"u","·∂ô":"u","≈Ø":"u","≈©":"u","·ππ":"u","·πµ":"u","·µ´":"ue","Íù∏":"um","‚±¥":"v","Íùü":"v","·πø":"v"," ã":"v","·∂å":"v","‚±±":"v","·πΩ":"v","Íù°":"vy","·∫É":"w","≈µ":"w","·∫Ö":"w","·∫á":"w","·∫â":"w","·∫Å":"w","‚±≥":"w","·∫ò":"w","·∫ç":"x","·∫ã":"x","·∂ç":"x","√Ω":"y","≈∑":"y","√ø":"y","·∫è":"y","·ªµ":"y","·ª≥":"y","∆¥":"y","·ª∑":"y","·ªø":"y","»≥":"y","·∫ô":"y","…è":"y","·ªπ":"y","≈∫":"z","≈æ":"z","·∫ë":"z"," ë":"z","‚±¨":"z","≈º":"z","·∫ì":"z","»•":"z","·∫ï":"z","·µ∂":"z","·∂é":"z"," ê":"z","∆∂":"z","…Ä":"z","Ô¨Ä":"ff","Ô¨É":"ffi","Ô¨Ñ":"ffl","Ô¨Å":"fi","Ô¨Ç":"fl","ƒ≥":"ij","≈ì":"oe","Ô¨Ü":"st","‚Çê":"a","‚Çë":"e","·µ¢":"i","‚±º":"j","‚Çí":"o","·µ£":"r","·µ§":"u","·µ•":"v","‚Çì":"x"},String.prototype.latinise=function(){return this.replace(/[^A-Za-z0-9\[\] ]/g,function(t){return e.latin_map[t]||t})},String.prototype.latinize=String.prototype.latinise,String.prototype.isLatin=function(){return this===this.latinise()}}function Ye(e,t){var i=e.join(",").length;return i+t.length+1<=P}function We(e){return e.length<L}function Qe(e){var t=[],i="";return e&&(e.split(",").forEach(function(e){if(We(t)){var i=e.trim().replace(" ","").latinize();Ze(i)&&Ye(t,i)&&t.push(i)}}),i=t.join(",")),i}function Ze(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}var Ke=this,Xe=500,et=0,tt=null,it=400,at=0,nt=t("translate"),st=null;Ke.widthDynamic="0%",Ke.lenghtBatchs=[],Ke.visitsGeoreference=0,Ke.currentPage=1,Ke.itemsPerPage=Xe,Ke.menuVisitIsOpen=!1;var ot=h.cities.chile,rt={ALL:1,WARNINGS:2,ERRORS:3},lt=[],ct="Direcci√≥n dudosa",dt=null,ut=[],pt=E.getActiveTour(),mt=null,vt=["PE","CL"];Ke.FILTERS=rt,Ke.NUM_BATCH=Xe,Ke.visits=[],Ke.activeVisit=null,Ke.planDate=null,Ke.importErrors=[],Ke.importWarnings=[],Ke.optimizationOptions=angular.copy(p.localOptimizationOptions),Ke.nextStep=!1,Ke.location_start={country_code:"CL"},Ke.warningVisitsQty=0,Ke.errorVisitsQty=0,Ke.activeFilter=rt.ALL,Ke.activatePanelOnTour={"planner-visits":["selection-import","visits-list","optimize"]},Ke.activateMapOnTour={"planner-routes":["welcome"]},Ke.enableJdh=!0,Ke.totalVisits=0,Ke.planName=null,Ke.dateOptions={formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM",formatDay:"d",showWeeks:!1,maxMode:"day",startingDay:0},Ke.popupCalendar=!1,Ke.dateToGetIntegrationVisits=p.planDate.start,Ke.dateToGetIntegrationVisitsNotCompleted=p.planDate.start,Ke.bulkEdition=!1,Ke.allVisitsChecked=!1,Ke.dataVisitsImport={},Ke.dataVisitsImportNotCompleted={},Ke.accountToViewZones=!1,Ke.listZones=[],Ke.remove=M,Ke.goNext=B,Ke.removeAlert=j,Ke.activateVisit=H,Ke.importExcel=G,Ke._cancelLoading=ze,Ke.showDeleteModal=$,Ke.deleteAllVisits=F,Ke.downloadExcelVisit=U,Ke.checkOptionOptimize=Y,Ke.refreshVisits=N,Ke.isEditingPlan=X,Ke.showRemoveWarningVisitsModal=ee,Ke.showRemoveErrorVisitsModal=te,Ke.goToAlertVisits=se,Ke.goToErrorVisits=oe,Ke.allowedToDisplayOption=W,Ke.goNextWithJDH=ue,Ke.getRowsFromExcel=q,Ke.getVisitsIntegration=me,Ke.checkAlgorithmToOptimize=pe,Ke.checkOptions=ve,Ke.checkAllVisits=Ue,Ke.openBulkEdit=Ge,Ke.checkVisit=qe,Ke.openMenuToAddVisits=ge,Ke.openComponentVisitsIntegration=he,Ke.closeMenuVisitsImport=fe,Ke.updatePlannerStepsInfo=V,Ke.openComponentVisitsIntegrationNotCompleted=_e,Ke.formatContactEmail=Qe,u.$on("TOUR:STEP_CHANGED",Be),u.$on("TOUR:END_ALL_TOURS",He),mt=i.$on("visitClickedOnMap",function(e,t){m.removeAlertNotification(),a(t.visit.id),angular.isDefined(t.visit.error)&&(m.addAlertNotification(t.visit.error),u.$$phase||u.$apply())}),u.$on("$destroy",function(){i.isLoadingPlanner=!1,m.removeAlertNotification(),st&&(st.activate=!1),mt(),"planner.vehicles-list"===s.current.name&&u.$emit("Planner:Plan:steps",{key:"visit",value:!1})}),pt?$e():O()}e.$inject=["$log","$filter","$rootScope","$anchorScroll","$q","$state","$stateParams","$timeout","moment","lodash","ngDialog","$scope","plannerService","alertNotificationService","XLSX","__env","Utils","$interval","Toasts","sessionService","xlsxService","marketingService","$translate","googleService","$window","cleanerService","validatorGeoreferenceService","TourManager","TourFake","zoneService","JOINED_EMAILS_MAX_LENGTH","MAX_EMAILS_INPUT"],angular.module("icarus.planner").controller("PlannerVisitsListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m){function v(){o.hideVehicles(),o.hideVisits(),o.hideRoutes(),o.hideInfoWindow(),o.deactivateVisits(),N=s.fstatus||1,$=s.page||1,z.priorityLevels=o.getPriorityLevels();try{V=c.createAutoCompleteService(),M=c.createGeocode(),R=c.createPlacesService(t[0].createElement("div"))}catch(a){e.error(a)}return i.all([o.getPlan()]).then(function(){s.visitId?E():S(),z.requiredSkills=angular.copy(o.getSkills()),z.optionalSkills=angular.copy(o.getSkills()),z.requiredSkills.map(function(e){e.visible=!0}),z.optionalSkills.map(function(e){e.visible=!0})},function(t){e.info(t)})}function g(){z.form.$valid&&(z.visit.contactEmail=D(z.emails),h().then(function(){function t(){l.isLoading=!1,z.visit.setEditMode(!1),n.go("^.visits-list",{recent:z.visit.id,fstatus:N,page:$})}function i(t){e.error(t),l.isLoading=!1}if(z.serviceTimeError=!1,isNaN(z.visit.duration))z.serviceTimeError=!0;else{if(z.visit.load=isNaN(z.visit.load)||!z.visit.load?0:parseFloat(parseFloat(z.visit.load).toFixed(2)),z.saving=!0,l.isLoading=!0,F&&F.address.toLowerCase().replace(/\s/g,"")!==z.visit.address.toLowerCase().replace(/\s/g,"")&&z.visit.removeError(),!z.visit.backendId)return z.visit.setEditMode(!1),n.go("^.visits-list",{recent:z.visit.id,fstatus:N,page:$}),z.saving=!1,void(l.isLoading=!1);z.visit.save(o.getRouteById(z.visit.routeId)).then(t,i)}}))}function h(){var e=i.defer();return z.visit.zones=[],u.getZonesIfProceed().then(function(t){z.visit.zones=u.getZonesIntoVisit(t,z.visit.latitude,z.visit.longitude),e.resolve()}),e.promise}function _(){return z.visit.backendId||F?!z.visit.backendId&&F?(d.merge(z.visit,F),void n.go("^.visits-list",{recent:z.visit.id,fstatus:N,page:$})):(d.merge(z.visit,F),void(z.visit.id?n.go("^.visits-list",{recent:z.visit.id,fstatus:N,page:$}):n.go("^.visits-list",{fstatus:N,page:$}))):(o.removeVisit(z.visit),void n.go("^.visits-list",{fstatus:N,page:$}))}function f(e){var t=i.defer();return V.getPlacePredictions({input:e,types:["address"]},function(e,i){return i!==c.placesServiceStatusOk()?t.reject(i):void t.resolve(e)}),t.promise}function b(t,i){if(!t&&i.address){var n=c.createAutoCompleteService();n.getPlacePredictions({input:i.address,types:["address"]},function(e){(null===e||0===e.length)&&M.geocode({address:z.visit.address},function(e,t){if(t===c.geocoderStatusOK()){var n=e[0];i.setPosition(n.geometry.location.lat(),n.geometry.location.lng()),o.setMapCenterOn(i),a.$apply(),o.setMapCenterOn(i)}else{var s=c.getGoogleMapsLatLng(0,0);i.setPosition(s.lat(),s.lng()),o.setMapCenterOn(i),a.$apply(),o.setMapCenterOn(i)}})})}else t&&R.getDetails({placeId:t.place_id},function(n,s){s===c.placesServiceStatusOk()?(i.setPosition(n.geometry.location.lat(),n.geometry.location.lng()),o.setMapCenterOn(i),a.$apply(),o.setMapCenterOn(i)):e.error(s,t,i)})}function y(e,t){function i(e){return function(t){return"object"==typeof t?t.id===e:t===e}}w(e,t)?t.splice(t.indexOf(e),1):t.push(e),z.requiredSkills.forEach(function(e){var t=z.visit.skills_required.filter(i(e.id))[0];if(t){var a=z.optionalSkills.filter(i(e.id))[0];a.visible=!1}else{var n=z.visit.skills_optional.filter(i(e.id))[0];n||(e.visible=!0)}}),z.optionalSkills.forEach(function(e){var t=z.visit.skills_optional.filter(i(e.id))[0];if(t){var a=z.requiredSkills.filter(i(e.id))[0];a.visible=!1}else{var n=z.visit.skills_required.filter(i(e.id))[0];n||(e.visible=!0)}})}function w(e,t){return-1!==t.indexOf(e)}function A(e){var t=/^([0-1]?[0-9]|2[0-3])(:[0-5][0-9])?$/,i=e>1?"windowStart2":"windowStart",a=e>1?"windowEnd2":"windowEnd",n=e>1?"2":"";z.visit[i]&&!t.test(z.visit[i])||z.visit[a]&&!t.test(z.visit[a])?(z.invalidForm=!0,z["invalidDate"+n]=!0,z["emptyDate"+n]=!1,z["timeBetweenDate"+n]=!1):z.visit[i]&&!z.visit[a]||!z.visit[i]&&z.visit[a]?(z.invalidForm=!0,z["emptyDate"+n]=!0,z["invalidDate"+n]=!1,z["timeBetweenDate"+n]=!1):z.visit[i]&&z.visit[a]&&moment(z.visit[i],"HH:mm").isSameOrAfter(moment(z.visit[a],"HH:mm"))?(z.invalidForm=!0,z["invalidDate"+n]=!1,z["emptyDate"+n]=!1,z["timeBetweenDate"+n]=!0):z.visit[i]&&z.visit[a]&&moment(z.visit[i],"HH:mm").isBefore(moment(z.visit[a],"HH:mm"))?(z["invalidDate"+n]=!1,z["emptyDate"+n]=!1,z["timeBetweenDate"+n]=!1):(z["invalidDate"+n]=!1,z["emptyDate"+n]=!1,z["timeBetweenDate"+n]=!1),z.visit[i]&&t.test(z.visit[i])&&(z.visit[i]=moment(z.visit[i],"HH:mm").format("HH:mm")),z.visit[a]&&t.test(z.visit[a])&&(z.visit[a]=moment(z.visit[a],"HH:mm").format("HH:mm"))}function x(){A(1),A(2),z.emptyDate||z.emptyDate2||z.invalidDate||z.invalidDate2||z.timeBetweenDate||z.timeBetweenDate2||(z.invalidForm=!1)}function k(){z.serviceTimeError=isNaN(z.visit.duration)}function I(e){"title"===e&&(z.form.title.$invalid&&!z.form.title.$viewValue?z.invalidTitle=!0:z.invalidTitle=!1),"address"===e&&(z.form.address.$invalid&&!z.form.address.$viewValue?z.invalidAddress=!0:z.invalidAddress=!1),"load"===e&&(z.form.load.$invalid&&!z.form.load.$viewValue?z.invalidLoad=!0:z.invalidLoad=!1),"load2"===e&&(z.form.load_2.$invalid?z.invalidLoad2=!0:z.invalidLoad2=!1),"load3"===e&&(z.form.load_3.$invalid?z.invalidLoad3=!0:z.invalidLoad3=!1)}function S(){try{var t=o.getGmap().getCenter();z.visit=o.createVisit(t.lat(),t.lng()),z.visit.plannedDate=o.planDate.start,z.visit.actionCreate(z.visit),z.visit.setEditMode(!0)}catch(i){e.error(i)}}function E(){var e=o.getVisit(s.visitId);F=angular.copy(e),e.error&&r.addAlertNotification(e.error),z.visit=e,z.visit.contactEmail&&e.contactEmail.split(",").map(function(e){z.emails.push({text:e})}),z.visit.setEditMode(!0),z.visit.windowOneError&&(z.timeBetweenDate=!0),z.visit.windowTwoError&&(z.timeBetweenDate2=!0),(z.visit.load2||z.visit.load3||z.visit.windowStart2||z.visit.windowEnd2||z.visit.load||z.visit.windowStart||z.visit.windowEnd||10!==z.visit.duration||z.visit.reference||z.visit.priorityLevel||z.visit.contactName||z.visit.contactPhone||z.visit.notes||z.visit.skills_required.length>0||z.visit.skills_optional.length>0)&&(z.moreOptions=!1),o.centerVisit(z.visit,!1)}function C(){z.invalidDate||z.invalidDate2||z.emptyDate||z.emptyDate2||z.timeBetweenDate||z.timeBetweenDate2||(z.visit.areValidVisitWindowTimes()?(z.visit.status=1,z.visit.error=null,z.invalidForm=!1,r.removeAlertNotification()):(z.invalidForm=!0,r.addAlertNotification(z.visit.error)),z.visit.procureVisitStatus(),z.visit.actionUpdate(z.visit))}function D(e){return e.map(function(e){return e.text}).join(",")}function P(e){var t=L(e)&&O(e)&&T();return z.form.$invalid=!t,t}function L(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i=t.test(e.text);return z.emailInputError.invalidFormat=!i,i}function O(e){var t=JSON.parse(JSON.stringify(z.emails));t.push(e);var i=D(t),a=i.length<=p;return z.emailInputError.maxLength=!a,a}function T(){var e=z.emails.length<m;return z.emailInputError.maxQuantity=!e,e}var V,R,M,z=this,F=null,N=1,$=1;z.emailInputError={invalidFormat:!1,maxQuantity:!1,maxLength:!1},z.invalidDate=!1,z.invalidDate2=!1,z.emptyDate=!1,z.emptyDate2=!1,z.timeBetweenDate=!1,z.timeBetweenDate2=!1,z.invalidForm=!1,z.maxEmails=m,z.form={},z.emails=[],z.visit={skills_optional:[],skills_required:[]},z.saving=!1,z.serviceTimeError=!1,z.moreOptions=!0,z.requiredSkills=[],z.optionalSkills=[],z.priorityLevels=[],z.save=g,z.cancel=_,z.getPlaces=f,z.addressSelected=b,z.skillsHandler=y,z.isInArray=w,z.checkForm=I,z.validateTime=x,z.validateTimeService=k,z.validateWindowTimes=C,z.validateEmailInput=P,v();var j=a.$on("$stateChangeStart",function(){z.form.$pristine?e.info("NO CHANGES"):e.info("HAS CHANGES"),F&&(r.removeAlertNotification(),z.visit.setEditMode(!1),o.putOffCenterVisit(z.visit))});a.$on("$destroy",j)}e.$inject=["$log","$document","$q","$scope","$state","$stateParams","plannerService","alertNotificationService","$rootScope","googleService","lodash","zoneService","JOINED_EMAILS_MAX_LENGTH","MAX_EMAILS_INPUT"],angular.module("icarus.planner").controller("PlannerVisitsDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(e,t){x.data.latitude=e,x.data.longitude=t}function p(){try{y=l.createAutoCompleteService(),A=l.createGeocode(),w=l.createPlacesService(t[0].createElement("div"))}catch(i){e.error(i)}x.visitsQty=k.length,n.$broadcast("Planner:Clear:Visits")}function m(){n.$broadcast("Planner:RemoveVisitsFromArray:Visit",{visits:[x.visit]}),r.mapFitBoundAllVisits()}function v(e){var t=i.defer();return y.getPlacePredictions({input:e,types:["address"]},function(e,i){i===l.placesServiceStatusOk()?t.resolve(e):t.reject(i)}),t.promise}function g(e,t){x.visit=new c,x.visit.id="dummy",x.visit.latitude=e,x.visit.longitude=t,n.$broadcast("Planner:Visit:Create",{visit:x.visit})}function h(t){if(!t&&x.data.address){var i=l.createAutoCompleteService();i.getPlacePredictions({input:x.data.address,types:["address"]},function(e){(null===e||0===e.length)&&A.geocode({address:x.data.address},function(e,t){if(t===l.geocoderStatusOK()){var i=e[0];return g(i.geometry.location.lat(),i.geometry.location.lng()),u(i.geometry.location.lat(),i.geometry.location.lng()),a.$apply(),void r.centerVisit(x.visit)}var n=l.getGoogleMapsLatLng(0,0);g(n.lat(),n.lng()),u(n.lat(),n.lng()),a.$apply(),r.centerVisit(x.visit)})})}else t&&w.getDetails({placeId:t.place_id},function(i,n){n===l.placesServiceStatusOk()?(g(i.geometry.location.lat(),i.geometry.location.lng()),u(i.geometry.location.lat(),i.geometry.location.lng()),a.$apply(),r.centerVisit(x.visit)):e.error(n,t,x.visit)})}function _(){x.data.address&&(x.data.status=1,x.data.error=null)}function f(){x.form.$invalid||(_(),d.getZonesIfProceed().then(function(e){r.visitsBulkEdit(k,x.data),r.getVisits().forEach(function(t){t.zones=d.getZonesIntoVisit(e,t.latitude,t.longitude)}),s.go("^.visits-list",{page:o.currentPage})}))}function b(){s.go("^.visits-list",{page:o.currentPage})}var y,w,A,x=this,k=o.visitsId;x.form={},x.data={address:"",latitude:0,longitude:0},x.visit={},x.visitsQty=0,x.save=f,x.cancel=b,x.getPlaces=v,x.addressSelected=h,p(),a.$on("$destroy",m)}e.$inject=["$log","$document","$q","$scope","$rootScope","$state","$stateParams","plannerService","googleService","PlannerVisitModel","zoneService"],angular.module("icarus.planner").controller("PlannerVisitsBulkEditController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m){function v(){L.vehicles=[],L.planDate={},L.planDate.start=i().toDate(),L.shift={start:"09:00",end:"17:00"}}function g(){_()}function h(e,i){i.steps.current.is("goto-visits","planner-vehicles")&&(L.vehicles=[],L.nextStep=!0,L.selectAllVehicles=!0,L.vehicles.push(u.createFakeVehicles()),i.steps.current.overrideAction("next",function(){t.go("^.visits-list")}),i.steps.current.overrideAction("back",function(){L.vehicles.length=0,m.$digest(),this.back()}))}function _(){function e(e){a.hideVehicles(),a.hideVisits(),a.hideRoutes(),a.hideInfoWindow(),a.deactivateVisits(),L.planName=a.getPlanName(),L.isEditingPlan=!!L.planName,L.planDate=e.planDate,L.planDate.start=i(e.planDate.start).toDate(),L.shift=e.shift,a.restoreVehicles(),L.vehicles=a.vehicles,L.isEditingPlan&&(O=r("filter")(L.vehicles,{active:!0})),L.vehicles.map(function(e){if(e.setIconFillColorWithVehicleColor(),e.driver){var t;try{t=JSON.parse(e.driver)}catch(i){t=e.driver}e.driverName=t.name}}),L.getVehiclesActive()>0?L.nextStep=!0:(L.nextStep=!1,L.selectAllVehicles=!1),S(),k(),P(),m.$emit("Planner:Plan:steps-reset")}function t(){n.isLoading=!1}return n.isLoading=!0,L.nextStep=!1,L.selectAllVehicles=!1,o("Vehicles.disabled_vehicles_selected").then(function(e){L.disableVehiclesMsg=e},function(e){L.disableVehiclesMsg=e}),l.fbq("track","ViewContent"),c.callGoogleTrackConversion("XzLLCJzsmG0QndigwgM"),L.dateOptions={formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM",formatDay:"d",showWeeks:!1,maxMode:"day",startingDay:0},L.popupPlanDate={opened:!1},a.getPlan().then(e,t)}function f(e){L.getVehiclesActive()>0?(L.nextStep=!0,L.getVehiclesActive()===L.vehicles.length?L.selectAllVehicles=!0:L.selectAllVehicles=!1,k(),y(e)):(L.nextStep=!1,L.selectAllVehicles=!1,L.vehicleDisabled=!1,a.disableStep.next=L.nextStep,a.disableStep.vehicleDisabled=L.vehicleDisabled),e.active||a.getPlanName()&&a.setVehiclesEnableEditPlan(!0)}function b(e){return a.getGmap().setZoom(11),e===L.selectedVehicle?(e.setVisible(!1),a.getCenter(),void(L.selectedVehicle=null)):(L.selectedVehicle=e,L.vehicles.map(function(e){e!==L.selectedVehicle&&e.setVisible(!1)}),e.setOpacity(1),e.setVisible(),void a.centerVehicle(e))}function y(){for(var e=!1,t=a.routesAccount,n=0;n<L.vehicles.length;n++){var s=L.vehicles[n],o=i(L.planDate.start),l=i(L.planDate.start),c=!!r("filter")(O,{id:s.id}).length;w(s,!0,"Vehicles.available.default"),o.set({hour:parseInt(s.shift.start.slice(0,2)),minute:parseInt(s.shift.start.slice(3,5))}),l.set({hour:parseInt(s.shift.end.slice(0,2)),minute:parseInt(s.shift.end.slice(3,5))});var d=s.isAvailableIn(o,l,t,L.planDate);d.available||(e=s.active&&!c?!0:e,w(s,!1,"Vehicles.notAvailable.until",d.until))}L.vehicleDisabled=e,a.disableStep.next=L.nextStep,a.disableStep.vehicleDisabled=L.vehicleDisabled}function w(e,t,i,a){e.available.value=t,o(i).then(function(t){e.available.msg=a?t+" "+a.format("HH:mm"):t},function(t){e.available.msg=t})}function A(){L.vehicles.map(function(e){L.selectAllVehicles?e.active=!0:e.active=!1}),L.getVehiclesActive()>0?(L.nextStep=!0,k(),y()):(L.nextStep=!1,L.vehicleDisabled=!1,a.disableStep.next=L.nextStep,a.disableStep.vehicleDisabled=L.vehicleDisabled),a.getPlanName()&&a.setVehiclesEnableEditPlan(!0)}function x(){var e=0;return L.vehiclesActive=0,L.vehicles.map(function(t){t.active&&(e++,L.vehiclesActive++)}),e===L.vehicles.length&&e>0&&L.vehicles.length>0&&(L.selectAllVehicles=!0),e}function k(){L.vehicles.forEach(function(e){e.active&&(e.locationStart.latitude&&e.locationEnd.latitude&&e.locationStart.longitude&&e.locationEnd.longitude||(L.nextStep=!1))}),n.isLoading=!1}function I(){L.popupPlanDate.opened=!0}function S(){var t={start:i(L.planDate.start).format("YYYY-MM-DD")};e.info(L.planDate.start),a.routesAccount.length=0,a.loadRoutes(t).then(function(){y()})}function E(){t.go("^.visits-list")}function C(e){return function(t){return s.naturalValue(t[e])}}function D(){var e,t=!1,n=/^\s*([01]?\d|2[0-3]):?([0-5]\d)\s*$/;return(e=L.shift.start.match(n))?(L.scheduleForm.$invalid=!1,L.invalidDate=!1,(t=(2===e[1].length?"":"0")+e[1]+":"+e[2])&&(e=L.shift.end.match(n))?(L.scheduleForm.$invalid=!1,L.invalidDate=!1,(t=(2===e[1].length?"":"0")+e[1]+":"+e[2])?(L.shift.start&&(L.shift.start=i(L.shift.start,"HH:mm").format("HH:mm")),L.shift.end&&(L.shift.end=i(L.shift.end,"HH:mm").format("HH:mm")),void(L.shift.start>L.shift.end||L.shift.start===L.shift.end?(L.scheduleForm.$invalid=!0,L.timeBetweenDate=!0):(L.scheduleForm.$invalid=!1,L.timeBetweenDate=!1,a.setShift(L.shift.start,L.shift.end),L.vehicles.map(function(e){e.shiftDefault.start||e.shiftDefault.end||(e.shift=angular.copy(L.shift))}),y()))):(L.scheduleForm.$invalid=!0,void(L.invalidDate=!0))):(L.scheduleForm.$invalid=!0,void(L.invalidDate=!0))):(L.scheduleForm.$invalid=!0,void(L.invalidDate=!0))}function P(){d.getConfigByKey("vehicle_refill_time").then(function(e){var t=e?e:0;L.vehicles.map(function(e){e.refill=t})})}var L=this,O=[];L.activatePanelOnTour={"planner-vehicles":["select-date","vehicle-info","goto-visits"]},L.planDate=null,L.shift=null,L.vehicles=[],L.vehiclesActive=null,L.dateOptions=null,L.popupPlanDate=null,L.selectedVehicle=null,L.seeAllVehicles=!1,L.openPopupPlanDate=I,L.selectDate=S,L.toggleSelectAllVehicles=A,L.goNext=E,L.toggleVehicle=f,L.getVehiclesActive=x,L.toggleSelectedVehicle=b,L.naturalSort=C,L.validateTime=D,L.setVehiclesRefill=P,L.isEditingPlan=!1,L.plannerService=a,L.planName=null,L.disableVehiclesMsg="",m.$on("TOUR:STEP_CHANGED",h),m.$on("TOUR:START",v),m.$on("TOUR:END_ALL_TOURS",g),m.$on("Vehicles:Init-activate",_),p.getActiveTour()?v():_(),n.$on("checkRoutes",function(){S()})}e.$inject=["$log","$state","moment","plannerService","$rootScope","naturalService","$translate","$filter","$window","marketingService","accountConfigsService","TourFake","TourManager","$scope"],angular.module("icarus.planner").controller("PlannerVehiclesListController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p){function m(){function i(e){if(r.hideVisits(),r.hideRoutes(),S.vehicle=e.vehicle,S.vehicle.driver){var t;try{t=JSON.parse(S.vehicle.driver)}catch(i){t=S.vehicle.driver}S.vehicle.driver=t}S.vehicle.setEditMode(),r.centerVehicle(S.vehicle),C={name:S.vehicle.name,capacity:S.vehicle.capacity,capacity2:S.vehicle.capacity2,capacity3:S.vehicle.capacity3,driver:S.vehicle.driver,locationStart:{address:S.vehicle.locationStart.address,latitude:S.vehicle.locationStart.latitude,longitude:S.vehicle.locationStart.longitude},locationEnd:{address:S.vehicle.locationEnd.address,latitude:S.vehicle.locationEnd.latitude,longitude:S.vehicle.locationEnd.longitude},shift:{start:S.vehicle.shift.start,end:S.vehicle.shift.end},skills:[]},angular.copy(S.vehicle.skills,C.skills),S.drivers=e.drivers,S.skills=e.skills,S.skills.map(function(e){e.id=String(e.id)}),y()}function o(t){e.info(t),404===t.status&&(c.push("error",E("Planner_toast.vehicle_not_found")),n.go("^"))}u.callGoogleTrackConversion("rlQ5CJL7_2wQndigwgM");try{I=p.createAutoCompleteService(),k=p.createPlacesService(t[0].createElement("div"))}catch(l){e.error(l)}return a.all({vehicle:r.getVehicle(s.vehicleId),drivers:r.getDrivers(),skills:r.getSkills()}).then(i,o)}function v(e){var t=a.defer();return I.getPlacePredictions({input:e,types:["address"]},function(e,i){i===p.placesServiceStatusOk()?t.resolve(e):t.reject(i)}),t.promise}function g(t,a){k.getDetails({placeId:t.place_id},function(n,s){if(s===p.placesServiceStatusOk()){r.getGmap().setZoom(11);var o=parseFloat(n.geometry.location.lat().toFixed(6)),l=parseFloat(n.geometry.location.lng().toFixed(6));a.setLocationStart(n.formatted_address,o,l),i.$apply(),r.centerVehicle(a)}else e.error(s,t,a)})}function h(t,a){k.getDetails({placeId:t.place_id},function(n,s){if(s===p.placesServiceStatusOk()){r.getGmap().setZoom(11);var o=parseFloat(n.geometry.location.lat().toFixed(6)),l=parseFloat(n.geometry.location.lng().toFixed(6));a.setLocationEnd(n.formatted_address,o,l),i.$apply(),r.centerVehicle(a)}else e.error(s,t,a)})}function _(){var e,t=/^([0-1]?[0-9]|2[0-3])(:[0-5][0-9])?$/;if(S.vehicle.shift.start){if(!(e=S.vehicle.shift.start.match(t)))return S.form.$valid=!1,void(S.invalidDate=!0);S.form.$valid=!0,S.invalidDate=!1}else S.form.$valid=!0,S.invalidDate=!1,S.vehicle.shift.start=null;if(S.vehicle.shift.end){if(!(e=S.vehicle.shift.end.match(t)))return S.form.$valid=!1,void(S.invalidDate=!0);S.form.$valid=!0,S.invalidDate=!1}else S.form.$valid=!0,S.invalidDate=!1,S.vehicle.shift.end=null;return S.vehicle.shift.start&&(S.vehicle.shift.start=moment(S.vehicle.shift.start,"HH:mm").format("HH:mm")),S.vehicle.shift.end&&(S.vehicle.shift.end=moment(S.vehicle.shift.end,"HH:mm").format("HH:mm")),S.vehicle.shift.start||S.vehicle.shift.end?S.vehicle.shift.start>S.vehicle.shift.end||S.vehicle.shift.start===S.vehicle.shift.end?(S.form.$valid=!1,void(S.timeBetweenDate=!0)):(S.form.$valid=!0,S.timeBetweenDate=!1,void(!S.vehicle.shift.start&&S.vehicle.shift.end||S.vehicle.shift.start&&!S.vehicle.shift.end?(S.form.$valid=!1,S.emptyDate=!0):(S.form.$valid=!0,S.emptyDate=!1))):(S.emptyDate=!1,void(S.timeBetweenDate=!1))}function f(){A(),S.form.$valid&&(w(),S.vehicle.capacity=x(S.vehicle.capacity),S.vehicle.capacity2=S.vehicle.capacity2?x(S.vehicle.capacity2):0,S.vehicle.capacity3=S.vehicle.capacity3?x(S.vehicle.capacity3):0,D=!0,n.go("^.vehicles-list"))}function b(){var e=S.vehicle.skills;e.forEach(function(e){e||S.vehicle.skills.splice(S.vehicle.skills.indexOf(e),1)})}function y(){for(var e=0;e<S.vehicle.skills.length;e++){var t=S.vehicle.skills[e],i=d.find(S.skills,function(e){return e.id===t});i&&(S.skillsVehicle[i.id]=!0)}}function w(){Object.keys(S.skillsVehicle).forEach(function(e){-1===S.vehicle.skills.indexOf(e)&&S.skillsVehicle[e]?S.vehicle.skills.push(e):S.vehicle.skills.indexOf(e)>-1&&!S.skillsVehicle[e]&&S.vehicle.skills.splice(S.vehicle.skills.indexOf(e),1)})}function A(){return S.invalidDate||S.timeBetweenDate||S.emptyDate?void(S.form.$valid=!1):S.vehicle.name&&S.vehicle.capacity&&S.vehicle.locationStart.address&&S.vehicle.locationEnd.address?void 0:void(S.form.$valid=!1)}function x(e){e=String(e);var t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return"es"===t.substring(0,2).toLowerCase()?(e=e.split(".").join("").replace(",","."),parseFloat(e)):(e=e.split(",").join(""),parseFloat(e))}var k,I,S=this,E=l("translate"),C=null,D=!1;S.vehicle=null,S.drivers=null,S.skills=[],S.skillsVehicle={},S.form={},S.save=f,S.getPlaces=v,S.startAddressSelected=g,S.endAddressSelected=h,S.getPlaces=v,S.startAddressSelected=g,S.endAddressSelected=h,S.validateTime=_,m(),i.$on("$destroy",function(){var e=r.shift;S.vehicle.options.animation=0,S.vehicle.setEditMode(!1),S.vehicle.selected=!1,S.vehicle.shift.start||(S.vehicle.shift.start=e.start),S.vehicle.shift.end||(S.vehicle.shift.end=e.end),D?b():d.merge(S.vehicle,C)})}e.$inject=["$log","$document","$scope","$q","$state","$stateParams","$window","plannerService","$filter","Toasts","lodash","marketingService","googleService"],angular.module("icarus.planner").controller("PlannerVehiclesDetailController",e)}(),function(){"use strict";function e(e){function t(e,t,a){var n;return e&&t?(n=e.filter(function(e){return i(e,t,a)?e:void 0}),n||(n=[]),n):[]}function i(t,i,a){return a&&t&&i&&t.address===i.address&&e.isEqual(t.skills_required,i.skills_required)&&t.id!==i.id}return{getSimilar:t,isSimilar:i}}e.$inject=["lodash"],angular.module("icarus.planner").factory("visitSimilarService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l){function c(e){this.backendId=null,this.plannedDate=null,this.title="",this.address="",this.latitude=null,this.longitude=null,this.contactName="",this.contactPhone="",this.contactEmail="",this.duration=g,this.notes="",this.reference="",this.load=null,this.load2=null,this.load3=null,this.priority=!1,this.windowStart=null,this.windowEnd=null,this.windowStart2=null,this.windowEnd2=null,this.routeId=null,this.vehicle=null,this.numRoute=null,this.country="",this.administrative_area="",this.estimatedTimeArrival=null,this.estimatedTimeDeparture=null,this.skills_required=[],this.skills_optional=[],this.order=null,this.zIndex=0,this.id=e||d(),this.options={animation:0,visible:!0,draggable:!1,icon:{path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z",fillColor:"#A4A4A4",fillOpacity:1,strokeWeight:1,strokeColor:tinycolor("#A4A4A4").darken(15).toString(),anchor:{x:10,y:31}},labelClass:"marker_labels",labelAnchor:l.createPoint(15,13),labelContent:""},this.error=null,this.status=1,this.editMode=!1,this.highlight=!1,this.active=!1,this.capacityError=!1,this.capacityError2=!1,this.capacityError3=!1,this.timeError=!1,this.skillsError=!1,this.indicatorError=null,this.selected=!1,this.defaultColor="#A4A4A4",this.sms_enabled=!1,this.windowOneError=!1,this.windowTwoError=!1,this.OverlappingWindowError=!1,this.checked=!1,this.hover=!1,this.priorityLevel=null,this.zones=[]}function d(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function u(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return i}function p(e,t,i){var a="";return a+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container">',a+=t?'<i class="'+i+'" class="sp-text-color-danger"></i>':'<i class="'+i+'"></i>',a+='</div><div class="sp-planner-infowindow-desc-container"><span>'+r("formatNumber")(e,2,".",",")+"</span></div></div>"}function m(e,t){var i="",a="",n=0,s=0;for(n=0;n<e.length;n++){for(a="",s=0;s<t.length;s++)t[s].id===e[n]&&(a=t[s].name);i+=n===e.length-1?"<span>"+a+"</span>":"<span>"+a+", </span>"}return i}function v(e){for(var t="",i=0;i<e.length;i++)t+=i===e.length-1?"<span>"+e[i].name+"</span>":"<span>"+e[i].name+", </span>";return t}var g=10,h="#A4A4A4",_="23:59";return c.prototype.save=function(i,s){function r(e){e&&(u.backendId=e.data.id)}function l(t){return e.error(t),n.reject(t)}angular.isUndefined(s)&&(s=this.plannedDate);var c=a.API_URL+"routes/visits/",d={title:this.title,address:this.address,latitude:this.latitude.toFixed(6),longitude:this.longitude.toFixed(6),load:parseFloat(parseFloat(this.load).toFixed(2)),load_2:this.load2?parseFloat(parseFloat(this.load2).toFixed(2)):0,load_3:this.load3?parseFloat(parseFloat(this.load3).toFixed(2)):0,window_start:""===this.windowStart||null===this.windowStart?"00:00":this.windowStart,window_end:""===this.windowEnd||null===this.windowEnd?"23:59":this.windowEnd,window_start_2:""===this.windowStart2||null===this.windowStart2?"23:59":this.windowStart2,window_end_2:""===this.windowEnd2||null===this.windowEnd2?"23:59":this.windowEnd2,duration:this.duration.toString().split(":").length>=3?this.duration:this.duration+":00",contact_name:this.contactName,contact_phone:this.contactPhone,contact_email:this.contactEmail,reference:this.reference,notes:this.notes,order:this.order,priority:this.priority,planned_date:o(s).format("YYYY-MM-DD"),route:i,estimated_time_arrival:this.estimatedTimeArrival,estimated_time_departure:this.estimatedTimeDeparture,skills_optional:this.skills_optional,skills_required:this.skills_required,sms_enabled:this.sms_enabled},u=this;return angular.isUndefined(u.backendId)||null===u.backendId?t.post(c,d).then(r,l):t.put(c+u.backendId+"/",d).then(r,l)},c.prototype.setEditMode=function(e){angular.isUndefined(e)?this.editMode=!0:this.editMode=e,this.editMode?(this.setHighlight(!1,!0),this.options.draggable=!0,this.setVisible()):(this.options.draggable=!1,this.setVisible(!1))},c.prototype.setVisible=function(e,t){angular.isUndefined(e)&&(e=!0),angular.isUndefined(t)&&(t=!0),this.options.visible=e,t&&this.actionUpdateLight()},c.prototype.setHighlight=function(e,t){this.active||(angular.isUndefined(t)&&(t=!1),this.highlight=!!e,t&&!this.selected&&(this.highlight?this.options.icon.fillColor=tinycolor(this.defaultColor).darken(25).toString():this.options.icon.fillColor=this.defaultColor))},c.prototype.setSelected=function(e,t,i){angular.isUndefined(t)&&(t=!1),angular.isUndefined(i)&&(i=!0),this.selected=e,t&&(e?this.options.icon.fillColor=tinycolor(this.defaultColor).darken(30).toString():this.options.icon.fillColor=this.defaultColor,i&&this.actionUpdate(this))},c.prototype.setDarkerHighlight=function(e,t){if(!this.active){angular.isUndefined(t)&&(t=!1);var i=this;this.highlight=!!e,t&&!this.selected&&(this.highlight?s.$broadcast("Planner:Highlight:Visit",{visit:i}):s.$broadcast("Planner:notHighlight:Visit",{visit:i}))}},c.prototype.setActive=function(e){this.active=!!e,this.highlight=!!e},c.prototype.setPosition=function(e,t){angular.isUndefined(e)||angular.isUndefined(t)||(this.latitude=e,this.longitude=t,this.actionUpdate(this))},c.prototype.setError=function(e){if(!angular.isUndefined(e)){switch(this.error=e,e.type){case 2:this.options.icon.fillColor="#FFCC33",this.setDefaultColor("#FFCC33"),this.status=2;break;case 3:this.options.icon.fillColor="#e67e22",this.setDefaultColor("#e67e22"),this.status=3;break;case 4:this.setDefaultColor("#FF5252"),this.options.icon.fillColor="#FF5252",this.status=4;break;default:this.options.icon.fillColor=this.defaultColor,
this.status=1}this.actionUpdate(this)}},c.prototype.setIndicatorError=function(e){if(!angular.isUndefined(e)){switch(this.indicatorError=e,e.type){case 4:this.setDefaultColor("#FF5252");break;default:this.options.icon.fillColor=this.defaultColor}this.actionUpdate(this)}},c.prototype.removeError=function(e){angular.isUndefined(e)&&(e=h),this.error=null,this.status=1,this.setDefaultColor(e),this.actionUpdate(this)},c.prototype.removeIndicatorError=function(e){angular.isUndefined(e)&&(e=h),this.indicatorError=null,this.setDefaultColor(e),this.actionUpdate(this)},c.prototype.removeIndicatorsErrors=function(){this.capacityError=!1,this.capacityError2=!1,this.capacityError3=!1,this.timeError=!1,this.skillsError=!1},c.prototype.setOpacity=function(e){this.options.icon.fillOpacity=e,1===e?this.options.icon.strokeColor=tinycolor(this.options.icon.fillColor).darken(15).toString():this.options.icon.strokeColor=tinycolor(this.options.icon.fillColor).lighten(15).toString(),this.actionUpdateLight()},c.prototype.setDefaultColor=function(e){this.defaultColor=e,this.options.icon.fillColor=e,this.options.icon.strokeColor=tinycolor(e).darken(15).toString()},c.prototype.procureVisitStatus=function(){var e=this.status;switch(e){case 2:this.setDefaultColor("#FFCC33"),this.status=2;break;case 3:this.options.icon.fillColor="#e67e22",this.setDefaultColor("#e67e22"),this.status=3;break;case 4:this.setDefaultColor("#FF5252"),this.status=4;break;default:this.setDefaultColor(h),this.status=1}},c.prototype.setOriginalIconColor=function(){var e=this.status;switch(e){case 2:this.setIconFillColor("#FFCC33"),this.status=2;break;case 3:this.options.icon.fillColor="#e67e22",this.setDefaultColor("#e67e22"),this.status=3;break;case 4:this.setIconFillColor("#FF5252"),this.status=4;break;default:this.setIconFillColor(this.defaultColor),this.status=1}},c.prototype.setIconFillColor=function(e){this.options.icon.fillColor=e,this.options.icon.strokeColor=tinycolor(e).darken(15).toString(),this.actionUpdateLight(this)},c.prototype.setLabelContent=function(e){this.options.labelContent=e||"",this.options.labelClass=null!==e&&""!==e?"marker_labels":"marker_labels-empty";var t=this.options.labelContent.toString().length;switch(t){case 1:this.options.labelAnchor=l.createPoint(-1,27);break;case 2:this.options.labelAnchor=l.createPoint(2,27);break;case 3:this.options.labelAnchor=l.createPoint(4,27);break;default:this.options.labelAnchor=l.createPoint(-1,27)}this.actionUpdateLight(this)},c.prototype.updateOrder=function(e){this.order=e,this.setLabelContent(this.order)},c.prototype.getPriority=function(){var e=0;return null!==this.priorityLevel?this.priorityLevel>=0&&this.priorityLevel<=5&&(e=this.priorityLevel):(1===this.priority||this.priority===!0)&&(e=1),e},c.prototype.getCPriority=function(){var e=!1;switch(this.priority){case 1:e=!0;break;case!0:e=!0;break;default:e=!1}return e},c.prototype.getZones=function(){var e=[];return this.zones.forEach(function(t){e.push(parseInt(t.id))}),e},c.prototype.actionCreate=function(e){s.$broadcast("Planner:Visit:Create",{visit:e})},c.prototype.actionCreateLight=function(){s.$broadcast("Planner:Visit:CreateMarkerLight",{visit:this})},c.prototype.actionUpdate=function(e){s.$broadcast("Planner:Visit:Update",{visit:e})},c.prototype.actionUpdateLight=function(){s.$broadcast("Planner:Visit:UpdateMarkerLight",{visit:this})},c.prototype.actionRemove=function(e){s.$broadcast("Planner:Visit:Remove",{visit:e})},c.prototype.actionPaintOnMap=function(){var e=this;e.options.visible=!0,s.$broadcast("Planner:Visit:Create",{visit:e})},c.prototype.ifMarkerNotCreatedThenCreate=function(){var e=this;s.$broadcast("Planner:Visit:ifMarkerNotCreatedThenCreate",{visit:e})},c.prototype.updateLocation=function(t){var i=this,a={},n=new google.maps.Geocoder;a=t.latLng;var o={location:a};n.geocode(o,function(t,n){n===google.maps.GeocoderStatus.OK?t[0]?(i.latitude=a.lat(),i.longitude=a.lng(),i.address=t[0].formatted_address,i.actionUpdate(i),s.$apply()):e.error("No reverse geocode results found",o):e.error(n,o)})},c.prototype.areValidVisitWindowTimes=function(){this.windowOneError=!1,this.windowTwoError=!1,this.OverlappingWindowError=!1;var e=!0,t=this.windowStart?o(this.windowStart,"HH:mm"):null,i=this.windowEnd?o(this.windowEnd,"HH:mm"):null,a=this.windowStart2?o(this.windowStart2,"HH:mm"):null,n=this.windowEnd2?o(this.windowEnd2,"HH:mm"):null;return this.windowStart&&this.windowEnd&&t.isAfter(i)?(this.windowOneError=!0,this.status=4,this.error={type:4,msg:r("translate")("Visits.alert_notification.error_window")},e=!1):this.windowStart2&&this.windowEnd2&&a.isAfter(n)?(this.windowTwoError=!0,this.status=4,this.error={type:4,msg:r("translate")("Visits.alert_notification.error_window")},e=!1):this.windowStart&&this.windowEnd&&this.windowStart2&&this.windowEnd2&&i.isAfter(a)?(this.OverlappingWindowError=!0,this.status=4,this.error={type:4,msg:r("translate")("Visits.alert_notification.error_window")},e=!1):!this.windowStart&&!this.windowEnd||!this.windowStart2&&!this.windowEnd2||this.windowStart&&this.windowEnd&&this.windowStart2&&this.windowEnd2||!this.windowStart&&this.windowEnd&&this.windowStart2&&!this.windowEnd2||this.windowStart&&this.windowEnd&&this.windowStart2&&!this.windowEnd2||!this.windowStart&&this.windowEnd&&this.windowStart2&&this.windowEnd2||(this.OverlappingWindowError=!0,this.status=4,this.error={type:4,msg:r("translate")("Visits.alert_notification.error_window")},e=!1),e},c.prototype.getInfoWindowHTML=function(t){var a=n.defer(),s=null,o=this.vehicle,r=null,l=this.load,c=this.load2,d=this.load3,g=this.title,h=this.notes,f=this.routeId,b=this.address,y=this.duration,w=this.windowEnd,A=this.windowStart2,x=this.windowEnd2,k=this.timeError,I=this.windowStart,S=this.capacityError,E=this.capacityError2,C=this.capacityError3,D=this.skills_required,P=this.skills_optional,L=this.estimatedTimeArrival,O=this.skillsError,T=this.zones?this.zones:[];return this.estimatedTimeArrival&&(L=this.estimatedTimeArrival>="12"?this.estimatedTimeArrival+" PM":this.estimatedTimeArrival+" AM"),plannerService.getPlan().then(function(e){for(var n=0;n<e.vehicles.length;n++)e.vehicles[n].id===o&&(r=e.vehicles[n].name,s=u(e.vehicles[n].routes,f)+1);var V='<div class="sp-planner-infowindow"><div class="sp-planner-infowindow-title">'+g+'</div><div class="sp-planner-infowindow-content">';b&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-map-pin"></i></div><div class="sp-planner-infowindow-desc-container" ng-if="parameter.address"><span style="font-style: italic">'+b+"</span></div></div>"),l&&(V+=p(l,S,"sp-icon-carga-peso-outline")),c&&(V+=p(c,E,"sp-icon-carga-volumen-outline")),d&&(V+=p(d,C,"sp-icon-carga-valor-outline")),(I||w)&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container">',V+=k?'<i class="sp-icon-ventana-horaria" class="sp-text-color-danger"></i>':'<i class="sp-icon-ventana-horaria"></i>',V+='</div><div class="sp-planner-infowindow-desc-container">',I&&!w?V+="<span>"+i.instant("Planner.infowindow_since")+" "+I+"</span>":I&&w?V+="<span>"+I+" "+i.instant("Planner.infowindow_to")+" "+w+"</span>":!I&&w&&(V+=i.instant("Planner.infowindow_until_to")+" "+w+"</span>"),V+="</div></div>"),(A||x)&&A!==_&&x!==_&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container">',V+=k?'<i class="sp-icon-ventana-horaria" class="sp-text-color-danger"></i>':'<i class="sp-icon-ventana-horaria"></i>',V+='</div><div class="sp-planner-infowindow-desc-container">',A&&!x?V+="<span>"+i.instant("Planner.infowindow_since")+" "+A+"</span>":A&&x?V+="<span>"+A+" "+i.instant("Planner.infowindow_to")+" "+x+"</span>":!A&&x&&(V+=i.instant("Planner.infowindow_until_to")+" "+x+"</span>"),V+="</div></div>"),y&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-tiempo-servicio"></i></div>',V+='<div class="sp-planner-infowindow-desc-container"><span>'+y+"</span></div></div>"),D.length>0&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container">',V+=O?'<i class="sp-icon-skills" class="sp-text-color-danger"></i>':'<i class="sp-icon-skills"></i>',V+='</div><div class="sp-planner-infowindow-desc-container">',V+=m(D,t),V+="</div></div>"),P.length>0&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container">',V+=O?'<i class="sp-icon-skills-opcionales" class="sp-text-color-danger"></i>':'<i class="sp-icon-skills-opcionales"></i>',V+='</div><div class="sp-planner-infowindow-desc-container">',V+=m(P,t),V+="</div></div>"),h&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-notes"></i></div>',V+='<div class="sp-planner-infowindow-desc-container"><span>'+h+"</span></div></div>"),L&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="fa fa-clock-o"></i></div>',V+='<div class="sp-planner-infowindow-desc-container"><span>'+L+"</span></div></div>"),r&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-vehiculos"></i></div>',V+='<div class="sp-planner-infowindow-desc-container"><span>'+r+"</span></div></div>"),s&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-rutas"></i></div>',V+='<div class="sp-planner-infowindow-desc-container"><span>'+i.instant("Routes.route_text")+" "+s+"</span></div></div>"),T.length>0&&(V+='<div class="sp-planner-infowindow-prop"><div class="sp-planner-infowindow-icon-container"><i class="sp-icon-tracking"></i></div><div class="sp-planner-infowindow-desc-container">',V+=v(T),V+="</div></div>"),V+="</div></div>",a.resolve(V)},function(t){e.info(t),a.reject(t)}),a.promise},c}e.$inject=["$log","$http","$translate","__env","$q","$rootScope","moment","$filter","googleService"],angular.module("icarus.planner").factory("PlannerVisitModel",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(e){if(!e)throw new Error("PlannerVehicleModel: id required");if("string"!=typeof e)throw new Error("PlannerVehicleModel: id should be a string");this.backendId=e,this.name=null,this.initials="",this.capacity=null,this.capacity2=null,this.capacity3=null,this.driverId=null,this.locationStart={address:null,latitude:null,longitude:null},this.locationEnd={address:null,latitude:null,longitude:null},this.skills=[],this.color=null,this.colorDarker=null,this.id=e,this.locationStartMarker=null,this.locationEndMarker=null,this.shift={},this.shiftDefault={},this.active=!0,this.enabled=!0,this.routes=[],this.refill=0,this.options={draggable:!1,visible:!1,icon:{path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z",fillColor:"#41D3BD",fillOpacity:1,strokeWeight:0,anchor:{x:8,y:5}}},this.optionsEnd={draggable:!1,visible:!1,icon:{path:"M16,2.057c-5.633,0-10.215,4.582-10.215,10.214c0,5.39,9.1,16.896,9.486,17.383,c0.176,0.223,0.445,0.352,0.729,0.352s0.553-0.129,0.729-0.352c0.388-0.487,9.486-11.993,9.486-17.383,C26.215,6.639,21.632,2.057,16,2.057z",fillColor:"#41D3BD",fillOpacity:1,strokeWeight:0,anchor:{x:9,y:5}}},this.available={msg:"",value:!0},this.actionCreate(this)}function p(e,t,a,s,r){var l=n.defer();l.resolve();var c=Boolean(s.join),u=Boolean(s.open_ended),h=Boolean(s.big_cluster),_=m(s),y=!1,A=!1,x=!1,k=l.promise;if(!angular.isUndefined(t[a])){t[a].totalLoad=0,t[a].totalLoad2=0,t[a].totalLoad3=0;var I=1;r&&t[a].clearCapacityErrors(),t[a].visits.map(function(i){if(i.updateOrder(I),I++,r||!h){y=v(i,e,t[a],y,"load"),A=v(i,e,t[a],A,"load2"),x=v(i,e,t[a],x,"load3");var n=e.validateVisitSkills(i);t[a].skillsError=Boolean(n),i.skillsError=Boolean(n)}}),t[a].totalLoadPercentage=(t[a].totalLoad/e.capacity*100).toFixed(1),t[a].formattedLoad=d("formatNumber")(t[a].totalLoad,2)+"/"+d("formatNumber")(e.capacity,2),e.capacity2&&(t[a].totalLoadPercentage2=(t[a].totalLoad2/e.capacity2*100).toFixed(1),t[a].formattedLoad2=d("formatNumber")(t[a].totalLoad2,2)+"/"+d("formatNumber")(e.capacity2,2)),e.capacity3&&(t[a].totalLoadPercentage3=(t[a].totalLoad3/e.capacity3*100).toFixed(1),t[a].formattedLoad3=d("formatNumber")(t[a].totalLoad3,2)+"/"+d("formatNumber")(e.capacity3,2));var S=[];S.push(e.locationStart.latitude+","+e.locationStart.longitude),t[a].visits.map(function(e){S.push(e.latitude+","+e.longitude)}),u&&!h&&angular.isUndefined(t[a+1])||S.push(e.locationEnd.latitude+","+e.locationEnd.longitude);var E=angular.copy(S);(h||o.drawCluster)&&(S.shift(),S.pop(),b(t[a],S)),k=n.all([g(e,t[a],E,h,c,_),f(t[a],S,h)]).then(function(){w(t,e,a),a++,p(e,t,a,s,r)})["catch"](function(e){i.error("OSRM Error",e)})}return k}function m(e){return e.fmv||S}function v(e,t,i,a,n){switch(n){case"load":e.load&&(i.totalLoad=i.totalLoad+e.load,i.totalLoad>t.capacity?(e.capacityError=!0,i.capacityError=!0,a=!0):(a||(i.capacityError=!1),e.capacityError=!1));break;case"load2":if(e.load2){if(i.totalLoad2=i.totalLoad2+e.load2,!t.capacity2){e.capacityError2=!0,i.capacityError2=!0,a=!0;break}i.totalLoad2>t.capacity2?(e.capacityError2=!0,i.capacityError2=!0,a=!0):(a||(i.capacityError2=!1),e.capacityError2=!1)}break;case"load3":if(e.load3){if(i.totalLoad3=i.totalLoad3+e.load3,!t.capacity3){e.capacityError3=!0,i.capacityError3=!0,a=!0;break}i.totalLoad3>t.capacity3?(e.capacityError3=!0,i.capacityError3=!0,a=!0):(a||(i.capacityError3=!1),e.capacityError3=!1)}}return a}function g(e,n,o,r,l,d){var u=t.OSRM_URL+"table";return a.get(u,{params:{loc:o},headers:{Authorization:void 0}}).then(function(t){e.isTheFirstRoute(n.id)&&(n.estimatedTimeStart=e.shift.start);var i=t.data.distance_table,a=s(n.estimatedTimeStart,I),o=s.duration(0);if(n.timeError=!1,i){if(n.visits[0]){var u=s(n.visits[0].windowStart,I),p=i[0][1]*d/10;u.subtract(p,"seconds"),a.isBefore(u)&&(n.estimatedTimeStart=u.format(I),a=s(n.estimatedTimeStart,I))}for(var m=0;m<i.length;m++){var v=!1,g=0;if(m<n.visits.length){var f=n.visits[m];if(f.timeError=!1,m-1>=0){var b=n.visits[m-1];v=c.isSimilar(b,f,l)}(!v||v&&0===m)&&(g=i[m][m+1]*d/10,a.add(g,"seconds"),o.add(g,"seconds")),a.isBefore(s(f.windowStart,I),"minute")&&(a=s(f.windowStart,I),o=o.add(a.diff(s(f.windowStart,I),"seconds"),"seconds")),f.estimatedTimeArrival=a.format("HH:mm"),f.windowStart2&&f.windowEnd2&&"23:59"!==f.windowStart2&&"23:59"!==f.windowEnd2?(a.isAfter(s(f.windowEnd,I))&&a.isBefore(s(f.windowStart2,I))&&(a=s(f.windowStart2,I),f.estimatedTimeArrival=a.format("HH:mm"),o=o.add(a.diff(s(f.windowStart2,I),"seconds"),"seconds")),(!a.isBetween(s(f.windowStart,"HH:mm"),s(f.windowEnd,"HH:mm"),null,"[]")&&!a.isBetween(s(f.windowStart2,"HH:mm"),s(f.windowEnd2,"HH:mm"),null,"[]")||e.shift.end&&a.isAfter(s(e.shift.end,"HH:mm"),"minute"))&&(r||(f.timeError=!0,n.timeError=!0))):(!a.isBetween(s(f.windowStart,"HH:mm"),s(f.windowEnd,"HH:mm"),null,"[]")||e.shift.end&&a.isAfter(s(e.shift.end,"HH:mm"),"minute"))&&(r||(f.timeError=!0,n.timeError=!0)),_(m,f,n,l)||(a.add(f.duration,"minutes"),o.add(f.duration,"minutes")),f.estimatedTimeDeparture=a.format(I)}else g=i[m][m+1]*d/10,a.add(g,"seconds"),o.add(g,"seconds"),n.estimatedTimeEnd=a.format(I),e.shift.end&&a.isAfter(s(e.shift.end,I),"minute")&&(r||(n.timeError=!0))}o._data.days&&parseInt(o._data.days)>0?(n.totalTime=s(o._data).format(k),n.totalTimeFormatted=n.totalTime):(n.totalTime=s(o._data).format(I),n.totalTimeFormatted=h(n.estimatedTimeStart,n.estimatedTimeEnd))}else n.totalTime=E,n.totalTimeFormatted=E},function(e){i.error("Unable to get distance table from "+u+" for route "+n.id+". "+e.data)})}function h(e,t){var i,a=s.utc(e,I),n=s.utc(t,I);return n.isBefore(a)&&n.add(1,"day"),i=s.duration(n.diff(a)),s.utc(+i).format("H:mm")}function _(e,t,i,a){var n=!1;if(e+1<i.visits.length){var s=i.visits[e+1];n=c.isSimilar(s,t,a)}return n}function f(e,t,a,n){var s;return s=n?!0:!1,l.callOsrmViaroute(t,s).then(function(i){if(207===i.data.status)f(e,t,a,!0);else if(0===i.data.status){var n=i.data.route_summary;e.totalDistance=n.total_distance/1e3,a||o.drawCluster||(e.path=y(i.data.route_geometry,6)),e.actionUpdate(e)}})["catch"](function(e){i.info("Error _callOSRMForDistance ",e)})}function b(e,t){var i=new ConvexHullGrahamScan;if(t.forEach(function(e){var t=e.split(","),a=t[0].trim(),n=t[1].trim();i.addPoint(n,a)}),i.points.length>0){var a=i.getHull();a=a.map(function(e){return r.getGoogleMapsLatLng(e.y,e.x)}),e.path=a}}function y(e,t){t=Math.pow(10,-t);for(var i=e?e.length:0,a=0,n=0,s=0,o=[];i>a;){var l,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var u=1&d?~(d>>1):d>>1;n+=u,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var p=1&d?~(d>>1):d>>1;s+=p;var m={latitude:n*t,longitude:s*t};o.push(r.getGoogleMapsLatLng(m.latitude,m.longitude))}return o}function w(e,t,i){if(e.length>i+1){var a=60*t.refill;e[i+1].estimatedTimeStart=s(e[i].estimatedTimeEnd,I).add(a,"seconds").format(I)}}function A(e){var t="00:00:00";return t=e.startTime?s(e.startTime).format("HH:mm:ss"):e.estimatedTimeStart}function x(e){var t="00:00:00";return t=e.endTime?s(e.endTime).format("HH:mm:ss"):e.estimatedTimeEnd}var k="D HH:mm",I="HH:mm",S=2,E="00:00";return u.fromJson=function(e){var t=new u(e.id.toString());return t.name=e.name,t.capacity=e.capacity,t.capacity2=e.capacity_2,t.capacity3=e.capacity_3,t.locationStart={address:e.location_start_address,latitude:parseFloat(e.location_start_latitude)||0,longitude:parseFloat(e.location_start_longitude)||0},t.locationEnd={address:e.location_end_address,latitude:parseFloat(e.location_end_latitude)||0,longitude:parseFloat(e.location_end_longitude)||0},t.skills=e.skills.map(function(e){return e.toString()}),t.color=e.color,t.colorDarker=tinycolor(e.color).darken(30).toString(),t.shift={start:e.shift_start,end:e.shift_end},t.shiftDefault={start:e.shift_start,end:e.shift_end},t},u.prototype.activate=function(){this.active=!0},u.prototype.setLocationStart=function(e,t,i){this.locationStart.address=e,this.locationStart.latitude=t,this.locationStart.longitude=i},u.prototype.setLocationEnd=function(e,t,i){this.locationEnd.address=e,this.locationEnd.latitude=t,this.locationEnd.longitude=i},u.prototype.showAllRoutes=function(e,t,i){var a=i.big_cluster,n=i.open_ended;angular.isUndefined(e)&&(e=!0),angular.isUndefined(t)&&(t=!0),angular.isUndefined(a)&&(a=!1),angular.isUndefined(n)&&(n=!1),e?(t&&(this.setVisible(!0,n),this.setOpacity(1)),this.routes.map(function(e){e.setVisibleWithoutOpacity(),a?(e.setVisible(),e.collapse||o.$broadcast("Planner:Routes:showMarkersOfRoute",{route:e})):e.visits.map(function(e){e.setVisible(!0)})})):(this.setVisible(!1,n),this.routes.map(function(e){e.setVisibleWithoutOpacity(!1),a?(e.setVisible(!1),e.collapse||o.$broadcast("Planner:Routes:hideMarkersOfRoute",{route:e})):e.visits.map(function(e){e.setVisible(!1)})}))},u.prototype.setEditMode=function(e){angular.isUndefined(e)&&(e=!0),e?(this.options.draggable=!0,this.optionsEnd.draggable=!0,this.setVisible()):(this.options.draggable=!1,this.optionsEnd.draggable=!1,this.setVisible(!1))},u.prototype.setVisible=function(e,t){angular.isUndefined(e)&&(e=!0),angular.isUndefined(t)&&(t=!1),e?(this.options.visible=!0,t||(this.optionsEnd.visible=!0)):(this.options.visible=!1,this.optionsEnd.visible=!1),this.actionUpdate(this)},u.prototype.setOpacity=function(e){this.options.icon.fillOpacity=e,this.optionsEnd.icon.fillOpacity=e,this.actionUpdate(this)},u.prototype.createRoute=function(){var t=this.shift.start;this.routes.length>0&&(t=this.routes[this.routes.length-1].estimatedTimeEnd);var i=new e(this.id);return i.estimatedTimeStart=t,i.estimatedTimeEnd=t,angular.copy(this.locationStart,i.locationStart),angular.copy(this.locationEnd,i.locationEnd),this.routes.push(i),i},u.prototype.addRoute=function(e){return angular.copy(this.locationStart,e.locationStart),angular.copy(this.locationEnd,e.locationEnd),e.setStrokeColor(this.color),this.routes.push(e),e},u.prototype.removeRoute=function(e){e.clear(),this.routes.splice(this.routes.indexOf(e),1)},u.prototype.clear=function(){this.routes.forEach(function(e){e.clear()}),this.routes.length=0},u.prototype.setIconFillColorWithVehicleColor=function(){this.options.icon.fillColor=this.color,this.optionsEnd.icon.fillColor=this.color,this.actionUpdate(this)},u.prototype.setIconFillColorWithDefaultColor=function(){this.options.icon.fillColor="#41D3BD",this.optionsEnd.icon.fillColor="#41D3BD",this.actionUpdate(this)},u.prototype.validateVisitSkills=function(e){var t=this,i=!1;if((e.skills_required.length>0||e.skills_optional.length>0)&&0===t.skills.length)return!0;if(e.skills_required&&e.skills_required.length>0&&(e.skills_required.forEach(function(e){return-1===t.skills.indexOf(String(e))?void(i=!0):void 0}),i))return i;if(e.skills_optional&&e.skills_optional.length>0){var a=0;if(e.skills_optional.forEach(function(e){-1===t.skills.indexOf(String(e))&&a++}),a===e.skills_optional.length)return!0}return!1},u.prototype.recalculateRouteStartingAt=function(e,t){var i=0;return angular.forEach(this.routes,function(t,a){t.id===e.id&&(i=a)}),p(this,this.routes,i,t,!0)},u.prototype.recalculateAllRoutes=function(e){return p(this,this.routes,0,e,!1)},u.prototype.actionCreate=function(e){o.$broadcast("Planner:Vehicle:Create",{vehicle:e})},u.prototype.actionUpdate=function(e){o.$broadcast("Planner:Vehicle:Update",{vehicle:e})},u.prototype.actionRemove=function(e){o.$broadcast("Planner:Vehicle:Remove",{vehicle:e})},u.prototype.updateLocationStart=function(e){var t=this,a={},n=r.createGeocode();a=e.latLng;var s={location:a};n.geocode(s,function(e,n){n===r.geocoderStatusOK()?e[0]?(t.locationStart.latitude=a.lat().toFixed(6),t.locationStart.longitude=a.lng().toFixed(6),t.locationStart.address=e[0].formatted_address,t.actionUpdate(t),o.$apply()):i.error("No reverse geocode results found",s):i.error(n,s)})},u.prototype.updateLocationEnd=function(e){var t=this,a={},n=r.createGeocode();a=e.latLng;var s={location:a};n.geocode(s,function(e,n){n===r.geocoderStatusOK()?e[0]?(t.locationEnd.latitude=a.lat().toFixed(6),t.locationEnd.longitude=a.lng().toFixed(6),t.locationEnd.address=e[0].formatted_address,t.actionUpdate(t),o.$apply()):i.error("No reverse geocode results found",s):i.error(n,s)})},u.prototype.isTheFirstRoute=function(e){return this.routes[0].id===e},u.prototype.isAvailableIn=function(e,t,a,n){var o=this.id,r=[],l={available:!0,until:null};try{a.forEach(function(e){var t=s(n.start),i=s(n.start);if(parseInt(o)===parseInt(e.vehicleId)){var a=A(e),l=x(e);if(t.set({hour:parseInt(a.slice(0,2)),minute:parseInt(a.slice(3,5)),second:parseInt(a.slice(6,8))}),i.set({hour:parseInt(l.slice(0,2)),minute:parseInt(l.slice(3,5)),second:parseInt(l.slice(6,8))}),0===r.length)r.push({from:t,to:i});else for(var c=null,d=0;d<r.length;d++){if(c=r[d],t.isBefore(c.from)&&i.isBefore(c.from)){r.splice(d,0,{from:t,to:i});break}if(t.isSame(c.from)&&!i.isSame(c.to)){if(i.isAfter(c.to)){r[d].to=i;break}}else if(!t.isSame(c.from)&&i.isSame(c.to)){if(t.isBefore(c.from)){r[d].from=t;break}}else{if(t.isSame(c.to)){r[d].to=i;break}if(d===r.length&&t.isAfter(c.to)&&i.isAfter(c.to)){r.push({from:t,to:i});break}}}}});for(var c=null,d=0;d<r.length;d++)c=r[d],(e.isSameOrBefore(c.from)&&t.isSameOrAfter(c.from)||e.isSameOrBefore(c.from)&&t.isSameOrAfter(c.to)||e.isSameOrAfter(c.from)&&t.isSameOrBefore(c.to)||e.isSameOrBefore(c.to)&&t.isSameOrAfter(c.to))&&(l.available=!1,l.until=c.to)}catch(u){i.error(u)}return l},u}e.$inject=["PlannerRouteModel","__env","$log","$http","$q","moment","$rootScope","googleService","osrmService","visitSimilarService","$filter"],angular.module("icarus.planner").factory("PlannerVehicleModel",e)}(),function(){"use strict";function e(e,t,i,a){function n(e,t,i,a,n){var s=Math.PI*e/180,o=Math.PI*i/180,r=t-a,l=Math.PI*r/180,c=Math.sin(s)*Math.sin(o)+Math.cos(s)*Math.cos(o)*Math.cos(l);return c=Math.acos(c),c=180*c/Math.PI,c=60*c*1.1515,"K"===n&&(c=1.609344*c),"N"===n&&(c=.8684*c),c}function s(t,i){switch(i){case h:t.status=4,t.error={type:4,msg:e("translate")("Visits.alert_notification.country_center")},t.procureVisitStatus();break;case _:t.status=4,t.error={type:4,msg:e("translate")("Visits.alert_notification.error_distance")},t.procureVisitStatus();break;case g:t.status=4,t.error={type:4,msg:e("translate")("Visits.alert_notification.error_country")},t.procureVisitStatus();break;case b:t.status=2,t.error={type:2,msg:e("translate")("Visits.alert_notification.error_wrong_area")},t.procureVisitStatus();break;case f:t.status=3,t.error={type:3,msg:e("translate")("Visits.alert_notification.error_area_center")},t.procureVisitStatus();break;case y:t.status=2,t.error={type:2,msg:e("translate")("Visits.alert_notification.error_doubt")},t.procureVisitStatus();break;default:t.status=1,t.error=null,t.procureVisitStatus()}}function o(){var e;return A[v]?(e=A[v].centersOfArea,m=A[v].centerOfCountry):(v="CL",e=A[v].centersOfArea,m=A[v].centerOfCountry),e}function r(e,t,n){var o,r,c=n;return a.getInfoToValidateVisit().then(function(i){r=i.country,w=i.maxDistance.value,e.administrative_area=e.administrative_area_level_3,v=r,!e.administrative_area&&e.locality&&(e.administrative_area=e.locality),o=l(c,e,t),s(e,o)})["catch"](function(e){i.info(e)})}function l(e,t,i){var a;return t.country!==v?a=g:(a=p(t,e),a===x&&(a=c(t,i)),a)}function c(e,t){var i,a;return i=o(),d(e)?a=h:u(i,e)?a=f:t.administrative_area&&t.administrative_area!==e.administrative_area&&(a=b),a}function d(e){var t=!1;return e.latitude===m.lat&&e.longitude===m.lng&&(t=!0),t}function u(e,t){var i,a,n=!1,s=1e-6;return e.forEach(function(e){n||(i=parseFloat(e.lat),a=parseFloat(e.lng),(i===t.latitude||i===t.latitude+s||i===t.latitude-s||a===t.longitude||a===t.longitude+s||a===t.longitude-s)&&(n=!0))}),n}function p(e,t){for(var i=x,a=0;a<t.length;a++){var s=n(t[a].locationStart.latitude,t[a].locationStart.longitude,e.latitude,e.longitude,"K");if(s>w)i=_;else{if(e.error.msg!==y){i=x;break}i=y}}return i}var m,v="CL",g="Pa√≠s diferente",h="Centro del pa√≠s",_="Demasiado lejos de la bodega",f="Centro de la comuna",b="Diferente comuna a la se√±alada en la direcci√≥n",y="Direcci√≥n dudosa",w=150,A=t,x="N/A";return{validateVisit:r,validateCenterCountry:d,validateCenterArea:u,validateMaxDistance:p}}e.$inject=["$filter","CLEANER_CONFIG","$log","sessionService"],angular.module("icarus.planner").factory("validatorGeoreferenceService",e)}(),function(){"use strict";function e(){var e=/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/,t={Arica:{city:"Arica",location:{lat:-18.4782534,lng:-70.31259879999999}},Camarones:{city:"Arica",location:{lat:-19.0111932,lng:-69.8654656}},Putre:{city:"Parinacota",location:{lat:-18.1969907,lng:-69.55972729999996}},"General Lagos":{city:"Parinacota",location:{lat:-17.6533,lng:-69.63470000000001}},Iquique:{city:"Iquique",location:{lat:-20.2307033,lng:-70.1356692}},"Alto Hospicio":{city:"Iquique",location:{lat:-20.2686722,lng:-70.10491689999998}},"Pozo Almonte":{city:"Tamarugal",location:{lat:-20.2567092,lng:-69.78601279999998}},"Cami√±a":{city:"Tamarugal",location:{lat:-19.3116281,lng:-69.42986869999999}},Colchane:{city:"Tamarugal",location:{lat:-19.7,lng:-68.88329999999996}},Huara:{city:"Tamarugal",location:{lat:-19.9972461,lng:-69.77185150000003}},Pica:{city:"Tamarugal",location:{lat:-20.489483,lng:-69.330511}},Antofagasta:{city:"Antofagasta",location:{lat:-23.6509279,lng:-70.39750219999996}},Mejillones:{city:"Antofagasta",location:{lat:-23.0985013,lng:-70.4455041}},"Sierra Gorda":{city:"Antofagasta",location:{lat:-22.8860128,lng:-69.31719950000002}},Taltal:{city:"Antofagasta",location:{lat:-25.406494,lng:-70.48030269999998}},Calama:{city:"El Loa",location:{lat:-22.4543923,lng:-68.92938190000001}},"Ollag√ºe":{city:"El Loa",location:{lat:-21.2256917,lng:-68.25478020000003}},"San Pedro de Atacama":{city:"El Loa",location:{lat:-22.9087073,lng:-68.19971559999999}},Tocopilla:{city:"Tocopilla",location:{lat:-22.0857976,lng:-70.1930064}},"Mar√≠a Elena":{city:"Tocopilla",location:{lat:-22.3450046,lng:-69.6607055}},"Copiap√≥":{city:"Copiap√≥",location:{lat:-27.3665763,lng:-70.33215869999998}},Caldera:{city:"Copiap√≥",location:{lat:-27.0667,lng:-70.81781419999999}},"Tierra Amarilla":{city:"Copiap√≥",location:{lat:-27.4671706,lng:-70.26521960000002}},"Cha√±aral":{city:"Cha√±aral",location:{lat:-26.3450046,lng:-70.62419299999999}},"Diego de Almagro":{city:"Cha√±aral",location:{lat:-26.3902488,lng:-70.04753019999998}},Vallenar:{city:"Huasco",location:{lat:-28.5757953,lng:-70.75710090000001}},"Alto del Carmen":{city:"Huasco",location:{lat:-28.759444,lng:-70.48666700000001}},Freirina:{city:"Huasco",location:{lat:-28.512094,lng:-71.07959670000002}},Huasco:{city:"Huasco",location:{lat:-28.4664,lng:-71.2192}},"La Serena":{city:"Elqui",location:{lat:-29.9026691,lng:-71.25193739999997}},Coquimbo:{city:"Elqui",location:{lat:-29.9590009,lng:-71.33891829999999}},Andacollo:{city:"Elqui",location:{lat:-30.2357949,lng:-71.0828027}},"La Higuera":{city:"Elqui",location:{lat:-29.5119534,lng:-71.20008439999998}},Paihuano:{city:"Elqui",location:{lat:-30.0276898,lng:-70.51781419999998}},"Vicu√±a":{city:"Elqui",location:{lat:-30.0319,lng:-70.7081}},Illapel:{city:"Choapa",location:{lat:-31.6308,lng:-71.1653}},Canela:{city:"Choapa",location:{lat:-31.398889,lng:-71.45611099999996}},"Los Vilos":{city:"Choapa",location:{lat:-31.9121865,lng:-71.51120170000002}},Salamanca:{city:"Choapa",location:{lat:-31.782493,lng:-70.9607105}},Ovalle:{city:"Limar√≠",location:{lat:-30.604304,lng:-71.19698819999996}},"Combarbal√°":{city:"Limar√≠",location:{lat:-31.1790967,lng:-71.00509579999999}},"Monte Patria":{city:"Limar√≠",location:{lat:-30.6978944,lng:-70.95868889999997}},Punitaqui:{city:"Limar√≠",location:{lat:-30.8260995,lng:-71.25779119999999}},"R√≠o Hurtado":{city:"Limar√≠",location:{lat:-30.266667,lng:-70.66666700000002}},"Valpara√≠so":{city:"Valpara√≠so",location:{lat:-33.047238,lng:-71.61268849999999}},Casablanca:{city:"Valpara√≠so",location:{lat:-33.3190376,lng:-71.40763179999999}},"Conc√≥n":{city:"Valpara√≠so",location:{lat:-32.9239368,lng:-71.52347929999996}},"Juan Fern√°ndez":{city:"Valpara√≠so",location:{lat:-33.7744303,lng:-80.77686130000001}},"Puchuncav√≠":{city:"Valpara√≠so",location:{lat:-32.722005,lng:-71.41170039999997}},Quintero:{city:"Valpara√≠so",location:{lat:-32.7723101,lng:-71.5333}},"Vi√±a del Mar":{city:"Valpara√≠so",location:{lat:-33.0153481,lng:-71.55002760000002}},"Los Andes":{city:"Los Andes",location:{lat:-32.8337995,lng:-70.59721789999998}},"Calle Larga":{city:"Los Andes",location:{lat:-32.857493,lng:-70.62580689999999}},Rinconada:{city:"Los Andes",location:{lat:-32.8352416,lng:-70.70103670000003}},"San Esteban":{city:"Los Andes",location:{lat:-32.8004995,lng:-70.57980320000001}},"La Ligua":{city:"Petorca",location:{lat:-32.44990180000001,lng:-71.23259580000001}},Cabildo:{city:"Petorca",location:{lat:-32.4258064,lng:-71.06616209999999}},Papudo:{city:"Petorca",location:{lat:-32.5072087,lng:-71.44850129999998}},Petorca:{city:"Petorca",location:{lat:-32.25,lng:-70.93330000000003}},Zapallar:{city:"Petorca",location:{lat:-32.5538059,lng:-71.4581359}},Quillota:{city:"Quillota",location:{lat:-32.8803027,lng:-71.2497156}},"La Calera":{city:"Quillota",location:{lat:-32.7877958,lng:-71.20399629999997}},Hijuelas:{city:"Quillota",location:{lat:-32.7980018,lng:-71.1437211}},"La Cruz":{city:"Quillota",location:{lat:-32.8258069,lng:-71.2273055}},Nogales:{city:"Quillota",location:{lat:-32.7333,lng:-71.20421149999999}},"San Antonio":{city:"San Antonio",location:{lat:-33.5922807,lng:-71.60551229999999}},Algarrobo:{city:"San Antonio",location:{lat:-33.3647762,lng:-71.67055340000002}},Cartagena:{city:"San Antonio",location:{lat:-33.5482466,lng:-71.60457450000001}},"El Quisco":{city:"San Antonio",location:{lat:-33.398596,lng:-71.6981538}},"El Tabo":{city:"San Antonio",location:{
lat:-33.4557162,lng:-71.66693409999999}},"Santo Domingo":{city:"San Antonio",location:{lat:-33.635833,lng:-71.62805600000002}},"San Felipe":{city:"San Felipe de Aconcagua",location:{lat:-32.75,lng:-70.72081149999997}},Catemu:{city:"San Felipe de Aconcagua",location:{lat:-32.7788041,lng:-70.9627036}},Llaillay:{city:"San Felipe de Aconcagua",location:{lat:-32.844379,lng:-70.94281799999999}},Panquehue:{city:"San Felipe de Aconcagua",location:{lat:-32.7670303,lng:-70.83330000000001}},Putaendo:{city:"San Felipe de Aconcagua",location:{lat:-32.628461,lng:-70.71774340000002}},"Santa Mar√≠a":{city:"San Felipe de Aconcagua",location:{lat:-32.7470027,lng:-70.6587073}},"Quilpu√©":{city:"Marga Marga",location:{lat:-33.0482707,lng:-71.4408752}},Limache:{city:"Marga Marga",location:{lat:-33.0095283,lng:-71.25958880000002}},"Olmu√©":{city:"Marga Marga",location:{lat:-32.9981387,lng:-71.18927830000001}},"Villa Alemana":{city:"Marga Marga",location:{lat:-33.0516935,lng:-71.39062339999998}},Rancagua:{city:"Cachapoal",location:{lat:-34.17013240000001,lng:-70.7406259}},Codegua:{city:"Cachapoal",location:{lat:-34.0370319,lng:-70.67286410000003}},Coinco:{city:"Cachapoal",location:{lat:-34.2661579,lng:-70.95934169999998}},Coltauco:{city:"Cachapoal",location:{lat:-34.2877978,lng:-71.0855512}},"Do√±ihue":{city:"Cachapoal",location:{lat:-34.228986,lng:-70.95792879999999}},Graneros:{city:"Cachapoal",location:{lat:-34.0666916,lng:-70.73256459999999}},"Las Cabras":{city:"Cachapoal",location:{lat:-34.2932184,lng:-71.3126292}},"Machal√≠":{city:"Cachapoal",location:{lat:-34.179452,lng:-70.65651509999998}},Malloa:{city:"Cachapoal",location:{lat:-34.4423905,lng:-70.9463887}},Mostazal:{city:"Cachapoal",location:{lat:-33.9497607,lng:-70.57408859999998}},Olivar:{city:"Cachapoal",location:{lat:-34.233,lng:-70.88299999999998}},Peumo:{city:"Cachapoal",location:{lat:-34.3963392,lng:-71.1700793}},Pichidegua:{city:"Cachapoal",location:{lat:-34.3573785,lng:-71.28725959999997}},"Quinta de Tilcoco":{city:"Cachapoal",location:{lat:-34.3554003,lng:-70.9704681}},Rengo:{city:"Cachapoal",location:{lat:-34.4023791,lng:-70.86744110000001}},"Requ√≠noa":{city:"Cachapoal",location:{lat:-34.2883749,lng:-70.815833}},"San Vicente":{city:"Cachapoal",location:{lat:-34.4349435,lng:-71.09137479999998}},Pichilemu:{city:"Cardenal Caro",location:{lat:-34.3867245,lng:-72.00477309999997}},"La Estrella":{city:"Cardenal Caro",location:{lat:-34.2051972,lng:-71.6547276}},Litueche:{city:"Cardenal Caro",location:{lat:-34.117272,lng:-71.72517599999998}},Marchihue:{city:"Cardenal Caro",location:{lat:-34.3984467,lng:-71.62157150000002}},Navidad:{city:"Cardenal Caro",location:{lat:-33.9593954,lng:-71.82951880000002}},Paredones:{city:"Cardenal Caro",location:{lat:-34.6519651,lng:-71.90014480000002}},"San Fernando":{city:"Colchagua",location:{lat:-34.5858603,lng:-70.9907801}},"Ch√©pica":{city:"Colchagua",location:{lat:-34.7255387,lng:-71.27259249999997}},Chimbarongo:{city:"Colchagua",location:{lat:-34.70924,lng:-71.0412713}},Lolol:{city:"Colchagua",location:{lat:-34.7284166,lng:-71.64582430000002}},Nancagua:{city:"Colchagua",location:{lat:-34.6523209,lng:-71.1968597}},Palmilla:{city:"Colchagua",location:{lat:-34.5325061,lng:-71.41299370000002}},Peralillo:{city:"Colchagua",location:{lat:-34.4772681,lng:-71.487259}},Placilla:{city:"Colchagua",location:{lat:-34.6337953,lng:-71.11082729999998}},Pumanque:{city:"Colchagua",location:{lat:-34.6026565,lng:-71.65529329999998}},"Santa Cruz":{city:"Colchagua",location:{lat:-34.6324213,lng:-71.35921159999998}},Talca:{city:"Talca",location:{lat:-35.4232444,lng:-71.64848039999998}},"Constituci√≥n":{city:"Talca",location:{lat:-35.33330000000001,lng:-72.41669999999999}},Curepto:{city:"Talca",location:{lat:-35.0958545,lng:-72.02088909999998}},Empedrado:{city:"Talca",location:{lat:-35.589943,lng:-72.2763046}},Maule:{city:"Talca",location:{lat:-35.4232444,lng:-71.64848039999998}},Pelarco:{city:"Talca",location:{lat:-35.3838823,lng:-71.44719199999997}},Pencahue:{city:"Talca",location:{lat:-35.3960652,lng:-71.79745630000002}},"R√≠o Claro":{city:"Talca",location:{lat:-35.2808267,lng:-71.25995069999999}},"San Clemente":{city:"Talca",location:{lat:-35.5364676,lng:-71.4893705}},"San Rafael":{city:"Talca",location:{lat:-35.3074574,lng:-71.52349859999998}},Cauquenes:{city:"Cauquenes",location:{lat:-35.9676285,lng:-72.3222331}},Chanco:{city:"Cauquenes",location:{lat:-35.7333,lng:-72.5333}},Pelluhue:{city:"Cauquenes",location:{lat:-35.8141512,lng:-72.57499789999997}},"Curic√≥":{city:"Curic√≥",location:{lat:-34.9779853,lng:-71.25288030000002}},"Huala√±√©":{city:"Curic√≥",location:{lat:-34.9725157,lng:-71.7993371}},"Licant√©n":{city:"Curic√≥",location:{lat:-34.9852447,lng:-71.98498799999999}},Molina:{city:"Curic√≥",location:{lat:-35.1164987,lng:-71.2829759}},Rauco:{city:"Curic√≥",location:{lat:-34.9253441,lng:-71.3156315}},Romeral:{city:"Curic√≥",location:{lat:-34.9622896,lng:-71.1319939}},"Sagrada Familia":{city:"Curic√≥",location:{lat:-34.9984205,lng:-71.34458219999999}},Teno:{city:"Curic√≥",location:{lat:-34.8702993,lng:-71.16640330000001}},"Vichuqu√©n":{city:"Curic√≥",location:{lat:-34.8837446,lng:-71.99539720000001}},Linares:{city:"Linares",location:{lat:-35.846407,lng:-71.59961369999996}},"Colb√∫n":{city:"Linares",location:{lat:-35.699248,lng:-71.4146915}},"Longav√≠":{city:"Linares",location:{lat:-35.9636265,lng:-71.68312509999998}},Parral:{city:"Linares",location:{lat:-36.1399593,lng:-71.8244406}},Retiro:{city:"Linares",location:{lat:-36.05,lng:-71.76670000000001}},"San Javier":{city:"Linares",location:{lat:-35.5930962,lng:-71.73250209999998}},"Villa Alegre":{city:"Linares",location:{lat:-35.6761961,lng:-71.7439129}},"Yerbas Buenas":{city:"Linares",location:{lat:-35.750077,lng:-71.5837328}},"Concepci√≥n":{city:"Concepci√≥n",location:{lat:-36.8201352,lng:-73.0443904}},Coronel:{city:"Concepci√≥n",location:{lat:-37.0340769,lng:-73.14048379999997}},Chiguayante:{city:"Concepci√≥n",location:{lat:-36.9532166,lng:-73.01737800000001}},Florida:{city:"Concepci√≥n",location:{lat:-36.8237875,lng:-72.66847180000002}},Hualqui:{city:"Concepci√≥n",location:{lat:-36.9737875,lng:-72.9368437}},Lota:{city:"Concepci√≥n",location:{lat:-37.0920575,lng:-73.1545822}},Penco:{city:"Concepci√≥n",location:{lat:-36.7333,lng:-72.98329999999999}},"San Pedro de La Paz":{city:"Concepci√≥n",location:{lat:-36.8305354,lng:-73.11673680000001}},"Santa Juana":{city:"Concepci√≥n",location:{lat:-37.1749687,lng:-72.9457031}},Talcahuano:{city:"Concepci√≥n",location:{lat:-36.7247834,lng:-73.11698079999996}},"Tom√©":{city:"Concepci√≥n",location:{lat:-36.6131562,lng:-72.95885929999997}},"Hualp√©n":{city:"Concepci√≥n",location:{lat:-36.7866757,lng:-73.10995309999998}},Lebu:{city:"Arauco",location:{lat:-37.6097143,lng:-73.64832939999997}},Arauco:{city:"Arauco",location:{lat:-37.2457765,lng:-73.31666439999998}},"Ca√±ete":{city:"Arauco",location:{lat:-37.8058201,lng:-73.39197389999998}},Contulmo:{city:"Arauco",location:{lat:-38.0149266,lng:-73.22928780000001}},Curanilahue:{city:"Arauco",location:{lat:-37.4762431,lng:-73.34212430000002}},"Los √Ålamos":{city:"Arauco",location:{lat:-37.6261237,lng:-73.46226639999998}},"Tir√∫a":{city:"Arauco",location:{lat:-38.3419149,lng:-73.49551600000001}},"Los √Ångeles":{city:"Biob√≠o",location:{lat:-37.4629159,lng:-72.36122510000001}},Antuco:{city:"Biob√≠o",location:{lat:-37.3313164,lng:-71.67642769999998}},Cabrero:{city:"Biob√≠o",location:{lat:-37.0332999,lng:-72.39999999999998}},Laja:{city:"Biob√≠o",location:{lat:-37.271425,lng:-72.71949059999997}},"Mulch√©n":{city:"Biob√≠o",location:{lat:-37.7178812,lng:-72.23743430000002}},Nacimiento:{city:"Biob√≠o",location:{lat:-37.5059062,lng:-72.6737875}},Negrete:{city:"Biob√≠o",location:{lat:-37.5862531,lng:-72.5320562}},Quilaco:{city:"Biob√≠o",location:{lat:-37.6875544,lng:-71.99866259999999}},Quilleco:{city:"Biob√≠o",location:{lat:-37.4741645,lng:-71.98362050000003}},"San Rosendo":{city:"Biob√≠o",location:{lat:-37.2620301,lng:-72.72311189999999}},"Santa B√°rbara":{city:"Biob√≠o",location:{lat:-37.66670000000001,lng:-72.01670000000001}},Tucapel:{city:"Biob√≠o",location:{lat:-37.2923048,lng:-71.9512186}},Yumbel:{city:"Biob√≠o",location:{lat:-37.0833,lng:-72.56669999999997}},"Alto Biob√≠o":{city:"Biob√≠o",location:{lat:-38.05,lng:-71.316667}},"Chill√°n":{city:"√ëuble",location:{lat:-36.6062618,lng:-72.1023351}},Bulnes:{city:"√ëuble",location:{lat:-36.7421593,lng:-72.30177179999998}},Cobquecura:{city:"√ëuble",location:{lat:-36.1386156,lng:-72.79452179999998}},Coelemu:{city:"√ëuble",location:{lat:-36.4833,lng:-72.69999999999999}},Coihueco:{city:"√ëuble",location:{lat:-36.6291031,lng:-71.83270929999998}},"Chill√°n Viejo":{city:"√ëuble",location:{lat:-36.6291031,lng:-72.1397968}},"El Carmen":{city:"√ëuble",location:{lat:-36.9,lng:-72.0333}},Ninhue:{city:"√ëuble",location:{lat:-36.4,lng:-72.39999999999998}},"√ëiqu√©n":{city:"√ëuble",location:{lat:-36.3,lng:-71.89999999999998}},Pemuco:{city:"√ëuble",location:{lat:-36.9667,lng:-72.10000000000002}},Pinto:{city:"√ëuble",location:{lat:-36.7,lng:-71.89409369999998}},Portezuelo:{city:"√ëuble",location:{lat:-36.5267723,lng:-72.42821329999998}},"Quill√≥n":{city:"√ëuble",location:{lat:-36.7338906,lng:-72.4602031}},Quirihue:{city:"√ëuble",location:{lat:-36.2832999,lng:-72.5333}},"R√°nquil":{city:"√ëuble",location:{lat:-36.65256600000001,lng:-72.59729620000002}},"San Carlos":{city:"√ëuble",location:{lat:-36.42615,lng:-71.97083429999998}},"San Fabi√°n":{city:"√ëuble",location:{lat:-36.55,lng:-71.55000000000001}},"San Ignacio":{city:"√ëuble",location:{lat:-36.533333,lng:-72.433333}},"San Nicol√°s":{city:"√ëuble",location:{lat:-36.5,lng:-72.2167}},Treguaco:{city:"√ëuble",location:{lat:-36.4211406,lng:-72.66059369999999}},Yungay:{city:"√ëuble",location:{lat:-37.1220156,lng:-72.01315620000003}},Temuco:{city:"Caut√≠n",location:{lat:-38.7359018,lng:-72.59037390000003}},Carahue:{city:"Caut√≠n",location:{lat:-38.7088593,lng:-73.16788120000001}},Cunco:{city:"Caut√≠n",location:{lat:-38.9320562,lng:-72.02798430000001}},Curarrehue:{city:"Caut√≠n",location:{lat:-39.3616465,lng:-71.58902760000001}},Freire:{city:"Caut√≠n",location:{lat:-38.9573,lng:-72.6269289}},Galvarino:{city:"Caut√≠n",location:{lat:-38.4088593,lng:-72.78211870000001}},Gorbea:{city:"Caut√≠n",location:{lat:-39.1005597,lng:-72.67635999999999}},Lautaro:{city:"Caut√≠n",location:{lat:-38.5084312,lng:-72.45413429999996}},Loncoche:{city:"Caut√≠n",location:{lat:-39.3681199,lng:-72.63151270000003}},Melipeuco:{city:"Caut√≠n",location:{lat:-38.852306,lng:-71.69294279999997}},"Nueva Imperial":{city:"Caut√≠n",location:{lat:-38.7445218,lng:-72.9482281}},"Padre Las Casas":{city:"Caut√≠n",location:{lat:-38.7667,lng:-72.60000000000002}},Perquenco:{city:"Caut√≠n",location:{lat:-38.4161093,lng:-72.37562179999998}},"Pitrufqu√©n":{city:"Caut√≠n",location:{lat:-38.9833,lng:-72.64173119999998}},"Puc√≥n":{city:"Caut√≠n",location:{lat:-39.2722541,lng:-71.97762849999998}},Saavedra:{city:"Caut√≠n",location:{lat:-38.7832999,lng:-73.39999999999998}},"Teodoro Schmidt":{city:"Caut√≠n",location:{lat:-38.9991844,lng:-73.09429690000002}},"Tolt√©n":{city:"Caut√≠n",location:{lat:-39.2043263,lng:-73.20774360000001}},"Vilc√∫n":{city:"Caut√≠n",location:{lat:-38.6677187,lng:-72.22444059999998}},Villarrica:{city:"Caut√≠n",location:{lat:-39.2820124,lng:-72.2307798}},Cholchol:{city:"Caut√≠n",location:{lat:-38.6005906,lng:-72.84114060000002}},Angol:{city:"Malleco",location:{lat:-37.8060734,lng:-72.70380469999998}},Collipulli:{city:"Malleco",location:{lat:-37.9582687,lng:-72.43211869999999}},"Curacaut√≠n":{city:"Malleco",location:{lat:-38.4401849,lng:-71.88766950000002}},Ercilla:{city:"Malleco",location:{lat:-38.0553156,lng:-72.38329999999996}},Lonquimay:{city:"Malleco",location:{lat:-38.4541781,lng:-71.36978720000002}},"Los Sauces":{city:"Malleco",location:{lat:-37.9791031,lng:-72.83448120000003}},Lumaco:{city:"Malleco",location:{lat:-38.16402009999999,lng:-72.90318460000003}},"Pur√©n":{city:"Malleco",location:{lat:-38.0326817,lng:-73.07182829999999}},Renaico:{city:"Malleco",location:{lat:-37.6737875,lng:-72.58920620000004}},"Traigu√©n":{city:"Malleco",location:{lat:-38.25,lng:-72.68330000000003}},Victoria:{city:"Malleco",location:{lat:-38.2326538,lng:-72.3515084}},Valdivia:{city:"Valdivia",location:{lat:-39.8173788,lng:-73.24253329999999}},Corral:{city:"Valdivia",location:{lat:-39.8885744,lng:-73.4315987}},Lanco:{city:"Valdivia",location:{lat:-39.4510195,lng:-72.77961670000002}},"Los Lagos":{city:"Valdivia",location:{lat:-39.8624984,lng:-72.8185588}},"M√°fil":{city:"Valdivia",location:{lat:-39.6648976,lng:-72.9571573}},Mariquina:{city:"Valdivia",location:{lat:-39.540279,lng:-72.96565199999998}},Paillaco:{city:"Valdivia",location:{lat:-40.0684279,lng:-72.87484139999998}},Panguipulli:{city:"Valdivia",location:{lat:-39.6436316,lng:-72.3364942}},"La Uni√≥n":{city:"Ranco",location:{lat:-40.2952749,lng:-73.07932799999998}},Futrono:{city:"Ranco",location:{lat:-40.12454109999999,lng:-72.38084959999998}},"Lago Ranco":{city:"Ranco",location:{lat:-40.3211603,lng:-72.48221230000001}},"R√≠o Bueno":{city:"Ranco",location:{lat:-40.3313422,lng:-72.94853660000001}},"Puerto Montt":{city:"Llanquihue",location:{lat:-41.468917,lng:-72.9411364}},Calbuco:{city:"Llanquihue",location:{lat:-41.7720156,lng:-73.13270929999999}},"Cocham√≥":{city:"Llanquihue",location:{lat:-41.4923218,lng:-72.30843119999997}},Fresia:{city:"Llanquihue",location:{lat:-41.15,lng:-73.41633430000002}},Frutillar:{city:"Llanquihue",location:{lat:-41.116667,lng:-73.05000000000001}},"Los Muermos":{city:"Llanquihue",location:{lat:-41.3994093,lng:-73.4649905}},Llanquihue:{city:"Llanquihue",location:{lat:-41.2606312,lng:-73.00784060000001}},"Maull√≠n":{city:"Llanquihue",location:{lat:-41.614807,lng:-73.5990281}},"Puerto Varas":{city:"Llanquihue",location:{lat:-41.3167,lng:-72.98329999999999}},Castro:{city:"Chilo√©",location:{lat:-42.4801402,lng:-73.76241370000002}},Ancud:{city:"Chilo√©",location:{lat:-41.8675003,lng:-73.8276965}},Chonchi:{city:"Chilo√©",location:{lat:-42.6232593,lng:-73.77384990000002}},"Curaco de V√©lez":{city:"Chilo√©",location:{lat:-42.4405468,lng:-73.60370690000002}},Dalcahue:{city:"Chilo√©",location:{lat:-42.377631,lng:-73.651882}},"Puqueld√≥n":{city:"Chilo√©",location:{lat:-42.6014407,lng:-73.67148480000003}},"Queil√©n":{city:"Chilo√©",location:{lat:-42.6186043,lng:-73.78004809999999}},"Quell√≥n":{city:"Chilo√©",location:{lat:-43.1169327,lng:-73.61388210000001}},Quemchi:{city:"Chilo√©",location:{lat:-42.1427625,lng:-73.47431819999997}},Quinchao:{city:"Chilo√©",location:{lat:-42.5381325,lng:-73.41877290000002}},Osorno:{city:"Osorno",location:{lat:-40.5761897,lng:-73.1149469}},"Puerto Octay":{city:"Osorno",location:{lat:-40.9768373,lng:-72.88196160000001}},Purranque:{city:"Osorno",location:{lat:-40.9084312,lng:-73.16610930000002}},Puyehue:{city:"Osorno",location:{lat:-40.7685941,lng:-72.236379}},"R√≠o Negro":{city:"Osorno",location:{lat:-40.7832999,lng:-73.23329999999999}},"San Juan de la Costa":{city:"Osorno",location:{lat:-40.516667,lng:-73.39999999999998}},"San Pablo":{city:"Osorno",location:{lat:-40.4124031,lng:-73.01256560000002}},"Chait√©n":{city:"Palena",location:{lat:-42.9167,lng:-72.7167}},"Futaleuf√∫":{city:"Palena",location:{lat:-43.1833,lng:-71.86669999999998}},"Hualaihu√©":{city:"Palena",location:{lat:-42.0216398,lng:-72.6891622}},Palena:{city:"Palena",location:{lat:-43.61669999999999,lng:-71.80000000000001}},Coyhaique:{city:"Coyhaique",location:{lat:-45.5712254,lng:-72.068265}},"Lago Verde":{city:"Coyhaique",location:{lat:-44.2385218,lng:-71.85112709999999}},"Ays√©n":{city:"Ays√©n",location:{lat:-46.5076086,lng:-74.21337970000002}},Cisnes:{city:"Ays√©n",location:{lat:-44.75,lng:-72.69999999999999}},Guaitecas:{city:"Ays√©n",location:{lat:-43.883333,lng:-73.75}},Cochrane:{city:"Capit√°n Prat",location:{lat:-47.2535728,lng:-72.57298229999998}},"O'Higgins":{city:"Capit√°n Prat",location:{lat:-48.4674467,lng:-72.55919180000001}},Tortel:{city:"Capit√°n Prat",location:{lat:-47.8015353,lng:-73.53584940000002}},"Chile Chico":{city:"General Carrera",location:{lat:-46.5409005,lng:-71.72227950000001}},"R√≠o Ib√°√±ez":{city:"General Carrera",location:{lat:-46.3,lng:-71.933333}},"Punta Arenas":{city:"Magallanes",location:{lat:-53.1638329,lng:-70.91706829999998}},"Laguna Blanca":{city:"Magallanes",location:{lat:-52.25,lng:-71.91666699999996}},"R√≠o Verde":{city:"Magallanes",location:{lat:-52.58467899999999,lng:-71.513733}},"San Gregorio":{city:"Magallanes",location:{lat:-52.5531325,lng:-70.4082396}},"Cabo de Hornos":{city:"Ant√°rtica Chilena",location:{lat:-55.09916279999999,lng:-69.27477440000001}},"Ant√°rtica":{city:"Ant√°rtica Chilena",location:{lat:-52.20643159999999,lng:-72.16850010000002}},Porvenir:{city:"Tierra del Fuego",location:{lat:-53.2957997,lng:-70.36665449999998}},Primavera:{city:"Tierra del Fuego",location:{lat:-52.716667,lng:-69.25}},Timaukel:{city:"Tierra del Fuego",location:{lat:-54.294722,lng:-69.16750000000002}},Natales:{city:"√öltima Esperanza",location:{lat:-51.73333299999999,lng:-72.51666699999998}},"Torres del Paine":{city:"√öltima Esperanza",location:{lat:-51.259167,lng:-72.34500000000003}},Santiago:{city:"Santiago",location:{lat:-33.4488897,lng:-70.6692655}},Cerrillos:{city:"Santiago",location:{lat:-33.5041325,lng:-70.71089949999998}},"Cerro Navia":{city:"Santiago",location:{lat:-33.4216593,lng:-70.73468869999999}},"Conchal√≠":{city:"Santiago",location:{lat:-33.3846893,lng:-70.68002130000002}},"El Bosque":{city:"Santiago",location:{lat:-33.5630463,lng:-70.67521339999996}},"Estaci√≥n Central":{city:"Santiago",location:{lat:-33.4590774,lng:-70.6990045}},Huechuraba:{city:"Santiago",location:{lat:-33.3742128,lng:-70.63674249999997}},Independencia:{city:"Santiago",location:{lat:-33.4133469,lng:-70.6662915}},"La Cisterna":{city:"Santiago",location:{lat:-33.5264495,lng:-70.66135109999999}},"La Florida":{city:"Santiago",location:{lat:-33.5226882,lng:-70.59871420000002}},"La Granja":{city:"Santiago",location:{lat:-33.53779310000001,lng:-70.620678}},"La Pintana":{city:"Santiago",location:{lat:-33.5855661,lng:-70.6285838}},"La Reina":{city:"Santiago",location:{lat:-33.4411269,lng:-70.53405909999998}},"Las Condes":{city:"Santiago",location:{lat:-33.4087844,lng:-70.567069}},"Lo Barnechea":{city:"Santiago",location:{lat:-33.352669,lng:-70.51851699999997}},"Lo Espejo":{city:"Santiago",location:{lat:-33.5139265,lng:-70.69308409999996}},"Lo Prado":{city:"Santiago",location:{lat:-33.4442688,lng:-70.7233493}},Macul:{city:"Santiago",location:{lat:-33.4851471,lng:-70.5992005}},"Maip√∫":{city:"Santiago",location:{lat:-33.5209155,lng:-70.76313349999998}},"√ëu√±oa":{city:"Santiago",location:{lat:-33.4566678,lng:-70.59784150000002}},"Pedro Aguirre Cerda":{city:"Santiago",location:{lat:-33.4940901,lng:-70.67650259999999}},"Pe√±alol√©n":{city:"Santiago",location:{lat:-33.4719116,lng:-70.5627854}},Providencia:{city:"Santiago",location:{lat:-33.4314474,lng:-70.6093325}},Pudahuel:{city:"Santiago",location:{lat:-33.4421135,lng:-70.7640644}},Quilicura:{city:"Santiago",location:{lat:-33.3576747,lng:-70.72927179999999}},"Quinta Normal":{city:"Santiago",location:{lat:-33.4317378,lng:-70.69239170000003}},Recoleta:{city:"Santiago",location:{lat:-33.3972075,lng:-70.6428148}},Renca:{city:"Santiago",location:{lat:-33.4063601,lng:-70.72799650000002}},"San Joaqu√≠n":{city:"Santiago",location:{lat:-33.496202,lng:-70.62833610000001}},"San Miguel":{city:"Santiago",location:{lat:-33.4923545,lng:-70.65179699999999}},"San Ram√≥n":{city:"Santiago",location:{lat:-33.538901,lng:-70.64249889999996}},Vitacura:{city:"Santiago",location:{lat:-33.3905211,lng:-70.57241239999996}},"Puente Alto":{city:"Cordillera",location:{lat:-33.6186082,lng:-70.59060569999997}},Pirque:{city:"Cordillera",location:{lat:-33.6793441,lng:-70.58310689999996}},"San Jos√© de Maipo":{city:"Cordillera",location:{lat:-33.643169,lng:-70.34520700000002}},Colina:{city:"Chacabuco",location:{lat:-33.2044597,lng:-70.67585050000002}},Lampa:{city:"Chacabuco",location:{lat:-33.2827093,lng:-70.87932799999999}},"Til Til":{city:"Chacabuco",location:{lat:-33.1380064,lng:-70.91770529999997}},"San Bernardo":{city:"Maipo",location:{lat:-33.6005906,lng:-70.7060687}},Buin:{city:"Maipo",location:{lat:-33.7309374,lng:-70.74232180000001}},"Calera de Tango":{city:"Maipo",location:{lat:-33.6291031,lng:-70.76869679999999}},Paine:{city:"Maipo",location:{lat:-33.8125656,lng:-70.7375968}},Melipilla:{city:"Melipilla",location:{lat:-33.6861588,lng:-71.2166838}},"Alhu√©":{city:"Melipilla",location:{lat:-34.0264691,lng:-71.1002881}},"Curacav√≠":{city:"Melipilla",location:{lat:-33.3977192,lng:-71.12752119999999}},"Mar√≠a Pinto":{city:"Melipilla",location:{lat:-33.51766920000001,lng:-71.12392210000002}},"San Pedro":{city:"Melipilla",location:{lat:-33.8950912,lng:-71.4563779}},Talagante:{city:"Talagante",location:{lat:-33.6637468,lng:-70.92739369999998}},"El Monte":{city:"Talagante",location:{lat:-33.6815281,lng:-70.98539679999999}},"Isla de Maipo":{city:"Talagante",location:{lat:-33.7464562,lng:-70.89999999999998}},"Padre Hurtado":{city:"Talagante",location:{lat:-33.5749687,lng:-70.81499050000002}},"Pe√±aflor":{city:"Talagante",location:{lat:-33.6060255,lng:-70.87818370000002}}},i={};return i.latlngPattern=e,i.cities={},i.cities.chile=t,i}angular.module("icarus.planner").factory("Utils",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o){function r(e){this.backendId=null,this.plannedDate=null,this.vehicleId=e,this.estimatedTimeStart="00:00",this.estimatedTimeEnd="00:00",this.totalTime="00:00",this.totalTimeFormatted="00:00",this.totalDistance=0,this.totalLoad=0,this.totalLoad2=0,this.totalLoad3=0,this.totalLoadPercentage=0,this.totalLoadPercentage2=0,this.totalLoadPercentage3=0,this.visits=[],this.locationStart={address:null,latitude:null,longitude:null},this.locationEnd={address:null,latitude:null,longitude:null},this.comment=null,this.collapse=!0,this.id=l(),this.path=[],this.visible=!0,this.editable=!1,this.geodesic=!0,this.stroke={color:"#586BA4",weight:3,opacity:1},this.capacityError=!1,this.capacityError2=!1,this.capacityError3=!1,this.timeError=!1,this.skillsError=!1,this.areVisitsListed=!1,this.createAt=null,this.formattedLoad="",this.formattedLoad2="",this.formattedLoad3="",this.startTime=null,this.endTime=null}function l(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}return r.createInstance=function(e){return new r(e)},r.prototype.save=function(s,o,r,l,c){function d(e){return e&&(m.backendId=e.data.id),t.resolve(e.data)}function u(i){return e.error(i),t.reject(i)}var p,m=this,v=a.API_URL+"routes/routes/",g=this.totalTime.split(" ");p=g.length>1?g[1].split(":").length>=3?this.totalTime:this.totalTime+":00":g[0].split(":").length>=3?this.totalTime:this.totalTime+":00";var h={vehicle:this.vehicleId,driver:o,plan:r,estimated_time_start:this.estimatedTimeStart,estimated_time_end:this.estimatedTimeEnd,status:"assigned",total_duration:p,total_distance:(1e3*this.totalDistance).toFixed(0),total_load:this.totalLoad,total_load_percentage:parseFloat(this.totalLoadPercentage).toFixed(0),total_load_2:this.totalLoad2,total_load_2_percentage:parseFloat(this.totalLoadPercentage2).toFixed(0),total_load_3:this.totalLoad3,total_load_3_percentage:parseFloat(this.totalLoadPercentage3).toFixed(0),location_start_address:s.locationStart.address,location_start_latitude:s.locationStart.latitude,location_start_longitude:s.locationStart.longitude,location_end_address:s.locationEnd.address,location_end_latitude:s.locationEnd.latitude,location_end_longitude:s.locationEnd.longitude,comment:this.comment};return(!c||angular.isUndefined(m.backendId)||null===m.backendId)&&(h.planned_date=i(l.start).format("YYYY-MM-DD")),angular.isUndefined(m.backendId)||null===m.backendId?n.post(v,h).then(d,u):n.patch(v+m.backendId+"/",h).then(d,u)},r.prototype.addVisit=function(e,t){return angular.isUndefined(t)&&(t=!0),e.routeId=this.id,e.vehicle=this.vehicleId,e.selected=!1,this.visible&&t&&e.setVisible(!0),e.updateOrder(this.visits.length+1),this.visits.push(e),this.routeChanged(),e},r.prototype.routeChanged=function(){this.backendId=null},r.prototype.removeVisit=function(e){e.routeId=null,e.vehicle=null,e.estimatedTimeArrival=null,e.estimatedTimeDeparture=null,this.visits.splice(this.visits.indexOf(e),1),this.routeChanged()},r.prototype.clear=function(){this.visits.forEach(function(e){e.routeId=null,e.estimatedTimeArrival=null,e.estimatedTimeDeparture=null}),this.visits.length=0,this.routeChanged()},r.prototype.clearVisits=function(){for(var e=this.visits.shift();e;)e.routeId=null,e.estimatedTimeArrival=null,e.estimatedTimeDeparture=null,e=this.visits.shift();this.routeChanged()},r.prototype.setVisible=function(e){angular.isUndefined(e)&&(e=!0,this.setOpacity(1)),this.visible=e,this.actionUpdate(this)},r.prototype.setVisibleWithoutOpacity=function(e){angular.isUndefined(e)&&(e=!0),this.visible=e,this.actionUpdate(this)},r.prototype.hideVisitsWithError=function(e){this.visits.map(function(t){(t.timeError||t.capacityError||t.capacityError2||t.capacityError3||t.skillsError)&&(angular.isUndefined(e)?t.removeIndicatorError():t.removeIndicatorError(e))})},r.prototype.showVisitsWithError=function(){this.visits.map(function(e){if(e.timeError||e.capacityError||e.capacityError2||e.capacityError3||e.skillsError){var t={msg:"Indicator Error",type:4};e.setIndicatorError(t),e.setOpacity(1)}})},r.prototype.setOpacity=function(e){this.stroke.opacity=e,this.visits.map(function(t){t.setOpacity(e)}),this.actionUpdate(this)},r.prototype.setVisitsListed=function(e){this.areVisitsListed=e},r.prototype.setStrokeColor=function(e){this.stroke.color=e},r.prototype.clearCapacityErrors=function(){this.capacityError=!1,this.capacityError2=!1,this.capacityError3=!1},r.prototype.createVisitsMarkers=function(){this.visits.forEach(function(e){e.actionCreate(e)})},r.prototype.calculatePath=function(e){function t(e,i,o,r){var l=a.OSRM_URL+"viaroute",c=Boolean(r);return n.get(l,{params:{loc:i,uturns:c},headers:{Authorization:void 0}}).then(function(a){if(207!==a.data.status||c){var n=a.data.route_summary;n&&n.total_distance&&(e.totalDistance=n.total_distance/1e3),o?e.path=[]:e.path=s(a.data.route_geometry,6)}else t(e,i,o,!0);e.actionUpdate(e)})}function i(e,t){var i=new ConvexHullGrahamScan;if(t.forEach(function(e){var t=e.split(","),a=t[0].trim(),n=t[1].trim();i.addPoint(n,a)}),i.points.length>0){var a=i.getHull();a=a.map(function(e){return o.getGoogleMapsLatLng(e.y,e.x)}),e.path=a}}function s(e,t){t=Math.pow(10,-t);for(var i=e?e.length:0,a=0,n=0,s=0,r=[];i>a;){var l,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var u=1&d?~(d>>1):d>>1;n+=u,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var p=1&d?~(d>>1):d>>1;s+=p;var m={latitude:n*t,longitude:s*t};r.push(o.getGoogleMapsLatLng(m.latitude,m.longitude))}return r}var r=[];return this.visits.map(function(e){e.latitude&&e.longitude&&r.push([e.latitude,",",e.longitude].join(""))}),e?(r.shift(),r.pop(),void i(this,r)):t(this,r,e)},r.prototype.actionCreate=function(e){s.$broadcast("Planner:Route:Create",{route:e})},r.prototype.actionUpdate=function(e){s.$broadcast("Planner:Route:Update",{route:e})},r.prototype.actionRemove=function(e){s.$broadcast("Planner:Route:Remove",{route:e})},r}e.$inject=["$log","$q","moment","__env","$http","$rootScope","googleService"],angular.module("icarus.planner").factory("PlannerRouteModel",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y,w,A){function x(){var e=a.defer();return e.resolve(yi),e.promise}function k(){var e=a.defer();return e.resolve(bi),e.promise}function I(){var e=a.defer();return e.resolve(ki),e.promise}function S(e){Mi.lat=e.center.latitude,Mi.lng=e.center.longitude}function E(){var e=a.defer();return i.get(s.MAP_OPTIONS).then(function(t){e.resolve(t.data)})["catch"](function(t){e.reject(t)}),e.promise}function C(){return i.get(ii+"traveltime-depot/")}function D(){var e=angular.copy(yi);wi=e.map(function(e){return{id:e.id,shift:e.shift}})}function P(){for(var e=0;e<yi.length;e++)for(var t=0;t<wi.length;t++)yi[e].id===wi[t].id&&(yi[e].shift=wi[t].shift)}function L(e){pi=e}function O(){return Vi?Vi:Vi=be().then(Ie).then(ke(di)).then(ye).then(function(){return{planDate:di,shift:fi,vehicles:yi,routes:Ai,visits:xi,drivers:bi,skills:ki}})}function T(){return tt()}function V(){yi.length=0,bi.length=0,ki.length=0,xi.length=0,Ai.length=0,$i={},gi=null,hi=null,Vi=null,ui=!1,Ei=[],mi.load2=!1,mi.load3=!1,zi={start:null,end:null},di.start=n().toDate()}function R(){xi.length=0,Ai.length=0,$i={},gi=null,hi=null,Vi=null,ui=!1,mi.load2=!1,mi.load3=!1,di.start=n().toDate(),yi.forEach(function(e){e.routes.length=0,e.enable=!0,e.active=!0})}function M(e){gi=e}function z(){return gi}function F(){return{planId:gi,updatingReturn:vi}}function N(){xi.forEach(function(e){Ni[e.id]={routeId:e.routeId,order:e.order,estimatedTimeArrival:e.estimatedTimeArrival,estimatedTimeDeparture:e.estimatedTimeDeparture,capacityError:e.capacityError,capacityError2:e.capacityError2,capacityError3:e.capacityError3,timeError:e.timeError,skillsError:e.skillsError,error:angular.copy(e.error),options:angular.copy(e.options)}}),Ai.forEach(function(e){$i[e.id]={estimatedTimeStart:e.estimatedTimeStart,estimatedTimeEnd:e.estimatedTimeEnd,totalTime:e.totalTime,totalTimeFormatted:e.totalTimeFormatted,totalDistance:e.totalDistance,totalLoad:e.totalLoad,totalLoadPercentage:e.totalLoadPercentage,totalLoad2:e.totalLoad2,totalLoadPercentage2:e.totalLoadPercentage2,totalLoad3:e.totalLoad3,totalLoadPercentage3:e.totalLoadPercentage3,path:e.path,capacityError:e.capacityError,capacityError2:e.capacityError2,capacityError3:e.capacityError3,timeError:e.timeError,skillsError:e.skillsError,visits:angular.extend([],e.visits)}})}function $(){xi.forEach(function(e){angular.extend(e,Ni[e.id])}),Ai.forEach(function(e){angular.extend(e,$i[e.id])}),H(),B(),j()}function j(){yi.forEach(function(e){e.routes.sort(function(e,t){return e.estimatedTimeStart>t.estimatedTimeStart?1:t.estimatedTimeStart>e.estimatedTimeStart?-1:0})})}function B(){yi.forEach(function(e){e.routes.forEach(function(e){e.visits.sort(function(e,t){return e.order>t.order?1:t.order>e.order?-1:0})})})}function H(){var e;for(var t in $i)u.find(Ai,{id:t})||(Ai.push($i[t]),e=u.find(yi,{id:$i[t].vehicleId}),xi.forEach(function(e){e.routeId===t&&$i[t].visits.push(e)}),e&&$i[t].visits.length>0&&e.routes.push($i[t]))}function U(e){Ri=e}function q(){return Ri}function G(){if(Ri){var e=null,t=null,i=null;Mi.lat&&Mi.lng&&(e=Mi.lat,t=Mi.lng,i=g.getGoogleMapsLatLng(e,t),Ri.setCenter(i))}}function J(){var e=0,t=0,i=0,a=0,n=0,s=0,o=0;Ai.map(function(e){e.visits.length>0&&(i++,t+=e.totalLoad?e.totalLoad:0,n+=e.totalLoad2?e.totalLoad2:0,o+=e.totalLoad3?e.totalLoad3:0)}),e=isNaN(t/i)?0:(t/i).toFixed(1),a=isNaN(n/i)?0:(n/i).toFixed(1),s=isNaN(o/i)?0:(o/i).toFixed(1),Fi.averageLoad=e,Fi.averageLoad2=a,Fi.averageLoad3=s}function Y(){var e,t=0,i=0;t=n.duration(0,"HH:mm"),Ai.map(function(e){if(e.visits.length>0){i++;var a=n.duration(e.totalTimeFormatted).asMinutes();t.add(a,"minutes")}});var a=isNaN(t.asMinutes()/i)?0:(t.asMinutes()/i).toFixed(0);e=n.duration({minutes:a}),Fi.averageTime=Math.floor(e.asHours())+n.utc(e.asMilliseconds()).format(":mm")}function W(e){ct()||(di.start=e.format("YYYY-MM-DD"))}function Q(e,t){di.start=e,di.end=t}function Z(e){hi=e}function K(){return fi}function X(e,t){fi.start=e,fi.end=t}function ee(e){return O().then(function(t){for(var i=0;i<t.vehicles.length;i++)if(t.vehicles[i].id===e)return t.vehicles[i];var n={status:404};return a.reject(n)},function(e){return a.reject(e)})}function te(){return bi}function ie(e){return O().then(function(t){for(var i=0;i<t.drivers.length;i++)if(t.drivers[i].id===e)return t.drivers[i];return a.reject("DRIVER NOT FOUND")})}function ae(e){var t=new r(e);return Ai.push(t),t}function ne(e){if(e.vehicleId){var i=yi.filter(he(e.vehicleId))[0];i.removeRoute(e)}Ai.splice(Ai.indexOf(e),1),t.$broadcast("Planner:Route:Remove",{route:e})}function se(e,t){var i=new l;return i.plannedDate=di.start,i.latitude=e,i.longitude=t,i.zIndex=2*(xi.length+1),xi.push(i),
i}function oe(e){for(var t=0;t<xi.length;t++)if(xi[t].id===e)return xi[t]}function re(e,i){if(angular.isUndefined(i)&&(i=!0),e.routeId){Ei.push(e);var a=ge(e.routeId);if(a.removeVisit(e),i){var n=yi.filter(he(a.vehicleId))[0];n.recalculateRouteStartingAt(a,Pi)}}xi.splice(xi.indexOf(e),1),c.removeAlertNotification(),t.$broadcast("Planner:Visit:Remove",{visit:e})}function le(){var e=g.getLatLngBounds();if(angular.forEach(xi,function(t){var i=g.getGoogleMapsLatLng(t.latitude,t.longitude);e.extend(i)}),Ri.fitBounds(e),xi.length<=3){if(0===xi.length)return Ri.setCenter(g.getGoogleMapsLatLng(-33.45,-70.666667)),void Ri.setZoom(11);Ri.setZoom(12)}Ri.panBy(1,0)}function ce(e){u.merge(Pi,e),Pi.fmv=parseFloat(e.fmv)}function de(e){u.merge(Di,e),Di.fmv=parseFloat(e.fmv)}function ue(e){u.merge(Li,e)}function pe(){return Pi}function me(){return Li}function ve(e){return e?Ai.filter(function(t){return t.id===e})[0].backendId:null}function ge(e){return e?Ai.filter(function(t){return t.id===e})[0]:null}function he(e){return function(t){return t.id===e}}function _e(e){Ri&&Ri.setCenter(g.getGoogleMapsLatLng(e.latitude,e.longitude))}function fe(e){Ri&&Ri.setOptions({zoomControlOptions:{position:g.getZoomControlOptions(e)}})}function be(){function t(e){return e.data.map(function(e){var t={id:e.id.toString(),name:e.name,username:e.username,selected:!1,group:_("Driver.group_available")};return angular.isUndefined(u.find(bi,function(e){return e.id===t.id}))&&bi.push(t),t})}function n(t){return e.error(t),a.reject(t)}return i.get(ii).then(t,n)}function ye(){function t(e){return e.data.map(function(e){var t={id:e.id,name:e.skill};return angular.isUndefined(u.find(ki,function(e){return e.id===t.id}))&&ki.push(t),t})}function n(t){return e.error(t),a.reject(t)}return i.get(oi).then(t,n)}function we(e){for(var t=0;t<ki.length;t++)if(ki[t].id===parseInt(e)||ki[t].id===e)return ki[t]}function Ae(e){return function(t){return t.id===parseInt(e)}}function xe(){return ki}function ke(t){function n(e){return e.data.map(function(e){var t=new r;angular.extend(t,{createAt:e.created,estimatedTimeStart:e.estimated_time_start,estimatedTimeEnd:e.estimated_time_end,vehicleId:e.vehicle.toString(),id:e.id,totalLoad:e.total_load,totalLoadPercentage:e.total_load,totalLoad2:e.total_load_2,totalLoadPercentage2:e.total_load_2_percentage,totalLoad3:e.total_load_3,totalLoadPercentage3:e.total_load_3_percentage,startTime:e.start_time,endTime:e.end_time});for(var i=0;i<yi.length;i++)yi[i].id===e.vehicle.toString()&&(yi[i].shift.start<=e.estimated_time_start||yi[i].shift.end<=e.estimated_time_end)&&(yi[i].enabled=!1);return Si.push(t),t})}function s(t){return e.error(t),a.reject(t)}return i.get(ni,{params:{planned_date:t.start}}).then(n,s)}function Ie(t){function n(e){return e.data.map(function(e){if(angular.isUndefined(u.find(yi,function(t){return t.id===e.id.toString()}))){e.shift_start&&(e.shift_start=e.shift_start.split(":"),e.shift_start=e.shift_start[0]+":"+e.shift_start[1]),e.shift_end&&(e.shift_end=e.shift_end.split(":"),e.shift_end=e.shift_end[0]+":"+e.shift_end[1]);var i=o.fromJson(e);if(e.default_driver)for(var a=0;a<t.length;a++)t[a].id===e.default_driver.toString()&&(i.driver=t[a]);return i.shift.start||(i.shift.start=fi.start),i.shift.end||(i.shift.end=fi.end),yi.push(i),0===i.locationStart.latitude&&(i.active=!1),i}})}function s(t){return e.error(t),a.reject(t)}return i.get(ai).then(n,s)}function Se(){angular.isDefined(yi)&&yi.map(function(e){e.setVisible(!1)})}function Ee(){angular.isDefined(yi)&&yi.map(function(e){e.routes.length>0&&e.setVisible(!0)})}function Ce(){var e=[];if(angular.isUndefined(yi))return[];for(var t=0;t<yi.length;t++)yi[t].active&&e.push(yi[t]);return e}function De(e){e.setVisible(!0);var t=g.getGoogleMapsLatLng(e.locationStart.latitude,e.locationStart.longitude),i=g.getGoogleMapsLatLng(e.locationEnd.latitude,e.locationEnd.longitude),a=g.getLatLngBounds();a.extend(t),a.extend(i),Ri.fitBounds(a)}function Pe(e){e.routes.map(function(e){e.visits.length>0&&e.visits.map(function(e){e.setDefaultColor("#A4A4A4"),e.setVisible(!0,!1),e.updateOrder(null)}),ne(e)})}function Le(e){for(var t=0;t<xi.length;t++)if(xi[t].backendId===e)return t;return-1}function Oe(t,s){function o(e){return e.data.map(function(e){if((!e.route&&!e.vehicle&&!e.driver||""!==s)&&angular.isUndefined(u.find(xi,function(t){return t.id===e.id.toString()}))){var t=new l;return angular.extend(t,{title:e.title.trim(),address:e.address.trim(),latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),contactName:e.contact_name.trim(),contactPhone:e.contact_phone.trim(),contactEmail:e.contact_email,duration:n.duration(e.duration).asMinutes().toFixed(0),notes:e.notes.trim(),reference:e.reference.trim(),load:parseFloat(e.load),load2:parseFloat(e.load_2),load3:parseFloat(e.load_3),priority:e.priority,priorityLevel:e.priority_level,plannedDate:n(di.start).format("YYYY-MM-DD"),skills_required:e.skills_required,skills_optional:e.skills_optional,sms_enabled:e.sms_enabled}),e.contact_email&&(t.contactEmail=e.contact_email.trim()),e.window_start&&(t.windowStart=e.window_start.substring(0,5)),e.window_end&&(t.windowEnd=e.window_end.substring(0,5)),e.window_start_2&&(t.windowStart2=e.window_start_2.substring(0,5)),e.window_end_2&&(t.windowEnd2=e.window_end_2.substring(0,5)),e.estimated_time_arrival&&(t.estimatedTimeArrival=e.estimated_time_arrival.substring(0,5)),e.estimated_time_departure&&(t.estimatedTimeDeparture=e.estimated_time_departure.substring(0,5)),""===s&&(t.backendId=e.id.toString(),t.id=e.id.toString()),xi.push(t),t}})}function r(t){return e.error(t),a.reject(t)}var c;angular.isUndefined(s)&&(s="");var d=angular.copy(xi);c=t?t:n(di.start).format("YYYY-MM-DD"),d.forEach(function(e){n(e.plannedDate).isSame(n(c),"day")&&e.backendId&&!ct()&&xi.splice(Le(e.id),1)});var p={planned_date:c,not_assigned:!0};return""!==s&&(p.status=s,p.not_assigned=!1),i.get(si,{params:p}).then(o,r)}function Te(){angular.isDefined(xi)&&xi.map(function(e){e.setVisible()})}function Ve(){angular.isDefined(xi)&&xi.map(function(e){e.setVisible(!1)})}function Re(e,t){angular.isUndefined(t)&&(t=!0),ze(),e.setActive(!0),e.setVisible(!0);var i=g.getLatLngBoundsOnPoint(g.getGoogleMapsLatLng(e.latitude,e.longitude));Ge(i)}function Me(e){e.setActive(!1),le()}function ze(){Ti&&(Ti.setActive(!1),Ti.setHighlight(!1,!0))}function Fe(e){xi.map(function(t){return 1===e?void(t.options.visible=!0):void(t.status===e?t.options.visible=!0:t.options.visible=!1)})}function Ne(){function e(){return function(e,t){return e.status<t.status?1:e.status>t.status?-1:void 0}}xi.sort(e())}function $e(){xi.forEach(function(e){if(e.error)switch(e.error.type){case 2:e.setDefaultColor("#FFCC33");break;case 3:e.setDefaultColor("#D9A60D");break;case 4:e.setDefaultColor("#FF5252");break;default:e.setDefaultColor("#A4A4A4")}else e.setDefaultColor("#A4A4A4");e.setOriginalIconColor(),e.setOpacity(1)})}function je(){angular.isDefined(Ai)&&Ai.map(function(e){e.setVisible()})}function Be(){angular.isDefined(Ai)&&Ai.map(function(e){e.setVisible(!1)})}function He(e,t){Ai.forEach(function(i){if(i.id!==e.id){i.collapse=!0;var a=qe(i.vehicleId);a.setVisible(!1,t),i.setVisitsListed(!1)}})}function Ue(){yi.map(function(e){e.recalculateAllRoutes(Pi)})}function qe(e){for(var t=0;t<yi.length;t++)if(yi[t].id===e)return yi[t]}function Ge(e){Ri.fitBounds(e),Ri.setZoom(15)}function Je(e){ze(),Ti=e,e.setHighlight(!0,!0),e.setActive(!0)}function Ye(){Ti=null,t.$broadcast("Planner:Visit:hideInfoWindow",{})}function We(){var t="\n",i="	",a="",n=p("translate")("Excel_Header.driver")+i+p("translate")("Excel_Header.vehicle")+i+p("translate")("Excel_Header.route_Index")+i+p("translate")("Excel_Header.stop")+i+p("translate")("Excel_Header.title")+i+p("translate")("Excel_Header.address")+i+p("translate")("Excel_Header.service_Time")+i+p("translate")("Excel_Header.arrival_Time")+i+p("translate")("Excel_Header.distance")+i+p("translate")("Excel_Header.order_size")+i+p("translate")("Excel_Header.total_size")+i+p("translate")("Excel_Header.latitude")+i+p("translate")("Excel_Header.longitude")+i+p("translate")("Excel_Header.reference")+i+p("translate")("Excel_Header.warnings")+i+p("translate")("Excel_Header.visit_load2")+i+p("translate")("Excel_Header.visit_load3")+i+p("translate")("Excel_Header.route_coment")+i+p("translate")("Excel_Header.notes");a=a.concat(n)+t;var s="";yi.forEach(function(e){e.routes.forEach(function(a,n){var o=a.comment?a.comment:"";n+=1;var r=e.driver?angular.fromJson(e.driver).name:"";s=s.concat(r+i+e.name+i+n+i+0+i+"Inicio"+i+a.locationStart.address+i+i+a.estimatedTimeStart+i+0+i+i+a.totalLoad+i+parseFloat(a.locationStart.latitude)+i+parseFloat(a.locationStart.longitude)+i+o)+t,a.visits.sort(function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}),a.visits.forEach(function(l){var c=l.error?l.error.msg:i;s=s.concat(r+i+e.name+i+n+i+l.order+i+l.title+i+l.address+i+l.duration+i+l.estimatedTimeArrival+i+" "+i+l.load+i+a.totalLoad+i+parseFloat(l.latitude)+i+parseFloat(l.longitude)+i+l.reference+i+c+i+l.load2+i+l.load3+i+o+l.notes)+t}),s=s.concat(r+i+e.name+i+n+i+a.visits.length+1+i+"Fin"+i+a.locationEnd.address+i+i+a.estimatedTimeEnd+i+a.totalDistance+i+i+a.totalLoad+i+parseFloat(a.locationEnd.latitude)+i+parseFloat(a.locationEnd.longitude)+i+o)+t})}),a=a.concat(s);var o=new v([a],{type:"text/plain;charset=utf-8"});m.saveAs(o,"SimpliRoute_Plan_"+di.start+".txt"),e.info("descargando reporte txt")}function Qe(){var i=n(di.start).format("LL"),a=null,s=[],o=null,r="",l="",c="",d="",u="",m="",v="",g="",h="",_="",f=0,b=1;yi.forEach(function(e){if(e.routes&&e.routes.length>0){if(o=e.name,e.driver)try{r=angular.fromJson(e.driver).name}catch(t){r=e.driver.name}s.push({columns:[{alignment:"left",image:"simpli",width:200,margin:[-20,-10]},{text:"",width:150},{alignment:"right",text:i+"\n"+p("translate")("Pdf.vehicle")+": "+o+"\n "+r}]}),e.routes.forEach(function(e){var t=e.comment;(angular.isUndefined(t)||!t)&&(t=p("translate")("Pdf.no_route_comments")),e.visits.forEach(function(e){l=e.title,c=e.address,d=e.reference,u=e.contactName,m=e.contactPhone,_=e.notes,v=Ze(e.skills_required),e.windowStart&&e.windowStart.length>0&&(g=e.windowStart<"12:00"?e.windowStart+" am ":e.windowStart+" pm ",g+=p("translate")("Pdf.to")),e.windowEnd&&e.windowEnd.length>0&&(g=e.windowEnd<"12:00"?g+e.windowEnd+" am ":g+e.windowEnd+" pm "),e.windowStart2&&e.windowStart2.length>0&&(h=e.windowStart2<"12:00"?e.windowStart2+" am ":e.windowStart2+" pm ",h+=p("translate")("Pdf.to")),e.windowEnd2&&e.windowEnd2.length>0&&(h=e.windowEnd2<"12:00"?h+e.windowEnd2+" am ":h+e.windowEnd2+" pm "),++f,s.push({text:" ",margin:[0,0,0,2]}),s.push({table:{headerRows:1,keepWithHeaderRows:1,dontBreakRows:!0,widths:[150,"*",130,100],body:[[{stack:[{text:"R - "+b+" : "+f,margin:[0,-5]}]},{canvas:[{type:"line",x1:-115,y1:8,x2:360,y2:8,lineWidth:.5}],colSpan:3},""," "],[{text:[{text:p("translate")("Pdf.name"),style:"tableHeader"},{text:"\n"+l,fontSize:10}]},{text:[{text:p("translate")("Pdf.id"),fontSize:8},{text:"\n"+d,fontSize:10}]},{text:p("translate")("Pdf.coments"),alignment:"left",rowSpan:2,fontSize:8,style:"tableHeader",margin:[0,2,0,0]},{text:p("translate")("Pdf.signature"),alignment:"right",rowSpan:3,fontSize:8,style:"tableHeader",margin:[0,2,5,0]}],[{text:[{text:p("translate")("Pdf.address"),fontSize:8},{text:"\n"+c,fontSize:10}]},{text:[{text:p("translate")("Pdf.contact"),fontSize:8},{text:"\n"+u,fontSize:10}]},{text:[{text:"",fontSize:8},{text:"\n",fontSize:10}]},{text:[{text:"",fontSize:8},{text:"\n",fontSize:10}]}],[{text:[{text:p("translate")("Pdf.windows"),fontSize:8},{text:"\n"+g,fontSize:10},{text:"\n"+h,fontSize:10}]},{text:[{text:p("translate")("Pdf.phone"),fontSize:8},{text:"\n"+m,fontSize:10}]},{text:[{text:p("translate")("Pdf.skills_required"),fontSize:8},{text:"\n"+v,fontSize:10}]},{text:[{text:"",fontSize:8},{text:"\n",fontSize:10}]}],[{text:[{text:p("translate")("Pdf.route_comment"),fontSize:8,colSpan:2},{text:"\n"+t,fontSize:10,colSpan:2}]},{text:[{text:p("translate")("Pdf.notes"),fontSize:8,colSpan:2},{text:"\n"+_,fontSize:10,colSpan:2}]},"",""]]},layout:"noBorders"}),g="",h=""}),f=0,++b,s.push({text:" ",pageBreak:"after"})}),b=1,f=0}}),s.splice(-1,1),a={content:s,styles:{tableHeader:{fontSize:8}},images:{simpli:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAEsCAYAAAA7Ldc6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAJNtJREFUeNrs3V1u20iiNuDqD+f+eFbQ6hXEAXQf+b6B2CuIvYI4K7C9giQrsLOCOMDcW7kXEGcFUa+gPSuYw7JKXxS3RUn8J/U8gOCZji1RxSJZL+uHIQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0wC+Ege02y12VLn31oLwAA9N9vioB1jf7sxyR7vU4/R+mf7schvGxhW/7OXg/Za5q9vsaf2Xbc21MAAAII/Q0dMWQcZ683YX2PQ2z4H7Wwbf995j/Ps9dtDCTjxU8AAAQQOh46Yu/C6YbQ0dUAsuohhZGPekYAAAQQuhc8JtmPt2HR47GLrgaQVfMYRLLXzXgRTAAAEEBoKXicZj8uws85Hbtqcw7Irpa9IlfjRSgBAEAAoaEG/HlY9HgcVPCW/2qyZ2G26KX5XPJtbgQRAID2/T9FMPjwcZn9+BEWvR4HFb3tccNf43UF73EayyErj+tZ8d4fAABK0gMy3OBxGsoNtcrT2DyQ1Hvzo8LwtPQhLHpEzBEBAGiQHpDhBY/D7HWX/c/rUN+d/kmaxN6E8xrCx/J9Y4/IuVoDANAcPSDDCR6xkX4RmmtQ1z4Zvcbej398l+x1ZvleAID66QEZRviYZD++hWbv5h+m+SV1+txA+Hj8LrH8Gvg+AAB7Tw9I/8PH+9DuMKLYc3BTw/eKQ8hOW/g+ekMAAAQQnmmgx7v2sZF+2IHNqTSEtBg+luLE9Hd1BCsAAAGEPoaP4xQ+Djq0WTep0f5Q4nuN0veaDOU7AQAggPQ9fLQ95CrPPCyWtr3Z8TtV/aDEKsWhWCceYAgAIIDsW/CIDfPYO3Dcg82dZw32P7b8XnEI2V0Hg8eq2ANyZF4IAEB5VsHqT/i460n4iEY7/O5Bx8PHchvvZt2YbwMAIIBQa/hY9hBo/LbnJnu91AMCAFDe/yiCXoSPA6XRimlYrPA1VxQAAAKI8EGd4mT6S8UAACCACB/U7cwzQAAA6mEOSPfCx0j4aNWV8AEAIIDsS/iIoeOz8NGaqWFXAAACyD6FD6tdtSc+6+NMMQBV+fPPPw/iS0kA/MockO54L3y06qPVroCiQSOdv+Pr95X/Hf/7UVisqAeAANIds8Wwn1Ml0aoPimDwjcRJ9uPNSuMwekiNwy/Z6/bf//73g5Iipw6NwmKe3iQFjeX/buKz4zXidaq7o/Sf58v6m9XdW3sI6IvfFEHr4SNevO6G9r3GW9atjnz/22x7T9TGwTYa413o6+x1vOFXY2PunYYca+rRXcGwcZTVqWmJzz1M9XdTD/k01V8PTAU6zxyQdsPHKCwmndOuL4pgsI3GeIx92yJ8RI/HY7rTDF2ov8sl2bcZnhvD0V36GwABhLXiXS0TFNvnjuFwfQ4/h6tsfVym4VrQdnjedUn2gxRCXFcAAYR/SvM+NHI6YCyADLUBdxqKL+zwXgnSsotQ7AbVQfpbgM4yCb2d8HHoAtEZc0VQWYN/FH5O8H6RGkIHOSFgmn7Gid/f0764r3AM+5sSf3sYh7IYT0+LTkv+7TtFCAggrLpWBALIQELHYWroxzkWox3/fLLyv49X3rOqlakmJb9e/HsBhDaOq7J192DXAL3ymcvlg8PKjYRN4uf8J91MiP97nn22cysggHRFGnplkmB3GCtdrIF0Gha9eKOa9slxesX5GLehnWVy1Q0Gd25L80Ni2HgVfn1eSdmw/vRzlmEkHrtTvYl7dX14rFfZPr9RGggg3QgfsbH2Vkl0ijC424UlhoL3NQWPdZZh5H0KI1eb7q5aCQjW+hyamX+4DDqTdEzGYzYevx/1jgzqmhD382lY9JYdPrmmCiCsZRJ6s94Hd1W7GgzZcJHJXp9DsVWlqmzQxAvdj01L5brbCp0Tzxvn6fi9TnPG6L/D1LY5DW7oIYB0spE7Cds9i4B2TqCsDx+xfL51rP4+VPQ7eYQYuly/+1x/lzcSLu1qEECol1Wvumkafq7GxPPhIz6LYNSlxtmWTyu/raBuQONSD968TPhoeL5U4etido75pjcE9o85IA2YLe72TJRE59yMQzhTDGvDxyjs/iC0JmwbLK5C8aVMP/SkAcdwxfp7XeJvi/7dfCX8bBVk0rli9fVqh2veYw9r9h5Hhk6CAEK19H508OI+XqxIxnqfQzfnLH3c5pfiRNesUXNV4Pi7L9GAg0rEFYSy+vsm7H7z6mbLHsLnPvOy4N+thpbVYBJvAGzzHZZPcH9pgjrsB0OwapZ6P0ZKolPO2gofs548YTuNze7i3Jj5LndJU4NqlzAR3/tI7wcdcRJ2G0oYw0dnenVjiMpeR/GYCpuHNMYQ8jmtqgQIIJRk2d3uiI3Kl+OWlgZMz4A5n3V80ntqAHS13n4q0Ai63KIBFOtGXN73pfBBhxrwcb5TDCExVMzzgnkMK10KH0++xzQFkU1PZ4/nxnN7HobPEKx6G5yTYIWlrni8QI9bWhkmhY6LlVDa5bknsQHQ1buQhcJjbADFAJLGqsfjcrTyz9P079DVIBLr/U1aFGKycnw+hB495C/bzg/pAYV5c1vixPQbQ7FAAKE4vR/d8DisZlzN0pZFw8fdyn86nS3moMz3oN7ep0ZS/K5/rfz3/10J55Nt36tsoyT9/Y1Dgp4GkfvQ8+Wh09yWsCmEBAuEgABCoUbnKHjuRxfExua7DoSPpz0Kp6GDk+DTk87L9n5Mw2Ko1O22w5lWeiZe5xw3H1VnGESQiiHkVVi/St1x9u/vDIcEAYTd6f3oQPgos8xuFh6OxyWeJTFbDGVaN+n8TejmKlxlhwwWmgS70jNxk+agHKdjaHV7blVpGIx36Th/7obH8hxwo5hAAGE3p4qgVWdlJpvPFsMD4lCp2DC+2uW9ZosL58WGxvyobMCpyasSf3tbxSTYdNdzGUYmqSzn7obun7T/n5qbH9B/8XiOcz3C+knnrwQQEEDYrfFaxTAWinlI4eO24L6L+y2Gj+UwoFH8/2n53Hgx/Jq97lfnb6S/iWFjOXxotOXHxd/vWgAp0wNS+bMzlpPHe9hwHqV6cJjOBb8/qRfPNqzTK9bh72Ex1n9aNHilxnt8vQg/6+jqeWk5P2f5ebGcG3mCdurlOgw/H1y33MaDbepgmkMQ0jbPl9vvQXa98ykngBy2dOxONpyP2L+bHvZ/DX5TBLUEkMe75/tcBuMt61ZaKeyuwvBxVHSlqxQk7hq+8P2rrfkpa06+/y0RFjp3Psm+z/uC+/Pdto3ZdME6TI3oUdj9wXGbxJD6cdPFb2XoWt48mm0/71PRh9mt2a5lGb16JghVab5SXvOK69JdwX17VLThkj6zyLF4VOR7tHEMZ9vz97r60MT2pHlvr8M/V8db5z4F369VHSNrwnnjDeAin53Of+vq6VFV21bXd08ry70J269autz/XwSScvSA1KPOyefLC+yXsLgT/zD72eh5tcfBJ54UToquLJUmi38OzT800jjneh0WbDQebGiwvArNLbMdPy9Oyo0Xu6unF73UaIh3kd9W1LBffl48ls5KNJ7fh+aXIh+lsjhfV149M9mDY/R+3feMdbuOHrnUQ/k2XS8PCpxTDlMdi8dI7MX5UOF2HuY06OsOZFV/9l2F2/ZbxXUg7vuLAtf8p/v/Ki2TzY48iLBiNQ6/iie3uJrTH+PFz+nyznlsdI9/Trj+I/RwyEpJ8fselQgfk3SiHLWw7a+HshP26AnGn1Mjt+khIo/1NDbsl2Wdnlj/I11Iqy7/Ufq864L7to0yeq68PqcGJ930sKGxV/V5Kh4z30I1zzsapWPvR/a+HqDYj+vUJHvFc+Z1Bdf8+Pfx/Pgjb+gWAkifG5TLoUUfNv1iCiOx23NfEnkMXoWf8TFb3AG7C+3N2RnSScsFuLlyvksX0YsG6u5p+ry+Bsx4U+hb6rmie7431PA8zF7fajpm4vvFGwN3e3Qjpo/h432o52bjKJ0jL5WyANKmqhuUheY1pN6QoYeQq5LL7MaTxXXL3+FgNpwQ8jaNp6V+h6HZHrvDnoeQuN2fUwOE/Wt4noZm5vfFc/kP58HO7f+DNPep7ptkF7HHWIkLII2b/VzRpepGdtGVXeI66/OBFndc6eqyxL6KJ4mLjnyXLg3DKlNfDlIj1cV3uKHnouff4VwDoXNeNBA+rsN2vR7xWhtHGsQV/U7CYjTBSfr/N1ueH50HOxY+Uvic7LD/z9K+X77O0n/fpi126hyzHZPQq1V1F/98m2FX66QJ6leh/bv8VerjSlebTDq0LfclQ3Qs3zjcJda7D57dMTixAd/31V9iAyFU8cwaKpEXDOZl3nglfGy6pnwMi4eorvu825X3jNeOtyF/vucyhBzt89LQHVkZ8fMW1/u4f6+22Vdp/19saO/Fc8xXk9Pz6QGp1quK36/0En/pAXpDaQTOS4aPUQfDR3Q4685zY75W9D7LiZmXxkQPzhBuaJymxintG+U0YAsHkNRQ3DTkLt7g+yP7nMttPys2UlN4fbnhGr0MIc5/LUlzMiYbwmcMiSfbBsW0/5e9Y3ltq/cWvxBAGm1IVvx+Xyp6n+kAyjaeHF6WCB9x33zrYPioq+60FnqfXIBjEPk7rURkEvBAGowD2ZfvDZNpvYE4ygkg9yXe93HOT8i/sROXmH5XtJc2BpbUEL3acA78bE+3UrcmIX/I6H0Kn9OC+3+6IYQchP4PWRVA+iDdwa407Y6rCw7fGyqGuL3xztC/dgwWm+aq3IR+r3S1jUkXNiLdBawjsMYGawwhf6dlXTX8+u3NAL7D48pFdmWrjjdcG4ra9HyHs6qGx8Tek5C/GMrEEr2tuN5Qt47KDhFOvSZ5D1s81QsigDRhnxtU0xQQjtLzSLY+qOPvxnku48XzS86eCSKPzzcpGT62nYDYphcd2parmht9cZ98S2unnxui0M+GY0P7bfrkVfV4+omhWK16m/NvhUYApAbfeRPhY6UhGt8vb77mhfNcc9Ixva7hP68ifDwJIVcbwjDPMAm9wgvZHn7neADHcFDJsJ00X+UmLY97kd678IUirXTVl8ZFZwJs7FrOTuA3DZRdvEDEO9Dv0+d96vnk5k3eLRvQq98zNZji/n9dcZnH4zLO6blffl7qeVpOohxVcM67raGcXm4aj52GV7ypqLxiWdwEmm4kXubUwYesDtyW2J9rj4m6JgbH4VypXj53Lj9IoejSnm9EXh04qXpxlNgLlu37N2vqc+zls+CFAFKryu9gx3kL42ru+NVxd/2x63FcwwT3uLzubNErUrTXI57sr0P1q5LV3RjvWmN50uB2xYZk7K6epiAyuAZh9p0+rPnv87C4K3ebff9PYfPY9U03BeKKPs+uQJYa9vF1kxqAZe7OHdYRQLaZDJoC1TSttnYdyt0AepzTUqLBy+7hY9OSzh8Lvu8oJ5Q+NNAQjO//bc2/vRVAGqlbpznXrQ81rkq2bsXRA+eX5xmCVZ06ulcnHXufpZu6wsdKCCkTPu56Fj6W2z7pyrakxutJaH4FtVgG12l41um+nURSw/qkxFvM04o+D1t81mUod+f/VQfKK37fo1C+B+NNoKkG4iSdo/NCdNHl5/OGdH2se1nw1LhdVxcPDPdrxNsNIaEueQHjtd0igNTdcGryQNq2UXtccTgqNSej5gZ811e6aiPElr2YblpqsC6jFET27oFey7v7Bf/8cMex5u9K7N+DDpXZWSi3eMKxMfqNhI/LsHlBkLMSQeG4hlCzqysN0dbq1yjn+n9TZwBN770uhFh0RQDpndEsfzLdNqpc5WW5YlXnpN6Du9C9oUw7NR472BhuM4Qsg/231HDZJx+bqEcbLpp9q69nJevpxCWnlkbh453/2KsZNg/5e1d0qEq6UbHu/H/b1ENR05DKe0G3Fcc1nVO39VUAEUDaaPzW5WJWsPLOFuGjqgb545CcjvZ8nIbuL7PbWymExFXKpi1uxkXqDTnYkzIvM15412P+60DKbF6ykeHudHWhY5JWuIvzmf4Oi7Hxm+rl1bp5UhU0Pr80XASfBN1WrDuGHxp6Iv193jFh9/zKJPTue3yQ0WzR+N/6AEo9J1WuPX41zn9WR1vh4zIMZ5m7V13dsHT38CitZ3/RUtiLJ/AYQo6aupvZsmnBxsqowOcUbmh2bOWyDyXOB3t/l7JgT+OrJ2VY5NxQxdK4r2oK9EXEz3ufs50mJNd3jaj0HLfjdTIujJHXlkMAqdyogfe/m22x5G1NK0DNx82Nn90lfPRpmd1BiHco05K5MYi8beGkGhs4sbfr5R4U97yhfTrPuWj2rX4+ZN/ltuD5zzCJ5m/m3KfwcV/RuaG1xuczx9TDmvOjelZPeM4r1+8d2MRaVg3sM0Ow+hFAluk59oR8i0OOZk8+Mw4DS0OufoTqV4C66lJhx5A1W0w2Fz5aauSlFZTWPTyy9hN5drHZhydY/zW0sNOQwkPK9m3BgxbFxnmc7/GyivCRJh8f5IScNqz73IndX1sbKXQghN7bFdvRA9I/8QJ5nRrijTRMxt17SNddGOZdpF59pzQMKtaNm4ofDLeNOL78y8AfXNikGEBGA/kuZRoAhknUX8/iPJ2qVyQadSTIP62HwkZz8sr6cCi9vAII+6SLXYZDHf/f28bPyoPh4ippsQfudaj/WSxxuIgA8k8v9vnLbxiHLYC0d84+amgicJWBtIz/rPuHDs6dGrou9Ji/sBt+ZQgWm3zq4DZ9sVs62/iLw7Pi3c34ML1/hcWyzXU1ACYDX1mkaANFI7o4Q7CKm2+ok3Ueq5OelQf7x3n5CT0g5HkYd3M849Su6UcYCYvFCz7UOETrjfrAmnPERDHsfMz+Vubvs+M8b2GQ99m/T1vqBRFAoGP0gJCnkxeKsUlefWzYTNPTquPE9ZsK3/pY6UJnbOrxvPMgPmryquPbp90igDCQA8bB3M8gMl8JItMK3vLAykXQmeM79nrmPZH+cTVHJcUetgn+Yxf9yhAs+nrAPNg9/Q4iYfFgwyqe5TISSHmmTtDOsX2fFqO4XvMrce7WZVrKG2pvr5QdWkg99IAAbTZW4t3Sm5JvoweEqgLIVNFVclzfbDiuLypeQGLewWKYqAkggEAf7Otd/Hi3VI8WlTDHoFPHdd457brCfZUXQLpYH+aqR6PnBGFQAAFy7GUjPI0bL/O8md9VHVYcOgY7c1yf5fzKKKwfplXlfmurh/RFTtkIIEKdAKIIKjEd6PfqcsNupNoNyl/qAhWZlGg0m0tUbQiJ5fku51eO//zzz+OKPmfnINDSNapwQ1nvXuEAMlE8Agj90smx9bNFl/oQG51zVQ5Ke13w74SPekJIfBbQNOdXqhqKdd+x69hhDfXMfLdix69ecgFksIbabX846+b42clAy/uvPT6GylwgBDceZQ3ZUYlGWl0BZGLPhJNQ/9K86/bfKNWLJuthXq/O1xL1UA/I+qD7kHMtcAwKIMM08AfjdfHAfTXQsu5MkI0X7Ox12pN6ts/BjV+9L/G3X2vapr2/+7rFfJC4NO95yY/J239NP7A0rxduukVZraMHpHgIVXYCyGANtRfkdQe3aahPv+5SkI3hIw6N+BHX7K9z7HF8/1BuSJ2JwyzvOpc5N0zrOl8Zu//YsI4LTeQtNnFRspzy3vtNg/XwIKcezrecZ7Tud1450guH0DeKRwDZt+Tdd6ddGoY1W5zYRwMt63mHtmV5so5lfZG9/s4urJ+rmDD6TPi4cOzxpAG3699MQrkVle63WJmoaNCN3+e9Pfto01PSC+/DDavpHTa4FOtxWH/N3Ha1v3XntEnPjuWmr9V55Xvq8BNABJD+Oe/QtrweaiGPOxJAUlf1aM2FNYaQ/6Ywcl7kop6Gd8W//VFB+IgNj6nTz6Ase91GW9SlgxRi70K5GyWftvid7yXe/zTbzut97wnZYihW2VWxvuT820VDXzPvcz5u+R7fc+r8ccf2ad75d9Twtsxz2mIHFQzzo0L/owgqM+Rx6G+z12VHtuVjyL/D1FddakRv01X9/4e7ZCf1+ONh5cT/8MwF9Pd0MRpVfFG6DQzNQWrExSE59+nY+OtJwyIG3xfpZxXngpstfqfsUL/T1MCOnxWHitzv4/Mg4lCsrAxuw/phSu+zf59umAux7r1vsr+9WHOOifNMjtNQsFpsGE463WF/Tzecn7t23ntYcxxOWri2xTbCup60eE65KVK3qJ4ekOoMuQfkXVc2JE34PxlgGXepIXJasNE4Sa/jZQNy5XWa/m1U8bZ+ceoZtNgbF+9axiFMdyuviwpvRGzbIKniHH+Qvk9c9Sn29Nzt6X7NG4o1CuV6K65y/u26rmFBqef4ouB2PQ1S9znXhOMOTqhed2w0PmIhhtCcsis1zA8BpJPGw30Y4dl4u7uDTZf1u4GV8/cubETq3u9L79I8XWygqIdtG4Y1DfXby/lLKfDlncPPizayt2iAfq56KFx6v7wweVug/uQNC+xaI3rtM1hamAeyKewdp54qBJBBGdrFpHPhYyWExIdbDanx2ZUA26c5NlcByvm44zCoqoe+7O0S0iko5J33ykzcz5tnEoPNXVUhJDWw8+YgbQpb6+Rd32LDvksh5GtN+7FM3cprj8WhWBaGEEAGZTqg79LZ8LHi3UBC30OHniXTlyWOp3o/KCnOwbjc8W+qHvK37yu4bXo2yGnBBmi8Fl9tEUJKDWVKi3B8C/nP53hXZK5P+psPOb9ymhYDab3HOs2rWTek7rjsM6XSwiWTAnUrb2hl7GW7q6OHJo4kaKnnRwDZY18H8j36ED5iL0g8uZyE/j8HohPBNV0k+jD8arnfodE6tGF4jwBSrJGdFxQKPxskhcvphhDyLd4J37WxmBrEsQdi0+prNyVvlFxtuL4dp+9wWlEQKRPI8noHr4sMe4qhI5VzXDHx7Y77Px5bm3qeYqj5kVaoKxtGD1Nditv6OXho5EZWwRpgQ3IfwsdKCJnPQjgKi7tQgms5fRh+FS/GR1YxoYI6VDRInIX88f5bb4d6/Cje5Y8rOz0XAuJ/i5P2Lwu+90naV3mNwfj+52llrtjDdf/cwwLTHfjDdJ6cbPHZMXyclQxoD9nnnmyob7GMYiP9cfWwsJhPuGyLzJf1PIWs0ZO/i68X6WfZBvNVyF8YIobJ5QpeX1a37UkZx79/Ff75zK/HB3rucsykVdFC2Dxn5jQsepTmqey+p5sD8+fOEymsHKyU33PPJ3sVrNIogDTYGH6YLSptX5Nv6+Fjtjixx5PFp/GWF504fGm2aBT0dXWL1oPrhqf3dkW8EJxs+SRhyAsfhetQHN6THS9VnG/U45+N7Hin+vOaX3mb/fuHgsvyxvc+Su+9KTQ8XVq8jNLho0B9O1j5Dhcr5/am9uM8+6yPIX8lsGWgPC+4bZNdG/U7hJDl9p0+uTYWLRI9IBsYglW9vi4LWip8ZAHgfFbigItPOJ/9XGIzngQuZjs0iNO23/Sw3OddmP+RLu6buvvbFC86L4UPSgbYoyrqUBpWU7aBqS7/LM94fE9zGtbnJd479jTFEPKhoa/zrqrwUXF9a2I/XoZ67/q/LlF+L0Ozy91PHNkCSBsNpX0LH4/dv9nr22zxOp9tOPiyfz+Iv5O93s8W4zufu0N1vUuoGS9O0PfqS6mLxx/pQjfvyGbF7Yi9HieGq1DCh6oD7Eqjpuh7/mW3/KKWuSAr+yv2spzUeG67T3WslqCT6ttR6NYzo55tT4T6bgYelii/+3S8NhVEQwef1yKADFm6mz3v0SZXET5On5wgHh8alv3bf1MguXvyioHj77Do7Yh3tkZr3v4ghZBdLjzxBN2nhmqneszS3cI4fOCPVJY3LdXnaaybcTvqfHIxnTStOODHRuG7OgJsbNRkr5eh2M0PPSC/luV0Q8P1vILPuE2N0Cp7e+fpXFV7D20qo6q3P+97xfJ6lz5zl2vIWfq7Ksv4Kl2Tyl7f4nb9kepaXWUYy+1Ij30+c0Dqq3znPdjOqsNHpXcsVv4+fs5WK9akeTh9mZQ+7/IDLNPF7nH70p2cOCQuTribhHpWy5qmQHZbYoIw/W+IHqUJs7G+bTvh92nD/lOT9Sjdnb5ZOU5ebdrumh5s2HdXOdeUuArSZQX7KjY6L+O8kpU6VmT+2+Nk6qaXA69w+1c9pOPma/p5X/bYiT1B2TbepP35pkBbYJ6uCZ+qPlbSdztLc49WzzMHJcrvNpXfrd767fymCKo3W9zR/yF8VOrDeIeHOc0W29b1Sek7facuWVlRJZ60/3fl4nKQc6FZXuSW//t7usjcu1M0PFkd+W/BxsFvz7zXJPxctSevbt136eK/cpz8Y9sLPIOE+vbT8rwV69nva+pZrF//CYtnEE07+B0Ow/arWa2eixs5Zp6UcUgh/bnyrSQAVXBdC2vqQtyu5fDJWA/mbpgJIF0LId9Cd1dB6Fv4KLTds8VQsC73RL0cG4aBALIxgAAwLOaA1Oej8FG59ztOSo+9C9OO7od74QMAEECoUhwP2LVxgH0OH1Hswv2846T0Olc9GWJABQAQQPpo/HNSkvBRrVFY/8CqdfvhpGNhsGt1AwBAABmIK+GjFpPZDhPM01CnLk32/jju11LBAAACSB+MF0N/blrejKGFj6XT2Q7blcqgK4Hwg6MDABBAqMsn4aM2uz4p/TK0P/TpRu8HACCAUJv0oLlpxW87Dz/fd7qn4WPpbsdJ6UWeWFylK0cFALDPPAm9uUbnpMTfxzvmMUx8Wffk7NnPh+e8Tr+3D+EjiuHjLnu93DIQxieln6W/OWh4W2/G3VyRCwCgMR741JCCjfoYPN6NG5xH0oOH9+U17s92+J7HYYfVtCoQ9+Ufhl+xLzyIEIB1DMFqzq5Db25Sg7XJ8HHa0/AR7TopPc4Feboy1jRsHtpWlJWvAACCIViNiUNvZosQcrHFr5+NG149KzXer3tezHFS+ny8ZXjIfu/DbBEK1j6VPA1ti70lb8IOE96fmAcrXwEAPNID0qwPYfMcAOGjnM8pNGwbDG/GOZPSx4tA82G8mGNyFIr1jLzT+wEAIIA0LjVC321oqAof5RykEHJQw/6bjhchJM412TZQ3I499RwAQABpMYTExuhzDdLYuG10mM4Aw8dSHCr1vsZ9GENiDCLzDb+6KXACAOwdc0DaEe+gT8Kvd+nPmtyAAYePpTgp/XtdoS4O25othmXdhfVzQ64su8semyoCAJ5jucOWPFkGdqclZIWPnZzUOQQqPYn9uWeKxKFXJ2o6AMCvDMFqSWoU36T/+7Hhj3+1R0U9qnk/xgnsT8PjQ2i4RwsAQABhG3F+QO4qTDX5sifl28i8mhQmpyv/6cSqVwAAzzMEaw+lFaL+3oOvejRuaBx6Wvr3R1jM+7hUywAABBB+bTB/C8UfrNcH9+nZHU2W6fnYAwcBAHIZgrW/hj5E6FPTHyh8AAAIIOwvD/8DABBAoBFzz98AABBAoLEAoggAAAQQumXIE9AFEAAAAYSuSEvGHgz4K/5lLwMACCB0x/HAv9/vdjEAgABCd7wZ+Pcb2cUAAAIIHTALYRKGPf9DAAEAEEDokPd78B1HMyEEAEAAoV1Zo/w8DL/3Y2lijwMACCC0Fz5ig/z9Hn3lN/Y6AIAAQjvhI/Z6fN6zrz2Z6QUBABBAaDx8nGY/7sKwn/uxzoUaAADQLb8pgsEGj4PUAD/f86I4G4dwo0YAAAgg1Bc8Yuh4G/az1+Oph+x1lIWQe0UBANA+Q7CGJ4aOF8LHL+XxeaY8AAA6QQ/IQKUJ2HEI1kRpPJpnrxM9IQAAAgj1BpHTFERGSuMxhLwcL4ZlAQAggCCI1CIGjo/Z64PwAQAggNBsEJmE/RmaNc9enwQPAAABhPaDyCgsVso6DcOboH0bg8d48RMAAAGEjoWR4+zHm7D42Vdxcnns7bgdL3o+AAAQQOh4EDlIIeRV+tn1nhGhAwBAAGFAgeRwJZBMOhI4ptnra/xpXgcAgADC8ANJfL0IP/93Xb0kMWjMs9df6X/fCxwAAAIILFfWCiUDyTT9FDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgS/8nwABSYZLbrXe2HQAAAABJRU5ErkJggg=="}},a&&pdfMake.createPdf(a).download("SimpliRoute_Plan_"+di.start,function(){e.info("your pdf is done"),t.isLoading=!1})}function Ze(e){var t="";return e.forEach(function(e){ki.forEach(function(i){e===i.id&&(t=t+i.name+", ")})}),t}function Ke(e,t,a,n){var o=s.OSRM_URL+"viaroute",r=Boolean(n);return i.get(o,{params:{loc:t,uturns:r},headers:{Authorization:void 0}}).then(function(i){if(207!==i.data.status||r){if(!e.totalDistance||a){var n=i.data.route_summary;n&&n.total_distance&&(e.totalDistance=n.total_distance/1e3)}a||(e.path=Xe(i.data.route_geometry,6))}else Ke(e,t,a,!0)})}function Xe(e,t){t=Math.pow(10,-t);for(var i=e?e.length:0,a=0,n=0,s=0,o=[];i>a;){var r,l=0,c=0;do r=e.charCodeAt(a++)-63,c|=(31&r)<<l,l+=5;while(r>=32);var d=1&c?~(c>>1):c>>1;n+=d,l=0,c=0;do r=e.charCodeAt(a++)-63,c|=(31&r)<<l,l+=5;while(r>=32);var u=1&c?~(c>>1):c>>1;s+=u;var p={latitude:n*t,longitude:s*t};o.push(g.getGoogleMapsLatLng(p.latitude,p.longitude))}return o}function et(){t.$broadcast("Planner:Clear:Visits")}function tt(){function t(e){return e.data.map(function(e){var t={id:e.id,name:e.name,startDate:e.start_date,endDate:e.end_date,created:e.created};return Ii.push(t),t})}function n(t){return e.error(t),a.reject(t)}return Ii.length=0,i.get(ri,{}).then(t,n)}function it(e){var i=Pi.big_cluster||t.drawCluster;pi=!1,yi.map(function(e){e.active=!1,e.clear()}),t.$broadcast("Planner:Clear:Map",{mergePlan:!0}),xi.length=0,Ai.length=0,$i={},gi=null,hi=null,u.merge(di,{start:e.start_date?n(e.start_date).toDate():null,end:e.end_date?n(e.end_date).toDate():null}),Pi.big_cluster=e.is_cluster,gi=e.id?e.id.toString():null,hi=e.name,e.vehicles.map(function(e){var t=yi.filter(he(e.id))[0];t.active=!0,e.routes.map(function(e){if(e.driver)for(var i=0;i<bi.length;i++)if(bi[i].id===e.driver.toString()){t.driver=bi[i],t.driverId=e.driver;break}var a=ae(t.id);angular.extend(a,{vehicleId:e.vehicle.toString(),estimatedTimeStart:n(e.estimated_time_start,"HH:mm:ss").format("HH:mm"),estimatedTimeEnd:n(e.estimated_time_end,"HH:mm:ss").format("HH:mm"),totalTime:e.total_duration,totalTimeFormatted:dt(e.total_duration),totalDistance:e.total_distance/1e3,totalLoad:e.total_load,totalLoadPercentage:e.total_load_percentage,totalLoad2:e.total_load_2,totalLoadPercentage2:e.total_load_2_percentage,totalLoad3:e.total_load_3,totalLoadPercentage3:e.total_load_3_percentage,locationStart:{address:e.location_start_address,latitude:e.location_start_latitude,longitude:e.location_start_longitude},locationEnd:{address:e.location_end_address,latitude:e.location_end_latitude,longitude:e.location_end_longitude},comment:e.comment,startTime:e.start_time,endTime:e.end_time}),e.id&&(a.id=e.id.toString(),a.backendId=e.id.toString()),e.visits.sort(function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}),e.visits.map(function(e){var i=se(parseFloat(e.latitude),parseFloat(e.longitude));angular.extend(i,{backendId:e.id?e.id.toString():null,id:e.id?e.id.toString():null,title:e.title.trim(),address:e.address.trim(),latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),contactName:e.contact_name.trim(),contactPhone:e.contact_phone.trim(),contactEmail:e.contact_email,duration:n.duration(e.duration).asMinutes(),notes:e.notes.trim(),reference:e.reference.trim(),load:parseFloat(e.load),load2:parseFloat(e.load_2),load3:parseFloat(e.load_3),priority:e.priority,priorityLevel:e.priority_level,order:e.order,plannedDate:e.planned_date,requiredSkills:e.skills_required,optionalSkills:e.skills_optional,skills_required:e.skills_required,skills_optional:e.skills_optional,estimatedTimeArrival:n(e.estimated_time_arrival,"HH:mm:ss").format("HH:mm"),estimatedTimeDeparture:n(e.estimated_time_departure,"HH:mm:ss").format("HH:mm"),windowStart:angular.isString(e.window_start)&&e.window_start.length>=e.window_start.length-3?e.window_start.substring(0,e.window_start.length-3):"",windowEnd:angular.isString(e.window_end)&&e.window_end.length>=e.window_end.length-3?e.window_end.substring(0,e.window_end.length-3):"",windowStart2:angular.isString(e.window_start_2)&&e.window_start_2.length>=e.window_start_2.length-3?e.window_start_2.substring(0,e.window_start_2.length-3):"",windowEnd2:angular.isString(e.window_end_2)&&e.window_end_2.length>=e.window_end_2.length-3?e.window_end_2.substring(0,e.window_end_2.length-3):"",routeId:e.route.toString(),sms_enabled:e.sms_enabled,zones:angular.isUndefined(e.zones)||!e.zones?[]:e.zones}),i.contact_email&&(e.contactEmail=i.contact_email.trim());var s=t.validateVisitSkills(i);s&&(a.skillsError=!0,i.skillsError=!0),i.setIconFillColor(t.color),i.setDefaultColor(t.color),a.addVisit(i)}),t.addRoute(a)})});var s=a.defer(),o=[];return o=i?Ai.map(function(e){var t=yi.filter(he(e.vehicleId))[0],a=[];return a.push(t.locationStart.latitude+","+t.locationStart.longitude),e.visits.map(function(e){a.push(e.latitude+","+e.longitude)}),a.push(t.locationEnd.latitude+","+t.locationEnd.longitude),i?(a.shift(),a.pop(),at(e,a),void 0):Ke(e,a,i)}):Ai.map(function(e){var t=yi.filter(he(e.vehicleId))[0],a=[];return a.push(t.locationStart.latitude+","+t.locationStart.longitude),e.visits.map(function(e){a.push(e.latitude+","+e.longitude)}),a.push(t.locationEnd.latitude+","+t.locationEnd.longitude),Ke(e,a,i)}),a.all(o).then(function(){Vt().then(function(){s.resolve()})},function(e){s.reject(e)}),s.promise}function at(e,t){var i=new ConvexHullGrahamScan;if(t.forEach(function(e){var t=e.split(","),a=t[0].trim(),n=t[1].trim();i.addPoint(n,a)}),i.points.length>0){var a=i.getHull();a=a.map(function(e){return g.getGoogleMapsLatLng(e.y,e.x)}),e.path=a}}function nt(e){Oi=e}function st(){return Oi}function ot(){Fi.averageTime=0,Fi.averageLoad=0,Fi.averageLoad2=0,Fi.averageLoad3=0,Fi.usedVehicles=0,Fi.createdRoutes=0}function rt(e){return i["delete"](ri+e+"/")}function lt(){Vi=null}function ct(){return angular.isUndefined(hi)||""===hi?null:hi}function dt(e){var t,i,a,n,s,o=0,r=e.split(" ");r.length>1?(i=r[0],o+=24*parseInt(i)*60,t=r[1].split(":"),a=t[0],n=t[1],s=parseInt(60*a)+parseInt(n),o+=s):(t=r[0].split(":"),a=t[0],n=t[1],s=parseInt(60*a)+parseInt(n),o+=s),n=o%60,a=o/60;var l=String(a).split(".");return("0"+Math.floor(a)).slice(-1*l[0].length)+":"+("0"+n).slice(-2)}function ut(e){t.isLoading=!0;var i=a.defer(),s=[];zi.start&&(di.start=zi.start),di.end=di.start,_i=e,s=vt();var o={name:e,start_date:n(di.start).format("YYYY-MM-DD"),end_date:n(di.end).format("YYYY-MM-DD"),is_cluster:Pi.big_cluster,routes:s};return h.savePlan(o).then(function(e){mt(e.data),i.resolve(),t.isLoading=!1},function(e){i.reject(e),t.isLoading=!1}),i.promise}function pt(e){zi.start=e}function mt(e){e.id&&(M(e.id),e.routes.forEach(function(e,t){Ai[t]?Ai[t].backendId=e:Ai[t].backendId=null}))}function vt(){var e=[];return Ai.forEach(function(t){var i,a=yi.filter(he(t.vehicleId))[0],s=[],o=t.totalTime.split(" ");i=o.length>1?o[1].split(":").length>=3?t.totalTime:t.totalTime+":00":o[0].split(":").length>=3?t.totalTime:t.totalTime+":00",t.visits.forEach(function(e){var t={address:e.address,
contact_name:e.contactName,contact_phone:e.contactPhone,contact_email:e.contactEmail,duration:e.duration.toString().split(":").length>=3?e.duration:e.duration+":00",estimated_time_arrival:e.estimatedTimeArrival,estimated_time_departure:e.estimatedTimeDeparture,latitude:e.latitude.toFixed(6),longitude:e.longitude.toFixed(6),load:parseFloat(parseFloat(e.load).toFixed(2)),load_2:e.load2?parseFloat(parseFloat(e.load2).toFixed(2)):0,load_3:e.load3?parseFloat(parseFloat(e.load3).toFixed(2)):0,order:e.order,notes:e.notes,priority:e.getCPriority(),priority_level:e.getPriority(),reference:e.reference,skills_optional:e.skills_optional,skills_required:e.skills_required,sms_enabled:e.sms_enabled,title:e.title,window_end:""===e.windowEnd||null===e.windowEnd?"23:59":e.windowEnd,window_end_2:""===e.windowEnd2||null===e.windowEnd2?"23:59":e.windowEnd2,window_start:""===e.windowStart||null===e.windowStart?"00:00":e.windowStart,window_start_2:""===e.windowStart2||null===e.windowStart2?"23:59":e.windowStart2,id:e.backendId?parseInt(e.backendId):null};s.push(t)});var r={driver:a.driver?angular.fromJson(a.driver).id:null,vehicle:t.vehicleId,planned_date:n(di.start).format("YYYY-MM-DD"),total_distance:(1e3*t.totalDistance).toFixed(0),total_duration:i,total_load:t.totalLoad,total_load_percentage:parseInt(parseFloat(t.totalLoadPercentage).toFixed(0)),total_load_2:t.totalLoad2,total_load_2_percentage:parseInt(parseFloat(t.totalLoadPercentage2).toFixed(0)),total_load_3:t.totalLoad3,total_load_3_percentage:parseInt(parseFloat(t.totalLoadPercentage3).toFixed(0)),estimated_time_start:t.estimatedTimeStart,estimated_time_end:t.estimatedTimeEnd,comment:t.comment,location_start_address:t.locationStart.address,location_start_latitude:t.locationStart.latitude,location_start_longitude:t.locationStart.longitude,location_end_address:t.locationEnd.address,location_end_latitude:t.locationEnd.latitude,location_end_longitude:t.locationEnd.longitude,visits:s};e.push(r)}),e}function gt(a){return i.post(s.API_URL+"directory/geocode/",a).then(function(e){return e.data},function(i){e.info(i),t.isLoading=!1})}function ht(){return xi}function _t(){return Ai}function ft(e){var t={id:gi,name:e,startDate:n(di.start).format("YYYY-MM-DD"),endDate:n(di.end).format("YYYY-MM-DD")};return t}function bt(){return yi}function yt(){return di}function wt(e){xi=e}function At(e){yi=e}function xt(e){Ai=e}function kt(e,t){xi.map(function(i){-1!==e.indexOf(i.id)&&u.merge(i,t)})}function It(){xi.length>0&&xi.forEach(function(e){e.actionCreateLight()})}function St(){Ai.length>0&&Ai.forEach(function(e){e.actionCreate(e)})}function Et(){t.$broadcast("Planner:Clear:Polylines"),t.$broadcast("Planner:Clear:Polygons")}function Ct(){var t=a.defer(),i={start:n(di.start).format("YYYY-MM-DD")};return ke(i).then(function(){var e=Dt();t.resolve(e)},function(i){e.info(i),t.reject()}),t.promise}function Dt(){for(var e=Si,t=yi.filter(function(e){return!e.active}),i=[],a=0;a<t.length;a++){var s=t[a],o=n(di.start),r=n(di.start);s.busyHours=[],s.available={msg:"",value:!0},o.set({hour:parseInt(s.shift.start.slice(0,2)),minute:parseInt(s.shift.start.slice(3,5))}),r.set({hour:parseInt(s.shift.end.slice(0,2)),minute:parseInt(s.shift.end.slice(3,5))});var l=s.isAvailableIn(o,r,e,di);l.available&&i.push(s)}return i}function Pt(){return xi.filter(function(e){return!e.routeId})}function Lt(){return yi.filter(function(e){return e.active||e.available.value})}function Ot(){for(var e=0;e<yi.length;e++){var t=yi[e],i=n(di.start),a=n(di.start);Tt(t,!0,"Vehicles.available.default"),i.set({hour:parseInt(t.shift.start.slice(0,2)),minute:parseInt(t.shift.start.slice(3,5))}),a.set({hour:parseInt(t.shift.end.slice(0,2)),minute:parseInt(t.shift.end.slice(3,5))});var s=t.isAvailableIn(i,a,Si,di);s.available||Tt(t,!1,"Vehicles.notAvailable.until",s.until)}}function Tt(e,t,i,a){e.available.value=t,_(i).then(function(t){e.available.msg=a?t+" "+a.format("HH:mm"):t},function(t){e.available.msg=t})}function Vt(){var e=a.defer();if(0===Si.length){var t={start:n(di.start).format(f)};ke(t).then(function(){Ot(),e.resolve()},function(t){e.reject(t)})}else Ot(),e.resolve();return e.promise}function Rt(){var e={vehicles:yi,drivers:bi,date:y.formatTime(di.start,f),visitsOutOfRoute:Pt()};b.downloadReportExcelPlan(e,Pi)}function Mt(e){t.isLoading=!0;var i=a.defer(),s=[];zi.start&&(di.start=zi.start),_i=e,s=zt();var o={id:gi,name:e,start_date:n(di.start).format("YYYY-MM-DD"),end_date:n(di.end).format("YYYY-MM-DD"),is_cluster:Pi.big_cluster,routes:s};return console.log(o),h.editPlan(o).then(function(e){mt(e.data),i.resolve(),t.isLoading=!1},function(e){i.reject(e),t.isLoading=!1}),i.promise}function zt(){var e=[];return Ai.forEach(function(t){var i,a=yi.filter(he(t.vehicleId))[0],s=[],o=t.totalTime.split(" ");i=o.length>1?o[1].split(":").length>=3?t.totalTime:t.totalTime+":00":o[0].split(":").length>=3?t.totalTime:t.totalTime+":00",t.visits.forEach(function(e){var t={address:e.address,contact_name:e.contactName,contact_phone:e.contactPhone,contact_email:e.contactEmail,duration:e.duration.toString().split(":").length>=3?e.duration:e.duration+":00",estimated_time_arrival:e.estimatedTimeArrival,estimated_time_departure:e.estimatedTimeDeparture,latitude:e.latitude.toFixed(6),longitude:e.longitude.toFixed(6),load:parseFloat(parseFloat(e.load).toFixed(2)),load_2:e.load2?parseFloat(parseFloat(e.load2).toFixed(2)):0,load_3:e.load3?parseFloat(parseFloat(e.load3).toFixed(2)):0,order:e.order,notes:e.notes,priority:e.getCPriority(),priority_level:e.getPriority(),reference:e.reference,skills_optional:e.skills_optional,skills_required:e.skills_required,sms_enabled:e.sms_enabled,title:e.title,window_end:""===e.windowEnd||null===e.windowEnd?"23:59":e.windowEnd,window_end_2:""===e.windowEnd2||null===e.windowEnd2?"23:59":e.windowEnd2,window_start:""===e.windowStart||null===e.windowStart?"00:00":e.windowStart,window_start_2:""===e.windowStart2||null===e.windowStart2?"23:59":e.windowStart2,id:e.backendId?parseInt(e.backendId):null};s.push(t)});var r={id:t.backendId?t.backendId:null,driver:a.driver?angular.fromJson(a.driver).id:null,vehicle:t.vehicleId,planned_date:n(di.start).format("YYYY-MM-DD"),total_distance:(1e3*t.totalDistance).toFixed(0),total_duration:i,total_load:t.totalLoad,total_load_percentage:parseInt(parseFloat(t.totalLoadPercentage).toFixed(0)),total_load_2:t.totalLoad2,total_load_2_percentage:parseInt(parseFloat(t.totalLoadPercentage2).toFixed(0)),total_load_3:t.totalLoad3,total_load_3_percentage:parseInt(parseFloat(t.totalLoadPercentage3).toFixed(0)),estimated_time_start:t.estimatedTimeStart,estimated_time_end:t.estimatedTimeEnd,comment:t.comment,location_start_address:t.locationStart.address,location_start_latitude:t.locationStart.latitude,location_start_longitude:t.locationStart.longitude,location_end_address:t.locationEnd.address,location_end_latitude:t.locationEnd.latitude,location_end_longitude:t.locationEnd.longitude,visits:s,start_time:t.startTime,end_time:t.endTime};e.push(r)}),e}function Ft(){return 0===ji.length&&(ji=A.map(function(e){return{name:p("translate")("Visits.priority_levels."+e.label_name),value:e.value}})),ji}function Nt(e){return i.get(ri+e+"/")}function $t(e){return i.get(ni,{params:{plan:e.id}})}function jt(e){return i.get(si,{params:{route:e.id}})}function Bt(){return Pi}function Ht(){return pi}function Ut(e,t){mi[e]=t}function qt(){return mi}function Gt(e){w.setUserVisualState(e)}function Jt(){return w.getUserVisualState()}function Yt(e){$i[e.id]=e}function Wt(e){$i=e}function Qt(e){Ni=e}function Zt(e){xi.map(function(i){var a=g.getGoogleMapsLatLng(i.latitude,i.longitude);e.contains(a)&&(i.selected=!0,t.$broadcast("Planner:Visit:toggleSelectedEditVisit",{visit:i,multipleSelectionMode:!0}))})}function Kt(){xi.map(function(e){e.selected&&(e.selected=!1,t.$broadcast("Planner:Visit:toggleSelectedEditVisit",{visit:e,multipleSelectionMode:!0}))})}function Xt(e){bi=e}function ei(e){var t={id:e.id.toString(),name:e.name,username:e.username,selected:!1,group:_("Driver.group_available")},i=u.findIndex(bi,function(e){return e.id===t.id});-1===i?bi.push(t):u.merge(bi[i],t)}function ti(){return $i}var ii=s.API_URL+"accounts/drivers/",ai=s.API_URL+"routes/vehicles/",ni=s.API_URL+"routes/routes/",si=s.API_URL+"routes/visits/",oi=s.API_URL+"routes/skills/",ri=s.API_URL+"routes/plans/",li="09:00",ci="17:00",di={start:null,end:null},ui=!1,pi=!1,mi={load2:!1,load3:!1},vi=!1,gi=null,hi="",_i="",fi={start:li,end:ci},bi=[],yi=[],wi=[],Ai=[],xi=[],ki=[],Ii=[],Si=[],Ei=[],Ci={next:!1,vehicleDisabled:!1},Di={balance:!1,all_vehicles:!0,big_cluster:!1,join:!1,open_ended:!1,fmv:2,single_tour:!1},Pi=angular.copy(Di),Li=[],Oi=!1,Ti=null,Vi=null,Ri=null,Mi={lat:null,lng:null},zi={start:null,end:null},Fi={averageTime:0,averageLoad:0,averageLoad2:0,averageLoad3:0,usedVehicles:0,createdRoutes:0},Ni={},$i={},ji=[],Bi={planDate:di,planName:hi,shift:fi,vehicles:yi,routes:Ai,visits:xi,skills:ki,plans:Ii,visitsToDelete:Ei,routesAccount:Si,headerStatics:Fi,getPlan:O,backupPlan:N,restorePlan:$,setGmap:U,setPlanDate:W,setShift:X,getVehicle:ee,getRouteById:ve,getRouteObjById:ge,removeRoute:ne,optimizationOptions:Di,createVisit:se,getVisit:oe,removeVisit:re,resetVisitLook:$e,showRoutes:je,hideRoutes:Be,getActiveVehicles:Ce,hideVehicles:Se,showVisits:Te,hideVisits:Ve,mapFitBounds:Ge,mapFitBoundAllVisits:le,centerVisit:Re,putOffCenterVisit:Me,showInfoWindow:Je,hideInfoWindow:Ye,deactivateVisits:ze,filterVisibleVisits:Fe,recalculateAllRoutes:Ue,clearPlan:V,collapseOtherRoutes:He,getDrivers:te,centerVehicle:De,getSkillById:Ae,getSkills:xe,getGmap:q,setMapCenterOn:_e,calculateAverageLoad:J,calculateAverageTime:Y,getMapOptions:E,getPlans:T,mergePreviousPlan:it,previousActiveVisit:Ti,clearMapVisits:et,orderVisitsByStatus:Ne,returnVehicles:x,returnDrivers:k,returnSkills:I,getDriver:ie,isEditModeActive:st,setEditMode:nt,resetHeaderStatics:ot,deletePlan:rt,loadVisits:Oe,clearPlanPromise:lt,removeVehicle:Pe,getPlanName:ct,getCenter:G,setMapOptions:S,getShift:K,getTravelTimeDepot:C,backupVehicles:D,restoreVehicles:P,returnPlanMode:F,loadRoutes:ke,disableStep:Ci,routeDeleted:ui,setVehiclesEnableEditPlan:L,enableShowLoad:mi,planNameAux:_i,optimizationOptionsDisplayed:Li,localOptimizationOptions:Pi,exportPlanPdf:Qe,getSkillObjById:we,exportPlanTxt:We,clearPlanner:R,getPlanId:z,planDateModified:zi,createPlan:ut,changeDateModal:pt,tryPreGeoreferenceBatch:gt,getVisits:ht,getRoutes:_t,getPlanInfo:ft,setPlanId:M,getVehicles:bt,getPlanDate:yt,setlocalOptimizationOptions:ce,getlocalOptimizationOptions:pe,visitsBulkEdit:kt,setVisits:wt,setVehicles:At,createVisitsMarkerLight:It,clearMapRoutes:Et,createRoutesPolyline:St,getVehiclesAvailableWithoutRoute:Ct,getVisitsOutOfRoute:Pt,createRoute:ae,getVehiclesAvailable:Lt,exportPlanExcel:Rt,setRoutes:xt,setPlanName:Z,editPlan:Mt,setEditPlanDate:Q,getPriorityLevels:Ft,loadPlanDetail:Nt,loadRoutesDetail:$t,loadVisitDetail:jt,showVehicles:Ee,getOptimizationOptions:Bt,getPlanEditingSelected:Ht,setEnableShowLoad:Ut,getEnableShowLoad:qt,setUserVisualState:Gt,getUserVisualState:Jt,getVehicleById:qe,setBackupRoute:Yt,setBackupRoutes:Wt,setBackupVisits:Qt,setZoomControlPosition:fe,setMultipleVisitsSelected:Zt,deselectVisitsSelected:Kt,updateListDriver:ei,setDrivers:Xt,setOptimizationOptionsDisplayed:ue,setOptimizationOptions:de,getOptimizationOptionsDisplayed:me,getBackupRoutes:ti};return d.plannerService=Bi,Bi}e.$inject=["$log","$rootScope","$http","$q","moment","__env","PlannerVehicleModel","PlannerRouteModel","PlannerVisitModel","alertNotificationService","$window","lodash","$filter","FileSaver","Blob","googleService","planService","$translate","DATE_FORMAT","reportService","timeUtils","userRoutesVisualState","PRIORITY_LEVELS"],angular.module("icarus.planner").factory("plannerService",e)}(),function(){"use strict";function e(e,t,i,a){function n(e){var i={style:"defaultStyle",table:{widths:[30,120,"*",120,45],headerRows:1,body:[[{text:"#",style:"tableHeader"},{text:t("translate")("Summarized_Pdf.title"),style:"tableHeader"},{text:t("translate")("Summarized_Pdf.address"),style:"tableHeader"},{text:t("translate")("Summarized_Pdf.time_windows"),style:"tableHeader"},{text:t("translate")("Summarized_Pdf.arrival"),style:"tableHeader"}]]}};return e.sort(function(e,t){return e.order-t.order}),e.forEach(function(e){var t=o(e.windowStart,e.windowEnd,e.windowStart2,e.windowEnd2),a=[{text:e.order.toString(),style:"cellCenter"},{text:e.title,style:"cellCenter"},e.address,{text:t,style:"cellCenter"},{text:e.estimatedTimeArrival,style:"cellCenter"}];i.table.body.push(a)}),i}function s(e,s){var o,r=[],l=i.formatTime(s,"DD MMMM, YYYY"),c="SimpliRoute_Plan_"+i.formatTime(s,"YYYY-MM-DD");e.forEach(function(e){if(e.routes&&e.routes.length>0){var i="",a=e.name;e.driver&&(i=e.driver.name),r.push({columns:[{alignment:"left",image:"simpli",width:200,margin:[-20,-10]},{text:"",width:150},{alignment:"right",text:l+"\n"+t("translate")("Pdf.vehicle")+": "+a+"\n "+i}]}),e.routes.forEach(function(e){e.visits.length>0&&r.push(n(e.visits)),r.push({text:" ",pageBreak:"after"})})}}),r.splice(-1,1),o={content:r,styles:{header:{fontSize:18,bold:!0,margin:[0,0,0,10]},defaultStyle:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:13,color:"black",alignment:"center"},cellCenter:{alignment:"center"}},images:{simpli:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAEsCAYAAAA7Ldc6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAJNtJREFUeNrs3V1u20iiNuDqD+f+eFbQ6hXEAXQf+b6B2CuIvYI4K7C9giQrsLOCOMDcW7kXEGcFUa+gPSuYw7JKXxS3RUn8J/U8gOCZji1RxSJZL+uHIQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0wC+Ege02y12VLn31oLwAA9N9vioB1jf7sxyR7vU4/R+mf7schvGxhW/7OXg/Za5q9vsaf2Xbc21MAAAII/Q0dMWQcZ683YX2PQ2z4H7Wwbf995j/Ps9dtDCTjxU8AAAQQOh46Yu/C6YbQ0dUAsuohhZGPekYAAAQQuhc8JtmPt2HR47GLrgaQVfMYRLLXzXgRTAAAEEBoKXicZj8uws85Hbtqcw7Irpa9IlfjRSgBAEAAoaEG/HlY9HgcVPCW/2qyZ2G26KX5XPJtbgQRAID2/T9FMPjwcZn9+BEWvR4HFb3tccNf43UF73EayyErj+tZ8d4fAABK0gMy3OBxGsoNtcrT2DyQ1Hvzo8LwtPQhLHpEzBEBAGiQHpDhBY/D7HWX/c/rUN+d/kmaxN6E8xrCx/J9Y4/IuVoDANAcPSDDCR6xkX4RmmtQ1z4Zvcbej398l+x1ZvleAID66QEZRviYZD++hWbv5h+m+SV1+txA+Hj8LrH8Gvg+AAB7Tw9I/8PH+9DuMKLYc3BTw/eKQ8hOW/g+ekMAAAQQnmmgx7v2sZF+2IHNqTSEtBg+luLE9Hd1BCsAAAGEPoaP4xQ+Djq0WTep0f5Q4nuN0veaDOU7AQAggPQ9fLQ95CrPPCyWtr3Z8TtV/aDEKsWhWCceYAgAIIDsW/CIDfPYO3Dcg82dZw32P7b8XnEI2V0Hg8eq2ANyZF4IAEB5VsHqT/i460n4iEY7/O5Bx8PHchvvZt2YbwMAIIBQa/hY9hBo/LbnJnu91AMCAFDe/yiCXoSPA6XRimlYrPA1VxQAAAKI8EGd4mT6S8UAACCACB/U7cwzQAAA6mEOSPfCx0j4aNWV8AEAIIDsS/iIoeOz8NGaqWFXAAACyD6FD6tdtSc+6+NMMQBV+fPPPw/iS0kA/MockO54L3y06qPVroCiQSOdv+Pr95X/Hf/7UVisqAeAANIds8Wwn1Ml0aoPimDwjcRJ9uPNSuMwekiNwy/Z6/bf//73g5Iipw6NwmKe3iQFjeX/buKz4zXidaq7o/Sf58v6m9XdW3sI6IvfFEHr4SNevO6G9r3GW9atjnz/22x7T9TGwTYa413o6+x1vOFXY2PunYYca+rRXcGwcZTVqWmJzz1M9XdTD/k01V8PTAU6zxyQdsPHKCwmndOuL4pgsI3GeIx92yJ8RI/HY7rTDF2ov8sl2bcZnhvD0V36GwABhLXiXS0TFNvnjuFwfQ4/h6tsfVym4VrQdnjedUn2gxRCXFcAAYR/SvM+NHI6YCyADLUBdxqKL+zwXgnSsotQ7AbVQfpbgM4yCb2d8HHoAtEZc0VQWYN/FH5O8H6RGkIHOSFgmn7Gid/f0764r3AM+5sSf3sYh7IYT0+LTkv+7TtFCAggrLpWBALIQELHYWroxzkWox3/fLLyv49X3rOqlakmJb9e/HsBhDaOq7J192DXAL3ymcvlg8PKjYRN4uf8J91MiP97nn22cysggHRFGnplkmB3GCtdrIF0Gha9eKOa9slxesX5GLehnWVy1Q0Gd25L80Ni2HgVfn1eSdmw/vRzlmEkHrtTvYl7dX14rFfZPr9RGggg3QgfsbH2Vkl0ijC424UlhoL3NQWPdZZh5H0KI1eb7q5aCQjW+hyamX+4DDqTdEzGYzYevx/1jgzqmhD382lY9JYdPrmmCiCsZRJ6s94Hd1W7GgzZcJHJXp9DsVWlqmzQxAvdj01L5brbCp0Tzxvn6fi9TnPG6L/D1LY5DW7oIYB0spE7Cds9i4B2TqCsDx+xfL51rP4+VPQ7eYQYuly/+1x/lzcSLu1qEECol1Wvumkafq7GxPPhIz6LYNSlxtmWTyu/raBuQONSD968TPhoeL5U4etido75pjcE9o85IA2YLe72TJRE59yMQzhTDGvDxyjs/iC0JmwbLK5C8aVMP/SkAcdwxfp7XeJvi/7dfCX8bBVk0rli9fVqh2veYw9r9h5Hhk6CAEK19H508OI+XqxIxnqfQzfnLH3c5pfiRNesUXNV4Pi7L9GAg0rEFYSy+vsm7H7z6mbLHsLnPvOy4N+thpbVYBJvAGzzHZZPcH9pgjrsB0OwapZ6P0ZKolPO2gofs548YTuNze7i3Jj5LndJU4NqlzAR3/tI7wcdcRJ2G0oYw0dnenVjiMpeR/GYCpuHNMYQ8jmtqgQIIJRk2d3uiI3Kl+OWlgZMz4A5n3V80ntqAHS13n4q0Ai63KIBFOtGXN73pfBBhxrwcb5TDCExVMzzgnkMK10KH0++xzQFkU1PZ4/nxnN7HobPEKx6G5yTYIWlrni8QI9bWhkmhY6LlVDa5bknsQHQ1buQhcJjbADFAJLGqsfjcrTyz9P079DVIBLr/U1aFGKycnw+hB495C/bzg/pAYV5c1vixPQbQ7FAAKE4vR/d8DisZlzN0pZFw8fdyn86nS3moMz3oN7ep0ZS/K5/rfz3/10J55Nt36tsoyT9/Y1Dgp4GkfvQ8+Wh09yWsCmEBAuEgABCoUbnKHjuRxfExua7DoSPpz0Kp6GDk+DTk87L9n5Mw2Ko1O22w5lWeiZe5xw3H1VnGESQiiHkVVi/St1x9u/vDIcEAYTd6f3oQPgos8xuFh6OxyWeJTFbDGVaN+n8TejmKlxlhwwWmgS70jNxk+agHKdjaHV7blVpGIx36Th/7obH8hxwo5hAAGE3p4qgVWdlJpvPFsMD4lCp2DC+2uW9ZosL58WGxvyobMCpyasSf3tbxSTYdNdzGUYmqSzn7obun7T/n5qbH9B/8XiOcz3C+knnrwQQEEDYrfFaxTAWinlI4eO24L6L+y2Gj+UwoFH8/2n53Hgx/Jq97lfnb6S/iWFjOXxotOXHxd/vWgAp0wNS+bMzlpPHe9hwHqV6cJjOBb8/qRfPNqzTK9bh72Ex1n9aNHilxnt8vQg/6+jqeWk5P2f5ebGcG3mCdurlOgw/H1y33MaDbepgmkMQ0jbPl9vvQXa98ykngBy2dOxONpyP2L+bHvZ/DX5TBLUEkMe75/tcBuMt61ZaKeyuwvBxVHSlqxQk7hq+8P2rrfkpa06+/y0RFjp3Psm+z/uC+/Pdto3ZdME6TI3oUdj9wXGbxJD6cdPFb2XoWt48mm0/71PRh9mt2a5lGb16JghVab5SXvOK69JdwX17VLThkj6zyLF4VOR7tHEMZ9vz97r60MT2pHlvr8M/V8db5z4F369VHSNrwnnjDeAin53Of+vq6VFV21bXd08ry70J269autz/XwSScvSA1KPOyefLC+yXsLgT/zD72eh5tcfBJ54UToquLJUmi38OzT800jjneh0WbDQebGiwvArNLbMdPy9Oyo0Xu6unF73UaIh3kd9W1LBffl48ls5KNJ7fh+aXIh+lsjhfV149M9mDY/R+3feMdbuOHrnUQ/k2XS8PCpxTDlMdi8dI7MX5UOF2HuY06OsOZFV/9l2F2/ZbxXUg7vuLAtf8p/v/Ki2TzY48iLBiNQ6/iie3uJrTH+PFz+nyznlsdI9/Trj+I/RwyEpJ8fselQgfk3SiHLWw7a+HshP26AnGn1Mjt+khIo/1NDbsl2Wdnlj/I11Iqy7/Ufq864L7to0yeq68PqcGJ930sKGxV/V5Kh4z30I1zzsapWPvR/a+HqDYj+vUJHvFc+Z1Bdf8+Pfx/Pgjb+gWAkifG5TLoUUfNv1iCiOx23NfEnkMXoWf8TFb3AG7C+3N2RnSScsFuLlyvksX0YsG6u5p+ry+Bsx4U+hb6rmie7431PA8zF7fajpm4vvFGwN3e3Qjpo/h432o52bjKJ0jL5WyANKmqhuUheY1pN6QoYeQq5LL7MaTxXXL3+FgNpwQ8jaNp6V+h6HZHrvDnoeQuN2fUwOE/Wt4noZm5vfFc/kP58HO7f+DNPep7ptkF7HHWIkLII2b/VzRpepGdtGVXeI66/OBFndc6eqyxL6KJ4mLjnyXLg3DKlNfDlIj1cV3uKHnouff4VwDoXNeNBA+rsN2vR7xWhtHGsQV/U7CYjTBSfr/N1ueH50HOxY+Uvic7LD/z9K+X77O0n/fpi126hyzHZPQq1V1F/98m2FX66QJ6leh/bv8VerjSlebTDq0LfclQ3Qs3zjcJda7D57dMTixAd/31V9iAyFU8cwaKpEXDOZl3nglfGy6pnwMi4eorvu825X3jNeOtyF/vucyhBzt89LQHVkZ8fMW1/u4f6+22Vdp/19saO/Fc8xXk9Pz6QGp1quK36/0En/pAXpDaQTOS4aPUQfDR3Q4685zY75W9D7LiZmXxkQPzhBuaJymxintG+U0YAsHkNRQ3DTkLt7g+yP7nMttPys2UlN4fbnhGr0MIc5/LUlzMiYbwmcMiSfbBsW0/5e9Y3ltq/cWvxBAGm1IVvx+Xyp6n+kAyjaeHF6WCB9x33zrYPioq+60FnqfXIBjEPk7rURkEvBAGowD2ZfvDZNpvYE4ygkg9yXe93HOT8i/sROXmH5XtJc2BpbUEL3acA78bE+3UrcmIX/I6H0Kn9OC+3+6IYQchP4PWRVA+iDdwa407Y6rCw7fGyqGuL3xztC/dgwWm+aq3IR+r3S1jUkXNiLdBawjsMYGawwhf6dlXTX8+u3NAL7D48pFdmWrjjdcG4ra9HyHs6qGx8Tek5C/GMrEEr2tuN5Qt47KDhFOvSZ5D1s81QsigDRhnxtU0xQQjtLzSLY+qOPvxnku48XzS86eCSKPzzcpGT62nYDYphcd2parmht9cZ98S2unnxui0M+GY0P7bfrkVfV4+omhWK16m/NvhUYApAbfeRPhY6UhGt8vb77mhfNcc9Ixva7hP68ifDwJIVcbwjDPMAm9wgvZHn7neADHcFDJsJ00X+UmLY97kd678IUirXTVl8ZFZwJs7FrOTuA3DZRdvEDEO9Dv0+d96vnk5k3eLRvQq98zNZji/n9dcZnH4zLO6blffl7qeVpOohxVcM67raGcXm4aj52GV7ypqLxiWdwEmm4kXubUwYesDtyW2J9rj4m6JgbH4VypXj53Lj9IoejSnm9EXh04qXpxlNgLlu37N2vqc+zls+CFAFKryu9gx3kL42ru+NVxd/2x63FcwwT3uLzubNErUrTXI57sr0P1q5LV3RjvWmN50uB2xYZk7K6epiAyuAZh9p0+rPnv87C4K3ebff9PYfPY9U03BeKKPs+uQJYa9vF1kxqAZe7OHdYRQLaZDJoC1TSttnYdyt0AepzTUqLBy+7hY9OSzh8Lvu8oJ5Q+NNAQjO//bc2/vRVAGqlbpznXrQ81rkq2bsXRA+eX5xmCVZ06ulcnHXufpZu6wsdKCCkTPu56Fj6W2z7pyrakxutJaH4FtVgG12l41um+nURSw/qkxFvM04o+D1t81mUod+f/VQfKK37fo1C+B+NNoKkG4iSdo/NCdNHl5/OGdH2se1nw1LhdVxcPDPdrxNsNIaEueQHjtd0igNTdcGryQNq2UXtccTgqNSej5gZ811e6aiPElr2YblpqsC6jFET27oFey7v7Bf/8cMex5u9K7N+DDpXZWSi3eMKxMfqNhI/LsHlBkLMSQeG4hlCzqysN0dbq1yjn+n9TZwBN770uhFh0RQDpndEsfzLdNqpc5WW5YlXnpN6Du9C9oUw7NR472BhuM4Qsg/231HDZJx+bqEcbLpp9q69nJevpxCWnlkbh453/2KsZNg/5e1d0qEq6UbHu/H/b1ENR05DKe0G3Fcc1nVO39VUAEUDaaPzW5WJWsPLOFuGjqgb545CcjvZ8nIbuL7PbWymExFXKpi1uxkXqDTnYkzIvM15412P+60DKbF6ykeHudHWhY5JWuIvzmf4Oi7Hxm+rl1bp5UhU0Pr80XASfBN1WrDuGHxp6Iv193jFh9/zKJPTue3yQ0WzR+N/6AEo9J1WuPX41zn9WR1vh4zIMZ5m7V13dsHT38CitZ3/RUtiLJ/AYQo6aupvZsmnBxsqowOcUbmh2bOWyDyXOB3t/l7JgT+OrJ2VY5NxQxdK4r2oK9EXEz3ufs50mJNd3jaj0HLfjdTIujJHXlkMAqdyogfe/m22x5G1NK0DNx82Nn90lfPRpmd1BiHco05K5MYi8beGkGhs4sbfr5R4U97yhfTrPuWj2rX4+ZN/ltuD5zzCJ5m/m3KfwcV/RuaG1xuczx9TDmvOjelZPeM4r1+8d2MRaVg3sM0Ow+hFAluk59oR8i0OOZk8+Mw4DS0OufoTqV4C66lJhx5A1W0w2Fz5aauSlFZTWPTyy9hN5drHZhydY/zW0sNOQwkPK9m3BgxbFxnmc7/GyivCRJh8f5IScNqz73IndX1sbKXQghN7bFdvRA9I/8QJ5nRrijTRMxt17SNddGOZdpF59pzQMKtaNm4ofDLeNOL78y8AfXNikGEBGA/kuZRoAhknUX8/iPJ2qVyQadSTIP62HwkZz8sr6cCi9vAII+6SLXYZDHf/f28bPyoPh4ippsQfudaj/WSxxuIgA8k8v9vnLbxiHLYC0d84+amgicJWBtIz/rPuHDs6dGrou9Ji/sBt+ZQgWm3zq4DZ9sVs62/iLw7Pi3c34ML1/hcWyzXU1ACYDX1mkaANFI7o4Q7CKm2+ok3Ueq5OelQf7x3n5CT0g5HkYd3M849Su6UcYCYvFCz7UOETrjfrAmnPERDHsfMz+Vubvs+M8b2GQ99m/T1vqBRFAoGP0gJCnkxeKsUlefWzYTNPTquPE9ZsK3/pY6UJnbOrxvPMgPmryquPbp90igDCQA8bB3M8gMl8JItMK3vLAykXQmeM79nrmPZH+cTVHJcUetgn+Yxf9yhAs+nrAPNg9/Q4iYfFgwyqe5TISSHmmTtDOsX2fFqO4XvMrce7WZVrKG2pvr5QdWkg99IAAbTZW4t3Sm5JvoweEqgLIVNFVclzfbDiuLypeQGLewWKYqAkggEAf7Otd/Hi3VI8WlTDHoFPHdd457brCfZUXQLpYH+aqR6PnBGFQAAFy7GUjPI0bL/O8md9VHVYcOgY7c1yf5fzKKKwfplXlfmurh/RFTtkIIEKdAKIIKjEd6PfqcsNupNoNyl/qAhWZlGg0m0tUbQiJ5fku51eO//zzz+OKPmfnINDSNapwQ1nvXuEAMlE8Agj90smx9bNFl/oQG51zVQ5Ke13w74SPekJIfBbQNOdXqhqKdd+x69hhDfXMfLdix69ecgFksIbabX846+b42clAy/uvPT6GylwgBDceZQ3ZUYlGWl0BZGLPhJNQ/9K86/bfKNWLJuthXq/O1xL1UA/I+qD7kHMtcAwKIMM08AfjdfHAfTXQsu5MkI0X7Ox12pN6ts/BjV+9L/G3X2vapr2/+7rFfJC4NO95yY/J239NP7A0rxduukVZraMHpHgIVXYCyGANtRfkdQe3aahPv+5SkI3hIw6N+BHX7K9z7HF8/1BuSJ2JwyzvOpc5N0zrOl8Zu//YsI4LTeQtNnFRspzy3vtNg/XwIKcezrecZ7Tud1450guH0DeKRwDZt+Tdd6ddGoY1W5zYRwMt63mHtmV5so5lfZG9/s4urJ+rmDD6TPi4cOzxpAG3699MQrkVle63WJmoaNCN3+e9Pfto01PSC+/DDavpHTa4FOtxWH/N3Ha1v3XntEnPjuWmr9V55Xvq8BNABJD+Oe/QtrweaiGPOxJAUlf1aM2FNYaQ/6Ywcl7kop6Gd8W//VFB+IgNj6nTz6Ase91GW9SlgxRi70K5GyWftvid7yXe/zTbzut97wnZYihW2VWxvuT820VDXzPvcz5u+R7fc+r8ccf2ad75d9Twtsxz2mIHFQzzo0L/owgqM+Rx6G+z12VHtuVjyL/D1FddakRv01X9/4e7ZCf1+ONh5cT/8MwF9Pd0MRpVfFG6DQzNQWrExSE59+nY+OtJwyIG3xfpZxXngpstfqfsUL/T1MCOnxWHitzv4/Mg4lCsrAxuw/phSu+zf59umAux7r1vsr+9WHOOifNMjtNQsFpsGE463WF/Tzecn7t23ntYcxxOWri2xTbCup60eE65KVK3qJ4ekOoMuQfkXVc2JE34PxlgGXepIXJasNE4Sa/jZQNy5XWa/m1U8bZ+ceoZtNgbF+9axiFMdyuviwpvRGzbIKniHH+Qvk9c9Sn29Nzt6X7NG4o1CuV6K65y/u26rmFBqef4ouB2PQ1S9znXhOMOTqhed2w0PmIhhtCcsis1zA8BpJPGw30Y4dl4u7uDTZf1u4GV8/cubETq3u9L79I8XWygqIdtG4Y1DfXby/lLKfDlncPPizayt2iAfq56KFx6v7wweVug/uQNC+xaI3rtM1hamAeyKewdp54qBJBBGdrFpHPhYyWExIdbDanx2ZUA26c5NlcByvm44zCoqoe+7O0S0iko5J33ykzcz5tnEoPNXVUhJDWw8+YgbQpb6+Rd32LDvksh5GtN+7FM3cprj8WhWBaGEEAGZTqg79LZ8LHi3UBC30OHniXTlyWOp3o/KCnOwbjc8W+qHvK37yu4bXo2yGnBBmi8Fl9tEUJKDWVKi3B8C/nP53hXZK5P+psPOb9ymhYDab3HOs2rWTek7rjsM6XSwiWTAnUrb2hl7GW7q6OHJo4kaKnnRwDZY18H8j36ED5iL0g8uZyE/j8HohPBNV0k+jD8arnfodE6tGF4jwBSrJGdFxQKPxskhcvphhDyLd4J37WxmBrEsQdi0+prNyVvlFxtuL4dp+9wWlEQKRPI8noHr4sMe4qhI5VzXDHx7Y77Px5bm3qeYqj5kVaoKxtGD1Nditv6OXho5EZWwRpgQ3IfwsdKCJnPQjgKi7tQgms5fRh+FS/GR1YxoYI6VDRInIX88f5bb4d6/Cje5Y8rOz0XAuJ/i5P2Lwu+90naV3mNwfj+52llrtjDdf/cwwLTHfjDdJ6cbPHZMXyclQxoD9nnnmyob7GMYiP9cfWwsJhPuGyLzJf1PIWs0ZO/i68X6WfZBvNVyF8YIobJ5QpeX1a37UkZx79/Ff75zK/HB3rucsykVdFC2Dxn5jQsepTmqey+p5sD8+fOEymsHKyU33PPJ3sVrNIogDTYGH6YLSptX5Nv6+Fjtjixx5PFp/GWF504fGm2aBT0dXWL1oPrhqf3dkW8EJxs+SRhyAsfhetQHN6THS9VnG/U45+N7Hin+vOaX3mb/fuHgsvyxvc+Su+9KTQ8XVq8jNLho0B9O1j5Dhcr5/am9uM8+6yPIX8lsGWgPC+4bZNdG/U7hJDl9p0+uTYWLRI9IBsYglW9vi4LWip8ZAHgfFbigItPOJ/9XGIzngQuZjs0iNO23/Sw3OddmP+RLu6buvvbFC86L4UPSgbYoyrqUBpWU7aBqS7/LM94fE9zGtbnJd479jTFEPKhoa/zrqrwUXF9a2I/XoZ67/q/LlF+L0Ozy91PHNkCSBsNpX0LH4/dv9nr22zxOp9tOPiyfz+Iv5O93s8W4zufu0N1vUuoGS9O0PfqS6mLxx/pQjfvyGbF7Yi9HieGq1DCh6oD7Eqjpuh7/mW3/KKWuSAr+yv2spzUeG67T3WslqCT6ttR6NYzo55tT4T6bgYelii/+3S8NhVEQwef1yKADFm6mz3v0SZXET5On5wgHh8alv3bf1MguXvyioHj77Do7Yh3tkZr3v4ghZBdLjzxBN2nhmqneszS3cI4fOCPVJY3LdXnaaybcTvqfHIxnTStOODHRuG7OgJsbNRkr5eh2M0PPSC/luV0Q8P1vILPuE2N0Cp7e+fpXFV7D20qo6q3P+97xfJ6lz5zl2vIWfq7Ksv4Kl2Tyl7f4nb9kepaXWUYy+1Ij30+c0Dqq3znPdjOqsNHpXcsVv4+fs5WK9akeTh9mZQ+7/IDLNPF7nH70p2cOCQuTribhHpWy5qmQHZbYoIw/W+IHqUJs7G+bTvh92nD/lOT9Sjdnb5ZOU5ebdrumh5s2HdXOdeUuArSZQX7KjY6L+O8kpU6VmT+2+Nk6qaXA69w+1c9pOPma/p5X/bYiT1B2TbepP35pkBbYJ6uCZ+qPlbSdztLc49WzzMHJcrvNpXfrd767fymCKo3W9zR/yF8VOrDeIeHOc0W29b1Sek7facuWVlRJZ60/3fl4nKQc6FZXuSW//t7usjcu1M0PFkd+W/BxsFvz7zXJPxctSevbt136eK/cpz8Y9sLPIOE+vbT8rwV69nva+pZrF//CYtnEE07+B0Ow/arWa2eixs5Zp6UcUgh/bnyrSQAVXBdC2vqQtyu5fDJWA/mbpgJIF0LId9Cd1dB6Fv4KLTds8VQsC73RL0cG4aBALIxgAAwLOaA1Oej8FG59ztOSo+9C9OO7od74QMAEECoUhwP2LVxgH0OH1Hswv2846T0Olc9GWJABQAQQPpo/HNSkvBRrVFY/8CqdfvhpGNhsGt1AwBAABmIK+GjFpPZDhPM01CnLk32/jju11LBAAACSB+MF0N/blrejKGFj6XT2Q7blcqgK4Hwg6MDABBAqMsn4aM2uz4p/TK0P/TpRu8HACCAUJv0oLlpxW87Dz/fd7qn4WPpbsdJ6UWeWFylK0cFALDPPAm9uUbnpMTfxzvmMUx8Wffk7NnPh+e8Tr+3D+EjiuHjLnu93DIQxieln6W/OWh4W2/G3VyRCwCgMR741JCCjfoYPN6NG5xH0oOH9+U17s92+J7HYYfVtCoQ9+Ufhl+xLzyIEIB1DMFqzq5Db25Sg7XJ8HHa0/AR7TopPc4Feboy1jRsHtpWlJWvAACCIViNiUNvZosQcrHFr5+NG149KzXer3tezHFS+ny8ZXjIfu/DbBEK1j6VPA1ti70lb8IOE96fmAcrXwEAPNID0qwPYfMcAOGjnM8pNGwbDG/GOZPSx4tA82G8mGNyFIr1jLzT+wEAIIA0LjVC321oqAof5RykEHJQw/6bjhchJM412TZQ3I499RwAQABpMYTExuhzDdLYuG10mM4Aw8dSHCr1vsZ9GENiDCLzDb+6KXACAOwdc0DaEe+gT8Kvd+nPmtyAAYePpTgp/XtdoS4O25othmXdhfVzQ64su8semyoCAJ5jucOWPFkGdqclZIWPnZzUOQQqPYn9uWeKxKFXJ2o6AMCvDMFqSWoU36T/+7Hhj3+1R0U9qnk/xgnsT8PjQ2i4RwsAQABhG3F+QO4qTDX5sifl28i8mhQmpyv/6cSqVwAAzzMEaw+lFaL+3oOvejRuaBx6Wvr3R1jM+7hUywAABBB+bTB/C8UfrNcH9+nZHU2W6fnYAwcBAHIZgrW/hj5E6FPTHyh8AAAIIOwvD/8DABBAoBFzz98AABBAoLEAoggAAAQQumXIE9AFEAAAAYSuSEvGHgz4K/5lLwMACCB0x/HAv9/vdjEAgABCd7wZ+Pcb2cUAAAIIHTALYRKGPf9DAAEAEEDokPd78B1HMyEEAEAAoV1Zo/w8DL/3Y2lijwMACCC0Fz5ig/z9Hn3lN/Y6AIAAQjvhI/Z6fN6zrz2Z6QUBABBAaDx8nGY/7sKwn/uxzoUaAADQLb8pgsEGj4PUAD/f86I4G4dwo0YAAAgg1Bc8Yuh4G/az1+Oph+x1lIWQe0UBANA+Q7CGJ4aOF8LHL+XxeaY8AAA6QQ/IQKUJ2HEI1kRpPJpnrxM9IQAAAgj1BpHTFERGSuMxhLwcL4ZlAQAggCCI1CIGjo/Z64PwAQAggNBsEJmE/RmaNc9enwQPAAABhPaDyCgsVso6DcOboH0bg8d48RMAAAGEjoWR4+zHm7D42Vdxcnns7bgdL3o+AAAQQOh4EDlIIeRV+tn1nhGhAwBAAGFAgeRwJZBMOhI4ptnra/xpXgcAgADC8ANJfL0IP/93Xb0kMWjMs9df6X/fCxwAAAIILFfWCiUDyTT9FDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgS/8nwABSYZLbrXe2HQAAAABJRU5ErkJggg=="}},o&&a.create(o,c)}function o(e,t,i,a){var n="";return e&&t&&(n=n+e+" a "+t),i&&a&&(n&&(n+="\n"),n=n+i+" a "+a),n}var r={exportSummarizedPlanPdf:s,generateSummarizedVisits:n};return e.plannerReportsService=r,r}e.$inject=["$window","$filter","timeUtils","pdfService"],angular.module("icarus.planner").factory("plannerReportsService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o){function r(e,t,a){return e.big_cluster?i.post(w,t):a?i.post(x,t):i.post(A,t)}function l(e,t,a,n){var s=m(n);return s.vehicles=v(e,a,n.planEditingSelected,n.planName),s.nodes=c(t,n.optimizationOptions,n.isJDH,!1,a),n.optimizationOptions.big_cluster?i.post(w,s):n.isBigVrp?i.post(x,s):i.post(A,s)}function c(e,t,i,a,n){var o=[];return e.forEach(function(e){var r,l=s.getSimilar(o,e,t.join);r=l[0],r||(r={ident:e.id,group:[],address:e.address,lat:e.latitude,lon:e.longitude,duration:e.duration,load:0,load_2:0,load_3:0,window_start:e.windowStart||"00:00",window_end:e.windowEnd||"23:59",window_start_2:e.windowStart2||"23:59",window_end_2:e.windowEnd2||"23:59",cluster:0,skills_required:a?[]:e.skills_required,skills_optional:a?[]:e.skills_optional,sms_enabled:e.sms_enabled,priority_level:e.getPriority(),zones:a||0===n.length?[]:e.getZones()},i||(r.priority=e.getCPriority()),o.push(r)),r.group.push(e.id),e.duration&&(r.duration=e.duration),a||(r.load=h(e.load,r.load),r.load_2=h(e.load2,r.load_2),r.load_3=h(e.load3,r.load_3)),r.window_start=g(e.window_start,r.window_start),r.window_end=g(e.window_end,r.window_end),r.window_start_2=g(e.window_start_2,r.window_start_2),r.window_end_2=g(e.window_end_2,r.window_end_2)}),o}function d(e,s,o,r){function l(t){s.clearVisits(),t.data.vehicles[0].tours.forEach(function(t){t.nodes.shift(),t.nodes.pop();var i=1;t.nodes.forEach(function(t){var a=null,n=v.filter(function(e){return e.ident===t.ident})[0];n.group.forEach(function(l,c){for(var d=0;d<o.length;d++)if(o[d].id===l){a=o[d];break}if(c===n.group.length-1?a.updateOrder(i):a.updateOrder(t.order),a.removeIndicatorsErrors(),a.estimatedTimeArrival=t.arrival,a.estimatedTimeDeparture=t.departure,r.optimizationOptions.big_cluster){var u=e.validateVisitSkills(a);u&&(s.skillsError=!0,a.skillsError=!0)}a.setDefaultColor(e.color),s.addVisit(a),i++})})}),(r.optimizationOptions.big_cluster||n.drawCluster)&&s.calculatePath(!0),u.resolve(s)}function d(e){t.error("reorderRoute",e),u.reject(e)}var u=a.defer(),p=m(r),v=[];return p.vehicles=b(e),p.nodes=c(s.visits,r.optimizationOptions,r.isJDH,!0,[]),v=p.nodes,r.isJDH&&(p.isReorder=!0),r.optimizationOptions.big_cluster?i.post(k,p).then(l,d):r.isJDH?i.post(A,p).then(l,d):i.post(y,p).then(l,d),u.promise}function u(e,t,i,a,n){return angular.forEach(e,function(e,s){"id"!==s&&"created"!==s&&"modified"!==s&&"displayed_options"!==s?(t[s]=e,i[s]=e):"displayed_options"===s&&(a=e),"fmv"===s&&(t[s]=parseFloat(e),i[s]=parseFloat(e)),(n.username.includes("@simplit-solutions.com")||n.username.includes("@simpliroute.com"))&&(i.jdh=!0,t.jdh=!0,a=a.concat(",jdh"))}),p(t,i,a)}function p(e,i,n){var s=a.defer(),r={optionsPlanner:e,optionsPlannerLocal:i,optionsPlannerDisplayed:n};return o.getConfigByKey("optimize_cluster").then(function(t){var a=n.indexOf("big_cluster");t||(angular.isDefined(e.big_cluster)&&delete e.big_cluster,angular.isDefined(i.big_cluster)&&delete i.big_cluster,a>-1&&n.splice(a,1)),r.optionsPlannerDisplayed=n,r.optionsPlanner=e,r.optionsPlannerLocal=i,s.resolve(r)})["catch"](function(e){t.info(e),s.resolve(r)}),s.promise}function m(e){return{vehicles:[],nodes:[],balance:e.optimizationOptions.balance,all_vehicles:e.optimizationOptions.all_vehicles,big_cluster:e.optimizationOptions.big_cluster,join:e.optimizationOptions.join,open_ended:e.optimizationOptions.open_ended,fmv:e.optimizationOptions.fmv,single_tour:e.optimizationOptions.single_tour}}function v(e,t,i,a){var n=[];return e.forEach(function(e){if(!i&&a){if(!e.active||0===e.routes.length)return}else if(!e.active)return;n.push({ident:e.id,location_start:{ident:"vehicle-start-"+e.id,lat:e.locationStart.latitude,lon:e.locationStart.longitude},location_end:{ident:"vehicle-end-"+e.id,lat:e.locationEnd.latitude,lon:e.locationEnd.longitude},capacity:e.capacity,capacity_2:e.capacity2&&0!==e.capacity2?e.capacity2:1,capacity_3:e.capacity3&&0!==e.capacity3?e.capacity3:1,shift_start:e.shift.start,shift_end:e.shift.end,skills:f(e.skills),refill:parseInt(e.refill),zones:_(t,e.id)})}),n}function g(e,t){return e&&!t?t=e:e&&t&&e>t&&(t=e),t}function h(e,t){return e&&(t+=angular.isString(e)?0:e),t}function _(e,t){var i=[];return e.forEach(function(e){e.vehicles.forEach(function(a){parseInt(a)===parseInt(t)&&i.push(parseInt(e.id))})}),i}function f(e){var t=[];return e.forEach(function(e){t.push(parseInt(e))}),t}function b(e){return[{ident:e.id,location_start:{ident:"vehicle-start-"+e.id,lat:e.locationStart.latitude,lon:e.locationStart.longitude},location_end:{ident:"vehicle-end-"+e.id,lat:e.locationEnd.latitude,lon:e.locationEnd.longitude},shift_start:e.shift.start,capacity:e.capacity,capacity_2:e.capacity2&&0!==e.capacity2?e.capacity2:1,capacity_3:e.capacity3&&0!==e.capacity3?e.capacity3:1,skills:e.skills}]}var y=e.API_URL+"optimize/",w=e.API_URL+"optimize/k-means",A=e.VRP_URL+"vrp/optimize/sync/",x=e.VRP_URL+"big-vrp/optimize/sync/",k=e.API_URL+"optimize/optimize-k-means";return{reoptimizePlan:r,optimizePlan:l,getVisitsRequestData:c,reorderRoute:d,setOptimizationOptions:u,checkIfOptimizationOptionClusterExist:p}}e.$inject=["__env","$log","$http","$q","$rootScope","visitSimilarService","accountConfigsService"],angular.module("icarus.planner").service("optimizeService",e)}(),function(){"use strict";function e(e){function t(t){w=e[t]}function i(e){return a?_(" "+e+" ").trim():e}function a(){var e=!0;return(angular.isUndefined(w)||angular.isUndefined(w.latinMap)||angular.isUndefined(w.specialChars||angular.isUndefined(w.absoluteStopWords)||angular.isUndefined(w.continuationStopWords)||angular.isUndefined(w.urbanizationStopWords)||angular.isUndefined(w.districts)||angular.isUndefined(w.administrativeAreaLvl4)))&&(e=!1),
e}function n(e){var t=e.toLowerCase();for(var i in w.specialChars)w.specialChars.hasOwnProperty(i)&&(t=t.replace(new RegExp(RegExp.escape(i),"g"),w.specialChars[i]));return t}function s(e){return e.replace(/[^A-Za-z0-9\[\] ]/g,function(e){return w.latinMap[e]||e})}function o(e){var t=s(e);return n(t)}function r(e){var t=n(e).split(" ");return w.absoluteStopWords.forEach(function(e){for(var i=0,a=[];-1!==i&&-1===a.indexOf(i);)if(i=t.indexOf(e.toLowerCase(),i),a.push(i),-1!==i)if(t.length-1>i){var n=isNaN(parseInt(t[i+1]))?t[i+1]:parseInt(t[i+1]);"string"==typeof n&&t.splice(i,1)}else t.splice(i,1)}),t.join(" ")}function l(e){var t=!1,i={};return w.districts.forEach(function(a){var n=" "+a.toLowerCase()+" ";t||-1===e.indexOf(n.toLowerCase())?t&&-1!==e.indexOf(n.toLowerCase())&&(-1!==n.indexOf(" "+i.districtName+" ")?(i.index=e.indexOf(n.toLowerCase()),i.wordLength=a.split(" ").length,i.districtName=a.toLowerCase(),t=!0):w.sendAdministrativeAreaLv3&&(e=e.replace(new RegExp(RegExp.escape(n.toLowerCase()),"g")," "))):(i.index=e.indexOf(n.toLowerCase()),i.wordLength=a.split(" ").length,i.districtName=a.toLowerCase(),t=!0)}),v(i),e}function c(e){var t=e,i="",a=g();a.districtName&&w.sendAdministrativeAreaLv3&&(t=t.replace(new RegExp(RegExp.escape(" "+a.districtName.toLowerCase()+" "),"g")," "));var n=t.split(" ");return w.continuationStopWords.forEach(function(e){for(var t=0;-1!==t;)if(t=n.indexOf(e.toLowerCase()),-1!==t){var i=1;if(n.length-1>t)for(var a=t+1;a<n.length&&!(d(n,n[a],a)||u(n[a])||p(n[a]));a++)i++;n.splice(t,i)}}),i=a.districtName&&w.sendAdministrativeAreaLv3?n.join(" ")+" "+a.districtName:n.join(" ")}function d(e,t,i){var a=!0,n=g();if(n.hasOwnProperty("districtName")&&n.districtName){var s=n.districtName.split(" ");if(t===s[0])for(var o=0;o<s.length;o++)s[o]!==e[i+o]&&(a=!1);else a=!1}else a=!1;return a}function u(e){var t=!0,i=w.continuationStopWords.map(function(e){return e.toLowerCase()});return-1===i.indexOf(e)&&(t=!1),t}function p(e){var t=!0,i=w.absoluteStopWords.map(function(e){return e.toLowerCase()});return-1===i.indexOf(e)&&(t=!1),t}function m(e){var t=!0,i=w.urbanizationStopWords.map(function(e){return e.toLowerCase()});return-1===i.indexOf(e)&&(t=!1),t}function v(e){A=e}function g(){return A}function h(){var e="";return A.hasOwnProperty("districtName")&&A.districtName&&(e=A.districtName),e}function _(e){var t=l(o(e)),i="";h()||(i=b(t));var a=c(t),n=r(a);return i&&(n=n.length>1?n+", "+i:i,v({index:0,wordLength:i.split(" ").length,districtName:i})),n}function f(e){var t="";return w.administrativeAreaLvl4.hasOwnProperty(e)&&(t=w.administrativeAreaLvl4[e]),t}function b(e){var t=e.split(" "),i="",a=!1;return w.urbanizationStopWords.forEach(function(e){if(!a){var n=0,s=[];if(n=t.indexOf(e.toLowerCase()),-1!==n){if(t.length-1>n)for(var o=n+1;o<t.length;o++)if(d(t,t[o],o)||u(t[o])||p(t[o])||m(t[o])){if(m(t[o])||o!==n+1)break;s.push(t[o])}else s.push(t[o]);i=f(s.join(" ").trim().toUpperCase()),i&&(a=!0)}}}),i.toLowerCase()}function y(){return w.sendAdministrativeAreaLv3}var w=e,A={},x={setConfig:t,cleanAddress:i,replaceSpecialChars:n,latiniseString:s,cleanOfAbsoluteStopWords:r,applyRules:_,getDistrict:h,getDistrictAndDeleteOthersOnString:l,recognizeAndGetDistrictFromUrbanization:b,sendDistrictConfig:y};return x}e.$inject=["CLEANER_CONFIG"],angular.module("icarus.planner").factory("cleanerService",e)}(),function(){"use strict";function e(e,t){function i(t){e.$broadcast("NEW_ALERT_NOTIFICATION",{notification:t})}function a(){e.$broadcast("DELETE_ALERT_NOTIFICATION")}var n={addAlertNotification:i,removeAlertNotification:a};return t.alertNotificationService=n,n}e.$inject=["$rootScope","$window"],angular.module("icarus.planner").factory("alertNotificationService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y,w,A,x,k,I,S){function E(){function e(e){return 0===e.visits.length&&0===e.routes.length?(h.go("planner.vehicles-list"),void a.$emit("Planner:Plan:steps-reset")):(_.getUser().then(function(e){xe(e.account.configs)}),Le.optimizationOptions=n.localOptimizationOptions,n.hideVehicles(),n.hideInfoWindow(),Le.planName=n.getPlanName(),angular.isUndefined(i.optimize)?N():1===parseInt(i.optimize)?(b.fbq("track","ViewContent"),n.visits.length>0&&n.vehicles.length>0&&D()):2===parseInt(i.optimize)?he():N(),n.vehicles.length>0&&(Le.allVehicles=n.vehicles),Le.routes=n.routes,Le.routes.map(function(e){Ce(e)}),Le.planDate=s(e.planDate.start).format("DD MMMM, YYYY"),Le.shift=e.shift,Le.showLoads=n.enableShowLoad,void Le.updateStepsPlanner(e))}return I.callGoogleTrackConversion("lM5yCIP7_2wQndigwgM"),Le.jdh=i.jdh,Le.optimize=i.optimize,Le.planDate=null,Le.routes=null,Le.editMode=!1,Le.visitsOutOfRoute=[],Le.selectAllVisitsOutOfRoute=!1,Le.visibleAllRoutes=!0,Le.vehicles=[],Le.allVehicles=[],Le.moveToOptions=[],o.isLoading=!0,n.enableShowLoad.load2=!1,n.enableShowLoad.load3=!1,n.disableStep.vehicleDisabled=!1,Le.drivers=n.getDrivers(),n.clearMapVisits(),n.getPlan().then(e,function(){o.isLoading=!1})}function C(e){a.$emit("Planner:Plan:info",{planDate:e.planDate.start,planName:Le.planName}),a.$emit("Planner:Plan:steps",{key:"vehicle",value:!0}),a.$emit("Planner:Plan:steps",{key:"visit",value:!0}),a.$emit("Planner:Plan:steps",{key:"route",value:!0})}function D(){var t=n.getVehicles(),i=n.getVisits(),a={optimizationOptions:n.getOptimizationOptions(),isJDH:Ae(),planName:n.getPlanName(),planEditingSelected:n.getPlanEditingSelected(),isBigVrp:!1};k.getZonesIfProceed().then(function(n){S.getAllConfigs().then(function(e){a.isBigVrp=e.big_vrp,P(t,i,n,a)})["catch"](function(s){e.error(s),P(t,i,n,a)})})}function P(e,t,i,a){x.optimizePlan(e,t,i,a).then(L)["catch"](O)["finally"](function(){T()})}function L(e){function i(){var e=t.defer(),i=[];return n.vehicles.map(function(e){if(e.routes.length>0){var t=e.recalculateAllRoutes(Le.optimizationOptions).then(function(){e.routes.map(function(e){e.setVisible(),Le.optimizationOptions.big_cluster||e.visits.map(function(e){e.setVisible(),Le.optimizationOptions.big_cluster&&e.ifMarkerNotCreatedThenCreate()})})});i.push(t),Le.optimizationOptions.big_cluster||e.setVisible(!0,Le.optimizationOptions.open_ended),e.setIconFillColorWithVehicleColor(),Le.vehicles.push(e)}}),t.all(i).then(function(){e.resolve()},function(){e.resolve()}),e.promise}var a=n.getOptimizationOptions();a.big_cluster&&(o.isLoadingBigData=!0),R(),V(e.data),i().then(function(){if(Le.optimizationOptions.big_cluster||n.calculateAverageTime(),Le.optimizationOptions.big_cluster){var e=[],t=0;o.isLoadingBigData=!0,Le.vehicles.map(function(t){t.routes.map(function(t){e.push(t)})}),Te&&p.cancel(Te),Le.maxProgressBar=e.length,be(e,t),Te=p(ye,Oe)}Le.optimizationOptions.big_cluster||o.drawCluster||n.createVisitsMarkerLight(),o.isLoading=!1,Le.updatePlannerIndicators(),M()},function(){Le.optimizationOptions.big_cluster||n.calculateAverageTime(),o.isLoading=!1}),fe(Le.vehicles),Le.optimizationOptions.big_cluster||n.visits.map(function(e){null===e.routeId&&(e.setDefaultColor("#A4A4A4"),e.setVisible(!0,!1),e.updateOrder(null),Le.optimizationOptions.big_cluster&&e.ifMarkerNotCreatedThenCreate(),Le.visitsOutOfRoute.push(e))}),n.mapFitBoundAllVisits()}function O(t){if(e.error("Error optimizePlan",t),o.isLoading=!1,400===t.status)if(t.data.vehicles){for(var i=null,a=0;a<t.data.vehicles.length;a++)if(t.data.vehicles[a].capacity){i=!0;break}i&&(g.push("error",Ve("Planner_toast.error_optimize_capacity_vehicles")),h.go("planner.vehicles-list"))}else g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^");500===t.status&&(g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^")),(502===t.status||504===t.status)&&(g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^"))}function T(){Le.updateSelectedDrivers(),n.headerStatics.usedVehicles=Le.vehicles.length,n.headerStatics.createdRoutes=n.routes.length,n.visits.length>0&&n.vehicles.length>0&&n.routes.length>0&&!Le.optimizationOptions.big_cluster&&n.calculateAverageLoad()}function V(e){var t=n.getVehicles(),i=n.getRoutes(),a=n.getVisits(),s=n.getOptimizationOptions(),o=Ae(),r=x.getVisitsRequestData(a,s,o,!1,[]);t.forEach(function(e){e.clear()}),i.length=0,e.vehicles.forEach(function(e){for(var i=null,o=0;o<t.length;o++)if(t[o].id===e.ident){i=t[o];break}var l=1;e.tours.forEach(function(e){var t=n.createRoute(i.id);t.actionCreate(t),t.estimatedTimeStart=e.nodes.shift().arrival,t.estimatedTimeEnd=e.nodes.pop().arrival,e.nodes.forEach(function(e){var n=null,o=r.filter(function(t){return t.ident===e.ident})[0];o.group.forEach(function(r,c){for(var d=0;d<a.length;d++)if(a[d].id===r){n=a[d];break}if(c===o.group.length-1?n.updateOrder(l):n.updateOrder(e.order),n.estimatedTimeArrival=e.arrival,n.estimatedTimeDeparture=e.departure,s.big_cluster){var u=i.validateVisitSkills(n);u&&(t.skillsError=!0,n.skillsError=!0)}n.setIconFillColor(i.color),n.setDefaultColor(i.color),t.addVisit(n,!1),t.optimized=!0,l++})}),i.addRoute(t)})})}function R(){var e=n.getVisits();e.forEach(function(e){e.load2&&e.load2>0&&n.setEnableShowLoad("load2",!0),e.load3&&e.load3>0&&n.setEnableShowLoad("load3",!0)})}function M(){Le.vehiclesToSeeRoutesInDetail=n.getUserVisualState(),Le.vehicles.forEach(function(e){angular.isUndefined(Le.vehiclesToSeeRoutesInDetail[parseInt(e.id)])?(e.showRoutes=!0,Le.vehiclesToSeeRoutesInDetail[parseInt(e.id)]=!0):e.showRoutes=Le.vehiclesToSeeRoutesInDetail[parseInt(e.id)]}),Le.vehiclesToSeeRoutesInDetail.hasOwnProperty("outOfRoutes")?Le.showVisitsOutOfRoutes=Le.vehiclesToSeeRoutesInDetail.outOfRoutes:Le.vehiclesToSeeRoutesInDetail.outOfRoutes=Le.showVisitsOutOfRoutes,z()}function z(){Le.visitsOutOfRoute.forEach(function(e){e.setVisible(Le.vehiclesToSeeRoutesInDetail.outOfRoutes)})}function F(){a.$emit("Planner:Plan:calculate-indicator-tooltip"),a.$emit("Planner:Plan:calculate-indicator-average-kms")}function N(){n.vehicles.map(function(e){e.routes.length>0&&(e.routes.map(function(t){(Le.optimizationOptions.big_cluster||o.drawCluster)&&t.setVisibleWithoutOpacity(),t.visits.map(function(t){t.setDefaultColor(e.color)}),t.optimized&&Re&&t.calculatePath(Le.optimizationOptions.big_cluster).then(function(){t.actionCreate(t)})}),e.setIconFillColorWithVehicleColor(),Le.vehicles.push(e))}),fe(Le.vehicles),n.visits.map(function(e){Le.optimizationOptions.big_cluster||(e.load2&&e.load2>0&&(n.enableShowLoad.load2=!0),e.load3&&e.load3>0&&(n.enableShowLoad.load3=!0)),null===e.routeId&&(e.setDefaultColor("#A4A4A4"),e.updateOrder(null),Le.visitsOutOfRoute.push(e))}),Le.optimizationOptions.big_cluster||o.drawCluster||n.createVisitsMarkerLight(),n.mapFitBoundAllVisits(),n.headerStatics.createdRoutes=n.routes.length,n.headerStatics.usedVehicles=Le.vehicles.length,n.visits.length>0&&n.vehicles.length>0&&n.routes.length>0&&(n.calculateAverageLoad(),n.calculateAverageTime()),o.isLoading=!1,Le.updateSelectedDrivers(),Le.updatePlannerIndicators(),M(),$(),a.$emit("Planner:Plan-editing",{value:n.getPlanName()})}function $(){var e;n.clearMapVisits(),n.clearMapRoutes(),n.createRoutesPolyline(),Le.optimizationOptions.big_cluster||o.drawCluster||n.createVisitsMarkerLight(),Le.vehicles.forEach(function(t){e=Le.vehiclesToSeeRoutesInDetail[parseInt(t.id)],e?t.setVisible(!0,Le.optimizationOptions.open_ended):t.setVisible(!1),t.routes.forEach(function(t){e?t.setVisible():t.setVisible(!1),t.visits.forEach(function(t){e?t.setVisible():t.setVisible(!1)})})})}function j(e){Le.optimizationOptions.big_cluster?e.showAllRoutes(e.showRoutes,!1,Le.optimizationOptions):e.showAllRoutes(e.showRoutes,!0,Le.optimizationOptions);var t=e.routes[0].collapse;t&&!e.showRoutes?e.setVisible(!1):e.showRoutes&&e.setVisible(!0),H(e.showRoutes,e.id)}function B(e){var t=!e.collapse,i=n.vehicles.filter(K(e.vehicleId))[0];e.collapse=t,e.setVisitsListed(!t),t||(Le.route_not_collapsed=e.id),Le.optimizationOptions.big_cluster||o.drawCluster?(e.collapse||n.collapseOtherRoutes(e),e.visible&&(t?(e.hideVisitsWithError(i.color),n.clearMapVisits(),n.routes.map(function(e){e.setOpacity(1)}),e.setVisitsListed(!1)):(e.setVisitsListed(!0),i.setOpacity(1),e.setOpacity(1),o.$broadcast("Planner:Routes:showMarkersOfRoute",{route:e}),n.routes.map(function(t){t.id!==e.id&&t.setOpacity(.2)}),n.vehicles.map(function(e){e.id!==i.id&&e.setOpacity(0)})))):e.collapse?(n.clearMapVisits(),n.clearMapRoutes(),n.createRoutesPolyline(),n.createVisitsMarkerLight(),U()):(n.clearMapVisits(),n.clearMapRoutes(),n.collapseOtherRoutes(e,Le.optimizationOptions.open_ended),e.actionCreate(e),e.createVisitsMarkers(),e.visits.forEach(function(t){t.setVisible(e.visible)}),i.setVisible(e.visible,Le.optimizationOptions.open_ended))}function H(e,t){Le.vehiclesToSeeRoutesInDetail[t]=e}function U(){Le.vehicles.forEach(function(e){Le.vehiclesToSeeRoutesInDetail[parseInt(e.id)]&&(e.options.visible=e.showRoutes),e.setVisible(e.options.visible,Le.optimizationOptions.open_ended)})}function q(e,t,i){var a=!i.visible,s=!0;e&&e.stopPropagation(),Le.optimizationOptions.big_cluster?(i.setVisible(a),t.routes.map(function(e){e.visible&&(s=!1)}),t.showRoutes=!s):(t.setVisible(a,Le.optimizationOptions.open_ended),i.setVisible(a),i.visits.map(function(e){e.setVisible(a)}),i.collapse?i.hideVisitsWithError():(i.setOpacity(1),t.setOpacity(1),i.showVisitsWithError(),n.routes.map(function(e){e.id!==i.id&&e.setOpacity(.2)}),n.vehicles.map(function(e){e.id!==t.id&&e.setOpacity(.3)})),t.routes.map(function(e){e.visible&&(s=!1)}),s?t.showRoutes=!1:t.showRoutes=!0)}function G(){n.exportPlanTxt()}function J(){n.exportPlanExcel(),e.info("Descargado reporte excel")}function Y(){n.exportPlanPdf(),e.info("Descargado reporte pdf")}function W(){var t=n.getPlanDate();f.exportSummarizedPlanPdf(Le.vehicles,t.start),e.info("Descargado reporte pdf resumido")}function Q(){d.open({template:"app/planner/routes/finish-modal.html",controller:"FinishPlanController",controllerAs:"vm",showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-default custom-width-800"})}function Z(e){var t=Le.showVisitsOutOfRoutes;e&&e.stopPropagation(),Le.visitsOutOfRoute.map(function(e){e.setVisible(t)}),Le.vehiclesToSeeRoutesInDetail.outOfRoutes=Le.showVisitsOutOfRoutes}function K(e){return function(t){return t.id===e}}function X(){Le.visibleAllRoutes=!Le.visibleAllRoutes,Le.vehicles.forEach(function(e){e.showRoutes=Le.visibleAllRoutes,Le.optimizationOptions.big_cluster?e.showAllRoutes(Le.visibleAllRoutes,!1,Le.optimizationOptions):e.showAllRoutes(Le.visibleAllRoutes,Le.visibleAllRoutes,Le.optimizationOptions),H(Le.visibleAllRoutes,e.id)})}function ee(e,t){t?e.optionCircleFillColor=e.color:e.optionCircleFillColor="none"}function te(){var e=Le.visitsOutOfRouteActions.collapsed?"Planner:RemoveVisitsFromArray:Visit":"Planner:CreateVisitsFromArray:Visit";Le.optimizationOptions.big_cluster||o.drawCluster?ae(e):ie(e)}function ie(e){Le.visitsOutOfRouteActions.collapsed?(ae(e),n.clearMapVisits(),n.clearMapRoutes(),n.createRoutesPolyline(),n.createVisitsMarkerLight(),Le.out_of_route_opened="",ne()):(Le.out_of_route_opened="opened",n.hideVehicles(),n.clearMapVisits(),n.clearMapRoutes(),ae(e))}function ae(e){o.$broadcast(e,{visits:Le.visitsOutOfRoute})}function ne(){Le.vehicles.forEach(function(e){e.setVisible(e.showRoutes)})}function se(){return null!==n.getPlanName()}function oe(e){return le(e.visits)}function re(e){return le(e)}function le(e){var t=0,i=[];return e.map(function(e){var a=A.getSimilar(i,e,Le.optimizationOptions.join);0===a.length&&(t++,i.push(e))}),Le.optimizationOptions.join||(t=e.length),t}function ce(){n.clearPlan()}function de(){return Le.report.txt?(Le.report.txt=!1,Le.report.excel=!1,Le.report.pdf=!1,Le.report.summarizedPdf=!1,e.info("Descargando reporte txt"),void G()):Le.report.excel?(Le.report.excel=!1,Le.report.pdf=!1,Le.report.summarizedPdf=!1,e.info("Descargando reporte excel"),void J()):Le.report.pdf?(Le.report.excel=!1,Le.report.pdf=!1,Le.report.summarizedPdf=!1,e.info("Descargando reporte pdf"),void Y()):Le.report.summarizedPdf?(Le.report.excel=!1,Le.report.pdf=!1,Le.report.summarizedPdf=!1,e.info("Descargando reporte resumido pdf"),void W()):void 0}function ue(e){Le.openedDriverList=Le.openedDriverList===e?null:e}function pe(e){return Le.openedDriverList===e}function me(){for(var e=[],t=null,i=0;i<Le.vehicles.length;i++)angular.isUndefined(Le.vehicles[i].driver)||null===Le.vehicles[i].driver||""===Le.vehicles[i].driver||(t=Le.vehicles[i].driver instanceof Object?Le.vehicles[i].driver:JSON.parse(Le.vehicles[i].driver),t.selected=!0,t.group=Ve("Driver.group_assigned"),e.push(t));Le.drivers.map(function(t){var i=e.filter(function(e){return e.id===t.id});t.group=Ve(i.length?"Driver.group_assigned":"Driver.group_available"),t.selected=!!i.length})}function ve(e){return function(t){return m.naturalValue(t[e])}}function ge(e){var t;if(e.driverId||e.driver){var i=e.driver;"object"!=typeof e.driver&&(i=JSON.parse(i)),null!==i&&(t=i.name,e.driverId=i.id)}else t=c("translate")("Routes.assign_driver");return t}function he(){function t(e,t){x.reoptimizePlan(Le.optimizationOptions,e,t).then(i,a)}function i(e){Le.optimizationOptions.big_cluster&&(o.isLoadingBigData=!0),e.data.vehicles.forEach(function(e){for(var t=null,i=0;i<s.length;i++)if(s[i].id===e.ident){t=s[i];break}var a=1;e.tours.forEach(function(e){var i=n.createRoute(t.id);i.estimatedTimeStart=e.nodes.shift().arrival,i.estimatedTimeEnd=e.nodes.pop().arrival,e.nodes.forEach(function(e){var n=null,s=c.filter(function(t){return t.ident===e.ident})[0];s.group.forEach(function(o,l){for(var c=0;c<r.length;c++)if(r[c].id===o){n=r[c];break}if(l===s.group.length-1?n.updateOrder(a):n.updateOrder(e.order),n.estimatedTimeArrival=e.arrival,n.estimatedTimeDeparture=e.departure,Le.optimizationOptions.big_cluster){var d=t.validateVisitSkills(n);d&&(i.skillsError=!0,n.skillsError=!0)}n.setIconFillColor(t.color),n.setDefaultColor(t.color),i.addVisit(n,!1),i.optimized=!0,a++})}),t.addRoute(i)})}),_e().then(function(){if(Le.optimizationOptions.big_cluster){var e=[],t=0;o.isLoadingBigData=!0,Le.vehicles.map(function(t){t.routes.map(function(t){e.push(t)})}),Te&&p.cancel(Te),Le.maxProgressBar=e.length,be(e,t),Te=p(ye,Oe)}o.isLoading=!1},function(){o.isLoading=!1}),N()}function a(t){if(e.info("Routes ReoptimizePlan",t),400===t.status)if(t.data.vehicles){for(var i=null,a=0;a<t.data.vehicles.length;a++)if(t.data.vehicles[a].capacity){i=!0;break}i&&(g.push("error",Ve("Planner_toast.error_optimize_capacity_vehicles")),h.go("planner.vehicles-list"))}else g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^");500===t.status&&(g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^")),(502===t.status||504===t.status)&&(g.push("error",Ve("Planner_toast.error_optimize_500")),h.go("^"))}var s=[],r=[],l=Ae();o.isLoading=!0;var c=[],d={vehicles:[],nodes:[],balance:Le.optimizationOptions.balance,all_vehicles:Le.optimizationOptions.all_vehicles,big_cluster:Le.optimizationOptions.big_cluster,join:Le.optimizationOptions.join,open_ended:Le.optimizationOptions.open_ended,fmv:Le.optimizationOptions.fmv};r=n.getVisitsOutOfRoute(),r.length>0?n.getVehiclesAvailableWithoutRoute().then(function(i){s=i,s.length>0?k.getZonesIfProceed().then(function(i){s.forEach(function(e){d.vehicles.push({ident:e.id,location_start:{ident:"vehicle-start-"+e.id,lat:e.locationStart.latitude,lon:e.locationStart.longitude},location_end:{ident:"vehicle-end-"+e.id,lat:e.locationEnd.latitude,lon:e.locationEnd.longitude},capacity:e.capacity,capacity_2:e.capacity2&&0!==e.capacity2?e.capacity2:1,capacity_3:e.capacity3&&0!==e.capacity3?e.capacity3:1,shift_start:e.shift.start,shift_end:e.shift.end,skills:e.skills,refill:parseInt(e.refill)})}),r.forEach(function(e){var t,a=A.getSimilar(c,e,Le.optimizationOptions.join);t=a[0],e.load2&&e.load2>0&&(n.enableShowLoad.load2=!0),e.load3&&e.load3>0&&(n.enableShowLoad.load3=!0),t||(t={ident:e.id,group:[],address:e.address,lat:e.latitude,lon:e.longitude,duration:e.duration,load:0,load_2:0,load_3:0,window_start:e.windowStart||"00:00",window_end:e.windowEnd||"23:59",window_start_2:e.windowStart2||"23:59",window_end_2:e.windowEnd2||"23:59",cluster:0,skills_required:e.skills_required,skills_optional:e.skills_optional,sms_enabled:e.sms_enabled,priority_level:e.getPriority(),zones:0===i.length?[]:e.getZones()},l||(t.priority=e.getCPriority()),c.push(t)),t.group.push(e.id),e.load&&(t.load+=angular.isString(e.load)?0:e.load),e.load2&&(t.load_2+=angular.isString(e.load2)?0:e.load2),e.load3&&(t.load_3+=angular.isString(e.load3)?0:e.load3),e.duration&&(t.duration=e.duration),e.window_start&&!t.window_start?t.window_start=e.window_start:e.window_start&&t.window_start&&e.window_start<t.window_start&&(t.window_start=e.window_start),e.window_end&&!t.window_end?t.window_end=e.window_end:e.window_end&&t.window_end&&e.window_end>t.window_end&&(t.window_end=e.window_end),e.window_start_2&&!t.window_start_2?t.window_start_2=e.window_start_2:e.window_start_2&&t.window_start_2&&e.window_start_2<t.window_start_2&&(t.window_start_2=e.window_start_2),e.window_end_2&&!t.window_end_2?t.window_end_2=e.window_end_2:e.window_end_2&&t.window_end_2&&e.window_end_2>t.window_end_2&&(t.window_end_2=e.window_end_2)}),d.nodes=c,S.getAllConfigs().then(function(e){t(d,e.big_vrp)})["catch"](function(i){e.error(i),t(d,!1)})}):(N(),g.push("error",Ve("Planner_toast.error_no_vehicles_for_reoptimize")),o.isLoading=!1),M()})["catch"](function(t){e.error(t),N(),o.isLoading=!1}):(N(),g.push("error",Ve("Planner_toast.error_no_visits_for_reoptimize")),o.isLoading=!1)}function _e(){var e=t.defer(),i=0,a=0;return n.vehicles.map(function(t){t.routes.length>0&&(a++,t.recalculateAllRoutes(Le.optimizationOptions).then(function(){t.routes.map(function(e){e.setVisible(),Le.optimizationOptions.big_cluster||e.visits.map(function(e){e.setVisible(),Le.optimizationOptions.big_cluster&&e.ifMarkerNotCreatedThenCreate()})}),i++,i===a&&e.resolve()}),Le.optimizationOptions.big_cluster||t.setVisible(!0,Le.optimizationOptions.open_ended),t.setIconFillColorWithVehicleColor())}),e.promise}function fe(e){Le.moveToOptions=[],e.map(function(e){angular.forEach(e.routes,function(t,i){var a={name:[e.name," -- ",c("translate")("Routes.route_text")," ",i+1].join(""),vehicleId:e.id,routeId:t.id,color:e.color,background_color:"none"};Le.moveToOptions.push(a)})})}function be(t,i){if(t.length===i)return void we();var a=t[i],s=Le.optimizationOptions.big_cluster||o.drawCluster;if(s){var r=Ae(),l=n.getVisits(),c=n.getVehicleById(a.vehicleId),d={optimizationOptions:Le.optimizationOptions,isJDH:r};x.reorderRoute(c,a,l,d).then(function(){a.calculatePath(!0);var s=n.vehicles.filter(K(a.vehicleId))[0];s.recalculateRouteStartingAt(a,Le.optimizationOptions).then(function(){if(Le.maxProgressBar>Le.routesCompleted){Le.routesCompleted=i+1;var e=Le.routesCompleted/Le.maxProgressBar*100;Le.widthDynamic=String(e)+"%"}i+=1,be(t,i)},function(t){e.info(t),o.isLoadingBigData=!1})},function(t){e.info(t),we(),g.push("error",Ve("Planner_toast.error_order_route"))})}}function ye(){if(o.isLoadingBigData)if(Le.maxProgressBar>Le.routesCompleted){var e=(Le.routesCompleted+1)/Le.maxProgressBar*100,t=Le.widthDynamic.split("%");t[0]<e&&(t=parseFloat(t[0])+.1,Le.widthDynamic=String(t)+"%")}else we();else we()}function we(){u(function(){o.isLoadingBigData=!1,Le.widthDynamic="0%",Le.routesCompleted=0,Te&&p.cancel(Te)},10)}function Ae(){var e=!1;return e=1===parseInt(i.jdh)?!0:Le.enableJdhConfigAccount}function xe(e){e.forEach(function(e){"enable_jdh"===e.key&&(Le.enableJdhConfigAccount=e.value)})}function ke(){Le.vehicles=[],Le.routes=[],Le.allVehicles=[],Le.visibleAllRoutes=!0,a.$emit("Planner:Clear:Map"),Le.planDate=s().format("DD MMMM, YYYY"),Le.allVehicles.push(w.createAndAssignFakeRoutes()),angular.forEach(Le.allVehicles,function(e){angular.forEach(e.routes,function(e){e.setVisible(!0),angular.forEach(e.visits,function(e){e.setVisible(),e.ifMarkerNotCreatedThenCreate()}),Le.routes.push(e)}),e.setVisible(!0,!1),e.setIconFillColorWithVehicleColor(),e.recalculateAllRoutes(),Le.vehicles.push(e)}),a.$emit("TOUR:UPDATE_STADISTICS",{averageTime:"4:05",createdRoutes:1,usedVehicles:1,averageKms:84,averageLoad:0,averageLoad2:0,averageLoad3:0}),Re.getCurrentStep().next()}function Ie(e){e.collapse=!e.collapse,e.setVisitsListed(!e.collapse)}function Se(e,t){var i=t.steps.current;i.is("welcome","planner-routes")?(i.overrideAction("next",function(){Ie(Le.vehicles[0].routes[0]),this.next()}),i.overrideAction("back",function(){var e=this;a.$emit("Planner:Clear:Map"),h.go("^.visits-list",{},{location:"replace"}),setTimeout(function(){e.back()},100)})):i.is("goToAssign","planner-routes")&&(i.overrideAction("next",function(){Le.deployFinishModal()}),i.overrideAction("back",function(){Ie(Le.vehicles[0].routes[0]),this.back()}))}function Ee(){Le.routes=null,a.$emit("Planner:Clear:Map"),h.go("planner.vehicles-list",{},{location:"replace"})}function Ce(e){var t=v.find(Le.allVehicles,{id:e.vehicleId});e.formattedLoad=c("formatNumber")(e.totalLoad,2)+"/"+c("formatNumber")(t.capacity,2),e.formattedLoad2=c("formatNumber")(e.totalLoad2,2)+"/"+c("formatNumber")(t.capacity2,2),e.formattedLoad3=c("formatNumber")(e.totalLoad3,2)+"/"+c("formatNumber")(t.capacity3,2)}function De(){Pe(),h.go("planner.routes-detail",{route_opened:Le.route_not_collapsed,out_of_route_opened:Le.out_of_route_opened})}function Pe(){n.setUserVisualState(Le.vehiclesToSeeRoutesInDetail)}var Le=this,Oe=400,Te=null,Ve=c("translate"),Re=!1;Le.planDate=null,Le.routes=null,Le.visitsOutOfRouteActions={collapsed:!0},Le.editMode=!1,Le.visitsOutOfRoute=[],Le.selectAllVisitsOutOfRoute=!1,Le.showVisitsOutOfRoutes=!0,Le.visibleAllRoutes=!0,Le.vehicles=[],Le.allVehicles=[],Le.moveToOptions=[],Le.optionOutOfRoute={name:c("translate")("Routes.out_of_route"),vehicleId:-1,routeId:-1,color:"#A4A4A4",background_color:"none"},Le.jdh=0,Le.optimize=0,Le.optimizationOptions={balance:!1,all_vehicles:!0,big_cluster:!1,join:!1,open_ended:!1},Le.widthDynamic="0%",Le.routesCompleted=0,Le.planName=null,Le.report={excel:!1,pdf:!1,txt:!1,summarizedPdf:!1},Le.routeComment=null,Le.activatePanelOnTour={"planner-routes":["goToAssign"]},Le.route_not_collapsed="",Le.out_of_route_opened="",Le.vehiclesToSeeRoutesInDetail={},Le.toggleShowRoutes=j,Le.toggleShowRoute=q,Le.toggleCollapseRoute=B,Le.deployFinishModal=Q,Le.toggleVisitsOutOfRoutes=Z,Le.toggleVisibleAllRoutes=X,Le.fillVehiclesOptions=ee,Le.toogleVisitOutOfRoutesCollapse=te,Le.naturalSort=ve,Le.isEditingPlan=se,Le.calculateRouteVisits=oe,Le.calculateVisitsOutOfRoute=re,Le.clearPlan=ce,Le.downloadReport=de,Le.toggleVehicleDriversList=ue,Le.isVehicleDriversListOpen=pe,Le.updateSelectedDrivers=me,Le.naturalSort=ve,Le.getNameDriverAssigned=ge,Le.getPlanUnoptimized=N,Le.reoptimizePlan=he,Le.updateStepsPlanner=C,Le.updatePlannerIndicators=F,Le.goToRoutesDetail=De,Re=y.getActiveTour(),a.$on("$destroy",function(){Le.routes&&Le.routes.map(function(e){Le.optimizationOptions.big_cluster||o.drawCluster||(n.clearMapRoutes(),e.actionCreate(e))})}),o.$on("visitClickedOnMap",function(e,t){t.visit.routeId||(l.removeAlertNotification(),r(t.visit.id),angular.isUndefined(t.visit.indicatorError)||l.addAlertNotification(t.visit.indicatorError))}),a.$on("Planner:Route:toggleCollapseRoute",function(e,t){var i=t.route;B(i),a.$$phase||a.$apply()}),a.$on("TOUR:STEP_CHANGED",Se),a.$on("TOUR:END_ALL_TOURS",Ee),Re?ke():E()}e.$inject=["$log","$q","$stateParams","$scope","plannerService","moment","$rootScope","$anchorScroll","alertNotificationService","$filter","ngDialog","$timeout","$interval","naturalService","lodash","Toasts","$state","sessionService","plannerReportsService","$window","TourManager","TourFake","visitSimilarService","optimizeService","zoneService","marketingService","accountConfigsService"],angular.module("icarus.planner").controller("PlannerRoutesController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y){function w(){function e(e){return 0===e.visits.length&&0===e.routes.length?void n.go("planner.vehicles-list"):(g.getUser().then(function(e){oe(e.account.configs)}),Ae.optimizationOptions=p.localOptimizationOptions,p.hideVehicles(),p.hideInfoWindow(),Ae.planName=p.getPlanName(),L(),p.vehicles.length>0&&(Ae.vehiclesAvailable=p.getVehiclesAvailable()),Ae.routes=p.routes,Ae.planDate=m.formatTime(e.planDate.start,Ie),Ae.shift=e.shift,Ae.showLoads=p.enableShowLoad,p.visits.forEach(function(e){e.setLabelContent(e.order)}),c(function(){d(b.route_opened)}),"opened"===b.out_of_route_opened&&(Ae.visitsOutOfRouteActions.collapsed=!1),void(Ee=p.getPriorityLevels()))}return p.backupPlan(),p.setEditMode(!0),Ae.isEditingPlan=null!==p.getPlanName(),p.clearMapVisits(),t.isLoading=!0,Ae.drivers=p.getDrivers(),p.getPlan().then(e,function(){t.isLoading=!1})}function A(){var e=p.getUserVisualState();p.vehicles.forEach(function(t){e[parseInt(t.id)]||t.setVisible(!1)}),p.routes.map(function(t){if(t.visits.length>0){var i=parseInt(t.visits[0].vehicle);e[parseInt(i)]||(t.setVisible(!1),t.visits.forEach(function(e){e.setVisible(!1)}))}})}function x(e,t){e.background_color=t?e.color:"none"}function k(e,t){return-1===e&&-1===t}function I(e,i,a){for(var n=0;n<p.visits.length;n++)if(e=p.visits[n],e.selected){if(!e.routeId){t.isLoading=!1;continue}i=null,i=Ae.routes.filter(K(e.routeId))[0],i.removeVisit(e),0===i.visits.length&&(i.editingSelected=!1),-1===a.indexOf(i)&&a.push(i),e.setSelected(!1,!0,!1),e.setIconFillColor("#A4A4A4"),e.setDefaultColor("#A4A4A4"),e.setLabelContent(null),e.removeIndicatorError(),e.routeId=null,Ae.visitsOutOfRoute.push(e),Ae.optimizationOptions.big_cluster&&t.$broadcast("Planner:Visit:Remove",{visit:e})}return{visit:e,routeSrc:i}}function S(e,i,a,n,s,o,r){for(var l=0;l<p.vehicles.length;l++)if(p.vehicles[l].id===e){i=p.vehicles[l];for(var c=0;c<i.routes.length;c++)if(i.routes[c].id===a){n=i.routes[c];for(var d=0;d<p.visits.length;d++)if(s=p.visits[d],s.selected){s.routeId?(o=null,o=Ae.routes.filter(K(s.routeId))[0],o.removeVisit(s),0===o.visits.length&&(o.editingSelected=!1),-1===r.indexOf(o)&&r.push(o)):(Ae.visitsOutOfRoute.splice(Ae.visitsOutOfRoute.indexOf(s),1),0===Ae.visitsOutOfRoute.length&&(Ae.selectAllVisitsOutOfRoute=!1));var u=i.validateVisitSkills(s);u&&(n.skillsError=!0,s.skillsError=!0),s.setDefaultColor(i.color),Ae.optimizationOptions.big_cluster&&n.collapse&&t.$broadcast("Planner:Visit:Remove",{visit:s}),n.addVisit(s),s.setVisible(Ae.vehiclesToSeeRoutesInDetail[parseInt(s.vehicle)],!1),s.actionUpdate(s)}break}break}return{vehicle:i,route:n,visit:s,routeSrc:o}}function E(e){return e.map(function(e){var t=p.vehicles.filter(Z(e.vehicleId))[0];return t.recalculateRouteStartingAt(e,Ae.optimizationOptions)})}function C(e,n){t.isLoading=!0;var s=null,o={},r={},l={},c=[],d=null;if(k(e,n)?d=I(l,s,c):(d=S(e,o,n,r,l,s,c),o=d.vehicle,r=d.route),c.length>0){var u=E(c),m=k(e,n)?[]:o.recalculateRouteStartingAt(r,Ae.optimizationOptions);a.all([u,m]).then(function(){k(e,n)||r.collapse||r.showVisitsWithError(),Ae.optimizationOptions.big_cluster||(c.map(function(e){e.collapse||e.showVisitsWithError()}),p.calculateAverageLoad(),p.calculateAverageTime()),k(e,n)&&c.map(function(e){e.actionUpdate(e)}),i.info("Recalculo de rutas exitoso"),t.isLoading=!1},function(){i.info("Fallo el recalculo"),t.isLoading=!1})}else-1!==e&&-1!==n?o.recalculateRouteStartingAt(r,Ae.optimizationOptions).then(function(){r.collapse||r.showVisitsWithError(),Ae.optimizationOptions.big_cluster||(p.calculateAverageLoad(),p.calculateAverageTime()),i.info("Recalculo de rutas exitoso"),t.isLoading=!1},function(){t.isLoading=!1}):t.isLoading=!1;Ae.updatePlannerIndicators(),t.$broadcast("Planner:Reset:InfoBoxContainer"),Q(null,!0)}function D(){s.$emit("Planner:Plan:calculate-indicator-tooltip"),s.$emit("Planner:Plan:calculate-indicator-average-kms")}function P(e){return X(e)}function L(){t.isLoading=!1,p.vehicles.map(function(e){e.routes.length>0&&(e.routes.map(function(i){i.setVisible(),i.visits.map(function(i){i.setDefaultColor(e.color),Ae.optimizationOptions.big_cluster||t.drawCluster||(i.setVisible(),
i.ifMarkerNotCreatedThenCreate())}),i.optimized&&xe&&i.calculatePath(Ae.optimizationOptions.big_cluster).then(function(){i.actionCreate(i)})}),Ae.optimizationOptions.big_cluster||e.setVisible(!0,Ae.optimizationOptions.open_ended),e.setIconFillColorWithVehicleColor(),Ae.vehicles.push(e))}),ee(Ae.vehicles),p.visits.map(function(e){Ae.optimizationOptions.big_cluster||(e.load2&&e.load2>0&&(p.enableShowLoad.load2=!0),e.load3&&e.load3>0&&(p.enableShowLoad.load3=!0)),null===e.routeId&&(e.ifMarkerNotCreatedThenCreate(),e.setDefaultColor("#A4A4A4"),e.updateOrder(null),Ae.visitsOutOfRoute.push(e))}),p.headerStatics.createdRoutes=p.routes.length,p.headerStatics.usedVehicles=Ae.vehicles.length,p.visits.length>0&&p.vehicles.length>0&&p.routes.length>0&&!Ae.optimizationOptions.big_cluster&&(p.calculateAverageLoad(),p.calculateAverageTime()),A(),O(),t.isLoading=!1}function O(){var e=p.getUserVisualState();Ae.vehicles.forEach(function(t){t.showRoutes=!1,e[parseInt(t.id)]&&(t.showRoutes=e[t.id])}),Ae.showVisitsOutOfRoutes=e.outOfRoutes}function T(e){var i=!e.collapse,a=p.vehicles.filter(Z(e.vehicleId))[0];e.collapse=i,e.setVisitsListed(!i),Ae.optimizationOptions.big_cluster||t.drawCluster?(e.collapse||p.collapseOtherRoutes(e),e.visible&&(i?(e.hideVisitsWithError(a.color),p.clearMapVisits(),e.setVisitsListed(!1)):(e.setVisitsListed(!0),t.$broadcast("Planner:Routes:showMarkersOfRoute",{route:e})))):(e.collapse?(we(),ye()):(p.collapseOtherRoutes(e,Ae.optimizationOptions.open_ended),a.setVisible(e.visible,Ae.optimizationOptions.open_ended)),e.visible&&i&&e.hideVisitsWithError(a.color))}function V(e){e.visits.map(function(t){if(t.setSelected(e.editingSelected,!0),Ae.isMultipleEditingModeActivated){var i=Y();W(i,Ae.isMultipleEditingModeActivated)}else Ae.sendToInfoBox(t)})}function R(){Ae.optimizationOptions.big_cluster&&(Ae.visitsOutOfRouteActions.collapsed?t.$broadcast("Planner:RemoveVisitsFromArray:Visit",{visits:Ae.visitsOutOfRoute}):t.$broadcast("Planner:CreateVisitsFromArray:Visit",{visits:Ae.visitsOutOfRoute}))}function M(){te(Ae.selectAllVisitsOutOfRoute)}function z(e){function t(e){return function(t){return t.id===e.id}}var i=ie(e.id);e.routes.forEach(function(e){i.comment=e.comment});var a=Ae.vehicles.find(t(e));angular.isUndefined(a)&&(e=p.vehicles.find(t(e)),e.activate(),e.showRoutes="false",e.setIconFillColorWithVehicleColor(),Ae.vehicles.push(e),Ae.optimizationOptions.big_cluster||e.setVisible(!0,Ae.optimizationOptions.open_ended),p.headerStatics.usedVehicles=Ae.vehicles.length),e.routes.length>0?i.estimatedTimeStart=e.routes[e.routes.length-1].estimatedTimeEnd:i.estimatedTimeStart=p.shift.start,e.addRoute(i),e.recalculateAllRoutes(Ae.optimizationOptions).then(function(){Ae.optimizationOptions.big_cluster||(p.calculateAverageLoad(),p.calculateAverageTime()),e.collapseRoutes=!1}),p.headerStatics.createdRoutes=p.routes.length,ee(Ae.vehicles)}function F(e){t.isLoading=!0;var a=angular.copy(e),n=Ae.enableJdhConfigAccount,s=p.getVisits(),o=p.getVehicleById(e.vehicleId),l={optimizationOptions:Ae.optimizationOptions,isJDH:n},c=Ae.optimizationOptions.big_cluster||t.drawCluster;y.reorderRoute(o,e,s,l).then(function(e){N(a,e,n),e.calculatePath(c);var s=p.vehicles.filter(Z(e.vehicleId))[0];s.recalculateRouteStartingAt(e,Ae.optimizationOptions).then(function(){t.isLoading=!1,Ae.updatePlannerIndicators()},function(e){i.info(e),t.isLoading=!1,r.push("error",Se("Planner_toast.error_order_route"))})},function(e){i.info(e),t.isLoading=!1,r.push("error",Se("Planner_toast.error_order_route"))})}function N(e,t,i){Ae.optimizationOptions.big_cluster||i||e.visits.map(function(e){if(angular.isUndefined(l.find(t.visits,function(t){return t.id===e.id})))for(var i=0;i<p.visits.length;i++)p.visits[i].id===e.id&&t.addVisit(p.visits[i])})}function $(e,t){Ae.isMultipleEditingModeActivated=t}function j(e){var t,i=[],a=!0,n=null;if(e.selected&&(i=v.getSimilar(p.visits,e,Ae.optimizationOptions.join),i.map(function(t){if(t.setSelected(e.selected,!0),t.routeId){n=p.routes.filter(K(t.routeId))[0];for(var i=0;i<n.visits.length;i++)if(!n.visits[i].selected){a=!1;break}n.editingSelected=a}})),e.routeId){n=p.routes.filter(K(e.routeId))[0];for(var s=0;s<n.visits.length;s++)if(!n.visits[s].selected){a=!1;break}n.editingSelected=a}if(e.setSelected(e.selected,!0),t=i.concat(e),Ae.isMultipleEditingModeActivated){var o=Y();W(o,Ae.isMultipleEditingModeActivated)}else B(t)}function B(e){e.forEach(function(e){Ae.sendToInfoBox(e)})}function H(e,t,i,a){e&&e.stopPropagation(),i.visits.length>0?(s.deleteRoute=me,s.vehicle=t,s.route=i,s.routeIndex=a,o.open({template:"app/planner/routes/routes-delete-modal.html",scope:s})):me(t,i)}function U(){se(),p.restorePlan(),ve(),u.removeAlertNotification(),p.routes.map(function(e){e.collapse=!0}),p.setEditMode(!1),p.setUserVisualState(Ae.vehiclesToSeeRoutesInDetail),n.go("planner.routes")}function q(){ae()}function G(e,t){var i=!0,a=null;angular.isUndefined(t)&&(t=!1),e.routeId&&(a=p.routes.filter(K(e.routeId))[0],a.visits.forEach(function(e){e.selected||(i=!1)}),a.editingSelected=i),e.setSelected(e.selected,!0),t||Ae.sendToInfoBox(e);var n=Y();W(n,t)}function J(e){var i={id:e.id,title:e.title,address:e.address,load:e.load,load2:e.load2,load3:e.load3,windowStart:e.windowStart,windowEnd:e.windowEnd,windowStart2:e.windowStart2,windowEnd2:e.windowEnd2,priorityLevel:e.priorityLevel?Ee[e.priorityLevel]:{value:0},selected:e.selected,color:e.defaultColor,order:e.order};t.$broadcast("Planner:AddVisitInfoBoxContainer:Visit",{visit:i})}function Y(){for(var e={visits:0,routes:0},t=[],i=0;i<p.visits.length;i++)p.visits[i].selected&&(e.visits+=1,p.visits[i].routeId&&-1===t.indexOf(p.visits[i].routeId)&&(e.routes+=1,t.push(p.visits[i].routeId)));return e}function W(e,t){var i=null;e.visits>0&&(i={type:1,msg:e.visits+" "+Se("Routes.visits_and")+" "+e.routes+" "+Se("Routes.selected_routes")}),Q(i,t)}function Q(e,t){t&&s.$emit("Planner:Plan:ShowAlertMSC",{msg:e})}function Z(e){return function(t){return t.id===e}}function K(e){return function(t){return t.id===e}}function X(e){var t=0,i=[];return e.map(function(e){var a=v.getSimilar(i,e,Ae.optimizationOptions.join);0===a.length&&(t++,i.push(e))}),Ae.optimizationOptions.join||(t=e.length),t}function ee(t){Ae.moveToOptions=[],t.map(function(t){angular.forEach(t.routes,function(i,a){var n={name:[t.name," -- ",e("translate")("Routes.route_text")," ",a+1].join(""),vehicleId:t.id,routeId:i.id,color:t.color,background_color:"none"};Ae.moveToOptions.push(n)})})}function te(e){e=angular.isUndefined(e)?!0:e,Ae.visitsOutOfRoute.forEach(function(t){if(t.setSelected(e,!0),Ae.isMultipleEditingModeActivated){var i=Y();W(i,Ae.isMultipleEditingModeActivated)}else Ae.sendToInfoBox(t)})}function ie(e){var t=_.createInstance(e);return p.routes.push(t),t}function ae(){se(),u.removeAlertNotification(),p.routes.map(function(e){e.collapse=!0}),p.setEditMode(!1),p.setUserVisualState(Ae.vehiclesToSeeRoutesInDetail),ne(),n.go("planner.routes")}function ne(){p.setBackupRoutes({}),p.setBackupVisits({})}function se(){Ae.selectAllVisitsOutOfRoute=!1,p.visits.map(function(e){e.setSelected(!1,!0,!0)}),p.routes.map(function(e){e.editingSelected=!1}),Ae.optimizationOptions.big_cluster&&t.$broadcast("Planner:Clear:Map")}function oe(e){e.forEach(function(e){"enable_jdh"===e.key&&(Ae.enableJdhConfigAccount=e.value)})}function re(e){t.isLoading=!0;var a=e.dest.nodesScope.$parent.route,n=e.dest.nodesScope.$parent.$parent.vehicle;pe(e.dest.nodesScope.$modelValue),n.recalculateRouteStartingAt(a,Ae.optimizationOptions).then(function(){Ae.optimizationOptions.big_cluster||(p.calculateAverageLoad(),p.calculateAverageTime()),t.isLoading=!1},function(e){i.info(e),t.isLoading=!1})}function le(e,t){i.info(e);var a=t.$element.attr("data-type");return"visit"===a}function ce(e){Ae.node.isDraggin=!0,Ae.node.nodeFrom=e.source.nodesScope.$parent.$id}function de(e){var t=e.dest.nodesScope.$element[0],i=e.elements.dragging[0],a=t.offsetTop,n=i.offsetTop,s=t.clientHeight,o=n;(o>Ae.node.position+5||o<Ae.node.position-5)&&(n>a+s+30?t.scrollTop+=60:30>n-a&&(t.scrollTop-=60),Ae.node.position=o)}function ue(e){i.info(e),Ae.node.isDraggin=!1,Ae.node.position=0,c.cancel(ke),i.info("item stop dragged")}function pe(e){var t;angular.forEach(e,function(e,i){t=e,t.updateOrder(i+1)})}function me(e,a){t.isLoading=!0,p.setBackupRoute(a),a.visits.length>0&&(a.visits.map(function(e){-1===Ae.visitsOutOfRoute.indexOf(e)&&(e.setDefaultColor("#A4A4A4"),e.setVisible(!0,!1),e.updateOrder(null),t.$broadcast("Planner:Visit:UpdateMarkerColor",{visit:{id:e.id,defaultColor:e.defaultColor}}),Ae.visitsOutOfRoute.push(e))}),t.$broadcast("Planner:Update:InfoBoxColors",{color:"#A4A4A4",visits:angular.copy(a.visits)})),p.removeRoute(a),e.recalculateAllRoutes(Ae.optimizationOptions).then(function(){p.calculateAverageLoad(),p.calculateAverageTime(),p.headerStatics.createdRoutes=p.routes.length,0===e.routes.length&&(Ae.vehicles.splice(Ae.vehicles.indexOf(e),1),p.headerStatics.usedVehicles=p.headerStatics.usedVehicles-1,e.setVisible(!1)),ee(Ae.vehicles),t.isLoading=!1,Ae.updatePlannerIndicators()},function(e){r.push("error",Se("Planner_toast.error_delete_route")),i.info(e),t.isLoading=!1})}function ve(){Ae.visitsOutOfRoute=[],p.visits.map(function(e){null===e.routeId&&(e.setDefaultColor("#A4A4A4"),e.setVisible(!0,!1),e.setLabelContent(null),Ae.visitsOutOfRoute.push(e))})}function ge(e){return function(t){return f.naturalValue(t[e])}}function he(e){var t,i=!0,a=e.selected,n=[];Ae.visitsOutOfRoute.forEach(function(e){e.selected||(i=!1)}),Ae.selectAllVisitsOutOfRoute=i,a&&(n=v.getSimilar(p.visits,e,Ae.optimizationOptions.join),n.forEach(function(e){e.setSelected(a,!0)})),t=n.concat(e),e.setSelected(a,!0),B(t)}function _e(e){return X(e.visits)}function fe(e){Ae.optimizationOptions.big_cluster?e.showAllRoutes(e.showRoutes,!1,Ae.optimizationOptions):e.showAllRoutes(e.showRoutes,!0,Ae.optimizationOptions);var t=e.routes[0].collapse;t&&!e.showRoutes?e.setVisible(!1):e.showRoutes&&e.setVisible(!0),be(e.showRoutes,e.id)}function be(e,t){Ae.vehiclesToSeeRoutesInDetail[t]=e}function ye(e){e&&e.stopPropagation(),Ae.visitsOutOfRoute.map(function(e){e.ifMarkerNotCreatedThenCreate(),e.setDefaultColor("#A4A4A4"),e.updateOrder(null),e.setVisible(Ae.showVisitsOutOfRoutes)}),Ae.vehiclesToSeeRoutesInDetail.outOfRoutes=Ae.showVisitsOutOfRoutes}function we(){Ae.vehicles.forEach(function(e){Ae.vehiclesToSeeRoutesInDetail[parseInt(e.id)]&&(e.options.visible=e.showRoutes),e.setVisible(e.options.visible,Ae.optimizationOptions.open_ended)})}var Ae=this,xe=!1,ke=-1,Ie="DD MMMM, YYYY",Se=e("translate"),Ee=[];Ae.routes=null,Ae.planDate=null,Ae.isEditingPlan=!1,Ae.visibleAllRoutes=!0,Ae.selectAllVisitsOutOfRoute=!1,Ae.isMultipleEditingModeActivated=!1,Ae.drivers=[],Ae.vehicles=[],Ae.allVehicles=[],Ae.vehiclesAvailable=[],Ae.moveToOptions=[],Ae.moveToOptions=[],Ae.visitsOutOfRoute=[],Ae.optionOutOfRoute={name:Se("Routes.out_of_route"),vehicleId:-1,routeId:-1,color:"#A4A4A4",background_color:"none"},Ae.visitsOutOfRouteActions={collapsed:!0},Ae.optimizationOptions={balance:!1,all_vehicles:!0,big_cluster:!1,join:!1,open_ended:!1},Ae.node={collapsed:!0,expandOnHover:!0,isDraggin:!1,nodeFrom:0,position:0},p.enableShowLoad.load2=!1,p.enableShowLoad.load3=!1,p.disableStep.vehicleDisabled=!1,Ae.fillCircleOption=x,Ae.moveVisitTo=C,Ae.calculateVisitsOutOfRoute=P,Ae.toggleCollapseRoute=T,Ae.toggleEditingVisitsOfRoute=V,Ae.toogleVisitOutOfRoutesCollapse=R,Ae.toggleSelectAllVisitsOutOfRoute=M,Ae.addRouteToVehicle=z,Ae.confirmEditingChanges=q,Ae.reorderRoute=F,Ae.toggleSelectedEditVisit=j,Ae.goToDeleteRoute=H,Ae.cancelEditing=U,Ae.naturalSort=ge,Ae.toggleVisitOutOfRoute=he,Ae.calculateRouteVisits=_e,Ae.getPlanUnoptimized=L,Ae.updatePlannerIndicators=D,Ae.toggleShowRoutes=fe,Ae.toggleVisitsOutOfRoutes=ye,Ae.sendToInfoBox=J,Ae.dragControlListeners={accept:le,dropped:re,dragStart:ce,dragStop:ue,dragMove:de},Ae.vehiclesToSeeRoutesInDetail=p.getUserVisualState(),xe=h.getActiveTour(),t.$on("visitClickedOnMap",function(e,t){t.visit.routeId||(u.removeAlertNotification(),d(t.visit.id),angular.isUndefined(t.visit.indicatorError)||u.addAlertNotification(t.visit.indicatorError))}),s.$on("Planner:Route:toggleCollapseRoute",function(e,t){var i=t.route;T(i),s.$$phase||s.$apply()}),s.$on("Planner:Visit:toggleSelectedEditVisit",function(e,t){var i=t.visit,a=t.multipleSelectionMode;G(i,a),s.$$phase||s.$apply()}),s.$on("Planner:Visit:deselectEditVisit",function(e,t){var i=t.visitId,a=p.visits.find(function(e){return e.id===i});a.selected=!1,G(a)}),s.$on("$destroy",function(){s.$emit("Planner:Reset:InfoBoxContainer"),Ce()});var Ce=s.$on("Planner:Plan:returnIsMultipleEditingModeActivated",$);w()}e.$inject=["$filter","$rootScope","$log","$q","$state","$scope","ngDialog","Toasts","lodash","$timeout","$anchorScroll","alertNotificationService","plannerService","timeUtils","visitSimilarService","sessionService","TourManager","PlannerRouteModel","naturalService","$stateParams","optimizeService"],angular.module("icarus.planner").controller("PlannerRoutesDetailController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v){function g(){function e(e){j.vehicles=a.vehicles,j.plannedDate=n(e.planDate.start).format("LL"),j.plannedDateLabel=n(e.planDate.start).format("LL"),j.drivers=a.getDrivers(),j.planMergedName=a.getPlanName(),j.planMergedName&&(j.planName=j.planMergedName),j.updateSelectedDrivers()}return j.savedPlan=null,j.notSavedPlan=null,j.failedVehicle=null,j.planName=n().format("D-MM-YYYY HH:mm:ss"),j.editing=null===a.getPlanName()?!1:!0,a.getPlan().then(e)}function h(e){var t=0;return e.routes.map(function(e){t+=e.visits.length}),t}function _(e){var t=0;return e.routes.map(function(e){t+=e.totalDistance}),t.toFixed(1)}function f(e){var t=0;e.routes.map(function(e){var i,a,n,s,o,r=e.totalTime.split(" ");r.length>1?(a=r[0],t+=24*parseInt(a)*60,i=r[1].split(":"),n=i[0],s=i[1],o=parseInt(60*n)+parseInt(s),t+=o):(i=r[0].split(":"),n=i[0],s=i[1],o=parseInt(60*n)+parseInt(s),t+=o)});var i=t%60,a=t/60,n=String(a).split(".");return("0"+Math.floor(a)).slice(-1*n[0].length)+":"+("0"+i).slice(-2)}function b(){function t(){e.info("Plan almacenado con exito"),j.savedPlan=!0,j.saving=!1;var t=a.getPlanInfo(j.planName);m.createLogForPlan(t,B("Log.actions.editing_plan"))}function i(t){j.saving=!1,j.notSavedPlan=!0,y(t),e.error(t)}j.saving=!0,C(),a.getPlanId()?a.editPlan(j.planName).then(t,i):a.createPlan(j.planName).then(t,i)}function y(e){switch(!0){case k(e,"vehicle"):w(e);break;case 400===e.status:A(e);break;default:s.closeAll(),o.push("error",B("Planner_toast.error_save_plan_finish"))}}function w(e){a.getVehicle(e.vehicle).then(function(e){j.failedVehicle=e,j.data.title=B("Routes.assignments.errorMessage"),j.data.msg=B("Routes.pleaseCorrects"),j.data.vehicleName=e.name,j.data.vehicleTitle=B("Routes.the_vehicle")})}function A(e){e.data.non_field_errors?(x(e.data.non_field_errors),j.dataError.msg=B("Routes.assignments.default_error.message")):e.data.planned_date?(j.dataError.title=B("Routes.assignments.isErrorInPlanInstance"),j.dataError.msg=B("Routes.pleaseCorrects")):(j.dataError.title=B("Routes.assignments.default_error.title"),j.dataError.msg=B("Routes.assignments.default_error.message"))}function x(e){e.forEach(function(e){e.includes("account")&&e.includes("name")?j.dataError.title=B("Routes.assignments.plan_name_error.title"):j.dataError.title=B("Routes.assignments.default_error.title")})}function k(e,t){return e?hasOwnProperty.call(e,t):!1}function I(){s.closeAll()}function S(e){return function(t){return l.naturalValue(t[e])}}function E(){for(var e=[],t=null,i=0;i<j.vehicles.length;i++)angular.isUndefined(j.vehicles[i].driver)||null===j.vehicles[i].driver||""===j.vehicles[i].driver||(t=j.vehicles[i].driver instanceof Object?j.vehicles[i].driver:JSON.parse(j.vehicles[i].driver),t.selected=!0,t.group=B("Driver.group_assigned"),e.push(t));j.drivers.map(function(t){var i=e.filter(function(e){return e.id===t.id});t.group=B(i.length?"Driver.group_assigned":"Driver.group_available"),t.selected=!!i.length})}function C(){a.vehicles.map(function(e){e.routes.map(function(e){0===e.visits.length&&a.removeRoute(e)})})}function D(){c.$broadcast("Planner:Clear:Map"),a.clearPlan(),a.setUserVisualState({})}function P(e){D(),t.go(e,{}),c.$broadcast("Planner:Plan:steps-reset"),c.$broadcast("Planner:Plan-editing",{value:!1})}function L(){j.popupOpened?j.popupOpened=!1:j.popupOpened=!0}function O(){a.changeDateModal(n(j.plannedDate).format("YYYY-MM-DD")),j.plannedDateLabel=n(j.plannedDate).format("LL")}function T(e){if(e.length>0){var t=e[0].comment;e.forEach(function(e){e.comment=t})}}function V(){a.exportPlanTxt()}function R(){a.exportPlanExcel()}function M(){a.exportPlanPdf()}function z(){var e=a.getPlanDate();v.exportSummarizedPlanPdf(j.vehicles,e.start)}function F(){j.onTour=!0,j.routeDistance=84,j.routeTime="4:05",j.planName="Plan 1",j.plannedDate=n().format("LL"),j.plannedDateLabel=n().format("LL"),j.savedPlan=null,j.notSavedPlan=null,j.failedVehicle=null,j.editing=!1,j.vehicles=p.getFakeVehicles(),j.drivers=a.getDrivers(),j.vehicles[0].driver=j.drivers[0],j.updateSelectedDrivers(),setTimeout(function(){H.getCurrentStep().next()},1e3)}function N(){j.onTour=!1,j.closeModal(),t.go("planner.vehicles-list",{},{location:"replace",reload:!0})}function $(e,t){var i=t.steps.current;i.is("assignPanel","planner-routes")?(i.overrideAction("next",function(){j.savedPlan=!0,this.next()}),i.overrideAction("back",function(){j.closeModal(),this.back()})):i.is("endTour","planner-routes")&&(i.overrideAction("next",function(){j.closeModal(),u.endTours()}),i.overrideAction("back",function(){j.savedPlan=!1,this.back()}))}var j=this,B=r("translate"),H=u.getActiveTour();j.plannedDate="null",j.planName="",j.vehicles=[],j.drivers=[],j.saving=!1,j.savedPlan=null,j.notSavedPlan=null,j.failedVehicle=null,j.isErrorInPlanInstance=!1,j.isErrorDataFormat=!1,j.isDefaultError=!1,j.onTour=!1,j.planMergedName=null,j.appLink=d.APP_MOBILE_GOOGLEPLAY_LINK,j.dateOptions={formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM",formatDay:"d",showWeeks:!1,startingDay:0,minDate:n().toDate()},j.activateModalOnTour={"planner-routes":["goToAssign","assignPanel","endTour"]},j.dataError={},j.savePlan=b,j.getVehicleTotalVisits=h,j.getVehicleTotalDistance=_,j.getVehicleTotalTime=f,j.closeModal=I,j.naturalSort=S,j.updateSelectedDrivers=E,j.clearPlan=D,j.clearAndGoTo=P,j.changeDate=L,j.setDate=O,j.checkRoutesComment=T,j.downloadReportTxt=V,j.downloadReportExcel=R,j.downloadReportPdf=M,j.downloadReportSummarizedPdf=z,i.$on("TOUR:STEP_CHANGED",$),i.$on("TOUR:END_ALL_TOURS",N),H?F():g()}e.$inject=["$log","$state","$scope","plannerService","moment","ngDialog","Toasts","$filter","naturalService","$rootScope","__env","TourManager","TourFake","LogService","plannerReportsService"],angular.module("icarus.planner").controller("FinishPlanController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l){function c(){function a(e){h.plans=e,n.isLoading=!1}function s(i){n.isLoading=!1,e.info(i),404===i.status&&r.push("error",_("Planner_toast.error_get_plans_1")),500===i.status&&r.push("error",_("Planner_toast.error_get_plans_2")),t.go("^")}n.isLoading=!0,i.getPlans().then(a,s)}function d(e){t.go("planner.vehicles-list.plans-detail",{planId:e})}function u(e,t,i){var a=this;a.isEditingCurrentPlan=e,a.plan=t,a.deletePlan=i}function p(e,t){f=!1,e.stopPropagation();for(var a=null,n=0;n<h.plans.length;n++)if(h.plans[n].id===t){a=h.plans[n];break}if(a){var o=i.getPlanName(),r=i.getPlanId();r===t&&o&&(f=!0),s.openConfirm({template:"app/planner/plans/plans-delete-modal.html",controller:u,controllerAs:"vm",resolve:{isEditingCurrentPlan:function(){return f},plan:function(){return a},deletePlan:function(){return m}}})}}function m(t){n.isLoading=!0,i.deletePlan(t.id).then(function(){e.info("Plan eliminado exitosamente");for(var s={},o=0;o<h.plans.length;o++)if(h.plans[o].id===t.id){s=h.plans[o],h.plans.splice(h.plans.indexOf(s),1);break}f&&(n.$broadcast("Planner:Clear:Map"),i.clearPlanner(),i.planDate.start=a().toDate(),i.planDate.end=null),n.isLoading=!1,n.$broadcast("checkRoutes"),g(t)},function(t){e.info(t),t&&r.push("error",_("Planner_toast.error_delete_plan")),n.isLoading=!1})}function v(e,i){e.stopPropagation(),t.go("planner.vehicles-list.plans-detail",{planId:i,isCopy:!0})}function g(e){l.createLogForPlan(e,_("Log.actions.delete_plan"))}u.$inject=["isEditingCurrentPlan","plan","deletePlan"];var h=this,_=o("translate"),f=!1;h.plans=[],h.duplicatePlan=v,h.goToDetail=d,h.showDeleteModal=p,h.deletePlan=m,c()}e.$inject=["$log","$state","plannerService","moment","$rootScope","ngDialog","$filter","Toasts","LogService"],angular.module("icarus.planner").controller("PlannerPlansController",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f){function b(){se(),pe.dateOptions={formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM",formatDay:"d",showWeeks:!1,maxMode:"day",startingDay:0,minDate:new Date},pe.popupPlanDateStart={opened:!1},pe.popupPlanDateEnd={opened:!1},r.isLoading=!0,s.getPlan(),y(a.planId).then(function(){s.getPlan().then(function(){angular.copy(s.vehicles,pe.vehicles),angular.copy(s.getDrivers(),pe.drivers),angular.copy(s.getSkills(),pe.skills),k()}),r.isLoading=!1},function(t){e.info(t),r.isLoading=!1,404===t.status&&v.push("error",ve("Planner_toast.error_get_plans_3")),i.go("^")}),Z()}function y(e){var t=w(e).then(A).then(x).then(function(){return{plan:pe.plan,routes:pe.plan.routes}});return t}function w(t){function i(e){return pe.plan=e.data,pe.plan.name=pe.isCopy?"":pe.plan.name,pe.resetDay=pe.plan.reset_day,pe.planDate.start=o(e.data.start_date).toDate(),pe.planDate.end=o(e.data.end_date).toDate(),K(),e.data}function a(t){return e.error(t),c.reject(t)}return s.loadPlanDetail(t).then(i,a)}function A(t){function i(e){return e.data.map(function(e){pe.plan.routes.push(e)}),pe.plan.routes}function a(t){return e.error(t),c.reject(t)}return pe.plan.routes=[],s.loadRoutesDetail(t).then(i,a)}function x(t){return c.all(t.map(function(t){function i(e){t.visits=e.data,e.data.map(function(e){me.push(e)})}function a(t){return e.error(t),c.reject(t)}return s.loadVisitDetail(t).then(i,a)}))}function k(){pe.plan.vehicles=[],pe.plan.routes.map(function(e){var t=I(e.vehicle.toString());t.routes.length=0}),pe.plan.routes.map(function(e){var t=I(e.vehicle.toString());t.driverId=e.driver?e.driver.toString():null,t.routes.push(e),-1===pe.plan.vehicles.inArray(t.id,"id")&&pe.plan.vehicles.push(t)})}function I(e){for(var t=0;t<pe.vehicles.length;t++)if(pe.vehicles[t].id===e)return pe.vehicles[t];return null}function S(e){for(var t=0;t<pe.drivers.length;t++)if(pe.drivers[t].id===e)return pe.drivers[t];return null}function E(e){for(var t=0;t<pe.skills.length;t++)if(pe.skills[t].id.toString()===e)return pe.skills[t];return null}function C(){pe.popupPlanDateStart.opened=!0}function D(){pe.popupPlanDateEnd.opened=!0}function P(e){var t=0;return e.routes.map(function(e){t+=e.visits.length}),t}function L(e){var t=0;return e.routes.map(function(e){t+=parseFloat(e.total_distance/1e3)}),t.toFixed(1)}function O(e){var t=0;e.routes.map(function(e){var i,a,n,s,o,r=e.total_duration.split(" ");r.length>1?(a=r[0],t+=24*parseInt(a)*60,i=r[1].split(":"),n=i[0],s=i[1],o=parseInt(60*n)+parseInt(s),t+=o):(i=r[0].split(":"),n=i[0],s=i[1],o=parseInt(60*n)+parseInt(s),t+=o)});var i=t%60,a=t/60,n=String(a).split(".");return("0"+Math.floor(a)).slice(-1*n[0].length)+":"+("0"+i).slice(-2)}function T(){function t(){pe.updatingPlan=!1,pe.planUpdated=!0,u(function(){pe.planUpdated=null},2500)}function i(t){e.error(t),pe.updatingPlan=!1,pe.planUpdated=!1,u(function(){pe.planUpdated=null},2500),404===t.status&&v.push("error",ve("Planner_toast.error_put_plan_found")),500===t.status&&v.push("error",ve("Planner_toast.error_put_plan_found"))}pe.updatingPlan=!0,c.all([V(),R()]).then(t,i)}function V(){function i(){pe.plan.start_date=o(pe.planDate.start).format(ce),pe.plan.end_date=o(pe.planDate.end).format(ce),n.resolve()}function a(t){e.error(t),n.reject(t)}var n=c.defer(),s={name:pe.plan.name,start_date:o(pe.planDate.start).format(ce),end_date:o(pe.planDate.end).format(ce),reset_day:pe.resetDay.id};return t.put(le+pe.plan.id+"/",s).then(i,a),n.promise}function R(){var e=pe.plan.vehicles.map(function(e){e.routes.map(function(i){var a={};return o(o(pe.planDate.start).format(ce)).isSameOrAfter(o(o().format(ce)))&&(a.planned_date=o(pe.planDate.start).format(ce)),e.driverId!==i.driver&&(a.driver=e.driverId),t.patch(oe+i.id+"/",a)})});return c.all(e)}function M(){var e=angular.copy(pe.plan),t=j(e);s.mergePreviousPlan(t,pe.isCopy).then(function(){s.createPlan(t.name).then(function(){r.$broadcast("Planner:Clear:Map"),s.clearPlanner(),i.go("planner.vehicles-list.plans")},function(e){z(e)})},function(){})}function z(t){pe.saving=!1,pe.notSavedPlan=!0,F(t,"vehicle")&&s.getVehicle(t.vehicle).then(function(e){pe.failedVehicle=e}),500===t.status&&v.push("error",ve("Planner_toast.error_save_plan_finish")),400===t.status&&(t.data.non_field_errors?N(t.data.non_field_errors):v.push("error",ve("Planner_toast.error_save_plan_finish"))),e.error(t)}function F(e,t){return e?hasOwnProperty.call(e,t):!1}function N(e){var t=!1;e.forEach(function(e){e.includes("account")&&e.includes("name")&&(t=de),e.includes("planned_date")&&(t=ue)}),$(t)}function $(e){switch(!0){case"plan_name"===e:v.push("error",ve("Planner_toast.error_save_plan_finish_plan_name"));break;case"planned_date"===e:v.push("error",ve("Planner_toast.error_save_plan_finish_planned_date"));break;default:v.push("error",ve("Planner_toast.error_save_plan_finish"))}}function j(e){e.modified=g.toIsoString(),e.start_date=g.toIsoStringByDate(pe.planDate.start),e.end_date=pe.isCopy?pe.planDate.start:pe.planDate.end,e.end_date=g.toIsoStringByDate(e.end_date),e.id="";for(var t=0;t<e.routes.length;t++){var i=e.routes[t];i.plan=null,i.id=null;for(var a=0;a<i.visits.length;a++){var n=i.visits[a];n.checkin_time=null,n.checkin_latitude=null,n.checkin_longitude=null,n.checkout_comment="",n.checkout_latitude=null,n.checkout_longitude=null,n.checkout_observation=null,n.checkout_time=null,n.pictures.length=0,n.signature=null,n.id=null}}return e}function B(){r.isLoading=!0,ne().then(function(){s.mergePreviousPlan(pe.plan).then(function(){i.go("planner.routes"),r.isLoading=!1},function(t){e.error(t),e.error("Error cargando el plan"),r.isLoading=!1,400===t.status&&v.push("error",ve("Planner_toast.error_call_osrm"))})})}function H(){var e={Sheets:{},SheetNames:[]},t=[d("translate")("Excel_Header.driver"),d("translate")("Excel_Header.vehicle"),d("translate")("Excel_Header.route_Index"),d("translate")("Excel_Header.stop"),d("translate")("Excel_Header.arrival_Time"),d("translate")("Excel_Header.title"),d("translate")("Excel_Header.address"),d("translate")("Excel_Header.load"),d("translate")("Excel_Header.window_Start"),d("translate")("Excel_Header.window_End"),d("translate")("Excel_Header.service_Time"),d("translate")("Excel_Header.notes"),d("translate")("Excel_Header.latitude"),d("translate")("Excel_Header.longitude"),d("translate")("Excel_Header.reference"),d("translate")("Excel_Header.requires_Skills"),d("translate")("Excel_Header.optional_Skills"),d("translate")("Excel_Header.contact_Name"),d("translate")("Excel_Header.contact_Phone"),"Id","RID","VID","DID",d("translate")("Excel_Header.window_Start2"),d("translate")("Excel_Header.window_End2"),d("translate")("Excel_Header.visit_load2"),d("translate")("Excel_Header.visit_load3"),d("translate")("Excel_Header.contact_email")],i=[];pe.plan.vehicles.forEach(function(e){e.routes.forEach(function(e,t){t+=1;var a=e.driver?S(e.driver.toString()):"",n=I(e.vehicle.toString());e.visits.sort(function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}),e.visits.forEach(function(e,s){for(var o="",r=0;r<e.skills_required.length;r++)o+=r===e.skills_required.length-1?E(e.skills_required[r].toString()).name:E(e.skills_required[r].toString()).name+", ";for(var l="",r=0;r<e.skills_optional.length;r++)l+=r===e.skills_optional.length-1?E(e.skills_optional[r].toString()).name:E(e.skills_optional[r].toString()).name+", ";i.push([a?a.name:"",n.name,d("translate")("Routes.route_text")+" "+t,e.order,e.estimated_time_arrival,e.title,e.address,e.load,e.window_start,e.window_end,e.duration,e.notes,parseFloat(e.latitude),parseFloat(e.longitude),e.reference,o,l,e.contact_name,e.contact_phone,e.id,e.route,e.vehicle,e.driver,e.window_start2,e.window_end2,e.load_2,e.load_3,e.contact_email])})})}),e.Sheets.Plan=U([t].concat(i)),e.SheetNames.push("Plan"),pe.drivers.forEach(function(a){var n=i.filter(function(e){return e[0]===a.name});if(n.length>0){var s=e.SheetNames.length+". "+a.name;e.Sheets[s]=U([t].concat(n)),e.SheetNames.push(s)}}),q(e,"SimpliRoute_Plan_"+o(pe.planDate.start).format("YYYY-MM-DDTHH:mm"))}function U(e){function t(e,t){t&&(e+=1462);var i=Date.parse(e);return(i-new Date(Date.UTC(1899,11,30)))/864e5}for(var i={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!==e.length;++n)for(var s=0;s!==e[n].length;++s){a.s.r>n&&(a.s.r=n),a.s.c>s&&(a.s.c=s),a.e.r<n&&(a.e.r=n),a.e.c<s&&(a.e.c=s);var o={v:e[n][s]};if(null!==o.v){var r=XLSX.utils.encode_cell({c:s,r:n});angular.isNumber(o.v)?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=t(o.v)):o.t="s",i[r]=o}}return a.s.c<1e7&&(i["!ref"]=XLSX.utils.encode_range(a)),i}function q(e,t){function i(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0;a!==e.length;++a)i[a]=255&e.charCodeAt(a);return t}var a={bookType:"xlsx",bookSST:!1,type:"binary"},n=XLSX.write(e,a);saveAs(new Blob([i(n)],{type:""}),t+".xlsx")}function G(e){r.isLoading=!0;var t=new FileReader,i=!0;void 0===FileReader&&void 0===FileReader.prototype&&FileReader.prototype.readAsBinaryString instanceof Function||(i=!1),t.onload=function(e){pe.totalExcelVisits=0,pe.driversAfterEdit=[];var t=e.target.result,a=null,n=null;a=i?XLSX.read(t,{type:"binary"}):XLSX.read(btoa(J(t)),{type:"base64"}),n=a.Sheets[a.SheetNames[0]];var s=XLSX.utils.sheet_to_json(n,{header:"A"});pe.totalExcelVisits=s.length-1,Y(s,1)},i?t.readAsBinaryString(e[0]):t.readAsArrayBuffer(e[0])}function J(e){for(var t="",i=0,a=10240;i<e.byteLength/a;++i)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a,i*a+a)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a)))}function Y(i,a){for(var s=null,l=a;l<i.length;l++){pe.importingVisitsPercentage=l/i.length*100;var c=i[l],d=parseInt(c.T),u=c.F,m=c.G,g=c.M,h=c.N,_=c.U,f=parseInt(c.V),b=isNaN(c.W)?null:parseInt(c.W);-1===pe.driversAfterEdit.indexOf(b)&&pe.driversAfterEdit.push(b);var y=new RegExp(p.latlngPattern);if("undefined"!=typeof d&&"undefined"!=typeof g&&"undefined"!=typeof h&&"undefined"!=typeof _&&"undefined"!=typeof f&&"undefined"!=typeof b&&y.test(g+", "+h)){var w=(c.A||"",c.B||"",c.C||"",isNaN(c.D)?null:parseInt(c.D)),A=o(c.E,"HH:mm:ss").isValid()?o(c.E,"HH:mm:ss").format("HH:mm:ss"):null,x=isNaN(c.H)?0:parseFloat(parseFloat(c.H).toFixed(2)),k=o(c.I,"HH:mm:ss").isValid()?o(c.I,"HH:mm:ss").format("HH:mm:ss"):null,I=o(c.J,"HH:mm:ss").isValid()?o(c.J,"HH:mm:ss").format("HH:mm:ss"):null,S=o(c.K,"HH:mm:ss").isValid()?o(c.K,"HH:mm:ss").format("HH:mm:ss"):null,E=c.L||"",C=c.O||"",D=c.P?c.P.split(","):[],P=c.Q?c.Q.split(","):[],L=c.R||"",O=c.S||"",T=c.AB?ie(c.AB):"",V=o(c.X,"HH:mm:ss").isValid()?o(c.X,"HH:mm:ss").format("HH:mm:ss"):null,R=o(c.Y,"HH:mm:ss").isValid()?o(c.Y,"HH:mm:ss").format("HH:mm:ss"):null,M=isNaN(c.Z)?0:parseFloat(parseFloat(c.Z).toFixed(2)),z=isNaN(c.AA)?0:parseFloat(parseFloat(c.AA).toFixed(2)),F=[];D.map(function(e){for(var t=0;t<pe.skills.length;t++)pe.skills[t].name===e.trim()&&F.push(pe.skills[t].id)});var N=[];P.map(function(e){for(var t=0;t<pe.skills.length;t++)pe.skills[t].name===e.trim()&&N.push(pe.skills[t].id)});for(var $={id:d,title:u,address:m,load:x,duration:S,notes:E,reference:C,estimated_time_arrival:A,window_start:k,window_end:I,window_start2:V,window_end2:R,skills_required:F,
skills_optional:N,contact_name:L,contact_phone:O,contact_email:T,route:_,vehicle:f,driver:b,order:w,load_2:M,load_3:z},j={},B=0;B<me.length;B++)if(me[B].id===$.id){j=me[B];break}if(j){var H={},U=0;for(var q in j)if(j.hasOwnProperty(q)&&$.hasOwnProperty(q)){if(j[q]instanceof Array){j[q].equals($[q])||(H[q]=$[q],U++);continue}j[q]!==$[q]&&(H[q]=$[q],U++)}if(U>0){H.id=$.id,ge.push(H);continue}}else s={index:l},pe.visitsNotUpdated.push(s)}else s={index:l},pe.visitsNotUpdated.push(s)}ge.length>0?t.patch(re,ge).then(function(){r.isLoading=!1,pe.visitsUpdated=ge.length,pe.planUploaded=!0,ge.length=0},function(t){e.info(t),ge.length=0,r.isLoading=!1,pe.planUploaded=!1,v.push("error",ve("Planner_toast.error_visit_update_plan"))}):0===ge.length&&(r.isLoading=!1,pe.visitsUpdated=ge.length,pe.planUploaded=!0),n.$apply()}function W(){i.go("planner.vehicles-list.plans")}function Q(e){return function(t){return m.naturalValue(t[e])}}function Z(){pe.weekend_days=[{id:0,name:d("translate")("Planner.sunday")},{id:1,name:d("translate")("Planner.monday")},{id:2,name:d("translate")("Planner.thursday")},{id:3,name:d("translate")("Planner.wednesday")},{id:4,name:d("translate")("Planner.tuesday")},{id:5,name:d("translate")("Planner.friday")},{id:6,name:d("translate")("Planner.saturday")}]}function K(){switch(parseInt(pe.resetDay)){case 0:pe.resetDay={id:0,name:d("translate")("Planner.sunday")};break;case 1:pe.resetDay={id:1,name:d("translate")("Planner.monday")};break;case 2:pe.resetDay={id:2,name:d("translate")("Planner.thursday")};break;case 3:pe.resetDay={id:3,name:d("translate")("Planner.wednesday")};break;case 4:pe.resetDay={id:4,name:d("translate")("Planner.tuesday")};break;case 5:pe.resetDay={id:5,name:d("translate")("Planner.friday")};break;case 6:pe.resetDay={id:6,name:d("translate")("Planner.saturday")};break;default:pe.resetDay={id:1,name:d("translate")("Planner.monday")}}}function X(){pe.isCopy&&s.clearPlanner()}function ee(e,t){var i=e.join(",").length;return i+t.length+1<=_}function te(e){return e.length<f}function ie(e){var t=[],i="";return e&&(e.split(",").forEach(function(e){if(te(t)){var i=e.trim().replace(" ","").latinize();ae(i)&&ee(t,i)&&t.push(i)}}),i=t.join(",")),i}function ae(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function ne(){var e=c.defer();return h.getZonesIfProceed().then(function(t){t.length>0&&pe.plan.routes.map(function(e){e.visits.map(function(e){e.zones=h.getZonesIntoVisit(t,e.latitude,e.longitude)})}),e.resolve()}),e.promise}function se(){var e={};e.latin_map={"√Å":"A","ƒÇ":"A","·∫Æ":"A","·∫∂":"A","·∫∞":"A","·∫≤":"A","·∫¥":"A","«ç":"A","√Ç":"A","·∫§":"A","·∫¨":"A","·∫¶":"A","·∫®":"A","·∫™":"A","√Ñ":"A","«û":"A","»¶":"A","«†":"A","·∫†":"A","»Ä":"A","√Ä":"A","·∫¢":"A","»Ç":"A","ƒÄ":"A","ƒÑ":"A","√Ö":"A","«∫":"A","·∏Ä":"A","»∫":"A","√É":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","·∏Ç":"B","·∏Ñ":"B","∆Å":"B","·∏Ü":"B","…É":"B","∆Ç":"B","ƒÜ":"C","ƒå":"C","√á":"C","·∏à":"C","ƒà":"C","ƒä":"C","∆á":"C","»ª":"C","ƒé":"D","·∏ê":"D","·∏í":"D","·∏ä":"D","·∏å":"D","∆ä":"D","·∏é":"D","«≤":"D","«Ö":"D","ƒê":"D","∆ã":"D","«±":"DZ","«Ñ":"DZ","√â":"E","ƒî":"E","ƒö":"E","»®":"E","·∏ú":"E","√ä":"E","·∫æ":"E","·ªÜ":"E","·ªÄ":"E","·ªÇ":"E","·ªÑ":"E","·∏ò":"E","√ã":"E","ƒñ":"E","·∫∏":"E","»Ñ":"E","√à":"E","·∫∫":"E","»Ü":"E","ƒí":"E","·∏ñ":"E","·∏î":"E","ƒò":"E","…Ü":"E","·∫º":"E","·∏ö":"E","Íù™":"ET","·∏û":"F","∆ë":"F","«¥":"G","ƒû":"G","«¶":"G","ƒ¢":"G","ƒú":"G","ƒ†":"G","∆ì":"G","·∏†":"G","«§":"G","·∏™":"H","»û":"H","·∏®":"H","ƒ§":"H","‚±ß":"H","·∏¶":"H","·∏¢":"H","·∏§":"H","ƒ¶":"H","√ç":"I","ƒ¨":"I","«è":"I","√é":"I","√è":"I","·∏Æ":"I","ƒ∞":"I","·ªä":"I","»à":"I","√å":"I","·ªà":"I","»ä":"I","ƒ™":"I","ƒÆ":"I","∆ó":"I","ƒ®":"I","·∏¨":"I","Íùπ":"D","Íùª":"F","ÍùΩ":"G","ÍûÇ":"R","ÍûÑ":"S","ÍûÜ":"T","Íù¨":"IS","ƒ¥":"J","…à":"J","·∏∞":"K","«®":"K","ƒ∂":"K","‚±©":"K","ÍùÇ":"K","·∏≤":"K","∆ò":"K","·∏¥":"K","ÍùÄ":"K","ÍùÑ":"K","ƒπ":"L","»Ω":"L","ƒΩ":"L","ƒª":"L","·∏º":"L","·∏∂":"L","·∏∏":"L","‚±†":"L","Íùà":"L","·∏∫":"L","ƒø":"L","‚±¢":"L","«à":"L","≈Å":"L","«á":"LJ","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","≈É":"N","≈á":"N","≈Ö":"N","·πä":"N","·πÑ":"N","·πÜ":"N","«∏":"N","∆ù":"N","·πà":"N","»†":"N","«ã":"N","√ë":"N","«ä":"NJ","√ì":"O","≈é":"O","«ë":"O","√î":"O","·ªê":"O","·ªò":"O","·ªí":"O","·ªî":"O","·ªñ":"O","√ñ":"O","»™":"O","»Æ":"O","»∞":"O","·ªå":"O","≈ê":"O","»å":"O","√í":"O","·ªé":"O","∆†":"O","·ªö":"O","·ª¢":"O","·ªú":"O","·ªû":"O","·ª†":"O","»é":"O","Íùä":"O","Íùå":"O","≈å":"O","·πí":"O","·πê":"O","∆ü":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","√ï":"O","·πå":"O","·πé":"O","»¨":"O","∆¢":"OI","Íùé":"OO","∆ê":"E","∆Ü":"O","»¢":"OU","·πî":"P","·πñ":"P","Íùí":"P","∆§":"P","Íùî":"P","‚±£":"P","Íùê":"P","Íùò":"Q","Íùñ":"Q","≈î":"R","≈ò":"R","≈ñ":"R","·πò":"R","·πö":"R","·πú":"R","»ê":"R","»í":"R","·πû":"R","…å":"R","‚±§":"R","Íúæ":"C","∆é":"E","≈ö":"S","·π§":"S","≈†":"S","·π¶":"S","≈û":"S","≈ú":"S","»ò":"S","·π†":"S","·π¢":"S","·π®":"S","≈§":"T","≈¢":"T","·π∞":"T","»ö":"T","»æ":"T","·π™":"T","·π¨":"T","∆¨":"T","·πÆ":"T","∆Æ":"T","≈¶":"T","‚±Ø":"A","ÍûÄ":"L","∆ú":"M","…Ö":"V","Íú®":"TZ","√ö":"U","≈¨":"U","«ì":"U","√õ":"U","·π∂":"U","√ú":"U","«ó":"U","«ô":"U","«õ":"U","«ï":"U","·π≤":"U","·ª§":"U","≈∞":"U","»î":"U","√ô":"U","·ª¶":"U","∆Ø":"U","·ª®":"U","·ª∞":"U","·ª™":"U","·ª¨":"U","·ªÆ":"U","»ñ":"U","≈™":"U","·π∫":"U","≈≤":"U","≈Æ":"U","≈®":"U","·π∏":"U","·π¥":"U","Íùû":"V","·πæ":"V","∆≤":"V","·πº":"V","Íù†":"VY","·∫Ç":"W","≈¥":"W","·∫Ñ":"W","·∫Ü":"W","·∫à":"W","·∫Ä":"W","‚±≤":"W","·∫å":"X","·∫ä":"X","√ù":"Y","≈∂":"Y","≈∏":"Y","·∫é":"Y","·ª¥":"Y","·ª≤":"Y","∆≥":"Y","·ª∂":"Y","·ªæ":"Y","»≤":"Y","…é":"Y","·ª∏":"Y","≈π":"Z","≈Ω":"Z","·∫ê":"Z","‚±´":"Z","≈ª":"Z","·∫í":"Z","»§":"Z","·∫î":"Z","∆µ":"Z","ƒ≤":"IJ","≈í":"OE","·¥Ä":"A","·¥Å":"AE"," ô":"B","·¥É":"B","·¥Ñ":"C","·¥Ö":"D","·¥á":"E","Íú∞":"F","…¢":"G"," õ":"G"," ú":"H","…™":"I"," Å":"R","·¥ä":"J","·¥ã":"K"," ü":"L","·¥å":"L","·¥ç":"M","…¥":"N","·¥è":"O","…∂":"OE","·¥ê":"O","·¥ï":"OU","·¥ò":"P"," Ä":"R","·¥é":"N","·¥ô":"R","Íú±":"S","·¥õ":"T","‚±ª":"E","·¥ö":"R","·¥ú":"U","·¥†":"V","·¥°":"W"," è":"Y","·¥¢":"Z","√°":"a","ƒÉ":"a","·∫Ø":"a","·∫∑":"a","·∫±":"a","·∫≥":"a","·∫µ":"a","«é":"a","√¢":"a","·∫•":"a","·∫≠":"a","·∫ß":"a","·∫©":"a","·∫´":"a","√§":"a","«ü":"a","»ß":"a","«°":"a","·∫°":"a","»Å":"a","√†":"a","·∫£":"a","»É":"a","ƒÅ":"a","ƒÖ":"a","·∂è":"a","·∫ö":"a","√•":"a","«ª":"a","·∏Å":"a","‚±•":"a","√£":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","·∏É":"b","·∏Ö":"b","…ì":"b","·∏á":"b","·µ¨":"b","·∂Ä":"b","∆Ä":"b","∆É":"b","…µ":"o","ƒá":"c","ƒç":"c","√ß":"c","·∏â":"c","ƒâ":"c","…ï":"c","ƒã":"c","∆à":"c","»º":"c","ƒè":"d","·∏ë":"d","·∏ì":"d","»°":"d","·∏ã":"d","·∏ç":"d","…ó":"d","·∂ë":"d","·∏è":"d","·µ≠":"d","·∂Å":"d","ƒë":"d","…ñ":"d","∆å":"d","ƒ±":"i","»∑":"j","…ü":"j"," Ñ":"j","«≥":"dz","«Ü":"dz","√©":"e","ƒï":"e","ƒõ":"e","»©":"e","·∏ù":"e","√™":"e","·∫ø":"e","·ªá":"e","·ªÅ":"e","·ªÉ":"e","·ªÖ":"e","·∏ô":"e","√´":"e","ƒó":"e","·∫π":"e","»Ö":"e","√®":"e","·∫ª":"e","»á":"e","ƒì":"e","·∏ó":"e","·∏ï":"e","‚±∏":"e","ƒô":"e","·∂í":"e","…á":"e","·∫Ω":"e","·∏õ":"e","Íù´":"et","·∏ü":"f","∆í":"f","·µÆ":"f","·∂Ç":"f","«µ":"g","ƒü":"g","«ß":"g","ƒ£":"g","ƒù":"g","ƒ°":"g","…†":"g","·∏°":"g","·∂É":"g","«•":"g","·∏´":"h","»ü":"h","·∏©":"h","ƒ•":"h","‚±®":"h","·∏ß":"h","·∏£":"h","·∏•":"h","…¶":"h","·∫ñ":"h","ƒß":"h","∆ï":"hv","√≠":"i","ƒ≠":"i","«ê":"i","√Æ":"i","√Ø":"i","·∏Ø":"i","·ªã":"i","»â":"i","√¨":"i","·ªâ":"i","»ã":"i","ƒ´":"i","ƒØ":"i","·∂ñ":"i","…®":"i","ƒ©":"i","·∏≠":"i","Íù∫":"d","Íùº":"f","·µπ":"g","ÍûÉ":"r","ÍûÖ":"s","Íûá":"t","Íù≠":"is","«∞":"j","ƒµ":"j"," ù":"j","…â":"j","·∏±":"k","«©":"k","ƒ∑":"k","‚±™":"k","ÍùÉ":"k","·∏≥":"k","∆ô":"k","·∏µ":"k","·∂Ñ":"k","ÍùÅ":"k","ÍùÖ":"k","ƒ∫":"l","∆ö":"l","…¨":"l","ƒæ":"l","ƒº":"l","·∏Ω":"l","»¥":"l","·∏∑":"l","·∏π":"l","‚±°":"l","Íùâ":"l","·∏ª":"l","≈Ä":"l","…´":"l","·∂Ö":"l","…≠":"l","≈Ç":"l","«â":"lj","≈ø":"s","·∫ú":"s","·∫õ":"s","·∫ù":"s","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","·µØ":"m","·∂Ü":"m","≈Ñ":"n","≈à":"n","≈Ü":"n","·πã":"n","»µ":"n","·πÖ":"n","·πá":"n","«π":"n","…≤":"n","·πâ":"n","∆û":"n","·µ∞":"n","·∂á":"n","…≥":"n","√±":"n","«å":"nj","√≥":"o","≈è":"o","«í":"o","√¥":"o","·ªë":"o","·ªô":"o","·ªì":"o","·ªï":"o","·ªó":"o","√∂":"o","»´":"o","»Ø":"o","»±":"o","·ªç":"o","≈ë":"o","»ç":"o","√≤":"o","·ªè":"o","∆°":"o","·ªõ":"o","·ª£":"o","·ªù":"o","·ªü":"o","·ª°":"o","»è":"o","Íùã":"o","Íùç":"o","‚±∫":"o","≈ç":"o","·πì":"o","·πë":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","√µ":"o","·πç":"o","·πè":"o","»≠":"o","∆£":"oi","Íùè":"oo","…õ":"e","·∂ì":"e","…î":"o","·∂ó":"o","»£":"ou","·πï":"p","·πó":"p","Íùì":"p","∆•":"p","·µ±":"p","·∂à":"p","Íùï":"p","·µΩ":"p","Íùë":"p","Íùô":"q"," †":"q","…ã":"q","Íùó":"q","≈ï":"r","≈ô":"r","≈ó":"r","·πô":"r","·πõ":"r","·πù":"r","»ë":"r","…æ":"r","·µ≥":"r","»ì":"r","·πü":"r","…º":"r","·µ≤":"r","·∂â":"r","…ç":"r","…Ω":"r","‚ÜÑ":"c","Íúø":"c","…ò":"e","…ø":"r","≈õ":"s","·π•":"s","≈°":"s","·πß":"s","≈ü":"s","≈ù":"s","»ô":"s","·π°":"s","·π£":"s","·π©":"s"," Ç":"s","·µ¥":"s","·∂ä":"s","»ø":"s","…°":"g","·¥ë":"o","·¥ì":"o","·¥ù":"u","≈•":"t","≈£":"t","·π±":"t","»õ":"t","»∂":"t","·∫ó":"t","‚±¶":"t","·π´":"t","·π≠":"t","∆≠":"t","·πØ":"t","·µµ":"t","∆´":"t"," à":"t","≈ß":"t","·µ∫":"th","…ê":"a","·¥Ç":"ae","«ù":"e","·µ∑":"g","…•":"h"," Æ":"h"," Ø":"h","·¥â":"i"," û":"k","ÍûÅ":"l","…Ø":"m","…∞":"m","·¥î":"oe","…π":"r","…ª":"r","…∫":"r","‚±π":"r"," á":"t"," å":"v"," ç":"w"," é":"y","Íú©":"tz","√∫":"u","≈≠":"u","«î":"u","√ª":"u","·π∑":"u","√º":"u","«ò":"u","«ö":"u","«ú":"u","«ñ":"u","·π≥":"u","·ª•":"u","≈±":"u","»ï":"u","√π":"u","·ªß":"u","∆∞":"u","·ª©":"u","·ª±":"u","·ª´":"u","·ª≠":"u","·ªØ":"u","»ó":"u","≈´":"u","·πª":"u","≈≥":"u","·∂ô":"u","≈Ø":"u","≈©":"u","·ππ":"u","·πµ":"u","·µ´":"ue","Íù∏":"um","‚±¥":"v","Íùü":"v","·πø":"v"," ã":"v","·∂å":"v","‚±±":"v","·πΩ":"v","Íù°":"vy","·∫É":"w","≈µ":"w","·∫Ö":"w","·∫á":"w","·∫â":"w","·∫Å":"w","‚±≥":"w","·∫ò":"w","·∫ç":"x","·∫ã":"x","·∂ç":"x","√Ω":"y","≈∑":"y","√ø":"y","·∫è":"y","·ªµ":"y","·ª≥":"y","∆¥":"y","·ª∑":"y","·ªø":"y","»≥":"y","·∫ô":"y","…è":"y","·ªπ":"y","≈∫":"z","≈æ":"z","·∫ë":"z"," ë":"z","‚±¨":"z","≈º":"z","·∫ì":"z","»•":"z","·∫ï":"z","·µ∂":"z","·∂é":"z"," ê":"z","∆∂":"z","…Ä":"z","Ô¨Ä":"ff","Ô¨É":"ffi","Ô¨Ñ":"ffl","Ô¨Å":"fi","Ô¨Ç":"fl","ƒ≥":"ij","≈ì":"oe","Ô¨Ü":"st","‚Çê":"a","‚Çë":"e","·µ¢":"i","‚±º":"j","‚Çí":"o","·µ£":"r","·µ§":"u","·µ•":"v","‚Çì":"x"},String.prototype.latinize=function(){return this.replace(/[^A-Za-z0-9\[\] ]/g,function(t){return e.latin_map[t]||t})}}var oe=l.API_URL+"routes/routes/",re=l.API_URL+"routes/visits/",le=l.API_URL+"routes/plans/",ce="YYYY-MM-DD",de="plan_name",ue="planned_date",pe=this,me=[],ve=d("translate");pe.isCopy="true"===a.isCopy||!1,pe.plan={},pe.vehicles=[],pe.drivers=[],pe.skills=[],pe.driversAfterEdit=[];var ge=[];pe.visitsNotUpdated=[],pe.dateOptions=null,pe.planDate={},pe.weekend_days=[],pe.resetDay=null,pe.dateOptions=null,pe.popupPlanDateStart=null,pe.popupPlanDateEnd=null,pe.updatingPlan=!1,pe.planUpdated=null,pe.planUploaded=!1,pe.visitsUpdated=0,pe.totalExcelVisits=0,pe.visitsChangedButNotUpdated=0,pe.openPopupPlanDateStart=C,pe.openPopupPlanDateEnd=D,pe.getVehicleTotalVisits=P,pe.getVehicleTotalDistance=L,pe.getVehicleTotalTime=O,pe.updatePlanData=T,pe.loadPlan=B,pe.exportPlan=H,pe.uploadExcel=G,pe.goToPlans=W,pe.naturalSort=Q,pe.duplicatePlan=M,pe.setVisitsZones=ne,pe.formatContactEmail=ie,b(),Array.prototype.inArray=function(e,t){for(var i=-1,a=this,n=0;n<a.length;n++){var s=a[n];if(s.hasOwnProperty(t)&&s[t].toLowerCase()===e.toLowerCase())return i=n}return i},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,i=this.length;i>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},n.$on("$destroy",X)}e.$inject=["$log","$http","$state","$stateParams","$scope","plannerService","moment","$rootScope","__env","$q","$filter","$timeout","Utils","naturalService","Toasts","timeUtils","zoneService","JOINED_EMAILS_MAX_LENGTH","MAX_EMAILS_INPUT"],angular.module("icarus.planner").controller("PlannerPlansDetailController",e)}(),function(){"use strict";function e(){function e(e){return function(t){return 1===e?!0:"status"in t&&t.status===e?!0:!1}}function t(e){return function(t,i){return t.status<i.status?1:t.status>i.status?-1:t[e]<i[e]?-1:t[e]>i[e]?1:0}}return function(i,a,n){return null!==i?(a=a||1,n=n||"title",i.filter(e(a)).sort(t(n))):void 0}}angular.module("icarus.planner").filter("plannerVisitsStatusFilter",e)}(),function(){"use strict";function e(e,t){return function(e){if(e&&0!==e.length){var i=[];return angular.forEach(e,function(e){if(e){var a=t.skills.filter(t.getSkillById(e));a.length>0&&i.push(a[0].name)}}),i.join(", ")}}}e.$inject=["$log","plannerService"],angular.module("icarus.planner").filter("plannerCommaSeparatedArrayFilter",e)}(),function(){"use strict";function e(){function e(e){i=e}function t(){return i}var i={};return{setUserVisualState:e,getUserVisualState:t}}angular.module("icarus.planner").service("userRoutesVisualState",e)}(),function(){"use strict";function e(){return function(e,t,i){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(i.ngEnter,{event:t})}),t.preventDefault())})}}angular.module("icarus.planner").directive("ngEnter",e)}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"app/planner/directives/alert-notification-template.html",scope:{},link:function(e){function t(t,i){e.hideFlag=!1,e.notification=i.notification}function i(t){e.notification=null}function a(){e.hideFlag=!0}e.notification=null,e.hideFlag=!1,e.hide=a,e.$on("NEW_ALERT_NOTIFICATION",t),e.$on("DELETE_ALERT_NOTIFICATION",i)}}}angular.module("icarus.planner").directive("alertNotification",e)}(),function(){"use strict";function e(){function e(e){a.onGetVisits({date:e,status:t().join(",")})}function t(){var e=[];return a.data.optionsVisitsNotCompleted&&a.data.optionsVisitsNotCompleted.map(function(t){t.value&&e.push(t.key)}),e}function i(){var e=!0;a.data.optionsVisitsNotCompleted.map(function(t){t.value&&(e=!1)}),a.isDisabledSubmitButton=e}var a=this;a.getVisits=e,a.checkIfButtonIsDisabled=i,a.isDisabledSubmitButton=!1,a.data.optionsVisitsNotCompleted&&a.data.optionsVisitsNotCompleted.length>0&&(a.isDisabledSubmitButton=!0)}var t={templateUrl:"app/planner/components/visitsImport.html",controller:e,bindings:{data:"<",onGetVisits:"&"}};angular.module("icarus.planner").component("visitsImport",t)}(),function(){"use strict";function e(e,t){function i(){u.isMultipleEditingModeActivated=!0,u.onEnterOnMode()}function a(){u.isMultipleEditingModeActivated=!1,o(),u.onExitMode()}function n(){u.drawingManager||(u.drawingManager=s(u.map),e.listenerLimitDrawingPolygon(u.drawingManager,l))}function s(t){var i,a=r();return i=e.createDrawing(t,a.modesOptions,a.drawingModes,a.drawingModeInit,a.drawingShowControl)}function o(){u.drawingManager&&u.drawingManager.setMap(null),u.drawingManager=null,e.clearListenerLimitDrawingPolygon(u.map)}function r(){var t={polygonOptions:{fillColor:"#335F72",fillOpacity:.5,strokeWeight:2,strokeOpacity:0,clickable:!1,editable:!1,draggable:!1,zIndex:1}},i=["polygon"],a=e.overlayTypePolygon(),n=!1;return{modesOptions:t,drawingModes:i,drawingModeInit:a,drawingShowControl:n}}function l(t){var i=e.createPolygon({path:t.getPath()});t.setMap(null),u.onMultipleSelectionCompleted({polygon:i})}function c(){u.alertData.msg=null,u.alertCallToAction()}function d(e){u.drawingManager=e}var u=this;u.drawingManager=null,u.isMultipleEditingModeActivated=!1,u.enterOnMultipleEditingMode=i,u.exitMultipleEditingMode=a,u.initDrawingManager=n,u.clearDrawingManager=o,u.deselectSelection=c,u.setDrawingManager=d,t.$on("Planner:MSOMC:CLEAR_DRAWING_MANAGER",a),u.$onChanges=function(e){e.map?u.map=e.map.currentValue:e.alertData&&(u.alertData=e.alertData.currentValue)},u.$onDestroy=function(){o(),u.onExitMode()}}var t={templateUrl:"app/planner/components/multipleSelectionOnMap.html",controller:["googleService","$scope",e],bindings:{map:"<",showIf:"<",onMultipleSelectionCompleted:"&",onEnterOnMode:"&",onExitMode:"&",alertData:"<",alertCallToAction:"&"}};angular.module("icarus.planner").component("multipleSelectionOnMap",t)}(),function(){"use strict";function e(){var e=this;e.close=function(){e.callToClose({visitId:e.data.id})}}var t={templateUrl:"app/planner/components/infoBox.html",controller:e,bindings:{data:"<",callToClose:"&",viewCollapse:"<"}};angular.module("icarus.planner").component("infoBox",t)}(),function(){"use strict";function e(){}var t={templateUrl:"app/planner/components/errorFinishModal.html",controller:e,bindings:{data:"<"}};angular.module("icarus.planner").component("errorFinishModal",t)}(),function(){"use strict";function e(){function e(e){t.onChangeStep({state:e})}var t=this;t.changeStep=e}var t={templateUrl:"app/planner/components/breadCrumbs.html",controller:e,bindings:{data:"<",onChangeStep:"&"}};angular.module("icarus.planner").component("breadCrumbs",t)}(),function(){"use strict";function e(e){return function(t){return e.trustAsResourceUrl(t)}}e.$inject=["$sce"],angular.module("icarus.planner").filter("trusted",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u){function p(){u?m():v()}function m(){g(),ne.populateMonthSelect(),f()}function v(){ne.userWithoutDashboard=!0}function g(){n(function(){ne.isDOMRender=!0},0)}function h(e){Ae.forEach(function(t){t.active=t.indicatorName===e}),ne.indicators.activeLoad=xe[e],ne.indicators.activeLoad.eventIcons=Ae}function _(){ne.monthDates.push(ye);for(var e=1;le>=e;e++){var t={id:s(s().toDate()).subtract(e,"months").format(oe),name:s(s().toDate()).subtract(e,"months").format(re)};ne.monthDates.push(t)}}function f(){D(ne.reportsDate.id),y(ne.reportsDate.id,we),V(),ae()}function b(e){e="completed"===e?"failed":"completed",ne.graphics.pies.typeFailedActive="completed"!==e,y(ne.reportsDate.id,e)}function y(e,i){var a=e.split("-");l.getVisitsObservations(a[0],a[1],i).then(function(e){var t=e.data.map(function(e,t){return e.color=be[t]?be[t]:null,e});ne.graphics.pies.data=A(t),ne.graphics.pies.type=i,ne.graphics.pies.total=w(e.data)})["catch"](function(e){t.error(e)})}function w(e){return e.length>0?e.reduce(function(e,t){return{total:e.total+t.total}}):0}function A(e){var t=[];return e.forEach(function(e){var i={key:e.name,y:e.total};e.color&&(i.color=e.color),t.push(i)}),t}function x(e){var t={totalVisits:0,completedVisits:0};return e.forEach(function(e){t.totalVisits+=e.total_completed+e.total_failed+e.total_pending,t.completedVisits+=e.total_completed}),t}function k(e){return e?e.toFixed(0)+"%":"-"}function I(e,t){var i=t?100*e/t:0;return k(i)}function S(e){var t=x(e);ne.indicators.totalVisits.value=t.totalVisits?t.totalVisits:"-",ne.indicators.completedVisits.value=I(t.completedVisits,t.totalVisits)}function E(e,t,a){for(var n=[],s=[],o=[],r=C(parseInt(e),parseInt(t)),l=r.end.diff(r.start,"days")+1,c=1;l>=c;c++){var d=1===String(c).length?"0"+c:c,u=e+"-"+t+"-"+d,p=i("filter")(a,{date:u});0===p.length?(n.push({x:u,y:0}),s.push({x:u,y:0}),o.push({x:u,y:0})):p.map(function(e){n.push({x:e.date,y:e.total_pending}),s.push({x:e.date,y:e.total_failed}),o.push({x:e.date,y:e.total_completed})})}return[{key:se("Dashboard.BarGraph.visits_failed"),color:"#e74c3c",values:s},{key:se("Dashboard.BarGraph.visits_pending"),color:"#7f8c8d",values:n},{key:se("Dashboard.BarGraph.visits_completed"),color:"#1abc9c",values:o}]}function C(e,t){var i=s([e,t-1]),a=s(i).endOf("month");return{start:i,end:a}}function D(e){var i=e.split("-");P(i[0],i[1]).then(function(e){ne.graphics.bars.data=E(i[0],i[1],e.data),S(e.data),N()})["catch"](function(e){t.error(e)})}function P(e,t){return l.getVisitTotals(e,t)}function L(e){var t=[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:3,y:0},{x:4,y:0},{x:5,y:0},{x:6,y:0},{x:7,y:0},{x:8,y:0},{x:9,y:0},{x:10,y:0},{x:11,y:0},{x:12,y:0},{x:13,y:0},{x:14,y:0},{x:15,y:0},{x:16,y:0},{x:17,y:0},{x:18,y:0},{x:19,y:0},{x:20,y:0},{x:21,y:0},{x:22,y:0},{x:23,y:0},{x:24,y:0}];return e.forEach(function(e){t.forEach(function(t){t.x===parseInt(e.hour)&&(t.y=e.total_checkouts)})}),t}function O(e){var t=L(e.total_checkouts),i=L(e.total_checkouts_in_window);return[t,i]}function T(e){var t=!1;return o.isEmpty(e)||Object.keys(e.data).length>0&&(t=0!==e.data.total_checkouts.length&&0!==e.data.total_checkouts_in_window.length),t}function V(){var e=ne.reportsDate.id.split("-");R(e[0],e[1]).then(function(e){if(F(e),j(),$(),T(e)){var t=O(e.data);ne.graphics.area.data[0].values=t[0],ne.graphics.area.data[1].values=t[1]}else ne.graphics.area.data[0].values=[],ne.graphics.area.data[1].values=[]})["catch"](function(e){t.error(e)})}function R(e,t){return l.getVisitsCheckouts(e,t)}function M(e,t){return e.reduce(function(e,i){return e+i[t]},0)}function z(e,t){var i="-";return e>0&&(i=(100*t/e).toFixed(0)+"%"),i}function F(e){if(T(e)){var t=e.data,i=M(t.total_checkouts,"total_checkouts"),a=M(t.total_checkouts_in_window,"total_checkouts");ne.indicators.checkoutVisitsInTimeWindow.value=z(i,a)}}function N(){var e=Y();P(e[0],e[1]).then(function(e){if(j(),0!==e.data.length){var t=x(e.data),i=parseFloat((t.completedVisits/t.totalVisits*100).toFixed(0));H(t),U(i)}})["catch"](function(e){t.error(e)})}function $(){var e=Y();R(e[0],e[1]).then(function(e){if(T(e)){var t=M(e.data.total_checkouts,"total_checkouts"),i=M(e.data.total_checkouts_in_window,"total_checkouts"),a=t>0?i/t*100:0;q(a)}})["catch"](function(e){t.error(e)})}function j(){B(ne.indicators.totalVisits),B(ne.indicators.completedVisits),B(ne.indicators.checkoutVisitsInTimeWindow)}function B(e){e.dataUp=!1,e.dataDown=!1,e.dataZero=!0,e.perceChange="0%",e.classDiv=ge,e.classIcon=de,e.eventIcons=[]}function H(e){ne.indicators.totalVisits.dataZero=!1;var t="-"!==ne.indicators.totalVisits.value?ne.indicators.totalVisits.value:0,i=J(e.totalVisits,t);W(i,ne.indicators.totalVisits)}function U(e){var t=G(e,ne.indicators.completedVisits);W(t,ne.indicators.completedVisits)}function q(e){var t=G(Math.round(e),ne.indicators.checkoutVisitsInTimeWindow);W(parseInt(t),ne.indicators.checkoutVisitsInTimeWindow)}function G(e,t){var i="-"!==t.value?t.value:"0%",a=parseFloat(i.replace("%",""));return a-e}function J(e,t){return 0===e?0:(t-e)/e*100}function Y(){return d.lastDateByMonth(ne.reportsDate.id+"-01",1).split("-")}function W(e,t){e>0?(t.dataUp=!0,t.perceChange=e>999?ce:String(parseInt(e)).replace("-","")+"%",Q(t,ve,ue,!1)):0>e&&(t.dataDown=!0,t.perceChange=-999>e?ce:String(parseInt(e)).replace("-","")+"%",Q(t,me,pe,!1))}function Q(e,t,i,a){e.classDiv=t,e.classIcon=i,e.dataZero=a}function Z(e,t){return l.getVehicleTotals(e,t)}function K(e,t){var i=xe[t];i.dataZero=!1;var a=G(Math.round(e),i);W(a,i)}function X(){B(ne.indicators.maxVehicles),B(xe.percLoad1),B(xe.percLoad2),B(xe.percLoad3)}function ee(e){ne.indicators.maxVehicles.dataZero=!1;var t="-"!==ne.indicators.maxVehicles.value?ne.indicators.maxVehicles.value:0,i=J(e.total_max_vehicles,t);W(i,ne.indicators.maxVehicles),K(e.avg_perc_load_1,"percLoad1"),K(e.avg_perc_load_2,"percLoad2"),K(e.avg_perc_load_3,"percLoad3"),h("percLoad1")}function te(){var e=Y();Z(e[0],e[1]).then(function(e){X(),0!==e.data.length&&ee(e.data[0])})["catch"](function(e){t.error(e)})}function ie(e){ne.indicators.maxVehicles.value=e.total_max_vehicles,xe.percLoad1.value=k(e.avg_perc_load_1),xe.percLoad2.value=k(e.avg_perc_load_2),xe.percLoad3.value=k(e.avg_perc_load_3)}function ae(){var e=ne.reportsDate.id.split("-");Z(e[0],e[1]).then(function(e){e.data.length>0&&(ie(e.data[0]),te())})["catch"](function(e){t.error(e)})}var ne=this,se=i("translate"),oe="YYYY-MM",re="MMMM YYYY",le=5,ce="999%",de="glyphicon glyphicon-minus icon",ue="glyphicon glyphicon-arrow-up icon",pe="glyphicon glyphicon-arrow-down icon",me="down",ve="up",ge="zero",he="sp-icon-carga-peso",_e="sp-icon-carga-volumen",fe="sp-icon-carga-valor",be=["#F34235","#C41061","#A900FF","#6100E9","#2861FF","#00B7D3","#00C853","#AEEA00","#FFD600","#FF6D00","#DD2C00","#880E4F","#1A237E","#006064","#BF360C","#76FF03","#005EFF","#BA68C8","#FF5252","#33691E"],ye={id:s(s().toDate()).format(oe),name:s(s().toDate()).format(re)},we="failed",Ae=[{icon:he,indicatorName:"percLoad1",clickEvent:h,active:!0},{icon:_e,indicatorName:"percLoad2",clickEvent:h,active:!1},{icon:fe,indicatorName:"percLoad3",clickEvent:h,active:!1}],xe={percLoad1:{title:se("Dashboard.Indicators.vehicle_average_load_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:Ae},percLoad2:{title:se("Dashboard.Indicators.vehicle_average_load_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:Ae},percLoad3:{title:se("Dashboard.Indicators.vehicle_average_load_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:Ae}};ne.isDOMRender=!1,ne.monthDates=[],ne.reportsDate=ye,ne.graphics={bars:{options:{chart:{type:"multiBarChart",height:350,margin:{top:20,right:0,bottom:60,left:0},clipEdge:!0,staggerLabels:!1,transitionDuration:1e3,tooltips:!0,tooltipContent:function(e,t,i){return"<p>"+e+": "+i+"</p>"},stacked:!0,showControls:!1,xAxis:{showMaxMin:!1,tickFormat:function(e){return new Date(e).getUTCDate()}},yAxis:{axisLabelDistance:100,tickFormat:function(e){return d3.format(",.f")(e)}},showLegend:!1,showYAxis:!1,reduceXTicks:!1}},data:[]},pies:{type:"failed",typeFailedActive:!0,options:{chart:{type:"pieChart",height:282,donut:!0,x:function(e){return e.key},y:function(e){return e.y},duration:500,legend:{margin:{top:5,right:140,bottom:5,left:0}},showLegend:!1,showLabels:!1}},data:[]},area:{options:{chart:{showLegend:!1,type:"multiChart",height:250,reduceXTicks:!1,yAxis2:{show:!1,showMaxMin:!1},yAxis1:{show:!1,showMaxMin:!1},margin:{top:20,right:20,bottom:30,left:40},color:d3.scale.category10().range(),useInteractiveGuideline:!0,xAxis:{showMaxMin:!1}}},data:[{type:"area",yAxis:1,key:se("Dashboard.checkoutGraph.visits_total"),showYAxis:!1,color:"#B6BEC1",values:[]},{type:"line",yAxis:1,key:se("Dashboard.checkoutGraph.visits_window"),showYAxis:!1,color:"#28BAA4",values:[]}]}},ne.indicators={totalVisits:{title:se("Dashboard.Indicators.total_visits_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:[]},maxVehicles:{title:se("Dashboard.Indicators.max_vehicles_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:[]},completedVisits:{title:se("Dashboard.Indicators.visits_completed_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:[]},checkoutVisitsInTimeWindow:{title:se("Dashboard.Indicators.checkouts_in_time_window_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:[]},activeLoad:{title:se("Dashboard.Indicators.perc_load_1_title"),value:"-",dataUp:!1,dataDown:!1,dataZero:!0,perceChange:"0%",classDiv:ge,classIcon:de,eventIcons:Ae}},ne.userWithoutDashboard=!1,ne.populateMonthSelect=_,ne.updateReports=f,ne.changeView=b,ne.changeIndicator=h,p()}e.$inject=["$rootScope","$log","$filter","Toasts","$timeout","moment","lodash","ngDialog","dashboardService","reportService","timeUtils","PermissionToGraphics"],angular.module("icarus").controller("VisitsGraphicsController",e)}(),function(){"use strict";function e(e,t,i,a){function n(){i.sendEmailToGetDashboardGraphics().then(function(){t.push("success",o("Dashboard.Visits.Modal.success_email"))})["catch"](function(i){e.error(i),t.push("error",o("Dashboard.Visits.Modal.error_email"))})}var s=this,o=a("translate");s.sendEmail=n}e.$inject=["$log","Toasts","dashboardService","$filter"],angular.module("icarus").controller("ConfirmModalController",e)}(),function(){"use strict";angular.module("icarus.dashboard",[])}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(t,i){return e.get(u(t,i))}function u(e,t){return i.API_URL+_+"start_date="+e+"&end_date="+t}function p(){return t.all([a.list(),n.list(),s.listObservations(),o.list(),r.getExtraFields()])}function m(t){return e.get(f,{params:t})}function v(e){return l.getTimeServiceVisits(e)}function g(e){return t.all(e)}function h(){return c.getUser()}var _="routes/visits/history-visits/?",f=i.API_URL+"accounts/clients/";return{getReportVisitHistory:d,getDataExternalForReports:p,getClientsList:m,getTimeServiceVisits:v,getReportTimeServiceFromArrayPromises:g,getOptimizationPermissions:h}}e.$inject=["$http","$q","__env","driversService","vehicleService","mobileGeneralService","skillsService","extraFieldsService","settingsService","sessionService"],angular.module("icarus.dashboard").factory("dashboardReportService",e)}(),function(){"use strict";function e(e,t,i){function a(t,i){return e.get(l+"visit-totals/year/"+t+"/month/"+i+"/",{cache:c})}function n(t,i,a){return e.get(l+"visit-observations/year/"+t+"/month/"+i+"/",{params:{type:a},cache:c})}function s(t,i){return e.get(l+"visit-checkouts/year/"+t+"/month/"+i+"/",{cache:c})}function o(t,i){return e.get(l+"vehicle-totals/year/"+t+"/month/"+i+"/",{cache:c})}function r(){return e.post(l+"request-dashboards/")}var l=t.API_URL+"dashboards/",c=i("dashboards");return{getVisitTotals:a,getVisitsObservations:n,getVisitsCheckouts:s,getVehicleTotals:o,sendEmailToGetDashboardGraphics:r}}e.$inject=["$http","__env","$cacheFactory"],angular.module("icarus.dashboard").factory("dashboardService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m){function v(){g(),h()}function g(){c.getDataExternalForReports().then(function(e){$.drivers=e[0],$.vehicles=e[1],$.observations=e[2],$.skills=e[3],$.extraFields=e[4]})["catch"](function(e){a.error(e)})}function h(){c.getOptimizationPermissions().then(function(e){$.enableTimeServiceReport=e.is_staff,$.enableOptimizationRequestsReport=e.is_staff,$.enableLogReport=e.is_staff,e.is_staff&&_().then(function(e){$.clients=e.data.results,q=e.data.results})["catch"](function(e){a.error(e)})})["catch"](function(e){a.error(e)})}function _(e){var t={};return e&&(t.search=e),c.getClientsList(t)}function f(){$.clients=q}function b(e){return _(e).then(function(e){$.clients=e.data.results})}function y(t,i,a){var n;w(t,i,a),t=o.createTime(t),i=o.createTime(i),n=o.duration(i.diff(t)),o.asDays(n)>31||o.asDays(n)<-1?($.activateReportBtn=!1,$.validationErrorDate=!0,e[a].startDate.$setTouched(),e[a].startDate.$setDirty(),e[a].startDate.$setValidity("endDate_gt_startDate",!1),e[a].endDate.$setTouched(),e[a].endDate.$setDirty(),e[a].endDate.$setValidity("endDate_gt_startDate",!1),$[a].settingsErrorDateStart||($[a].settingsErrorBetweenDates=!0)):($.activateReportBtn=!0,$.validationErrorDate=!1,e[a].startDate.$setValidity("endDate_gt_startDate",!0),e[a].endDate.$setValidity("endDate_gt_startDate",!0),$[a].settingsErrorBetweenDates=!1)}function w(t,i,a){t=o.createTime(t),i=o.createTime(i),o.isAfter(t,i)?($.activateReportBtn=!1,$.validationErrorDate=!0,e[a].endDate.$setTouched(),e[a].endDate.$setDirty(),e[a].endDate.$setValidity("endDate_gt_startDate",!1),$[a].settingsErrorDateStart=!0):($.activateReportBtn=!0,$.validationErrorDate=!1,e[a].endDate.$setValidity("endDate_gt_startDate",!0),$[a].settingsErrorDateStart=!1)}function A(e,i){t.isLoading=!0;var a=angular.copy(e),n=angular.copy(i),s=O(H("General.excel_name"),a,n);$.disableReportBtn=!0,$.reportLoading=!0,(o.getTimeDate()-B)/6e4<2||G.start!==a||G.end!==n?(G.start=a,G.end=n,c.getReportVisitHistory(o.formatTime(a,m),o.formatTime(n,m)).then(function(e){return U=R(e),B=o.getTimeDate(),V(U,s)})["finally"](function(){L()})):V(U,s)["finally"](function(){L()})}function x(){$.generating_report=!0,t.isLoading=!0;var e=$.kmReportTime?o.formatTime($.kmReportTime.start,"HH:mm"):null,i=$.kmReportTime?o.formatTime($.kmReportTime.end,"HH:mm"):null,n=o.formatTime($.kmReportStartDate.model,m),s=o.formatTime($.kmReportEndDate.model,m),r={fromDate:n,toDate:s,startTime:e,endTime:i};d.getRoutesKilometersTravelingReport(r).then(function(e){$.generating_report=!1,t.isLoading=!1;var i=O("Reporte_rutas_",o.formatTime($.kmReportStartDate.model,m),o.formatTime($.kmReportEndDate.model,m))+".xlsx";u.donwloadFile(e.data,i)})["catch"](function(e){a.error(e),$.generating_report=!1,t.isLoading=!1})}function k(e,i){t.isLoading=!0,$.disableTcReportBtn=!0,d.visitsWithTrackingIdReport(e,i,$.emailTcReport).then(function(){t.isLoading=!1,$.disableTcReportBtn=!1,s.push("success",H("General.TC_REPORT.report_tc_success"))})["catch"](function(e){a.error(e),t.isLoading=!1,$.disableTcReportBtn=!1,s.push("error",H("General.TC_REPORT.report_tc_error"))})}function I(e,i){t.isLoading=!0,$.disableOrReportBtn=!0,d.optimizationRequestsReport(e,i).then(function(){t.isLoading=!1,$.disableOrReportBtn=!1})["catch"](function(){t.isLoading=!1,$.disableOrReportBtn=!1,s.push("error",H("General.error_creating_report"))})}function S(){t.isLoading=!0,$.generating_report=!0,d.logRequestsReport($.logReportClient.id,$.logReportStartDate.model,$.logReportEndDate.model).then(function(){t.isLoading=!1,$.generating_report=!1;
})["catch"](function(e){t.isLoading=!1,$.generating_report=!1,a.error(e)})}function E(){var e=$.tsReportTime?o.formatTime($.tsReportTime.start,"HH:mm"):null,t=$.tsReportTime?o.formatTime($.tsReportTime.end,"HH:mm"):null,i=C(o.formatTime($.tsReportStartDate.model,m),o.formatTime($.tsReportEndDate.model,m)),n=[];$.generating_report=!0,i.forEach(function(i){var a={clientId:$.tsReportClient.id,date:i,geofenseRadius:$.tsReportRadioGeofence,from:e,to:t};n.push(c.getTimeServiceVisits(a))}),c.getReportTimeServiceFromArrayPromises(n).then(function(e){D(e),$.generating_report=!1})["catch"](function(e){a.error(e),$.generating_report=!1})}function C(e,t){for(var i=[],a=o.createTime(e,"YYYY-MM-DD"),n=o.createTime(t,"YYYY-MM-DD");a.isSameOrBefore(n.format("YYYY-MM-DD"));)i.push(a.format("YYYY-MM-DD")),a=a.add(1,"days");return i}function D(e){var t=o.formatTime($.tsReportDate.model,m),i=$.tsReportClient.name,a=[],n=["Fecha","Titulo","Direccion","Checkin","Checkout","Tiempo servicio estimado","Tiempo servicio real","ETA","ETD","Conductor","Vehiculo"];e.forEach(function(e){e.data.forEach(function(e){a.push([e.date,e.title,e.address,e.checkin_time?o.formatTime(e.checkin_time,"YYYY-MM-DDTHH:mm:ss"):null,e.checkout_time?o.formatTime(e.checkout_time,"YYYY-MM-DDTHH:mm:ss"):null,e.estimated_time_service,e.calculated_time_service,e.estimated_time_arrival,e.estimated_time_departure,e.driver_name,e.vehicle_name])})}),P(n,a,t,"Reporte_Tiempo_Servicio_","Plan",i)}function P(e,t,i,a,n,s){var r=o.formatTime(i,m),l={headers:e,data:t},c=p.createWorkbook(n,l),d=p.writeWorkbook(c);a=T(a,r,s),u.downloadXLSX(d,a)}function L(){t.isLoading=!1,$.reportLoading=!1,$.disableReportBtn=!1}function O(e,t,i){return e+o.formatTime(t,m)+"_"+o.formatTime(i,m)}function T(e,t,i){return e=i?e+i+"_"+t.replace(/-/g,"")+".xlsx":e+t.replace(/-/g,"_")+".xlsx"}function V(e,t){for(var i={Sheets:{},SheetNames:[]},a=[H("General.excel_headers_id"),H("General.excel_headers_reference_id"),H("General.excel_headers_planned_date"),H("General.excel_headers_driver"),H("General.excel_headers_vehicle"),H("General.excel_headers_title"),H("General.excel_headers_address"),H("General.excel_headers_eta"),H("General.excel_headers_etd"),H("General.excel_headers_checkin_time"),H("General.excel_headers_checkout_time"),H("General.excel_headers_time_service"),H("General.excel_headers_time_advance"),H("General.excel_headers_time_delay"),H("General.excel_headers_latitude"),H("General.excel_headers_longitude"),H("General.excel_headers_checkout_lat"),H("General.excel_headers_checkout_lng"),H("General.excel_headers_load"),H("General.excel_headers_load_2"),H("General.excel_headers_load_3"),H("General.excel_headers_status"),H("General.excel_headers_comment"),H("General.excel_headers_observation"),H("General.excel_headers_time_windowStart"),H("General.excel_headers_time_windowEnd"),H("General.excel_headers_time_windowStart2"),H("General.excel_headers_time_windowEnd2"),H("General.excel_headers_skills_required"),H("General.excel_headers_skills_optional"),H("General.notes")],n=l.sortDefinition($.extraFields),s=0,o=n.length;o>s;s++){var c=n[s];c.enable&&a.push(n[s].label)}return i.Sheets.Plan=r.sheetFromMatrix([a].concat(e)),i.SheetNames.push("Plan"),r.write(i,t)}function R(e){var t=[];return e.data.map(function(e){var i=!1;e.historic_visits.map(function(e){"pending"!==e.status&&(i=!0,t.push(M(e)))}),i||t.push(M(e))}),t}function M(e){var t,i,a=null,s=null,r=null,c=[],d=[];e.vehicle&&(a=n.find($.vehicles,{id:e.vehicle})),e.driver&&(s=n.find($.drivers,{id:e.driver})),e.checkout_observation&&(r=n.find($.observations,{id:e.checkout_observation}));var u=z(e.planned_date,e.checkout_time,e.estimated_time_departure),p=N(e.checkin_time,e.checkout_time);t=e.skills_required?e.skills_required:null;for(var m=0;m<t.length;m++){var v=n.find($.skills,{id:t[m]});v&&v.skill&&c.push(v.skill)}i=e.skills_optional?e.skills_optional:null;for(var g=0;g<i.length;g++){var h=n.find($.skills,{id:i[m]});h&&h.skill&&d.push(h.skill)}var _=[e.id,e.reference?e.reference:null,e.planned_date?o.todayByDate(o.createTimeUTC(e.planned_date)):null,s?s.name:e.driver,a?a.name:e.vehicle,e.title?e.title:null,e.address?e.address:null,e.estimated_time_arrival?e.estimated_time_arrival:null,e.estimated_time_departure?e.estimated_time_departure:null,e.checkin_time?o.formatTime(e.checkin_time,"YYYY-MM-DDTHH:mm:ss"):null,e.checkout_time?o.formatTime(e.checkout_time,"YYYY-MM-DDTHH:mm:ss"):null,p,u.advance,u.delay,e.latitude?parseFloat(e.latitude):0,e.longitude?parseFloat(e.longitude):0,e.checkout_latitude?parseFloat(e.checkout_latitude):0,e.checkout_longitude?parseFloat(e.checkout_longitude):0,e.load?e.load:0,e.load_2?e.load_2:0,e.load_3?e.load_3:0,e.status,e.checkout_comment?e.checkout_comment:null,r?r.label:null,e.window_start?e.window_start:null,e.window_end?e.window_end:null,e.window_start2?e.window_start2:null,e.window_end2?e.window_end2:null,c.join(","),d.join(","),e.notes];if(angular.isDefined(e.extra_field_values)&&null!==e.extra_field_values)for(var f=angular.fromJson(e.extra_field_values),b=l.sortDefinition($.extraFields),y=0;y<b.length;y++){var w=b[y];if(w.enable){var A=w.key;f.hasOwnProperty(A)?_.push(f[A]):_.push("")}}return _}function z(e,t,i){t=t?t.replace("T"," "):null;var a=o.createTime(e+" "+i),n=o.createTime(t),s={advance:"00:00:00",delay:"00:00:00"};if(o.isValidMoment(a)&&o.isValidMoment(n)){var r=o.newDate(e+" "+i),l=o.getTime(r)-o.getTime(o.todayByDate(n));s={advance:l>0?F(a,n):"00:00:00",delay:0>l?F(n,a):"00:00:00"}}return s}function F(e,t){var i=o.diff(o.createTime(e),o.createTime(t));return o.formatTime(o.createTimeUTC(i),"HH:mm:ss")}function N(e,t){var i=null;if(o.isValidMoment(e)&&o.isValidMoment(t)){var a=o.diff(o.createTime(t),o.createTime(e)),n=o.duration(a),s=Math.floor(o.asHours(n)+o.createTimeUTC(a,":mm:ss"));i=s}return i}var $=this,j=o.today(),B=o.getTime(j),H=i("translate"),U=[],q=[],G={start:null,end:null};$.disableReportBtn=!1,$.visitHistoryReport={},$.visitHistoryReportStart={model:j,opened:!1},$.visitHistoryReportEnd={model:j,opened:!1},$.kilometers_report={},$.kmReportClient=null,$.generating_report=!1,$.kmReportStartDate={model:j,opened:!1},$.kmReportEndDate={model:j,opened:!1},$.kmReportTime={start:null,end:null},$.emailTcReport="",$.tc_report={},$.disableTcReportBtn=!1,$.tcReportStart={model:j,opened:!1},$.tcReportEnd={model:j,opened:!1},$.disableOrReportBtn=!1,$.or_report={},$.enableOptimizationRequestsReport=!1,$.orReportStart={model:j,opened:!1},$.orReportEnd={model:j,opened:!1},$.enableLogReport=!1,$.log_report={},$.logReportClient=null,$.logReportDate={model:j,opened:!1},$.logReportStartDate={model:j,opened:!1},$.logReportEndDate={model:j,opened:!1},$.ts_report={},$.enableTimeServiceReport=!1,$.tsReportClient=null,$.tsReportDate={model:j,opened:!1},$.tsReportStartDate={model:j,opened:!1},$.tsReportEndDate={model:j,opened:!1},$.tsReportRadioGeofence=!1,$.tsReportTime={start:null,end:null},$.clients=[],$.drivers=[],$.vehicles=[],$.observations=[],$.skills=[],$.extraFields=[],$.dateOptions={formatYear:"yyyy",formatDayTitle:"MMMM",formatDay:"dd",showWeeks:!1,maxMode:"day",startingDay:1},$.validateReportDate=y,$.exportVisitHistoryReport=A,$.exportRoutesReport=x,$.exportTcReport=k,$.exportOrReport=I,$.exportLogReport=S,$.exportTimeServiceReport=E,$.loadAllClients=f,$.refreshClients=b,v()}e.$inject=["$scope","$rootScope","$filter","$log","lodash","Toasts","timeUtils","XslxService","extraFieldsService","dashboardReportService","reportService","fileDownloaderService","xlsWriterService","DATE_FORMAT"],angular.module("icarus.dashboard").controller("ReportsController",e)}(),function(){"use strict";function e(e){function t(){e.open({template:"app/dashboard/visits/confirm-modal.html",controller:"ConfirmModalController",controllerAs:"vm"})}var i=this;i.openModalConfirmation=t}var t={templateUrl:"app/dashboard/components/visitsGraphicsModal.html",controller:["ngDialog",e],bindings:{data:"<"}};angular.module("icarus.dashboard").component("visitsGraphicsModal",t)}(),function(){"use strict";function e(e){function t(){n(),s(),o()}function i(){r.formErrors.emailError=!!r.report.$error.email,o()}function a(e,t,i){e.$setTouched(),e.$setDirty(),e.$setValidity(t,i)}function n(){var t=e.validateStartDate(r.reportStart.model,r.reportEnd.model);a(r.report.startDate,"endDate_gt_startDate",t),r.formErrors.startDateError=!t}function s(){if(r.reportEnd.model){var t=e.validateDateRange(r.reportStart.model,r.reportEnd.model,31);a(r.report.startDate,"invalid_dateRange",t),a(r.report.endDate,"invalid_dateRange",t),r.formErrors.dateRangeError=!t}}function o(){r.submitButtonActive=r.report.$valid}var r=this,l=e.today();r.report={},r.dateOptions={formatYear:"yyyy",formatDayTitle:"MMMM",formatDay:"dd",showWeeks:!1,maxMode:"day",startingDay:1},r.reportStart={model:l,opened:!1},r.reportEnd={model:l,opened:!1},r.emailReport="",r.submitButtonActive=!1,r.formErrors={startDateError:!1,dateRangeError:!1,emailError:!1},r.validateDates=t,r.validateEmail=i}var t={templateUrl:"app/dashboard/components/report.html",controller:["timeUtils",e],bindings:{data:"<",onSubmit:"=",loading:"<"}};angular.module("icarus.dashboard").component("report",t)}(),function(){"use strict";function e(){function e(e){t.onChangeView({type:e})}var t=this;t.changeView=e}var t={templateUrl:"app/dashboard/components/pieGraph.html",controller:e,bindings:{data:"<",onChangeView:"&"}};angular.module("icarus.dashboard").component("pieGraph",t)}(),function(){"use strict";function e(){}var t={templateUrl:"app/dashboard/components/indicator.html",controller:e,bindings:{data:"<"}};angular.module("icarus.dashboard").component("indicator",t)}(),function(){"use strict";function e(){}var t={templateUrl:"app/dashboard/components/barGraph.html",controller:e,bindings:{data:"<"}};angular.module("icarus.dashboard").component("barGraph",t)}(),function(){"use strict";function e(){}var t={templateUrl:"app/dashboard/components/areaGraph.html",controller:e,bindings:{data:"<"}};angular.module("icarus.dashboard").component("areaGraph",t)}(),function(){"use strict";angular.module("icarus.authentication",[])}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(){var e=t.use();switch(n.fbq("track","ViewContent"),e){case"es":p.linkToOtherReasons="https://www.simpliroute.com/post/10-razones-para-usar-un-software-optimizador-de-rutas";break;case"pt":p.linkToOtherReasons="https://www.simpliroute.com/postpt/10-razoes-para-utilizar-um-software-de-otimizacao-de-rotas";break;default:p.linkToOtherReasons="https://www.simpliroute.com/en-post/10-reasons-to-use-a-route-planner-software"}o.callGoogleTrackConversion("AawOCMf4k20QndigwgM")}function c(){p.submiting=!0,s.checkUsername(p.user.email).then(function(e){e.data.exist?p.signupForm.signup_email.$error.invalid="Login.existing_user":p.moreData=!0},function(e){(e.data||e.data.username)&&(p.error=!0),p.submiting=!1})}function d(){if("-"===p.user.country)return void(p.moreDataForm.moreData_country.$error.invalid="Error");u();var t={username:p.user.email,email:p.user.email,name:p.user.name,password:p.user.password,phone:p.user.phone,account:{name:p.user.company,country:p.user.country,vehicleQuantity:p.user.vehicle}};p.promiseLoading=s.signUp(t).then(function(){s.login(p.user.email,p.user.password).then(function(){e.go("planner")},function(){a.info("error service login")})},function(e){a.info("error service signup",e.data[0])})}function u(){var e={type:"send",events:{name:"event",category:"signup",action:"submit",label:"Petici√≥n de demo"}};o.sendEventGoogle(e)}var p=this;p.errorMsg=null,p.moreData=!1,p.submiting=!1,p.linkToOtherReasons="",p.user={},p.signup=c,p.saveMoreData=d,p.error=!0,p.quantityVehicle=[{id:5,num:"1 - 5"},{id:10,num:"6 - 10"},{id:20,num:"11 - 20"},{id:20,num:"20"}],l(),i.$watch("vm.user.email",function(){angular.isDefined(p.user.email)&&null!==p.user.email&&(p.user.email=p.user.email.toLowerCase())})}e.$inject=["$state","$translate","$scope","$log","$window","sessionService","marketingService","intercomService"],angular.module("icarus.authentication").controller("SignupController",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(t){var n=i.defer(),s={company_id:null,name:t.company,custom_attributes:{vehicle_number_text:t.vehicle,country:t.country}},r={email:t.email,name:t.name,phone:t.phone,last_seen_ip:"",companies:[s]};return o(s).then(function(t){a.getIP().then(function(i){r.last_seen_ip=i,r.companies[0].company_id=t.data.company_id,e.post(d,r).then(function(e){n.resolve(e)})["catch"](function(e){n.reject(e)})})["catch"](function(e){n.reject(e)})})["catch"](function(e){n.reject(e)}),n.promise}function o(t){return e.post(u,t)}function r(e){n.Intercom("hide"),e.email&&(n.intercomSettings.email=e.email),n.intercomSettings.name=e.name}function l(){delete n.intercomSettings.email,delete n.intercomSettings.name,n.Intercom("shutdown")}function c(){n.Intercom("boot",window.intercomSettings),n.Intercom("show")}var d=t.API_URL+"accounts/intercom-leads/",u=t.API_URL+"accounts/intercom-companies/";return{createLeadIntercom:s,createCompanyIntercom:o,setDataWindowIntercom:r,closeSessionIntercom:l,initChatIntercom:c}}e.$inject=["$http","__env","$q","sessionService","$window"],angular.module("icarus.authentication").factory("intercomService",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){l=i.uid,c=i.token,a.getUser().then(function(){t.go("planner.vehicles")})}function o(i,s){i===s&&(r.submiting=!0,a.passwordResetConfirm(l,c,i).then(function(){r.confirmed=!0,r.success=!0,n(function(){},4e3).then(function(){t.go("auth.login")})},function(t){400===t.status&&(r.confirmed=!0,r.success=!1),e.debug(t)})["finally"](function(){r.submiting=!1}))}var r=this,l=null,c=null;r.success=!1,r.submiting=!1,r.confirmed=!1,r.new_password="",r.new_password_repeat="",r.confirm=o,s()}e.$inject=["$log","$state","$stateParams","sessionService","$timeout"],angular.module("icarus.authentication").controller("PasswordResetConfirmController",e)}(),function(){"use strict";function e(e,t,i,a){function n(){i.getUser().then(function(){t.go("planner.vehicles")})}function s(n){o.submiting=!0,i.passwordReset(n).then(function(){o.reseted=!0,a(function(){},2e3).then(function(){t.go("auth.login")})},function(t){400===t.status&&(o.resetForm.email.$error.invalid=!0),e.debug(t)})["finally"](function(){o.submiting=!1})}var o=this;o.reseted=!1,o.submiting=!1,o.reset=s,n()}e.$inject=["$log","$state","sessionService","$timeout"],angular.module("icarus.authentication").controller("PasswordResetController",e)}(),function(){"use strict";function e(e,t,i,a){function n(){a.clearPlan(),o()}function s(e){function t(){o()}function a(e){400===e.status&&(r.submiting=!1,r.loginForm.password.$error.invalid=!0,r.loginForm.password.$invalid=!0)}r.submiting=!0;var n=e.username.trim();r.promiseLoading=i.login(n,e.password).then(t,a)}function o(){i.getUser().then(function(t){!t.is_monitor||t.is_admin||t.is_owner?t.is_monitor||!t.is_admin&&!t.is_owner?!t.is_driver||t.is_admin||t.is_owner||e.go("uprofile.info"):e.go("planner.vehicles-list"):e.go("tracking")})}var r=this;r.errorMsg=null,r.submiting=!1,r.credentials={},r.login=s,n(),t.$watch("vm.credentials.username",function(){angular.isDefined(r.credentials.username)&&null!==r.credentials.username&&(r.credentials.username=r.credentials.username.toLowerCase())})}e.$inject=["$state","$scope","sessionService","plannerService"],angular.module("icarus.authentication").controller("LoginController",e)}(),function(){"use strict";function e(e,t,i,a){function n(){r.disabledLink=!0,e.resendConfirmationEmail().then(function(){r.mailResend=!0,r.deleteMessage()})["finally"](function(){r.disabledLink=!1})}function s(){e.logout(),a.closeAll(),i.go("auth.login")}function o(){setTimeout(function(){t.$apply(function(){r.mailResend=!1})},2500)}var r=this;r.disabledLink=!1,r.mailResend=!1,r.resendConfirmationEmail=n,r.deleteMessage=o,r.goOut=s}e.$inject=["sessionService","$scope","$state","ngDialog"],angular.module("icarus.authentication").controller("AccountNotConfirmedController",e)}(),function(){"use strict";function e(e,t,i){function a(){r=t.uid,l=t.token,o.confirmAccount(r,l)}function n(t,a){o.showConfirmMessage=!1,e.confirmAccount(t,a,s()).then(function(){o.showConfirmMessage=!0})["catch"](function(e){o.showErrorMessage=!0,i.error(e)})}function s(){var e="en",t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return"es"===t.substring(0,2).toLowerCase()?e="es":"pt"===t.substring(0,2).toLowerCase()&&(e="pt"),e}var o=this,r="",l="";o.showConfirmMessage=!1,o.showErrorMessage=!1,o.confirmAccount=n,a()}e.$inject=["sessionService","$stateParams","$log"],angular.module("icarus.authentication").controller("AccountConfirmedController",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){e.isLoading=!0,a.listAddons().then(function(t){t.forEach(function(e){e.key===m&&e.enable&&(u.checkoutSms.add_on_id=e.id,l(e.id))}),e.isLoading=!1,u.checkoutSms.add_on_id||(u.messageNotSMS=!0)},function(t){i.error("Error get list Addons"),u.messageNotSMS=!0,e.isLoading=!1})}function r(){u.checkoutSms.value&&(e.isLoading=!0,u.checkoutSms.id?a.updateAddonProperty(u.checkoutSms).then(function(){d()},function(e){c(e)}):a.createAddonProperty(u.checkoutSms).then(function(e){d(),u.checkoutSms.id=e.id},function(e){c(e)}))}function l(e){a.getAddonPropertiesByKey(e,m).then(function(e){e&&(u.checkoutSms.key=e.key,u.checkoutSms.title=e.title,u.checkoutSms.value=e.value,u.checkoutSms.description=e.description,u.checkoutSms.add_on_id=e.add_on_id,u.checkoutSms.id=e.id)},function(e){i.info(e)})}function c(t){s.push("error",p("checkout_sms.error_save_sms")),i.error(t),e.isLoading=!1}function d(){e.isLoading=!1,s.push("success",p("checkout_sms.success_message"))}var u=this,p=n("translate"),m="checkout_sms";u.checkoutSms={key:"sms_body",title:p("checkout_sms.title"),description:p("checkout_sms.description")},u.saveSmsCheckout=r,o()}e.$inject=["$rootScope","$state","$log","addonsService","$filter","Toasts"],angular.module("icarus").controller("CheckoutSmsController",e)}(),function(){"use strict";function e(e,t,i){function a(){var t=e.defer();return i.get(u).then(function(e){t.resolve(e.data)},function(e){t.reject(e)}),t.promise}function n(t,a){var n=e.defer();return i.get(p+t+"/property/",{params:a}).then(function(e){n.resolve(e.data[0])},function(e){n.reject(e)}),n.promise}function s(t){var a=e.defer(),n=t.add_on_id;return i.post(p+n+"/property/",t).then(function(e){a.resolve(e.data)},function(e){a.reject(e)}),a.promise}function o(t){var a=e.defer(),n=t.add_on_id,s=t.id;return i.put(p+n+"/property/"+s+"/",t).then(function(e){a.resolve(e.data)},function(e){a.reject(e)}),a.promise}function r(t){var a=e.defer();return d(t).then(function(e){e?i.get(p+t+"/").then(function(e){a.resolve(e.data)})["catch"](function(e){a.reject(e)}):a.reject()})["catch"](function(e){a.reject(e)}),a.promise}function l(t,a){var n=e.defer(),s=[];return a.forEach(function(e){s.push(i.get(p+t+"/property/"+e+"/"))}),e.all(s).then(function(e){n.resolve(e)})["catch"](function(e){n.reject(e)}),n.promise}function c(t,a){var n=e.defer();return i["delete"](p+t+"/property/"+a+"/").then(function(e){n.resolve(e.data)})["catch"](function(e){n.reject(e)}),n.promise}function d(t){var i=e.defer();return a().then(function(e){for(var a=!1,n=0;n<e.length;n++)if(e[n].key===t){a=e[n].enable;break}i.resolve(a)})["catch"](function(e){i.reject(e)}),i.promise}var u=t.API_URL+"addons/addons/",p=t.API_URL+"addons/",m={isAddonEnable:d,listAddons:a,getAddonPropertiesByKey:n,createAddonProperty:s,updateAddonProperty:o,getInfoAddonAndPropertiesByKey:r,deleteProperty:c,getAddonByIdAndPropertiesByKeys:l};return m}e.$inject=["$q","__env","$http"],angular.module("icarus").factory("addonsService",e)}(),function(){"use strict";function e(e){e.state("uprofile",{parent:"main",url:"/uprofile","abstract":!0,controller:"UprofileController",controllerAs:"vm",templateUrl:"app/uprofile/uprofile.html",data:{authentication:!1},redirectTo:"uprofile.info"}).state("uprofile.info",{url:"/info",views:{viewAccount:{controller:"UprofileController",controllerAs:"vm",templateUrl:"app/uprofile/account/account.html"},viewPayment:{controller:"UprofilePaymentController",controllerAs:"vm",templateUrl:"app/uprofile/payment/payment.html"}}}).state("uprofile.info.change-password",{url:"/password",views:{"viewAccount@uprofile":{controller:"UprofileChangePassController",controllerAs:"vm",templateUrl:"app/uprofile/change-password/change-password.html"}}}).state("uprofile.info.add-payment",{url:"/payment",views:{"viewPayment@uprofile":{controller:"UprofilePaymentController",controllerAs:"vm",templateUrl:"app/uprofile/payment/add-payment.html"}}}).state("uprofile.info.confirm-cancel-subscription",{url:"/subscription",onEnter:["$state","$uibModal",function(e,t){t.open({controller:"UprofileSubscriptionController",controllerAs:"vm",templateUrl:"app/uprofile/confirm-cancel-subscription/cancel-subscription.html"}).result["finally"](function(){e.go("^")})}]})}e.$inject=["$stateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e){e.translations("es",{Uprofile:{profile:"Perfil",payment_information:"informaci√≥n de pago",test_will_end:"Tu prueba gratuita terminar√° en",select_payment_method:"Ingresar m√©todo de pago",test_finished:"Tu prueba ha terminado.",select_payment_method_to_continue:"Ingresa un m√©todo de pago para seguir utilizando nuestra aplicaci√≥n.",next_billing:"pr√≥xima facturaci√≥n",next_payment_will_be:"Tu pr√≥ximo pago deber√° ser realizado el",update_payment_method:"Actualizar m√©todo de pago",unpaid_msg:"Usted no ha realizado el √∫ltimo pago, √©ste debe ser realizado antes del",wish:"¬øDeseas",cancel_subscription:"cancelar tu suscripci√≥n?",Payment:{not_payment_method:"No existe un m√©todo de pago asociado",payment_method:"M√©todo de pago",payment_vehicles:"veh√≠culos pagados",card:"tarjeta",due_date:"fecha de expiraci√≥n",edit:"Editar",to_select_plan:"Para seleccionar este plan debes",delete_vehicles:"eliminar veh√≠culos",maxium_vehicles:"M√°ximo permitido de veh√≠culos es 1000",invalid_card_number:"Error: N√∫mero de tarjeta inv√°lido!","due date":"fecha de vencimiento",invalid_expiry:"Error: Expiraci√≥n inv√°lida!",expiration_year_invalid:"Error: El a√±o de expiraci√≥n de tu tarjeta es inv√°lido.!",security_code:"c√≥digo de seguridad",cvc_invalid:"Error: cvc inv√°lido!",discount_code_invalid:"Error: c√≥digo de descuento inv√°lido!",success_msg:"Informaci√≥n guardada exitosamente!!",error_msg:"Error con la tarjeta, por favor intenta nuevamente.",error_coupon_msg:"Error con el c√≥digo de descuento , c√≥digo de descuento no v√°lido!",cancel:"Cancelar",save:"Guardar",discount_code:"C√≥digo de descuento"},Payment_success:{title:"Pago Realizado",msg:"Tu pago se proces√≥ exitosamente!.",accept:"Aceptar"},CCSubscription:{cancel_subscription:"Cancelar suscripci√≥n",really_want_cancel:"¬øDesea realmente cancelar la suscripci√≥n?",close:"Cerrar"},ChangePassword:{title:"Informaci√≥n de tu cuenta",fullname:"nombre completo",email:"email",business:"empresa",country:"pa√≠s",token:"token",actual_password:"contrase√±a actual",actual_password_invalid:"Contrase√±a actual inv√°lida",required_password:"Contrase√±a requerida",too_short_password:"Contrase√±a demasiado corta",too_long_password:"Contrase√±a demasiado larga",new_password:"nueva contrase√±a",repeat_new_password:"repetir nueva contrase√±a",passwords_not_equal:"Las contrase√±as no coinciden, por favor intente de nuevo.",password_changed_successfully:"Su contrase√±a ha sido cambiada exitosamente!",change_password:"Cambiar contrase√±a",cancel:"Cancelar"},Account:{title:"Informaci√≥n de tu cuenta",fullname:"nombre completo",email:"email",business:"empresa",country:"pa√≠s",token:"token",change_password:"Cambiar contrase√±a"}}}),e.translations("en",{Uprofile:{profile:"Profile",payment_information:"payment information",test_will_end:"Your trial account will end in",select_payment_method:"Add your payment information",test_finished:"Your trial period has ended.",select_payment_method_to_continue:"Add your payment information to continue using SimpliRoute",next_billing:"next billing cycle",next_payment_will_be:"You next payment will be charge at",update_payment_method:"Update payment information",unpaid_msg:"You have an overdue payment, this should be paid before",wish:"¬øDo you",cancel_subscription:"want to cancel your subscription?",Payment:{not_payment_method:"No payment method associated to your account",payment_method:"Payment information",payment_vehicles:"paid vehicles",card:"card",due_date:"expiration date",edit:"Edit",to_select_plan:"To choose this plan you have to",delete_vehicles:"delete vehicles",maxium_vehicles:"Max number of vehicles is 1000",invalid_card_number:"Error: Invalid credit card number!","due date":"due date",invalid_expiry:"Error: Invalid expiration date!",expiration_year_invalid:"Error: Invalid expiration year.!",security_code:"Security Code",cvc_invalid:"Error: Invalid CVC!",discount_code_invalid:"Error: Invalid discount code!",success_msg:"Successfully saved information!",error_msg:"Error with your card, please try again.",error_coupon_msg:"Discount code error, invalid discount code!",cancel:"Cancel",save:"Save",discount_code:"Discount code"},Payment_success:{title:"Payment made",msg:"Your payment was processed successfully!.",accept:"Accept"},CCSubscription:{cancel_subscription:"Cancel subscription",really_want_cancel:"Do you want to cancel your subscription?",close:"Close"},ChangePassword:{title:"Account information",fullname:"Fullname",email:"Email",business:"Company name",country:"Country",token:"Api Token",actual_password:"Current password",actual_password_invalid:"Invalid current password",required_password:"Password is required",too_short_password:"Password is too short",too_long_password:"Password is too long",new_password:"new password",repeat_new_password:"Repeat your password",passwords_not_equal:"Passwords don't match, please retype.",password_changed_successfully:"Password updated!",change_password:"Change password",cancel:"Cancel"},Account:{title:"Account information",fullname:"Fullname",email:"Email",business:"Company name",country:"Country",token:"Api Token",change_password:"Change password"}}}),e.translations("pt",{Uprofile:{profile:"Perfil",payment_information:"Informa√ßƒÅo de pagamento",test_will_end:"Seu teste gratuito se encerrar√° em",select_payment_method:"Inserir m√©todo de pagamento",test_finished:"Seu teste terminou.",select_payment_method_to_continue:"Introduza um m√©todo de pagamento para continuar usando nosso aplicativo.",next_billing:"pr√≥ximo faturamento",next_payment_will_be:"Seu pr√≥ximo pagamento deve ser feito o",update_payment_method:"Atualiza√ß√£o m√©todo de pagamento",unpaid_msg:"Voc√™ n√£o ter feito o pagamento final, isso deve ser feito antes",wish:"Deseja",cancel_subscription:"cancelar sua assinatura?",Payment:{not_payment_method:"N√£o existe um m√©todo de pagamento associado",payment_method:"M√©todo de pagamento",payment_vehicles:"ve√≠culos pagos",card:"n√∫mero do cart√£o",due_date:"data de expira√ß√£o",edit:"Editar",to_select_plan:"Para selecionar este plano voc√™ deve",delete_vehicles:"remover ve√≠culos",maxium_vehicles:"M√°xima do ve√≠culo √© de 1000",invalid_card_number:"Erro: n√∫mero de cart√£o inv√°lido!","due date":"data de expira√ß√£o",invalid_expiry:"Erro: data de expira√ß√£o inv√°lido!",expiration_year_invalid:"Erro: O ano de validade do cart√£o √© inv√°lido!",security_code:"c√≥digo de seguran√ßa",cvc_invalid:"Error: c√≥digo de seguran√ßa inv√°lido!",discount_code_invalid:"Error: c√≥digo de desconto inv√°lido!",success_msg:"Informa√ß√µes salvas com sucesso!",error_msg:"Cart√£o de erro, por favor tente novamente.",error_coupon_msg:"Erro com o c√≥digo de desconto, c√≥digo de desconto inv√°lido!",cancel:"Cancelar",save:"Salvar",discount_code:"C√≥digo de cup√£o"},Payment_success:{title:"Pagamento realizado",msg:"O seu pagamento √© processado com sucesso!.",accept:"aceitar"},CCSubscription:{cancel_subscription:"Cancelar assinatura?",really_want_cancel:"Realmente voc√™ deseja cancelar a sua assinatura?",close:"Fechar"},ChangePassword:{title:"Informa√ß√µes de sua conta",fullname:"nome completo",email:"e-mail",business:"empresa",country:"pa√≠s",token:"token",actual_password:"senha atual",actual_password_invalid:"Senha atual inv√°lida",required_password:"senha necess√°ria",too_short_password:"Senha muito curta",too_long_password:"Senha demasiado longo",new_password:"nova senha",repeat_new_password:"repetir nova senha",passwords_not_equal:"Las contrase√±as no coinciden, por favor intente de nuevo.",password_changed_successfully:"Su contrase√±a ha sido cambiada exitosamente!",change_password:"Cambiar contrase√±a",cancel:"Fechar"},Account:{title:"Informa√ß√µes de sua conta",fullname:"nome completo",email:"e-mail",business:"empresa",country:"pa√≠s",token:"token",change_password:"Trocar senha"}}})}e.$inject=["$translateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){i.getUser().then(function(e){l.user=e,"past_due"===e.account.status?l.past_due=a(l.user.account.active_until).add(7,"days").format("LL"):"trialing"===e.account.status?l.trial=a(l.user.account.active_until).fromNow():l.trial=a(l.user.account.active_until).format("LL")},function(e){t.info(e)})}function o(){i.cancelSubscription()["catch"](function(e){t.info(e)})}function r(){e.cancelSubscription=o,n.open({template:"app/uprofile/confirm-cancel-subscription/cancel-subscription.html",scope:e})}var l=this;l.showSubscriptionModal=r,s()}e.$inject=["$scope","$log","sessionService","moment","ngDialog"],angular.module("icarus").controller("UprofileController",e)}(),function(){"use strict";function e(e,t,i){function a(e,t,i,a,n,s){function o(){return r(i.dispatchsId)}function r(e){var t=s.defer();return a.getVisitDetailById(e).then(function(e){a.selectVisit(e),Object.keys(e.extra_field_values).length>0?n.getExtraFields().then(function(i){for(var a={},n=0;n<i.length;n++){var s=i[n].key,o=i[n].label;(e.extra_field_values[s]||i[n].enable)&&(a[o]=null,a[o]=e.extra_field_values[s])}e.extra_field_values=a,t.resolve(e)})["finally"](function(){t.resolve(e)}):t.resolve(e)})["catch"](function(e){t.resolve(null)}),t.promise}var l=t.open({controller:"TrackingDispatchDetailController",controllerAs:"vm",resolve:{visit:o},template:"app/tracking/dispatchs/dispatch-detail.html",className:"ngdialog-theme-default custom-modal-center"});l.closePromise.then(function(){e.go("^",{},{notify:!1})})}e.state("tracking",{parent:"main",url:"/tracking/:trackingDate",params:{trackingDate:t().format(i)},controller:"TrackingController",controllerAs:"vm",templateUrl:"app/tracking/tracking.html",data:{authentication:!0},redirectTo:"tracking.vehicles"}).state("tracking.vehicles",{url:"/vehicles",params:{trackingDate:t().format(i)},views:{"tab-content":{controller:"VehiclesController",controllerAs:"vm",templateUrl:"app/tracking/vehicles/vehicles.html"}}}).state("tracking.all-dispatchs",{url:"/dispatchs",views:{"tab-content":{controller:"TrackingDispatchListController",controllerAs:"vm",templateUrl:"app/tracking/dispatchs/all-dispatchs.html"}}}).state("tracking.all-dispatchs.detail",{url:"/:dispatchsId",onEnter:["$state","ngDialog","$stateParams","trackingService","extraFieldsService","$q",a.bind(this)]}).state("tracking.vehicles.driver-dispatchs",{url:"/{vehicleId:int}/:driverId",views:{"item-detail@tracking":{controller:"TrackingDriverDispatchListController",controllerAs:"vm",templateUrl:"app/tracking/dispatchs/driver-dispatchs.html"}}}).state("tracking.vehicles.driver-dispatchs.detail",{url:"/:dispatchsId",params:{planId:null,routeId:null},onEnter:["$state","ngDialog","$stateParams","trackingService","extraFieldsService","$q",a.bind(this)]}).state("tracking.events",{url:"/events",params:{trackingDate:t().format(i)},views:{"tab-content":{controller:"EventsController",controllerAs:"vm",templateUrl:"app/tracking/events/events.html"}}}).state("tracking.events.detail",{url:"/:dispatchsId",onEnter:["$state","ngDialog","$stateParams","trackingService","extraFieldsService","$q",a.bind(this)]
})}e.$inject=["$stateProvider","moment","DATE_FORMAT"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e){e.translations("es",{Tracking:{vehicles:"Veh√≠culos",without_pictures:"NO HAY IM√ÅGENES ADJUNTAS",download_pictures:"Descargar adjuntos",show_dispatchs:"ver todos los <br> despachos",hide_dispatchs:"ocultar <br> despachos",error_data:"OH!",error_data_1:"Hubo un problema al consultar la informaci√≥n del d√≠a. <br>",error_data_2:"Por favor recargue la p√°gina web.",tracking:"Seguimiento",visits:"Visitas",events:"Eventos",route:"ruta",active_vehicles:"activos",inactive_vehicles:"inactivos",order_by:"ordenar por",eta_tooltip:"Hora Programada",checkout_time_tooltip:"Hora Checkout"},Indicators:{date_title:"fecha",alerts_title:"alertas",alerts_message:"Atenci√≥n urgente",progress_bar:"progreso de despachos",date_submit_button_title:"Filtrar",date_reset_button_title:"Resetear"},Visits:{visits:"Despachos",search:"Buscar",visits_failed:"Despachos no entregados",create_route:"Crea una ruta",without_visits_title:"No existen visitas <br> programadas para la fecha <br> seleccionada",without_visits_message:"para asignarle despachos a los veh√≠culos.",without_visits_filter:"Despacho no encontrado",without_visits_filter_message:"Su b√∫squeda no gener√≥ resultados, por favor intente nuevamente.",modal_title_visit_failed:"Despacho no entregado",modal_title_visit_completed:"Despacho entregado",modal_title_visit_canceled:"Despacho cancelado",modal_title_visit_pending:"Despacho pendiente por entregar",modal_body_visit_location:"Ubicaci√≥n",modal_body_visit_date:"Fecha",modal_body_visit_info:"Informaci√≥n de despacho",modal_body_visit_estimated_time:"Hora estimada",modal_body_visit_check_in:"Check In",modal_body_visit_check_out:"Check Out",modal_body_visit_time_service:"Tiempo de servicio",modal_body_visit_comments:"Comentarios",modal_body_visit_observations:"Motivos",modal_body_visit_time_window:"Ventanas Horarias",modal_time_window_to:"a",modal_time_window_since:"Desde las",modal_time_window_until_to:"Hasta las",modal_checkout_pending:"Despacho pendiente por entregar",modal_body_visit_load:"Carga",modal_body_visit_load_2:"Carga 2",modal_body_visit_load_3:"Carga 3",show_extra_fields:"Ver m√°s",hide_extra_fields:"Ocultar",extra_fields_value:"Informaci√≥n adicional de despacho",notes:"Notas",pending_checkout:"Esta visita a√∫n no se ha completado",not_checkout:"Visita sin datos GPS",attach:"Adjuntos",map:"Mapa",custom_alerts:"Alertas personalizadas"},Driver:{driver:"Conductor",driver_without_routes:"conductor sin rutas",without_assigned_driver:"sin conductor asignado"},Vehicle:{vehicle:"Veh√≠culo",create_vehicle:"Por favor",without_vehicle_title:"No existen veh√≠culos con <br> rutas para la fecha <br> seleccionada.",without_vehicle_message:"crea tu primer veh√≠culo",vehicle_without_routes:"Veh√≠culo sin ruta asignada",vehicle_without_routes_message:"para asignarle despachos a este veh√≠culo.",vehicle_filter_empty_results:"Veh√≠culo no encontrado",vehicle_filter_empty_results_message:"Su b√∫squeda no gener√≥ resultados, <br> por favor intente nuevamente."},Info:{unavailable_tracking:"Seguimiento no disponible",no_day_routes:"No hay rutas creadas para la fecha.",please:"Por favor",select_other_date:"selecciona otra fecha",or:"o",create_route:"crea una ruta",actives:"Activos"},Tracking_toast:{error_get_map:"Error obteniendo el mapa, Por favor revisar opciones del mapa",error_get_options_map_1:"Error en sintaxis del mapa.",error_get_options_map_2:"Error mapa no encontrado.",error_vehicle_not_found:"Error: veh√≠culo no encontrado",error_get_data_server:"Error: obteniendo informaci√≥n del servidor",error_visit_not_found:"Error: visita no encontrada"},Events:{without_events_title:"A√∫n no se han generado <br> eventos",completed:"exitosa",failed:"fallida",window_broken:"fuera de ventana horaria",file_attached:"archivo adjunto",visit:"Visita",route_started:"inici√≥ ruta",route_finished:"termin√≥ ruta"}}),e.translations("en",{Tracking:{vehicles:"Vehicles",without_pictures:"NO ATTACHED IMAGES",download_pictures:"Download",show_dispatchs:"see all <br> visits",hide_dispatchs:"hide <br> visits",error_data:"OH!",error_data_1:"There was a problem getting information day. <br>",error_data_2:"Please reload the website.",tracking:"Tracking",visits:"Visits",events:"Events",route:"route",active_vehicles:"actives",inactive_vehicles:"inactives",order_by:"order by",eta_tooltip:"Estimated Time",checkout_time_tooltip:"Checkout Time"},Indicators:{progress_bar:"progress of dispatches",alerts_title:"alerts",alerts_message:"Urgent attention",date_title:"date",date_submit_button_title:"Filter",date_reset_button_title:"Reset"},Visits:{visits:"Visits",search:"Search",visits_failed:"Undelivered dispatches",create_route:"Create route",without_visits_title:"There are no visits <br> scheduled for the <br> selected date",without_visits_message:"to assign dispatches to vehicles.",without_visits_filter:"Dispatch Not Found",without_visits_filter_message:"Please check your search and try again",modal_title_visit_failed:"Dispatch undelivered",modal_title_visit_completed:"Dispatch delivered",modal_title_visit_canceled:"Dispatch canceled",modal_title_visit_pending:"Dispatch pending delivery",modal_body_visit_location:"Location",modal_body_visit_date:"Date",modal_body_visit_info:"Information dispatch",modal_body_visit_estimated_time:"Estimated time",modal_body_visit_check_in:"Check In",modal_body_visit_check_out:"Check Out",modal_body_visit_time_service:"Time Service",modal_body_visit_comments:"Comments",modal_body_visit_observations:"Observations",modal_body_visit_time_window:"Time windows",modal_time_window_to:"to",modal_time_window_since:"since",modal_time_window_until_to:"until to",modal_checkout_pending:"Dispatch still undelivered",modal_body_visit_load:"Load",modal_body_visit_load_2:"Load 2",modal_body_visit_load_3:"Load 3",show_extra_fields:"See more",hide_extra_fields:"Hide",extra_fields_value:"Additional dispatch information",notes:"Notes",pending_checkout:"This visit has not yet been completed",not_checkout:"Visit without GPS data",attach:"Attached",map:"Map",custom_alerts:"Custom alerts"},Driver:{driver:"Driver",driver_without_routes:"Driver Without Routes",without_assigned_driver:"Without Assigned Driver"},Vehicle:{vehicle:"Vehicle",create_vehicle:"Please",without_vehicle_title:"There are no vehicles with <br> routes for the <br> selected date.",without_vehicle_message:"Create your first vehicle",vehicle_without_routes:"Vehicles without assigned route",vehicle_without_routes_message:"to assign dispatches to this vehicle.",vehicle_filter_empty_results:"Vehicle not found",vehicle_filter_empty_results_message:"Please check your search and try again"},Info:{unavailable_tracking:"Tracking unavailable",no_day_routes:"There are no routes created to date.",please:"Please",select_other_date:"select another date",or:"or",create_route:"create a route."},Tracking_toast:{error_get_options_map_1:"Error: Syntax map, Please review options map",error_get_options_map_2:"Error: map not found.",error_get_map:"Error getting the map.",error_vehicle_not_found:"Error: vehicle not found",error_get_data_server:"Error: getting server information",error_visit_not_found:"Error: visit not found"},Events:{without_events_title:"No events yet <br> generated",completed:"successful",failed:"failed",window_broken:"outside time window",file_attached:"attached file",visit:"Visit",route_started:"started route",route_finished:"ended route"}}),e.translations("pt",{Tracking:{vehicles:"Ve√≠culos",without_pictures:"N√ÉO H√Å IMAGENS ANEXADAS",download_pictures:"Baixar anexos",show_dispatchs:"ver todas as <br> entregas",hide_dispatchs:"ocultar <br> entregas",error_data:"OH!",error_data_1:"H√° um problema ao visualizar as informa√ß√µes do dia. <br>",error_data_2:"Por favor, atualize o site.",visits:"Entregas",tracking:"Rastreamento",events:"Eventos",route:"rota",active_vehicles:"ativos",inactive_vehicles:"inativos",order_by:"ordenar por",eta_tooltip:"Hor√°rio Agendado",checkout_time_tooltip:"Tempo de Visita"},Indicators:{date_title:"Data",alerts_title:"aten√ß√£o",alerts_message:"atendimento de urg√™ncia",progress_bar:"progresso de entregas",date_submit_button_title:"Filtro",date_reset_button_title:"Remover"},Visits:{visits:"Entregas",search:"Busca",visits_failed:"Entregas n√£o realizadas",create_route:"Crie uma rota",without_visits_title:"N√£o h√° entregas <br> marcadas para a data <br> selecionada",without_visits_message:"para atribuir entregas para a ve√≠culos.",without_visits_filter:"Entrega n√£o encontrado",without_visits_filter_message:"A sua pesquisa n√£o gerou resultados, por favor tente novamente.",modal_title_visit_completed:"Entrega realizada",modal_title_visit_canceled:"Entrega cancelada",modal_title_visit_pending:"Entrega pendente",modal_title_visit_failed:"Entrega n√£o realizada",modal_body_visit_location:"Localiza√ß√£o",modal_body_visit_date:"Data",modal_body_visit_info:"Informa√ß√µes da entrega",modal_body_visit_estimated_time:"Hora prevista",modal_body_visit_check_in:"Check In",modal_body_visit_check_out:"Check Out",modal_body_visit_time_service:"Tempo de servi√ßo",modal_body_visit_comments:"Coment√°rios",modal_body_visit_observations:"Observa√ß√£o",modal_body_visit_time_window:"Janelas de hor√°rio",modal_time_window_to:"a",modal_time_window_since:"Das",modal_time_window_until_to:"√†s",modal_checkout_pending:"Entre ainda n√£o realizada",modal_body_visit_load:"Carga",modal_body_visit_load_2:"Carga 2",modal_body_visit_load_3:"Carga 3",show_extra_fields:"Ver mais",hide_extra_fields:"esconder",extra_fields_value:"Informa√ß√µes adicionais de entregas",notes:"Notas",pending_checkout:"Esta visita ainda n√£o foi conclu√≠da",not_checkout:"Visita sem dados GPS",attach:"Anexos",map:"Mapa",custom_alerts:"Alertas personalizados"},Driver:{driver:"Motorista",driver_without_routes:"condutor sem rotas",without_assigned_driver:"sem motorista atribu√≠do"},Vehicle:{vehicle:"Ve√≠culo",create_vehicle:"Por favor",without_vehicle_title:"N√£o h√° ve√≠culos com <br> rotas para a data <br> selecionada.",without_vehicle_message:"criar o seu primeiro ve√≠culo",vehicle_without_routes:"Ve√≠culo sem rota atribu√≠da",vehicle_without_routes_message:"para atribuir entregas para este ve√≠culo.",vehicle_filter_empty_results:"Ve√≠culo n√£o encontrado",vehicle_filter_empty_results_message:"A sua pesquisa n√£o gerou resultados, <br> por favor tente novamente."},Info:{unavailable_tracking:"Seguimiento no disponible",no_day_routes:"N√£o h√° rotas criadas at√© √† data.",please:"Por favor",select_other_date:"selecione outra data",or:"o",create_route:"cria uma rota"},Tracking_toast:{error_get_options_map_1:"Erro ao carregar o mapa",error_get_options_map_2:"Erro: Mapa n√£o encontrado",error_get_map:"Erro ao obter o mapa.",error_vehicle_not_found:"Erro: Ve√≠culo n√£o encontrado",error_get_data_server:"Erro: Ve√≠culo n√£o encontrado",error_visit_not_found:"Erro: entrega n√£o encontrada"},Events:{without_events_title:"Ainda n√£o foram gerados <br> eventos",completed:"bem sucedido",failed:"fracassado",window_broken:"fora da janela de tempo",file_attached:"arquivo anexo",visit:"Entrega",route_started:"come√ßado rota",route_finished:"terminou rota"}})}e.$inject=["$translateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y){function w(){var e;m.fbq("track","ViewContent"),t.isLoading=!0,e=v.getGeneralProgress(ke),t.trackingDate=n.trackingDate,ae().then(function(){g.all([e,ie()]).then(function(e){W(e[0].data),Q()})["catch"](function(){i.warn("Error getting visit progress")})["finally"](function(){t.isLoading=!1})})["catch"](function(e){i.error(e)}),l.loadMap(),S(),r.callGoogleTrackConversion("-23ECMDsmG0QndigwgM")}function A(e){var i=s(e),o=i.format(_);Ae.showDate=i.format("LL"),t.isLoading=!0,t.trackingDate=o,n.trackingDate=o,D(),l.clearData(),H(),a.go("tracking",n)}function x(e){var t={vehicleId:e.id,driverId:e.driver instanceof Object?e.driver.id:null};H(),l.selectVehicle(e),a.go("tracking.driver-dispatchs",t)}function k(){return h(E,1e3*we)}function I(e){return e.total?Math.round((e.completed+e.failed)/e.total*100):0}function S(){c.getMapOptions().then(function(e){Ae.map=e;try{Ae.mapInstance=p.createMap(document.getElementById("map"),Ae.map.options),l.setMap(Ae.mapInstance),Ae.mapInstance.setCenter(p.getGoogleMapsLatLng(Ae.map.center.latitude,Ae.map.center.longitude)),t.$broadcast("mapLoaded"),p.googleMapsEventTrigger(Ae.mapInstance,"resize"),Ae.mapInstance.setCenter(p.getGoogleMapsLatLng(Ae.map.center.latitude,Ae.map.center.longitude)),b.instanciateInfoWindow(),G()}catch(a){i.info(a),u.push("error",xe("Tracking_toast.error_get_map"))}},function(e){i.info(e),e.message&&u.push("error",xe("Toast.error_get_options_map_1")),404===e.status&&u.push("error",xe("Toast.error_get_options_map_2"))})}function E(){Ae.refreshCount++;var t=n.trackingDate;oe(null,{date:t,fitboundsFlag:!1}),v.getGeneralProgress(t).then(function(i){var a={totalVisitsSuccess:Ae.totalVisitsSuccess,visitProgress:Ae.visitProgress,totalVisits:Ae.totalVisits,totalCustomAlerts:Ae.totalCustomAlerts,totalCheckoutFailedAlert:Ae.totalCheckoutFailedAlert};W(i.data);var n={totalVisitsSuccess:Ae.totalVisitsSuccess,visitProgress:Ae.visitProgress,totalVisits:Ae.totalVisits,totalCustomAlerts:Ae.totalCustomAlerts,totalCheckoutFailedAlert:Ae.totalCheckoutFailedAlert};P(a,n)&&e.$broadcast(f.REFRESH.GENERAL_PROGRESS_CHANGED,{date:t})},function(){i.warn("Error getting visit progress")})}function C(){h.cancel(Ae.interval)}function D(){C(),R(),B(),Ce={},t.trackingVehicles=null}function P(e,t){return e.totalVisitsSuccess!==t.totalVisitsSuccess||e.visitProgress!==t.visitProgress||e.totalVisits!==t.totalVisits||e.totalCustomAlerts!==t.totalCustomAlerts||e.totalCheckoutFailedAlert!==t.totalCheckoutFailedAlert}function L(e,t,n){var s;n=void 0===n||n;var o=t.length>0;o&&(Ae.mapInstance?(t.forEach(function(e){var t;if(s=e.id.toString(),Ae.markers[s])b.updateMarker(Ae.mapInstance,Ae.markers[s],e);else try{t=b.createMarker(Ae.mapInstance,e),t.addListener("click",function(){a.go("tracking.vehicles.driver-dispatchs.detail",{dispatchsId:this.id},{notify:!1})}.bind(t)),Ae.markers[s]=t}catch(n){i.error(n)}}),n&&(H(),b.fitBoundsToMarkers(Ae.mapInstance,De,Ae.markers))):i.error("Map could't be instantiate"))}function O(e,t){if(t=void 0===t||t,Ae.mapInstance){for(var i in e){var n=parseFloat(e[i].latitude),s=parseFloat(e[i].longitude);e[i].marker?(e[i].marker.setMap(Ae.mapInstance),e[i].marker.setPosition({lat:n,lng:s})):(e[i].marker=b.createVehicleMarker(Ae.mapInstance,e[i]),e[i].marker.addListener("click",function(){a.go("tracking.vehicles.driver-dispatchs",{vehicleId:this.vehicleId,driverId:this.driverId})}.bind(e[i].marker)))}t&&b.fitBoundsToVehicleMarkers(Ae.mapInstance,De,e)}}function T(e,t,a,s){var o=n.trackingDate,r=a?a.id:null,c=t?t.id:null,d=c+"-"+r;s=void 0===s||s,l.getLocationsByVehicleOrDriver(o,c,r).then(function(e){var i,n;Ae.allDriverPositions=e.data,pe()?(Ae.driverPositions=le(),n=y.calculatePolylines(Ae.driverPositions)):n=y.calculatePolylines(Ae.allDriverPositions),Ae.polylines[d]?b.updatePolyline(Ae.mapInstance,Ae.polylines[d],n,t.color,a):(i=b.createPolyline(Ae.mapInstance,n,t.color,a),i.length>0&&(Ae.polylines[d]=i)),s&&b.fitBoundsToPolylines(Ae.mapInstance,De,Ae.polylines)},function(e){i.error(e)})}function V(e,t,n){var s;n=void 0===n||n,Ae.mapInstance&&t&&t.length<=500?(t.forEach(function(e){var t;if(s=e.id.toString(),Ae.allMarkerVisits[s])e.visible=ve(e),b.updateMarker(Ae.mapInstance,Ae.allMarkerVisits[s],e);else try{t=b.createMarker(Ae.mapInstance,e,!1),t.addListener("click",function(){a.go("tracking.all-dispatchs.detail",{dispatchsId:this.id})}.bind(t)),Ae.allMarkerVisits[s]=t}catch(n){i.error(n)}}),n&&(H(),b.fitBoundsToMarkers(Ae.mapInstance,De,Ae.allMarkerVisits))):i.error("Map could't be instantiate")}function R(){for(var e in Ce){var t=Ce[e].marker;t&&t.setMap(null)}}function M(e,t,i,a,n){z()}function z(e){for(var t in Ce){var i=Ce[t].marker;i&&i.setVisible(!0)}}function F(){b.clearMarkers(Ae.markers)}function N(){H();for(var e in Ae.allMarkerVisits)Ae.allMarkerVisits[e].setVisible=!1,Ae.allMarkerVisits[e].setMap(null),delete Ae.allMarkerVisits[e]}function $(){H();for(var e in Ce){var t=Ce[e].marker;t&&(t.setVisible=!1,t.setMap(null),delete Ce[e])}}function j(){b.hideAllMarkers(Ae.markers)}function B(e){b.clearPolylines(Ae.polylines)}function H(){De={bounds:null}}function U(e){var t=null;t=e.vehicleId?e.vehicleId:e.driverId,Ce[t]?(Ce[t].timeStamp=e.timeStamp,Ce[t].latitude=e.latitude,Ce[t].longitude=e.longitude):Ce[t]=e}function q(e,t){v.getVehicleById(e.id).then(function(e){t.vehicleId=e.id,t.nameVehicle=e.name,t.color=e.color,U(t)})}function G(){var e=p.getLatLngBounds();if(a.includes("tracking.all-dispatchs")||a.includes("tracking.all-dispatchs.detail")){for(var t in Ce)Ce.hasOwnProperty(t)&&(Ce[t].getMap()||(Ce[t].setMap(Ae.mapInstance),Ce[t].marker&&e.bounds.extend(Ce[t].marker.getPosition())));for(var i in Ae.allMarkerVisits)Ae.allMarkerVisits.hasOwnProperty(i)&&(Ae.allMarkerVisits[i].getMap()||(Ae.allMarkerVisits[i].setMap(Ae.mapInstance),e.bounds.extend(Ae.allMarkerVisits[i].getPosition())))}else if(a.includes("tracking.driver-dispatchs")||a.includes("tracking.driver-dispatchs.detail")){var n=null;Ce.hasOwnProperty(a.params.driverId)?n=a.params.driverId:Ce.hasOwnProperty(a.params.vehicleId)&&(n=a.params.vehicleId,Ae.markers[i].setMap(Ae.mapInstance),e.bounds.extend(Ae.allMarkerVisits[i].getPosition()))}n&&Ce[n]&&!Ce[n].getMap()&&(Ce[n].setMap(Ae.mapInstance),Ce[n].marker&&e.bounds.extend(Ce[n].marker.getPosition()));for(var i in Ae.markers){Ae.markers.hasOwnProperty(i)&&!Ae.markers[i].getMap();for(var s in Ae.polylines)Ae.polylines.hasOwnProperty(s)&&(Ae.polylines[s].getMap()||(Ae.polylines[s].setMap(Ae.mapInstance),Ae.polylines[s].forEach(function(t){t.getPath().forEach(function(t){e.bounds.extend(t)})})))}e.bounds&&Ae.mapInstance.fitBounds(e.bounds)}function J(){var e=a.current.name;if("tracking"===e||"tracking.all-dispatchs"===e)Y(!0);else if("tracking.driver-dispatchs"===e){var t=a.params.driverId,i=a.params.vehicleId;for(var n in Ce)Ce[n].marker&&(String(n)===String(i)||String(n)===String(t)?Ce[n].marker.setVisible(!0):Ce[n].marker.setVisible(!1))}}function Y(e){for(var t in Ce)Ce[t].marker&&Ce[t].marker.setVisible(e)}function W(e){Ae.visitProgress=I(e),Ae.totalVisitsAlerts=parseInt(e.alerts)+parseInt(e.failed),Ae.totalCustomAlerts=e.alerts,Ae.totalCheckoutFailedAlert=e.failed,Ae.totalVisits=e.total,Ae.totalVisitsSuccess=e.completed,Ae.totalVisitsDone=e.completed+e.failed}function Q(){s(n.trackingDate).isSame(s(),"day")?Ae.interval=k():C()}function Z(t,i){e.$broadcast(f.REFRESH.CHANGE_VEHICLE_SELECTED,i)}function K(e,t){var i=t.markers,n=t.fitboundsFlag;i.forEach(function(e){if(U(e),e.withoutRoute){var t={timeStamp:e.timestamp,latitude:e.latitude,longitude:e.longitude};q(t,e)}}),O(Ce,n),a.includes("tracking.vehicles.driver-dispatchs")||X(),J(),_e(f.VEHICLES.RETURN_VEHICLE_DRIVER_ACTIVE,{})}function X(){for(var e in Ce)Ce[e].marker&&Ce[e].marker.setVisible(!0)}function ee(e,t){var i=[];t.forEach(function(e){Ae.allMarkerVisits[e.id]&&i.push(Ae.allMarkerVisits[e.id])}),H(),b.fitBoundsToMarkers(Ae.mapInstance,De,i)}function te(){H(),b.fitBoundsToVehicleMarkers(Ae.mapInstance,De,Ce)}function ie(){var a=t.trackingDate;v.getVehiclesWithRoutesByDate(a).then(function(t){ne(t),e.$broadcast(f.VEHICLES.VEHICLES_READY,{date:a})},function(e){i.error(e)})}function ae(){return v.getAllVehicles().then(function(e){ne(e)},function(e){i.error(e)})}function ne(e){t.trackingVehicles||(t.trackingVehicles=[]),e.forEach(function(e){for(var i=!1,a=0;a<t.trackingVehicles.length;a++)if(t.trackingVehicles[a].id===e.id){o.merge(t.trackingVehicles[a],e),i=!0;break}i||(t.trackingVehicles.push(e),t.trackingVehiclesColor[e.id]=e.color)})}function se(e){t.trackingVehicles||(t.trackingVehicles=[]);for(var i=!1,a=0;a<t.trackingVehicles.length;a++)if(t.trackingVehicles[a].id===e.id){i=!0;break}i||(t.trackingVehicles.push(e),t.trackingVehiclesColor[e.id]=e.color)}function oe(e,i){var a=i.date,n=i.fitboundsFlag;l.loadLastVehicleLocationByDate(a).then(function(e){var i=e.data,a=!0,s=[];i.forEach(function(e){a=!0;for(var i={driverId:null,vehicleId:null,nameVehicle:null,timeStamp:e.timestamp,latitude:e.latitude,longitude:e.longitude,color:null,marker:null,withoutRoute:!0,type:e.type},n=0;n<t.trackingVehicles.length;n++){var o=t.trackingVehicles[n];if(o.id===e.id||o.driver&&o.driver.id===e.id){t.trackingVehicles[n].isActive=!0,i.nameVehicle=o.name,i.color=o.color,i.vehicleId=o.id,o.driver&&(i.driverId=o.driver.id);var r=ye(o,i,s);(r.length>0&&(e.type===r.type||e.type!==r.type&&e.type!==Ie)||0===r.length)&&(i.withoutRoute=!1,s.push(i),a=!1,Ae.lastLocationVehicleOrDriver.push(i));break}}a&&"simpli"!==e.type&&v.getVehicleById(e.id).then(function(e){e.isActive=!0,se(e)})}),K(f.MAP.DRAW_VEHICLES_LAST_POSITION,{markers:s,fitboundsFlag:n})})}function re(e,t){var i=t.visitIds.map(function(e){return String(e)}),a=Object.keys(Ae.markers).length>0?Ae.markers:Ae.allMarkerVisits;for(var n in a)-1!==i.indexOf(n)?b.updateMarker(Ae.mapInstance,a[n],{visible:!0}):b.updateMarker(Ae.mapInstance,a[n],{visible:!1})}function le(){var e=s(Ae.timeSlider.min,"HH:mm"),t=s(Ae.timeSlider.max,"HH:mm");return o.filter(Ae.allDriverPositions,function(i){var a=s(i.timestamp).format("HH:mm"),n=s(a,"HH:mm");return n.isBetween(e,t,null,"[]")})}function ce(){var t={startDate:Ae.timeSlider.min,endDate:Ae.timeSlider.max};e.$broadcast(f.VISITS.FILTER_VISIT_MARKERS_BY_TIME,t),e.$broadcast(f.MAP.FILTER_POLYLINES_BY_TIME,t),e.$broadcast(f.VEHICLES.GET_VEHICLE_DRIVER_ACTIVE),Ae.isFilterActive=!0,Ae.trackingDateFilterOpened=!1}function de(){Ae.timeSlider.min=Se,Ae.timeSlider.max=Ee;var t={startDate:Ae.timeSlider.min,endDate:Ae.timeSlider.max};e.$broadcast(f.VISITS.FILTER_VISIT_MARKERS_BY_TIME,t),e.$broadcast(f.MAP.FILTER_POLYLINES_BY_TIME),fe(),Ae.isFilterActive=!1,Ae.trackingDateFilterOpened=!1}function ue(e,t,i){var a,n;pe()?(Ae.driverPositions=le(),n=y.calculatePolylines(Ae.driverPositions)):n=y.calculatePolylines(Ae.allDriverPositions),b.clearPolylines(Ae.polylines),a=b.createPolyline(Ae.mapInstance,n,e.color,t),a.length>0&&(Ae.polylines[i]=a)}function pe(){return Ae.timeSlider.min!==Se||Ae.timeSlider.max!==Ee}function me(){if(Ae.timeSlider.min!==Se||Ae.timeSlider.max!==Ee){var t={startDate:Ae.timeSlider.min,endDate:Ae.timeSlider.max};e.$broadcast(f.VISITS.FILTER_VISIT_MARKERS_BY_TIME,t)}}function ve(e){var t=s(Ae.timeSlider.min,"HH:mm"),i=s(Ae.timeSlider.max,"HH:mm"),a=s(e.estimated_time_arrival,"HH:mm");return a.isBetween(t,i,null,"[]")}function ge(){Ae.timeSlider.min=Se,Ae.timeSlider.max=Ee,Ae.trackingDateFilterOpened=!1,Ae.isFilterActive=!1}function he(e,t,i){var a=i?i.id:null,n=t?t.id:null,s=n+"-"+a;ue(t,i,s)}function _e(e,t){var i=l.filterVehicleLastPosition(Ae.lastLocationVehicleOrDriver,Ae.timeSlider.min,Ae.timeSlider.max);t&&(t.vehicleId||t.driverId)&&(Ae.driverActive=parseInt(t.driverId),Ae.vehicleActive=parseInt(t.vehicleId),Ae.viewVehicleActive=!0),b.hideAllMarkersLastPosition(Ce),i.forEach(function(e){Ae.viewVehicleActive?(Ce[e.driver]&&Ce[e.driver].marker&&e.driver===Ae.driverActive&&Ce[e.driver].marker.setVisible(!0),Ce[e.vehicle]&&Ce[e.vehicle].marker&&e.vehicle===Ae.vehicleActive&&Ce[e.vehicle].marker.setVisible(!0)):(Ce[e.driver]&&Ce[e.driver].marker&&Ce[e.driver].marker.setVisible(!0),Ce[e.vehicle]&&Ce[e.vehicle].marker&&Ce[e.vehicle].marker.setVisible(!0))})}function fe(){var e=parseInt(Ae.driverActive),t=parseInt(Ae.vehicleActive);Ce[t]?Ce[t].marker.setVisible(!0):Ce[e]?Ce[e].marker.setVisible(!0):z()}function be(){Ae.driverActive=null,Ae.vehicleActive=null,Ae.viewVehicleActive=null}function ye(e,t,i){var a=[];return a=t.driverId?i.filter(function(t){return t.vehicleId===e.id&&t.driverId===e.driver.id}):i.filter(function(t){return t.vehicleId===e.id})}var we=60,Ae=this,xe=d("translate"),ke=n.trackingDate,Ie="simpli",Se="00:00",Ee="23:59",Ce={};Ae.markers={},Ae.polylines={},Ae.allMarkerVisits={},Ae.driverPositions=[],Ae.allDriverPositions=[];var De={bounds:null};Ae.driverActive=null,Ae.vehicleActive=null,t.isLoading=!0,t.trackingVehicles=[],t.trackingVehiclesColor={},Ae.totalVisitsDone=0,Ae.totalVisitsSuccess=0,Ae.totalVisits=0,Ae.visitProgress=0,Ae.totalVisitsAlerts=0,Ae.totalCustomAlerts=0,Ae.totalCheckoutFailedAlert=0,Ae.state=a,Ae.locations={},Ae.locationsArray={},Ae.refreshCount=0,Ae.loadingData=!1,Ae.interval=null,Ae.$stateParams=n,Ae.showDate=s(ke).format("LL"),Ae.date=s(ke),Ae.mapInstance=null,Ae.dateOptions={formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM",formatDay:"d",showWeeks:!1,startingDay:0},Ae.trackingDateFilterOpened=!1,Ae.popupOpened=!1,Ae.timeSlider={min:Se,max:Ee,options:{hideLimitLabels:!0,pushRange:!0,stepsArray:[{value:"00:00"},{value:"01:00"},{value:"02:00"},{value:"03:00"},{value:"04:00"},{value:"05:00"},{value:"06:00"},{value:"07:00"},{value:"08:00"},{value:"09:00"},{value:"10:00"},{value:"11:00"},{value:"12:00"},{value:"13:00"},{value:"14:00"},{value:"15:00"},{value:"16:00"},{value:"17:00"},{value:"18:00"},{value:"19:00"},{value:"20:00"},{value:"21:00"},{value:"22:00"},{value:"23:59"}]}},Ae.lastLocationVehicleOrDriver=[],Ae.dateChanged=A,Ae.openListVehicleDriver=x,Ae.applyTimeFilter=ce,Ae.resetTimeFilter=de,Ae.isFilterActive=!1,w(),e.$on(f.MAP.DRAW_VISITS,L),e.$on(f.MAP.DRAW_ROUTE_POLYLINE,T),e.$on(f.MAP.DRAW_ALL_VISITS,V),e.$on(f.MAP.CLEAR_MARKERS,F),e.$on(f.MAP.HIDE_MARKERS,j),e.$on(f.MAP.CLEAR_POLYLINES,B),e.$on(f.MAP.CLEAR_ALL_VISITS,N),t.$on(f.MAP.DRAW_VEHICLES_LAST_POSITION,K),t.$on(f.MAP.FIT_BOUNDS_VEHICLES_LAST_POSITION,te),e.$on(f.MAP.CLEAR_VEHICLE_MARKERS,$),e.$on(f.MAP.FIT_BOUNDS_VISITS_MARKERS,ee),e.$on("showLastPositionVehicleById",_e),e.$on("$stateChangeSuccess",M),e.$on("$destroy",D),e.$on(f.REFRESH.VEHICLE_SELECTED_CHANGE,Z),e.$on(f.MAP.LOAD_VEHICLES_LAST_POSITION,oe),e.$on(f.MAP.UPDATE_FILTERED_VISIT_MARKERS,re),e.$on(f.VISITS.CALL_VISIT_FILTER,me),e.$on(f.MAP.SET_DEFAULT_TIME_FILTER,ge),e.$on(f.MAP.CALL_POLYLINES_FILTER,he),e.$on(f.VEHICLES.RETURN_VEHICLE_DRIVER_ACTIVE,_e),e.$on(f.VEHICLES.CLEAR_VEHICLE_DRIVER_ACTIVE,be),t.$on("positionNavigator",function(){t.mapInitCoord&&l.setMapCenterOn(t.mapInitCoord)})}e.$inject=["$scope","$rootScope","$log","$state","$stateParams","moment","lodash","marketingService","trackingService","mapService","$filter","Toasts","googleService","$window","planService","$q","$interval","DATE_FORMAT","TRACKING_EVENTS","TrackingMapService","polylineService"],angular.module("icarus").controller("TrackingController",e)}(),function(){"use strict";angular.module("icarus").constant("TRACKING_EVENTS",{MAP:{DRAW_VISITS:"draw:visits",DRAW_ALL_VISITS:"draw:all-visits",DRAW_VEHICLES:"draw:vehicles",DRAW_VEHICLES_LAST_POSITION:"draw:vehicles:last-position",DRAW_ROUTE_POLYLINE:"draw:route-polyline",CLEAR_VEHICLE_MARKERS:"erase:vehicles",UPDATE_SHOW_MARKERS:"update-show:markers",HIDE_MARKERS:"hide:markers",CLEAR_MARKERS:"erase:markers",CLEAR_ALL_VISITS:"erase:all-visits",CLEAR_POLYLINES:"erase:polylines",CLEAR_ALL:"erase:map",FIT_BOUNDS_VISITS_MARKERS:"fitbounds:visits-markers",FIT_BOUNDS_VEHICLES_LAST_POSITION:"fitbounds:vehicle-last-position",LOAD_VEHICLES_LAST_POSITION:"draw:load-vehicles-last-position",UPDATE_FILTERED_VISIT_MARKERS:"draw:update-filtered-visit-markers",SET_DEFAULT_TIME_FILTER:"draw:set-default-time-filter",FILTER_POLYLINES_BY_TIME:"draw:filter-polylines-by-time",CALL_POLYLINES_FILTER:"draw:call-polylines-filter"},VEHICLES:{LOAD_VEHICLES_LAST_LOCATION:"vehicles:load-last-location",LOAD_ALL_VEHICLES:"vehicles:load-all-vehicles",VEHICLES_READY:"vehicles:vehicles-ready",GET_VEHICLE_DRIVER_ACTIVE:"vehicles-driver-view-active",RETURN_VEHICLE_DRIVER_ACTIVE:"return-vehicles-driver-view-active",CLEAR_VEHICLE_DRIVER_ACTIVE:"vehicles:clear-vehicle-driver-active"},REFRESH:{DATE_CHANGED:"refresh:dateChanged",GENERAL_PROGRESS_CHANGED:"refresh:general-progress-changed",VEHICLE_SELECTED_CHANGE:"refresh:vehicle-selected-changed",CHANGE_VEHICLE_SELECTED:"refresh:change-vehicle-selected",DATE_CHANGED_REFRESH_VISITS:"refresh:date-changed-refresh-visits"},READY:{VEHICLES_MARKERS_CREATED:"ready:vehicles-markers-created"},VISITS:{FILTER_VISIT_MARKERS_BY_TIME:"visits:filter-visit-markers-by-time",CALL_VISIT_FILTER:"visit:call-visits-filter"}})}(),function(){"use strict";function e(e){function t(e){function t(e,t){t&&(e+=1462);var i=Date.parse(e);return(i-new Date(Date.UTC(1899,11,30)))/864e5}for(var i={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!==e.length;++n)for(var s=0;s!==e[n].length;++s){a.s.r>n&&(a.s.r=n),a.s.c>s&&(a.s.c=s),a.e.r<n&&(a.e.r=n),a.e.c<s&&(a.e.c=s);var o={v:e[n][s]};if(null!==o.v){var r=XLSX.utils.encode_cell({c:s,r:n});angular.isNumber(o.v)?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=t(o.v)):o.t="s",i[r]=o}}return a.s.c<1e7&&(i["!ref"]=XLSX.utils.encode_range(a)),i}function i(t,i){function a(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0;a!==e.length;++a)i[a]=255&e.charCodeAt(a);return t}var n={bookType:"xlsx",bookSST:!1,type:"binary"},s=XLSX.write(t,n);return e.when(saveAs(new Blob([a(s)],{type:""}),i+".xlsx"))}return{sheetFromMatrix:t,write:i}}e.$inject=["$q"],angular.module("icarus.shared").factory("XslxService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o){function r(){var t=new e("99999");return o.merge(t,{active:!0,capacity:1e3,capacity2:1,capacity3:1,color:"#00B0FF",enabled:!0,id:"",locationEnd:{address:"Suecia 155, Providencia, Chile",latitude:-33.42198,longitud:-70.607243},locationStart:{address:"Suecia 155, Providencia, Chile",latitude:-33.42198,longitud:-70.607243},name:"VEH1",options:{icon:{fillColor:"#00B0FF"}},shift:{end:"17:00",start:"09:00"},shiftDefault:{end:"17:00",start:"09:00"},available:{value:!0}}),v=t,u(v),g.length=0,g.push(v),v}function l(){var e=[{id:1,address:"Av. Grecia 1450, √ëu√±oa, Regi√≥n Metropolitana, Chile",latitude:-33.46132076559304,longitude:-70.61760809296874,plannedDate:new Date,title:"Sushi SimpliRoute",zIndex:2},{id:2,address:"Sergio Roberto Livingstone Polhammer 1170, Santiago, Independencia, Regi√≥n Metropolitana, Chile",latitude:-33.42379164908391,longitude:-70.6540003048828,plannedDate:new Date,title:"Pizzas SimpliRoute",zIndex:4},{id:3,address:"Yadran 7438, Santiago, Cerro Navia, Regi√≥n Metropolitana, Chile",latitude:-33.42937907268218,longitude:-70.74051763886717,plannedDate:new Date,title:"Restaurante SimpliRoute",zIndex:6},{id:4,address:"Italia 01228, La Cisterna, Regi√≥n Metropolitana, Chile",latitude:-33.529318778596284,longitude:-70.67871954316405,plannedDate:new Date,title:"Hotel SimpliRoute",zIndex:8},{id:5,address:"Los Robles 7146, Penalolen, Pe√±alol√©n, Regi√≥n Metropolitana, Chile",latitude:-33.550176812519716,longitude:-70.55821325654296,plannedDate:new Date,title:"Tour SimpliRoute",zIndex:10},{id:6,address:"Camino del Cazador 6943, Vitacura, Regi√≥n Metropolitana, Chile",latitude:-33.375710628644924,longitude:-70.56490805024413,plannedDate:new Date,title:"Bar SimpliRoute",zIndex:12},{id:7,address:"Leonidas Vial 1135, San Miguel, Regi√≥n Metropolitana, Chile",latitude:-33.494932774009506,longitude:-70.65348532075194,plannedDate:new Date,title:"Spa SimpliRoute",zIndex:14}];return h.length=0,angular.forEach(e,function(e){var t=new i(e.id);o.merge(t,e),h.push(t)}),h}function c(){v||r(),0===h.length&&l();var e=[{id:5,order:1,arrival:"09:35",departure:"09:45"},{id:4,order:2,arrival:"10:13",departure:"10:23"},{id:7,order:3,arrival:"10:35",departure:"10:45"},{id:1,order:4,arrival:"11:02",departure:"11:12"},{id:2,order:5,arrival:"11:26",departure:"11:36"},{id:3,order:6,arrival:"12:00",departure:"12:10"},{id:6,order:7,arrival:"12:49",departure:"12:59"}],i=new t(v.id);return s.$broadcast("TOUR:ROUTE:CREATE",{route:i}),p(i),i.estimatedTimeStart="09:00",i.estimatedTimeEnd="13:14",i.totalTimeFormatted="04:05",angular.forEach(e,function(e){for(var t=null,a=0;a<h.length;a++)if(h[a].id===e.id){t=h[a];break;
}t.updateOrder(e.order),t.estimatedTimeArrival=e.arrival,t.estimatedTimeDeparture=e.departure,t.setIconFillColor(v.color),t.setDefaultColor(v.color),i.addVisit(t,!1)}),v.routes.length=0,v.addRoute(i),angular.copy(v)}function d(){return{data:{hint_data:{locations:["zeUFAP____8c3SAALwAAADUAAAAAAAAAAAAAAP____8AAAAAUgUC_j2eyvsAAAEB","AIJFBYV6KAnImjcADQAAAHgAAAAAAAAAAAAAAP____8AAAAA0hAA_lNey_sAAAEB","P_TgA0L04ANYDyAAbwAAALAAAAAAAAAAAAAAAP____8AAAAA1mIA_pyHyfsAAAEB","1np4A_____8C0CUAJwAAAI0AAAAAAAAAAAAAAP____8AAAAAt-gA_unpyfsAAAEB","LEtPA_____-e_gkADAAAACcAAAAAAAAAAAAAAP____8AAAAAk2sB_vZ1yvsAAAEB","79YYCf____9F_gkAcQAAAIkAAAAAAAAAAAAAAP____8AAAAApwAC_kPoyfsAAAEB","rSWuA64lrgM4uCgAUQAAAB8AAAAAAAAAAAAAAP____8AAAAAvOgB_tuVyPsAAAEB","65N0A1U5EgSysSUAOAAAAC8AAABzAAAAAAAAAMBysAIAAAAAYLoC_ppFy_sFAAEB","zeUFAP____8c3SAALwAAADUAAAAAAAAAAAAAAP____8AAAAAUgUC_j2eyvsAAAEB"],checksum:3259087125},route_name:["",""],via_indices:[0,251,412,454,552,670,997,1566,1805],via_points:[[-33.421997,-70.6073],[-33.550125,-70.558128],[-33.529129,-70.678627],[-33.494858,-70.653465],[-33.461357,-70.617607],[-33.423191,-70.653885],[-33.429317,-70.740517],[-33.375648,-70.564453],[-33.421997,-70.6073]],found_alternative:!1,route_summary:{end_point:"Suecia",start_point:"Suecia",total_time:5627,total_distance:94262},route_geometry:"zi|v~@d{oteCtC{@lN_BbXmFtOmEfRoGbU}Fvq@wNxPmDdQqDjc@iJ`l@yMdDu@jeAqUp~@eTpPyEjS}E~c@{J|d@oKjq@gNp`@_JxN{C|w@sPty@eQj`AcVzAa@|Bq@zfAuVzdAyUxDu@tbAqKpdA}I|~@yIlk@qFbk@wFfr@qFdh@aFr_@eBlx@{Dfa@wCfaAaIjf@mD`bAeGvuAwLjBKtl@gBroAgI~`@q@xLa@hH[~CC`aAaFti@cDbLkDnFaFvJ_}A~NyIjFcCvJuDjIeBvHu@dGIjj@nAfB?roA|BleArCtBD~Sj@zoChH`b@jAjTf@xmAvC|]dA`CH`EDnDHxB?vIJ`SXpBB|ITpoAzAncB~C|j@dA~m@hAx_@r@~b@x@h{@nAltB~DhjA|B`iBnDl_B`DvlA`ClxAtChnAbCn_@t@nb@z@dt@vA`aAlBzP\\|h@dAlwArC|{@dBjj@fAh]r@d]p@`DFtDFj^t@l_@t@~_@v@jUb@vv@|ApJE|KQnH_@jIw@xGmA`ScE`OgEpSsG~OqGfNcHhMcIjX{PjVoO~`Aio@np@ic@pL{HhNgJ|wAe`Atl@m`@xgAkt@pL}Hnb@_YbyAaaAbtAi}@js@kd@dlAsx@zYeR`WyPlnAmy@|NyJdFiD~EeDrMqIhxDwdC~HcFdDaC`ImFzByAjkC_fBrT}NdCaBzEaDd_@uVhl@}c@rIaJtC{CdP}Pfx@ucAxNwPzMuOfBsBvVmTtk@u^~k@oWnw@iW|yEg{AjwC{{@nCaAvPsGtOwFjIeCfEuAxGuB|E}AjWuI~IaD~\\iKpNgEbL_DxLqChHcBrLgC~A]~Be@fDs@zDcAtIoB`GeBzDaA|GaBpK}CfT}EjWeFxYqHvY}It`@qJ|UkFvPmE`[_L`\\mN`j@mVvg@cQpe@aMtUcGl_@uItS{GtTqHdZaNpWaMjm@cS|JkDdUaIh^aIf^uIl]mKdKyCjHqBfYwM|VaNfb@sN`\\qK`x@mQ`WkHpR_IfI}DvDqC|OuLhEcD`eC_lBuHoLqEuBkM{VeNcX}KoTsGmN?wKb@ua@^_a@d@ad@`@ub@^ma@^ua@^ya@\\y_@b@qc@\\qc@|t@}i@cDlCyo@ne@]pc@c@pc@]x_@_@xa@_@ta@_@la@a@tb@e@`d@_@~`@c@ta@?vKrGlN|KnTdNbXjMzVpEtBa~@nu@aY`RmXlPoVvPmVxPgh@xR{^vOs\\lPs^zLse@~O}b@tIiPjDwO`EeX`KqWvMeXjL{U`IwPtFgy@dXkbAxXs@|SSr~@Mje@Kle@WnkAAjFIz^G|UA`EEtNEbVc@|w@OnsAjAtu@?bP?nG?rkA?`nA?f^Bds@PtnAQroAEdl@?vf@?bP?z`@?~\\?hV?fc@?bPsAzGcD`PE~BcBrhBg@zi@C|Bc@rd@QtRIxHm@no@e@~d@k@tf@{A`XcAxv@g@hc@ErDYdWc@n_@a@p^S`QKvJ_@n]sAhfASzOaAxl@QbH_Gd\\{Jnj@cEjUmFbZgFpYkFvY}Fd\\mGv]mGx]kEdVqBfLyFn[aAlFaDxPiAbG_AbFcEjUM|Dj@xR~BDlDTvDh@nEt@rGtApFvA~LrExf@tW`[~VhC|C`NfQ~ExGjOlYxIpT~[l_ArArLl[b~E`VxbCpFhl@lBzYzCbc@`BxVtEl~@jd@hyGpHp}@jCrg@pA~n@g@|j@kChm@m^ltEil@fkKiXtzDafAlmMopAvzLo]blDeH~i@os@dgD_GfXycB~iIer@vxDcbAh}Ee`@rhAgPzq@yp@{Wo`@gOec@mOk_@wMkg@kQq^`~A{Rb{@aOuGw^aPai@yUoaCyeAuaCy{@yoBms@_DgAsaBkn@ac@mIwSwHcNoBurM}|Eud@}PynFisBq{EaeByWsO_z@w]sZgOku@oUmFwBsm@wVkYkLac@iQgi@uRwi@iRibAe_@ohA{_@{t@aYoy@kZim@cUzUabBvEe_@t`@aaCnYmX{Jmi@nRipAzRwoA`GaHdCuC~MyOfD_UjLew@vf@`Jdh@nJhAoJe`@wHio@cL{WyEw~@kPkgAyRmGgAqgAyS}kA}S_hAwRycAeQe_BmYor@iMkQcDyi@{Joj@cKqv@iNcNeCkT{Dai@sJqb@wHqWyEiy@kN{u@wAchANw~@~@yHHwm@`AmjAnCad@|Agc@zA_[lAqi@xBcGcoBgEiuAqE}xAgDo~@oBwh@unAbBmpAbBwE}hA{H}vAyDmq@uEwkAiBc]mBq^UqBcDge@mCih@}Cuf@uC_e@yDcn@wCye@}Cae@_Cad@_Cae@aCef@kDun@wI{cBsBweAMeOIcDG{Ci@mFoOiaByLa_Au@uFaQ{rAc@eD}]ieFqHmiAkCob@kBoZoC_d@iCcg@{@cHgEd@eh@zAc[tA{CNqSh@_EByTv@kTXag@xA}g@kC{Km@mCM{BM_DOWtHqAlj@{B~t@yBbo@[lM{@n^uB|p@{ClcAcA~`@}@zL_BfF{BlF}H`KoBfCwAhBeq@`n@cp@fp@qC|CmBnBuz@by@e{@fw@ezAzsAqPrRiBlCsArCiClI_E~Pe@nF[zHOxG}NbCkBVkdA`RoBb@gSbEiFjC}ClDsMjUgD~DeFxC}GtAmEx@{C`U{UnfBsTrEm`@dIeoAnWyWlF{\\bHg\\zGyBd@w_@|HiY`GgB^i_Cjd@_TlE}h@hKibAvRo_AnPgVvEk\\bGaKhBs_@fH_TrEeQfC{BfAyRjJoGdBsYbHqY`GkDp@{BIaCUkCO_D?sD^m\\bHy\\|GgKjBsPrBcIv@_Gl@sDViETQxOc@hIs@dHmMh~@}Zj~Baw@tkFc@tCyc@haDuf@~wCo@`EcKfs@e@`DoGjd@mMd~@eEtWmFr_@_@zG?pHoMy@oV}BoEc@qQhAu[nBuQp@e\\wA_kAgFo`@mBc_BgG{S{@_UaAeSy@}c@mBi`@aB~F`}ApJx`C_gA~S}V`Eol@tHzJkyApAaRoBUiQqBkTcCeLrIcHzJsCtCS|F~JlyAhk@wFnl@uH|VaE~fA_TbFeAfq@mOhb@kIf`@eH|y@cQxk@qLds@eN|S}E`k@eKgJ``AwIjl@aEbMaJ~Xi@nBg@jDQbDE|CFtCjAhPb@dG`@vFVrFPxEFdGI~I_@`Iw@|HqDh]sCtJeCjK}CxNeCvNyA`LeAnKgClXuBrRcAvHcAzGyDxTqCdMkCfLeCzJqEhOqDfOeCtKmBxJ{B|NsAjMcA~LaBx\\k@vKo@pJ{@xJu@xFw@pFgCvM_DvMsDnM}GxTyGhSuI~WyHbWcRxq@iPxo@sH`[qHnZ_T`y@mKt^cGbUcEdRcBzIyAzIwCfR{Dt[YpC_B`LgDjRuAvGyArGcGdUaPvk@eHfXeHhWgGvRsDjKaEbKmKhVyMfZ{MpYqK~UoJpVmGxQoFpPaEtMwDhMyIv\\iIp[cIrZeTrx@sId[aJxZ_FfOgFhOqFvNwF~Mah@xhA{DjIwDtI{E|LkEzLaGbRoErQ_Mlm@uDpQ{DbQaEvPsEtPgFrPoFdP{ClIwCdIcDnIcD~HiFtLcFtKuMdWsHlMsLfRaHtJoFpHeDbEiGtHqFfHiMvNuRtSkRvQsRlQ_R|Nef@``@o_@v[yYbWgGvFuFzFgI`JuHvJyDlF}DtFiI`MqHvMeHpMqPp\\g_@`v@mQf[mSd\\cXra@}f@fv@}a@ro@_P`YaOzX{^xr@c^dq@qWhh@oIxPwOz[aFjKwE~KiFdO}DvMcDpMoCzNiBrMy@fIq@rH}@hNUvGShGC|J?`KJdR\\zQvBzlApAzlANnRFhR@bl@Adk@NzWVhNr@tOt@nNrA`OlAxJzAtJbDpQhErQbHxTpIpTvPv^~Pp^bPp^pHnSfCrItBrIhBtJ`BvIzAfK`AxJhA`Oz@bOhBnf@tDhgAn@hM|@rLnAxLzAzLvFn[dBjIzBvIjHtUpGrQbFpN~FpOxXns@zKhY|e@dlA|EdMzElMlE`M|DdMdFnQfEjQlBdJvAbJpAnJ~@bKdAfOj@nMb@pTIjSe@hSgAdSuChXkDhWmKzp@kXxdByD~ZiCdZmBf[aAt[o@dXMvWBjMDzLj@xZ|@|ZbAxZjEzwAv@b[p@j[b@f[^f[Lh~@qBltDqDdm@}Cb\\uA~Mw@nLm@hTe@|VMdg@f`@hG~N~Bhj@xIr\\jFmAoz@iAoz@oDwrCt[yE`YcEl{@iMp{AyUtg@qIjMwBz~@iNnVaE`LkBxXuEj\\qFl[kFpWiEzTsDfCc@`UuD`BW`YwE|[qFt\\qF~u@eM`|A{VtKkBfh@~QlY|IxMdEbI|C`[xJbDjAff@pPnFz@pRPjEAdRP`YPIm`ADln@B~PaYQeRQkE@qRQoF{@gf@qPcDkAa[yJcI}CyMeEmY}Igh@_RuKjBa|AzV_v@dMu\\pF}[pFaYvEaBVaUtDgCb@{TrDqWhEm[jFk\\pFyXtEaLjBoV`E{~@hNkMvBug@pIq{AxUm{@hMaYbEu[xEnDvrCeW~Hyl@|QmLnDCuj@SyNw@wOkAgQkCgg@tB{tD?aOCmOMc`@[c[c@g[u@q[s@sZkEqvAaCav@g@{ZIqM?eLLgWf@eW|@y[lByZdCaZlDcZ`W{}AvK}q@`EoYtAsKlAgMpAoRr@ySDeXi@kWkBq\\uBaScD}RoCiMuEqQkFiQyGiSaD}IoDeJoEkLiFgMi]e{@gLkZuYeu@aLcZaKgZoE_OiEcR_D}P}AqJuAqK_A}Jq@mJk@}Jc@}JiBek@qBck@iA{Vk@cKw@sJqA}LeBkL}BiMaC{KoBmHmBuGsG{PsOc^cPc]eS_c@uDoJgDeJyCoJyCuKeDkNiAoF{@kFwCsScBeR_A}Nm@}NSgMKyXBmo@Cko@g@_p@u@{s@m@e^q@m^_@mQSyNUaKAoKCsF@}FTyNf@aNx@mLr@eInAqJlDwSpDcP`CuHdCuHxKeXxTcd@zYcm@b[sl@zb@_y@~Tub@tUea@nPqWnPcW|]}i@b^ii@rQ_ZpQo[~]mt@`Sw_@tFaLpGeLdK}OfLkOpJcMlFuFzFwFfTkR~\\oXd^gYta@g\\lMaLbNcMdQyPdQwQlLoNvNeQvIeLjM_RpL_ShOsYvBkEpDgHlHmOjH}QzGsQzFePvFcQlFuRlFwSzEeSxEeT|L_n@fD{M`EaN~DaMjEeM~DkJrEyJbk@anAvFiNlF{NdF}N~E_OfJk[dDcMjDgMnIs[`I_[|Sex@xIq\\zJg\\|GsShGwQxHoRxImRr\\it@rMoZvEuLlEkMjKk^rKua@bJ{[~Is\\zB}IpBgJ|DwThBwM^cDxDe[jAgIrAkIxDgStD}PpG{UdIcYhRys@nHuZ`Q}r@nFqTdGuTbGiUnGwThQwj@nIuV|HoWjDkM`DuMfAqFdAgGhBsNfAoNx@_Ob@kLz@}P\\aF`@aFvAkNnB{MvBkKlBsIlCmJtBiHxC}JjEwNfDcN`DmOrAqHfAmIjBcRnCg\\jC{WlAuJzAsJxAuHdBcIrBaIlFkPjCgIdDqHbCuFhCeEpAgBdBmBdEsEpB_DdBcD|CyIxBwI`TwsAtNa{@`Kct@z\\ocCzVsgBhp@yuEbFq]~`@mmC`m@ibEdd@ucDl]cmCnCw_@p@gNUyNmAwT_BwKwBaMsa@knAw[qz@}mAckDgEeIgEqFgw@e`A}n@gn@m`Awz@yEwCoD}Bsy@od@cKqFkUiKq~@y`@k{Aoe@ue@uNeWaIkFkBmGcCuHiDoDiB_EwBmJiGqCoB}FiEeE_DiDyC}FgFuDyDqEeFwDqE}C{DiFwG{DqFmC}DkCaEaCuDcCcEeCqE}BuEoCyFoDyH_D}HaDgIyCmIgCeIeC{HcBkGaBgGuAmFuA{FsAuFiAoFyLim@{Wg|AwQkbAgRy}@gK_]{Nm`@oWgj@qNiUya@go@qWib@uXk_@u\\cb@up@cr@{J{JiJ}IaKyImI}GcXkRmXoMiJqEwS_H}TaGu_AcQus@qLi^_FaLgByKmBoXoGcHaBaCk@uFyAiEuA}ZiIkOcEcGkAeWeGiLgC}M}DgZ{I{TaG{VmC}UiFgMcDch@cNki@qMsu@mQ}w@{Qy\\}HwSqEwSkD}Fs@mGg@gLScLT_I\\aIj@sRdBag@rEkd@nFgGl@mF^eEVyFNi`@B}}@Dmw@b@q]Zw]RiNEsNWaN_AgMiB}LaC_MmDoHoC_GiC{^eQgv@c`@yYgOwX{MeTgKiN{HkLyGaLaHgG_EkGiEeF}DeFeEyFaF}DcEaGkGoFeGcEaFwGwHaMeP}Q_WuRoWwPsTaPqTsMuRe]ck@cLaQoKoQeLuQ}LcQoMkQkq@g}@eVe\\cv@cgAsv@sdAcHmJkXg^qYu_@k^of@yXm_@mGsJsFiJyFuKsFgLcFqLeEiLoDiMeDkNaDmQmBoNmAwKq@iHoC__@oJyoAeJcpAsJysAsJ_rA_K{nA}Daf@}Dkf@qByRsBmReEm]cFw]gD{RsDkRuEoUaFkTkEaQwEoQeJq\\{Moe@sM_e@g^g~AeC_NgC}NaWwgAaB}BqAeAyBs@kQq@eDUuCi@oCeAmCsBcAeB_BcEk@wBsAmHAeC@mERkIVmDZsDrAgL^sBNiC?eBMoB_AeEoAeCcBmBaFmNcAsDg@sDc@uGy@sM_@wGe@sHi@kQgBkd@{AsBaC]{DXaLcdBiA_I_BeIgYacAaFqSsCoQqXq@iZs@yQr@uJr@M`Oy@nFuEnTpEv@jHjD|CdAdFQbY_DzYeD|UsCfY`cA~AdIhA~H`LbdBzDYx@|NjEjv@nBx]EjDSdC{@bDyBpIaBrA_B|B}@~Ba@nBStBAtCP|Bj@nCr@jBrArB|AvArBbAw@xBvElBtCrFbBzDt@fIp@jHz@hHxA`IlDzR~DlThAxFbErU`BjB`EhUhDjBrKoC`Ck@`CGlC^~CvCvAtC~s@~~BdP`k@pGfU`GrT`F|QjEfQfEhR|DdR|EjWhFh[~F~c@dFzc@rBfTdBhTfE~h@~KluAbHv_A~Gz_AlDfg@nDrg@~I~mAvEfn@^jF|AzSnA|LvAfMvBxNpCzN`DvM~D~MfEjLvDnIdD`HjB~D~BxE`EnHfEbHdHhKhH~Jnf@zp@db@lj@bj@vs@nd@`n@nA|A``A`tA`V|[r[jb@nRbWrRtWjF|HlGvJpOdWjN`VxE~HnGzJbJdNfJ~MnZ|a@jr@~_AzGzIvHhJtFpG`HzHrFnG~GxG`MfKtFbExFbEfXxP`GhDjIpEpRnJd~@rd@jfA|i@`LjFdNxFpGvBzGrBzKzBtNfBdL|@hK^nWJd[Qx_@g@dTI`n@Ghi@NtYK|PK~G[hGo@tJcAjJgAdXeDlZgCvRaB~Ho@fIq@lE[lGQbHIzGH~Kt@zLtAfT~DlRjEvYjH~RzEpUjFnUzFjd@vKfd@lLpFpDxGnD|OlH|GnBtFrBnE|A~GxBtGdBxKpCzKrCjDdAhDnA`DtAlD`BfErBrCdBnC~BpEhEvCbD`BrBbAnAlB~BnA~ApCrDlEpF|BxBlCtBxBrA|BjArFdCnDlArHjBfGfAdCX~CLrEDjFObGUfFc@xLiBfEMjENpDj@~Cx@rCz@lC`ApC`BpCxBbCnC~GjI`]jb@jCzCtYh\\vXdZvYb]lEdF`yA`fBjCnCdK}q@nHal@zHgm@hCwRdB_BbCx@jF~EzU|SxOnMh[`XhKfHlFsCjOaMvWoRpFsEbEmDzvAk~@bXaRhFqD~AgAxd@s[he@kN",status_message:"Found route between points",status:0},status:200}}function u(e){function t(e){var t=d(),a=t.data.route_summary;e.totalDistance=(a.total_distance/1e3).toFixed(1),e.path=i(t.data.route_geometry,6),e.actionUpdate(e)}function i(e,t){t=Math.pow(10,-t);for(var i=e?e.length:0,a=0,s=0,o=0,r=[];i>a;){var l,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var u=1&d?~(d>>1):d>>1;s+=u,c=0,d=0;do l=e.charCodeAt(a++)-63,d|=(31&l)<<c,c+=5;while(l>=32);var p=1&d?~(d>>1):d>>1;o+=p;var m={latitude:s*t,longitude:o*t};r.push(n.getGoogleMapsLatLng(m.latitude,m.longitude))}return r}e.recalculateAllRoutes=function(){return a.when(t(this.routes[0]))}}function p(e){e.actionCreate=function(e){s.$broadcast("TOUR:ROUTE:CREATE",{route:e})}}function m(){return g}var v=null,g=[],h=[];return{createFakeVehicles:r,createFakeVisits:l,createAndAssignFakeRoutes:c,getFakeVehicles:m}}e.$inject=["PlannerVehicleModel","PlannerRouteModel","PlannerVisitModel","$q","googleService","$rootScope","lodash"],angular.module("icarus").factory("TourFake",e)}(),function(){"use strict";function e(){return function(e,t){return t=+t,e.slice(t)}}angular.module("icarus.shared").filter("startFrom",e)}(),function(){function e(e){function t(t,i,a){var n=i.find("input"),s=["ngModel","ngChange","ngTrueValue","ngFalseValue"],o={ngModel:"ng-model",ngChange:"ng-change",ngTrueValue:"ng-true-value",ngFalseValue:"ng-false-value"};for(var r in a)a.hasOwnProperty(r)&&-1!==s.indexOf(r)&&n.attr(o[r],a[r]);e(n)(t)}return{restrict:"E",scope:!1,template:'<label class="sp-switch"><input type="checkbox"><div class="slider"><div class="on">on</div><div class="off">off</div></div></label>',link:t}}e.$inject=["$compile"],angular.module("icarus.shared").directive("spSwitch",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u){function p(a){function r(e){X=null;var t=e.data,i=!1;return F={},angular.extend(F,{id:t.id.toString()}),F=t,F.api_token=d,F.created=n(F.created),F.modified=n(F.modified),F.last_login=n(F.last_login),F.account.active_until=n(F.account.active_until),(void 0===c.hotJarEnable||c.hotJarEnable===!1)&&"trialing"===t.account.status&&(c.hotJarEnable=!0,function(e,t,a,n,s,o){e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},i=S(F),i?e.hj("tagRecording",[F.email,"1st session"]):e.hj("tagRecording",[F.email]),e._hjSettings={hjid:345268,hjsv:5},s=t.getElementsByTagName("head")[0],o=t.createElement("script"),o.async=1,o.src=a+e._hjSettings.hjid+n+e._hjSettings.hjsv,s.appendChild(o)}(window,document,"//static.hotjar.com/c/hotjar-",".js?sv=")),s.setUserContext({id:F.id,username:F.username,email:F.email}),F}function l(a){return e.defaults.headers.common.Authorization=null,t.error(a),i.reject(a)}if(null!==F&&a!==!0)return i.when(F);if(X)return X;var d=o.get(N);return null===d?i.reject("NOT_AUTHENTICATED"):(e.defaults.headers.common.Authorization="Token "+d,X=e.get(j).then(r,l))}function m(t){function a(e){return e.data}function n(e){return i.reject(e)}var s={username:t.username,email:t.email,name:t.name,password:t.password,phone:t.phone,account:{name:t.account.name,country:t.account.country,vehicle_quantity:t.account.vehicleQuantity}};return e.post(B,s).then(a,n)}function v(t,i){function a(t){var i=t.data.auth_token;return o.set(N,i),e.defaults.headers.common.Authorization="Token "+i,i}var n={username:t,password:i};return e.post($,n).then(a)}function g(){R(a.get("extraFieldsDefinition")),R(a.get("dashboards")),R(a.get("zones")),F=null,o.remove(N),e.defaults.headers.common.Authorization=null,s.setUserContext(),R()}function h(t){function i(e){return e.data}var a={email:t};return e.post(q,a).then(i)}function _(t,i,a){function n(e){return e.data}var s={uid:t,token:i,new_password:a};return e.post(J,s).then(n)}function f(t,i){function a(e){return e.data}var n={new_password:t,current_password:i};return e.post(U,n).then(a)}function b(t,a,n){var s=i.defer(),o={plan_quantity:t};return a&&(o.source=a),n&&(o.coupon=n),e.put(Y,o).success(function(e){d.merge(F.account,e),F.account.coupon=e.coupon,s.resolve(e)}).error(function(e){s.reject(e)}),s.promise}function y(){function a(){return F.account.status="canceled",F.account.card_last4="",F}function n(e){return t.error(e),i.reject(e)}return e["delete"](Y).then(a,n)}function w(t){var i={optimization_options:t};return e.patch(W,i)}function A(t){var a=i.defer();return e.get(G,{params:{username:t}}).then(function(e){a.resolve(e)})["catch"](function(e){a.reject(e)}),a.promise}function x(){var t=i.defer();return e.get(r.IP_SERVICE_URL).then(function(e){t.resolve(e.data.ip)})["catch"](function(){t.resolve(null)}),t.promise}function k(a){var n=i.defer(),s={firstname:a.name,email:a.email,company:a.company,country:a.country,vehicle_number_text:a.vehicle,phone:a.phone,hs_context:{hutk:l.get("hubspotutk"),pageName:"SimpliRoute Form Signup"}};return x().then(function(i){i&&(s.hs_context.ipAddress=i),s.hs_context=JSON.stringify(s.hs_context),e.post(H,s).then(function(e){n.resolve(e)},function(e){t.error(e),n.reject()})}),n.promise}function I(){p().then(function(i){var a={address:i.account.country};e.post(r.API_URL+"directory/geocode/",a).then(function(e){return O(e.data)},function(e){t.info(e)})},function(e){t.info(e)})}function S(e){if(e.last_login&&e.created&&n(e.last_login).isValid()&&n(e.created).isValid()){var t=n(e.created),i=n(e.last_login),a=n.duration(i.diff(t)),s=a.asSeconds();if(.6>s)return!0}return!1}function E(){F&&(F.account.status=ee.active,F.has_suscription_id=!0,u.clearPlanPromise())}function C(e){if(F){var t=F.account.configs;t.forEach(function(t){t.key===e.key&&(t.value=e.value)})}}function D(a){var n=i.defer(),s=[];return a.forEach(function(t){s.push(e.post(Q,t))}),i.all(s).then(function(e){a.forEach(function(e){C(e)}),n.resolve(e)})["catch"](function(e){t.info(e),n.reject(e)}),n.promise}function P(){var e=i.defer(),t={country:"CL",maxDistance:150};return p().then(function(i){t.country=i.account.country,t.maxDistance=V(i.account.configs),e.resolve(t)})["catch"](function(t){e.reject(t)}),e.promise}function L(e){F&&(F.account.optimization_options=e)}function O(t){var a=i.defer();return e.get(r.MAP_OPTIONS).then(function(e){var i=e.data;i.center.latitude=parseFloat(t.latitude),i.center.longitude=parseFloat(t.longitude),T(i)})["catch"](function(e){a.reject(e)}),a.promise}function T(t){var a=i.defer();return e.post(r.MAP_OPTIONS,t).then(function(e){return e.data})["catch"](function(e){a.reject(e)}),a.promise}function V(e){return d.find(e,{key:"max_distance"})}function R(e){e&&e.removeAll()}function M(){return e.post(Z,{})}function z(t,i,a){return e.post(K+t+"/"+i+"/?browser_language="+a,{})}var F=null,N="token",$=r.API_URL+"auth/login/",j=r.API_URL+"accounts/me/",B=r.API_URL+"accounts/register/",H=r.API_URL+"accounts/hubspot-proxy/",U=r.API_URL+"auth/password/",q=r.API_URL+"auth/password/reset/",G=r.API_URL+"accounts/user-exist/",J=r.API_URL+"auth/password/reset/confirm/",Y=r.API_URL+"accounts/subscription/",W=r.API_URL+"accounts/account/",Q=r.API_URL+"accounts/configs/",Z=r.API_URL+"accounts/resend-confirmation-mail/",K=r.API_URL+"accounts/activate/",X=null,ee={active:"active"},te={login:v,logout:g,signUp:m,getUser:p,hubspot:k,setMapOptions:I,passwordReset:h,checkUsername:A,changePassword:f,setSubscription:b,cancelSubscription:y,passwordResetConfirm:_,updateOptimizationOptions:w,checkUserLastLogin:S,changeStatusAccount:E,changeAccountConfigs:C,saveAccountConfigs:D,getInfoToValidateVisit:P,setOptimizationOptions:L,getIP:x,resendConfirmationEmail:M,confirmAccount:z};return te}e.$inject=["$http","$log","$q","$cacheFactory","moment","Raven","store","__env","$cookies","$rootScope","lodash","plannerService"],angular.module("icarus.shared").factory("sessionService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r){function l(e,i){return t.API_URL+"reports/visits/from/"+s(e).format("YYYY-MM-DD")+"/to/"+s(i).format("YYYY-MM-DD")+"/"}function c(e,i){return t.API_URL+"optimize/requests/from/"+s(e).format("YYYY-MM-DD")+"/to/"+s(i).format("YYYY-MM-DD")+"/"}function d(e,i,a){return t.API_URL+"reports/logs/client/"+e+"/from/"+s(i).format("YYYY-MM-DD")+"/to/"+s(a).format("YYYY-MM-DD")+"/"}function u(e){var t=s().format(r),i="sr",a=[],n=["Empresa","Visitas Totales","M√°ximo de veh√≠culos"];e.data.forEach(function(e){a.push([e.account,e.total_visits,e.max_vehicles])}),p(n,a,t,"Llamadas a Servicio de optimizacion "+e.start_date+" "+e.end_date,"Llamadas",i)}function p(e,t,i,n,o,l){var c=s(i).format(r),d={headers:e,data:t},u=a.createWorkbook(o,d);v(u,n+l+"_"+c.replace(/-/g,""))}function m(e){return t.API_URL+"reports/routes/from/"+e.fromDate+"/to/"+e.toDate+"/"}function v(e,t){var i=a.writeWorkbook(e);n.downloadXLSX(i,t+A)}function g(t,i,a){var n=o.defer();return e.get(l(t,i),{params:{email:a}}).then(function(e){n.resolve(e)})["catch"](function(e){n.reject(e)}),n.promise}function h(t,i){var a=o.defer();return e.get(c(t,i)).then(function(e){u(e.data),a.resolve()})["catch"](function(e){a.reject(e)}),a.promise}function _(t,i,a){var n=o.defer();return e.get(d(t,i,a)).then(function(e){var o=angular.element("<a/>");o.css({display:"none"}),angular.element(document.body).append(o),o.attr({href:"data:attachment/csv;charset=utf-8,"+encodeURI(e.data),target:"_blank",download:"Reporte_Logs_Cliente_"+t+"_"+s(i).format(w)+"_a_"+s(a).format(w)+".csv"})[0].click(),o.remove(),n.resolve(e)})["catch"](function(e){n.reject(e)}),n.promise}function f(t){return e.get(m(t),{params:{start_time:t.startTime,end_time:t.endTime},responseType:"blob"})}function b(e,t){var n,s={Sheets:{},SheetNames:[]},o=[i("translate")("Excel_Header.driver"),i("translate")("Excel_Header.vehicle"),i("translate")("Excel_Header.route_Index"),i("translate")("Excel_Header.stop"),i("translate")("Excel_Header.title"),i("translate")("Excel_Header.address"),i("translate")("Excel_Header.service_Time"),i("translate")("Excel_Header.arrival_Time"),i("translate")("Excel_Header.distance"),i("translate")("Excel_Header.order_size"),i("translate")("Excel_Header.total_size"),i("translate")("Excel_Header.latitude"),i("translate")("Excel_Header.longitude"),i("translate")("Excel_Header.reference"),i("translate")("Excel_Header.warnings"),i("translate")("Excel_Header.visit_load2"),i("translate")("Excel_Header.visit_load3"),i("translate")("Excel_Header.route_coment"),i("translate")("Excel_Header.notes")],r=[],l=e.vehicles,c=e.drivers,d=e.date;l.forEach(function(e){e.routes.forEach(function(a,n){var s=a.comment,o=a.visits[a.visits.length-1];n+=1,r.push([e.driver?angular.fromJson(e.driver).name:"",e.name,n,0,i("translate")("Routes.start"),a.locationStart.address,"",a.estimatedTimeStart,0,"",a.totalLoad,parseFloat(a.locationStart.latitude),parseFloat(a.locationStart.longitude),"","","","",s]),a.visits.sort(function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}),a.visits.forEach(function(t){r.push([e.driver?angular.fromJson(e.driver).name:"",e.name,n,t.order,t.title,t.address,t.duration,t.estimatedTimeArrival,"",t.load,a.totalLoad,parseFloat(t.latitude),parseFloat(t.longitude),t.reference,t.error?t.error.msg:"",t.load2,t.load3,s,t.notes])}),r.push([e.driver?angular.fromJson(e.driver).name:"",e.name,n,a.visits.length+1,i("translate")("Routes.end"),t.open_ended?o.address:a.locationEnd.address,"",a.estimatedTimeEnd,a.totalDistance,"",a.totalLoad,t.open_ended?parseFloat(o.latitude):parseFloat(a.locationEnd.latitude),t.open_ended?parseFloat(o.longitude):parseFloat(a.locationEnd.longitude),"","","","",""])})}),n=e.visitsOutOfRoute?y(e.visitsOutOfRoute):[],n.forEach(function(e){r.push(["",i("translate")("Visits.out_of_route"),"",e.order,e.title,e.address,e.duration,"","",e.load,"",parseFloat(e.latitude),parseFloat(e.longitude),e.reference,e.error?e.error.msg:"",e.load2,e.load3,"",e.notes])}),s.Sheets.Plan=a.sheetFromMatrix([o].concat(r)),s.SheetNames.push("Plan"),c.forEach(function(e){var t=r.filter(function(t){return t[0]===e.name});if(t.length>0){var i=s.SheetNames.length+". "+e.name;s.Sheets[i]=a.sheetFromMatrix([o].concat(t)),s.SheetNames.push(i)}}),v(s,"SimpliRoute_Plan_"+d)}function y(e){return e.sort(function(e,t){return e.title>t.title?1:e.title<t.title?-1:0}),e}var w="YYYY-MM-DD",A=".xlsx";return{visitsWithTrackingIdReport:g,optimizationRequestsReport:h,logRequestsReport:_,getRoutesKilometersTravelingReport:f,downloadReportExcelPlan:b}}e.$inject=["$http","__env","$filter","xlsWriterService","fileDownloaderService","moment","$q","DATE_FORMAT"],angular.module("icarus.shared").factory("reportService",e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(e){return c.API_URL+"plans/"+e+"/"}function u(e){return c.API_URL+"plans/"+e+"/"}function p(e){return c.API_URL+"plans/routes/"+e+"/"}function m(e){return c.API_URL+"plans/visits/"+e+"/"}function v(e){return u(e)+"vehicles/"}function g(){return c.API_URL+"routes/vehicles/"}function h(e){var t;return t=r(e).isBefore(r(),"day")?c.API_URL+"plans/visit-history/"+e+"/progress/":u(e)+"progress/"}function _(e){var t;return t=r(e).isBefore(r(),"day")?c.API_URL+"plans/visit-history/date/"+e+"/latest/":c.API_URL+"plans/visits/date/"+e+"/"}function f(e){return c.API_URL+"events/all/"+e+"/"}function b(e){return c.API_URL+"events/by-routes/"}function y(t,i,a){var n=s.defer();return e.get(t,i).then(function(e){try{n.resolve(a(e.data))}catch(t){n.reject(t.message)}})["catch"](function(e){n.reject(e)}),n.promise}function w(e,t,i,a){var n=s.defer();return a||(a=function(e){var t=angular.isObject(e)?e.data:e;n.reject(t)}),e.apply(this,t).then(function(e){s.when(i(e)).then(function(e){n.resolve(e)})})["catch"](a),n.promise}function A(e){return c.API_URL+"plans/vehicles/"+e+"/"}function x(){return c.API_URL+"plans/create-plan/"}function k(e,t){return c.API_URL+"plans/visits-filter/?planned_date="+t+"&search="+e}function I(){return c.API_URL+"plans/edit-plan/"}function S(t){return e.get(h(t))}function E(t,i,a){var n=a?a:null,s={params:{vehicle:i,driver:n}};return e.get(h(t),s)}function C(t){return e.get(u(t))}function D(e){return y(d(e),null,t.fromJson)}function P(e){return y(p(e),null,i.fromJson)}function L(e){return y(m(e),null,a.fromJson)}function O(e){return y(m(e)+"detail/",null,n.fromJson)}function T(e){function t(e){var t=[];return angular.forEach(e.data.plans,function(e){t.push(D(e))}),s.all(t).then(function(e){return e})}return w(C,[e],t)}function V(t){function i(e){var t=[];return angular.forEach(e.data,function(e){var i=o.fromJson(e);t.push(i)}),t}return w(e.get,[v(t)],i)}function R(t,i,a){function n(e){return e.data.length>0?o.fromJson(e.data[0]):[]}return w(e.get,[v(t),{params:{vehicle:i,driver:a}}],n)}function M(t){function i(e){return o.fromJson(e.data)}return w(e.get,[A(t)],i)}function z(t){function i(e){var t=[];return angular.forEach(e.data,function(e){var i=a.fromJson(e);t.push(i)}),t}return w(e.get,[_(t)],i)}function F(t){var i=s.defer(),n=[];return e.get(p(t)+"visits/").then(function(e){e.data.map(function(e){n.push(a.fromJson(e))}),i.resolve(n)}),i.promise}function N(t){return e.post(x(),t)}function $(t){function i(e){var t=[];return angular.forEach(e.data,function(e){var i=l.fromJson(e);t.push(i)}),t}return w(e.get,[f(t)],i)}function j(t){function i(e){var t=[];return angular.forEach(e.data,function(e){var i=l.fromJson(e);t.push(i)}),t}return w(e.post,[b(),t],i)}function B(t,i){var n=s.defer();return e.get(k(t,i),{cache:!0}).then(function(e){var t=[];e.data.map(function(e){e=a.fromJson(e),t.push(e)}),n.resolve(t)}),n.promise}function H(){function t(e){var t=[];return angular.forEach(e.data,function(e){e.driver={},e.routes=[];var i=o.fromJson(e);t.push(i)}),t}return w(e.get,[g()],t)}function U(t){return e.post(I(),t)}return{getGeneralProgress:S,getProgressVehicleByDriverAndDate:E,getAllPlansByDate:T,getVehiclesWithRoutesByDate:V,getVehicleByIDAndDriverAndDate:R,getPlansByDate:C,getPlanByID:D,getRouteByID:P,getVisitByID:L,getVisitDetailByID:O,getVehicleById:M,getAllVisitsByDate:z,savePlan:N,getVisitsByRouteID:F,getEventsByDate:$,getEventsByRoutes:j,searchVisit:B,getAllVehicles:H,editPlan:U}}e.$inject=["$http","PlanModel","RouteModel","VisitModel","VisitDetailModel","$q","VehicleModel","moment","EventModel","__env"],angular.module("icarus.planner").factory("planService",e)}(),function(){"use strict";function e(e,t){function i(i,a){pdfMake.createPdf(i).download(a,function(){e.info("your pdf is done"),t.isLoading=!1})}return{create:i}}e.$inject=["$log","$rootScope"],angular.module("icarus.shared").factory("pdfService",e)}(),function(){"use strict";function e(e){var t={},i=function(e){return"00000000000000000000".slice(e.length)},a=function(e){return null===e||void 0===e?"":""+e},n="M"===e.DATETIME_FORMATS.shortDate.charAt(0),s=function(e){return a(e).replace(/(\d\d?)[-\/\.](\d\d?)[-\/\.](\d{4})/,function(e,t,i,a){var s=i;return n?Number(t)>12&&(i=t,t=s):Number(i)<13&&(i=t,t=s),a+"-"+t+"-"+i})},o=function(e){return e.replace(/(\d+)((\.\d+)+)?/g,function(e,t,a,n){return a!==n?e.replace(/(\d+)/g,function(e){return i(e)+e}):(a=a||".0",i(t)+t+a+i(a))})},r=function(e){return t[e]?t[e]:(t[e]=o(s(e)),t[e])};return{naturalValue:r,naturalSort:function(e,t){return e=r(e),t=r(t),t>e?-1:e>t?1:0}}}e.$inject=["$locale"],angular.module("icarus.shared").factory("naturalService",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(){var a=t.defer();return e.get(i.MAP_OPTIONS).then(function(e){l(e.data).then(function(e){a.resolve(e)})})["catch"](function(e){a.reject(e)}),a.promise}function r(){return c(s.options)}function l(s){var o=t.defer();return a.getUser().then(function(t){if(t.account.country){var a=t.account.country.toLowerCase(),r=bcCountries.getCountryByIso2Code(a);e.post(i.API_URL+"directory/geocode/",{address:r.name}).then(function(e){var t=e.data;n.mapInitCoord?(s.center.latitude=parseFloat(n.mapInitCoord.latitude),s.center.longitude=parseFloat(n.mapInitCoord.longitude)):(s.center.latitude=parseFloat(t.latitude),s.center.longitude=parseFloat(t.longitude)),o.resolve(s)},function(e){o.resolve(s)})}else o.resolve(s)},function(e){o.resolve(s)}),o.promise}function c(e){var t="";return e.styles.forEach(function(e){var i=Object.keys(e.stylers[0])[0],a=e.stylers[0][i];a=a.replace("#","0x"),t=t+"&style=feature:"+e.featureType+"%7Celement:"+e.elementType+"%7C"+i+":"+a}),t}var d={getMapOptions:o,getStringStyleOfOptions:r};return d}e.$inject=["$http","$q","__env","sessionService","$rootScope","MAP_OPTIONS"],angular.module("icarus.shared").factory("mapService",e)}(),function(){"use strict";function e(){return{restrict:"A",require:"ngModel",link:function(e,t,i,a){function n(e,t){return null===t||""===t||!r||e.test(t)?(a.$setValidity("pattern",!0),t):void a.$setValidity("pattern",!1)}var s,o="/([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/",r=!0;o&&(o.match(/^\/(.*)\/$/)?(o=new RegExp(o.substr(1,o.length-2)),s=function(e){return n(o,e)}):s=function(t){var i=e.$eval(o);if(!i||!i.test)throw new Error("Expected "+o+" to be a RegExp but was "+i);return n(i,t)}),a.$formatters.push(s),a.$parsers.push(s),i.$observe("required",function(e){r=e,s(a.$viewValue)})}}}angular.module("icarus.shared").directive("inputTimeValidator",e)}(),function(){"use strict";function e(){function e(){google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){var e=new google.maps.LatLngBounds;return this.getPath().forEach(function(t,i){e.extend(t)}),e})}function t(){google.maps.Polygon.prototype.contains||(e(),google.maps.Polygon.prototype.contains=function(e){if(this.getBounds&&!this.getBounds().contains(e))return!1;for(var t,i,a,n,s,o,r,l=e.lat(),c=e.lng(),d=this.getPaths(),u=0;u<d.getLength();u++){for(t=d.getAt(u),i=t.getLength(),s=i-1,a=!1,n=0;i>n;n++)o=t.getAt(n),r=t.getAt(s),(o.lng()<c&&r.lng()>=c||r.lng()<c&&o.lng()>=c)&&o.lat()+(c-o.lng())/(r.lng()-o.lng())*(r.lat()-o.lat())<l&&(a=!a),s=n;if(a)return!0}return!1})}function i(){return new google.maps.Geocoder}function a(e){return t(),new google.maps.Polygon(e)}function n(e){return new google.maps.Polyline(e)}function s(){return google.maps.GeocoderStatus.OK}function o(){return google.maps.Animation.DROP}function r(e,t){return new google.maps.LatLng(e,t)}function l(){return Number(google.maps.Marker.MAX_ZINDEX)}function c(e,t,i){return google.maps.event.addListener(e,t,i)}function d(e){return google.maps.event.removeListener(e)}function u(e,t){return new google.maps.Map(e,t)}function p(e,t){return google.maps.event.trigger(e,t)}function m(e){return new google.maps.InfoWindow(e)}function v(){return new google.maps.LatLngBounds}function g(e){return new google.maps.LatLngBounds(e)}function h(){return new google.maps.places.AutocompleteService}function _(e){return new google.maps.places.PlacesService(e)}function f(){return google.maps.places.PlacesServiceStatus.OK}function b(e,t){return new google.maps.Point(e,t)}function y(e){return new google.maps.Marker(e)}function w(){return google.maps.SymbolPath.CIRCLE}function A(e,t){return google.maps.geometry.spherical.computeDistanceBetween(e,t)}function x(e,t){return google.maps.geometry.spherical.computeHeading(e,t)}function k(e,t){return new google.maps.Size(e,t)}function I(e){return google.maps.ControlPosition[e]}function S(e,t,i,a,n){var s,o;return o={drawingMode:a,drawingControl:n,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:i}},angular.extend(o,t),s=new google.maps.drawing.DrawingManager(o),s.setMap(e),s}function E(e,t){google.maps.event.addListener(e,"polygoncomplete",t)}function C(){return google.maps.drawing.OverlayType.POLYGON}function D(e){google.maps.event.clearListeners(e,"polygoncomplete")}return{createGeocode:i,geocoderStatusOK:s,getGoogleMapsLatLng:r,googleMapsAnimationDrop:o,createPolygon:a,createPolyline:n,googleMapsMarkerMaxZIndex:l,googleMapsAddListener:c,googleMapsRemoveListener:d,createMap:u,googleMapsEventTrigger:p,createInfoWindow:m,getLatLngBounds:v,createAutoCompleteService:h,createPlacesService:_,placesServiceStatusOk:f,createPoint:b,createMarker:y,symbolMapCircle:w,geometryComputeDistanceBetween:A,geometryComputeHeading:x,createMapSize:k,getLatLngBoundsOnPoint:g,createDrawing:S,listenerLimitDrawingPolygon:E,getZoomControlOptions:I,overlayTypePolygon:C,clearListenerLimitDrawingPolygon:D}}angular.module("icarus").factory("googleService",e)}(),function(){"use strict";function e(){return function(e,t){var i,a,n,s=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;if(isNaN(e)||""===e||null===e)return"0";"es"===s.substring(0,2).toLowerCase()?(i=".",a=","):(i=",",a="."),t="undefined"==typeof t?2:t,i="undefined"==typeof i?",":i,a="undefined"==typeof a?".":a,e=e.toString();var o=e.split("."),r="undefined"==typeof o[1]?"00":o[1];for(r=r.toString(),r.length>t&&(r=Math.round(parseFloat("0."+r)*Math.pow(10,t)).toString()),n=r.length;t>n;n++)r+="0";var l=o[0],c="",d=0;for(n=l.length-1;n>-1;n--)c=(d++%3===2&&n>0?i:"")+l.substr(n,1)+c;return"00"!==r&&0!==t?c+a+r:c}}angular.module("icarus.shared").filter("formatNumber",e)}(),function(){"use strict";function e(e,t,i,a,n){function s(){var i=t.defer();return e.get(r,{cache:l
}).success(function(e){var t=e.map(n.fromJson).filter(Boolean);t=o(t),i.resolve(t)}).error(function(){i.reject()}),i.promise}function o(e){return e.sort(function(e,t){return e.order-t.order})}var r=a.API_URL+"accounts/extra-fields/",l=i("extraFieldsDefinition");return{getExtraFields:s,sortDefinition:o}}angular.module("icarus.shared").factory("extraFieldsService",e),e.$inject=["$http","$q","$cacheFactory","__env","ExtraFieldDefinition"]}(),function(){"use strict";function e(e){return{restrict:"E",scope:{event:"=data",showdriver:"=showdriver"},templateUrl:"app/shared/html/events-templates/base.html",link:function(t,i,a){t.getTemplate=function(){return"app/shared/html/events-templates/"+t.event.data.type.toLowerCase()+".html"},t.openModal=function(t){e.go("tracking.events.detail",{dispatchsId:t},{notify:!1})}}}}e.$inject=["$state"],angular.module("icarus.shared").directive("event",e)}(),function(){"use strict";function e(e,t,i){function a(){return e.get(o).then(n,s)}function n(e){return e.data}function s(e){return t.reject(e)}var o=i.API_URL+"accounts/drivers/";return{list:a}}e.$inject=["$http","$q","__env"],angular.module("icarus.shared").factory("driverService",e)}(),function(){"use strict";function e(e){return{restrict:"A",link:function(t,i){e(function(){i[0].focus()})}}}e.$inject=["$timeout"],angular.module("icarus.shared").directive("autofocus",e)}(),function(){"use strict";function e(e){e.state("settings",{parent:"main",url:"/settings",controller:"SettingsController",controllerAs:"vm",templateUrl:"app/settings/settings.html",data:{authentication:!0},redirectTo:"settings.users.list"}).state("settings.vehicles",{parent:"settings","abstract":!0,url:"/vehicles",template:"<ui-view></ui-view>"}).state("settings.vehicles.list",{parent:"settings.vehicles",url:"/",controller:"VehiclesListController",controllerAs:"vm",templateUrl:"app/settings/vehicles/vehicles-list.html"}).state("settings.vehicles.create",{parent:"settings.vehicles.list",url:"create",controller:"VehiclesDetailController",controllerAs:"vm",templateUrl:"app/settings/vehicles/vehicles-detail.html"}).state("settings.vehicles.detail",{parent:"settings.vehicles.list",url:":vehicleId",controller:"VehiclesDetailController",controllerAs:"vm",templateUrl:"app/settings/vehicles/vehicles-detail.html"}).state("settings.users",{parent:"settings","abstract":!0,url:"/users",template:"<ui-view></ui-view>"}).state("settings.users.list",{parent:"settings.users",url:"/",controller:"UsersListController",controllerAs:"vm",templateUrl:"app/settings/users/users-list.html"}).state("settings.users.create",{parent:"settings.users.list",url:"create",controller:"UsersDetailController",controllerAs:"vm",templateUrl:"app/settings/users/users-detail.html"}).state("settings.users.detail",{parent:"settings.users.list",url:":userId",controller:"UsersDetailController",controllerAs:"vm",templateUrl:"app/settings/users/users-detail.html"}).state("settings.skills",{parent:"settings","abstract":!0,url:"/skills",template:"<ui-view></ui-view>"}).state("settings.skills.list",{parent:"settings.skills",url:"/",controller:"SkillsListController",controllerAs:"vm",templateUrl:"app/settings/skills/skills-list.html"}).state("settings.generals",{parent:"settings","abstract":!0,url:"/routing-options",template:"<ui-view></ui-view>"}).state("settings.generals.list",{parent:"settings.generals",url:"/",controller:"GeneralsListController",controllerAs:"vm",templateUrl:"app/settings/generals/generals-list.html"}).state("settings.mobile-general",{parent:"settings","abstract":!0,url:"/mobile",template:"<ui-view></ui-view>"}).state("settings.mobile-general.list",{parent:"settings.mobile-general",url:"/",controller:"MobileGeneralsListController",controllerAs:"vm",templateUrl:"app/settings/mobile-general/mobile-general-list.html"}).state("settings.account",{parent:"settings","abstract":!0,url:"/account",template:"<ui-view></ui-view>"}).state("settings.account.list",{parent:"settings.account",url:"/",controller:"AccountController",controllerAs:"vm",templateUrl:"app/settings/account/account.html"}).state("settings.communication",{parent:"settings","abstract":!0,url:"/communication",template:"<ui-view></ui-view>"}).state("settings.communication.list",{parent:"settings.communication",url:"/",controller:"CommunicationController",controllerAs:"vm",templateUrl:"app/settings/communication/communication.html"}).state("settings.communication.detail",{parent:"settings.communication.list",url:":addonId/:addonPropertyKey",controller:"CommunicationDetailController",controllerAs:"vm",templateUrl:"app/settings/communication/communication-detail.html"}).state("settings.zones",{parent:"settings","abstract":!0,url:"/zones",template:"<ui-view></ui-view>"}).state("settings.zones.list",{parent:"settings.zones",url:"/",controller:"ZonesController",controllerAs:"vm",templateUrl:"app/settings/zones/zones.html"})}e.$inject=["$stateProvider"],angular.module("icarus.settings").config(e)}(),function(){"use strict";function e(e){e.translations("es",{settings:"Ajustes",drivers:"Usuarios",vehicles:"Veh√≠culos",skills:"Habilidades",generals:"Opciones de Ruteo",account:"Ajustes de Cuenta",mobile:"App M√≥vil",communication:"Comunicaci√≥n",zones:"Zonas",Settings:{account:"Cuenta",billing:"Facturaci√≥n",vehicles:"Veh√≠culos",users:"Conductores",required:"Requerido",optional:"Opcional",first_text:"Primero",last_text:"√öltimo",next_text:"Siguiente",previous_text:"Anterior"},Users:{type_1:"Conductor",type_2:"Administrador",type_3:"Propietario",type_4:"Monitor",without_drivers_1:"No se han creado usuarios <br>",without_drivers_2:" haga <br>",without_drivers_3:" clic <br>",without_drivers_4:"para crear uno.",just_admin_user_1:"No se han creado usuarios conductores",just_admin_user_2:" haga <br>",just_admin_user_3:" clic <br>",just_admin_user_4:"para crear uno.",title:"Configuraci√≥n de Conductores",noUsersTitle:"Sin conductores",noUsers:"No existen conductores",createUser:"Crea uno",btn_more_info:"Informaci√≥n opcional"},Vehicles:{without_vehicle_1:"Este es tu panel de veh√≠culos",without_vehicle_2:"En estos momentos no tienes veh√≠culos creados. Haz clic en el bot√≥n ",without_vehicle_3:" Nuevo veh√≠culo",without_vehicle_4:" y comienza a constru√≠r tu flota.",title:"Configuraci√≥n de veh√≠culos",no_vehicles:"Sin veh√≠culos",no_vehicles_msg_1:"No existen veh√≠culos.",no_vehicles_msg_2:"crea uno",head_title:"Informaci√≥n del veh√≠culo",error_name_vehicle_required:"Nombre del veh√≠culo requerido",error_name_required:"Nombre es requerido",error_name_duplicated:"El nombre del veh√≠culo ya existe",error_capacity_required:"Capacidad es requerido",error_capacity_min:"La Capacidad debe ser mayor a cero",error_limit_capacity:"La capacidad de carga del veh√≠culo es muy alta",error_address_origin:"Direcci√≥n de origen es requerida",error_address_end:"Direcci√≥n de destino es requerida",without_drivers_1:"No hay conductores disponibles, por favor haga clic ",without_drivers_2:"aqu√≠",without_drivers_3:"para crear conductores",without_skill_1:"No hay habilidades registradas, haga clic",without_skill_2:"aqu√≠",without_skill_3:"para crear habilidades",save:"Guardar",cancel:"Cancelar",new_vehicle_btn:"Nuevo veh√≠culo","import":"Importar",title_table_header:"Nombre",capacity_table_header:"Capacidad",capacity_2_table_header:"Capacidad 2 (Opcional)",capacity_3_table_header:"Capacidad 3 (Opcional)",origin_table_header:"Direcci√≥n de origen",destination_table_header:"Direcci√≥n de destino (Opcional)",driver_table_header:"Conductor (Opcional)",shift_start_table_header:"Inicio de Turno (Opcional)",shift_end_table_header:"Fin de Turno (Opcional)",skills_table_header:"Habilidades (Opcional)",edit:"Editar",previous:"Anterior",next:"Siguiente",title_lbl:"Nombre*",capacity_lbl:"Capacidad*",origin_lbl:"Direcci√≥n de origen*",use_address_detination:"Usar direcci√≥n de origen como direcci√≥n de destino",destination_lbl:"Direcci√≥n de destino",driver_lbl:"Conductor",select_driver:"--Seleccione conductor--",skills_lbl:"Habilidades",close:"Cerrar",delete_vehicle:"Eliminar veh√≠culo",irreversible_action:"Esta acci√≥n es irreversible",want_continue:"¬øDeseas continuar?","delete":"Eliminar",default_start_shift:"HH:MM",default_end_shift:"HH:MM",error_format_date:"* Formato de Hora incorrecto -- HH:MM",error_between_date:"* Hora de inicio debe ser menor a la Hora final.",error_empty_date:"* Debe ingresar ambas horas.",capacity_lbl_2:"Capacidad 2",capacity_lbl_3:"Capacidad 3",error_limit_capacity_2:"La capacidad 2 de carga del veh√≠culo es muy alta",error_limit_capacity_3:"La capacidad 3 de carga del veh√≠culo es muy alta",required_empty_fields_message:"Por favor rellene los campos requeridos",placeholder_name_vehicle:"Asigna un nombre a tu veh√≠culo.",placeholder_name_capacity:"10.000",placeholder_name_capacity_2:"10.000",placeholder_name_capacity_3:"10.000",placeholder_origin:"SANTA MARIA 2670, PROVIDENCIA, Santiago",placeholder_end:"MARTIN DE ZAMORA 2964, LAS CONDES, Santiago",tooltip_capacity:"Cantidad de productos, peso o carga que este veh√≠culo puede llevar como m√°ximo.",tooltip_capacity_2:"Rellena este campo en caso de que tengas restricciones de capacidad y quisieras agregar una capacidad opcional a la primera.",tooltip_schedule:"Rellena este campo si este veh√≠culo trabaja en un horario espec√≠fico distinto a tus dem√°s veh√≠culos.",tooltip_skills:"Las habilidades especiales del veh√≠culo. Por ejemplo, este veh√≠culo tiene un container de frio, o puede entrar a zonas de la ciudad que otros no pueden.",tooltip_addres_origin:"La direcci√≥n donde este veh√≠culo comienza el d√≠a.",tooltip_addres_end:"La direcci√≥n donde este veh√≠culo termina su d√≠a.",tooltip_driver_default:"Rellena este campo si este veh√≠culo es manejado siempre por una misma persona.",confirm_leave:"Atenci√≥n",confirm_leave_message_1:"Si abandona la edici√≥n del formulario puede perder los datos que no han sido guardados",confirm_leave_message_2:"¬øEsta seguro de abandonar?",confirm_leave_close:"Cerrar",confirm_leave_yes:"Abandonar",confirm_leave_message_3:"Las Habilidades es informaci√≥n opcional",confirm_leave_message_4:"El conductor por defecto es informaci√≥n opcional",btn_more_loads:"Informaci√≥n opcional",btn_download_list:"Descargar lista",import_vehicles:"Importar veh√≠culos",btn_new_vehicles:"Nuevos veh√≠culos",btn_edit_vehicles:"Editar Veh√≠culos"},Account:{options:"Opciones",btn_save:"Guardar",configs_saved_success:"Opciones guardadas satisfactoriamente",configs_saved_fail:"Hubo un error al guardar las opciones de cuenta, por favor intente nuevamente",default_values:"valores por defecto",setupOptions:{send_gps:"Activar env√≠o de GPS",enable_observations:"Motivos opcionales u obligatorios",max_distance:"M√°ximo de distancia (KM)",vehicle_refill_time:"Tiempo de recarga de veh√≠culos (MIN)",enable_jdh:"Nuevo Algoritmo de Optimizaci√≥n"},tooltipsOptions:{send_gps:"Al desactivar esta opci√≥n, los celulares de tus conductores dejar√°n de enviar datos GPS. Ap√°gala solo si tienes un proveedor de GPS externo",enable_observations:"Si haces este campo obligatorio, tus conductores deber√°n escoger una observaci√≥n para seguir avanzando.",max_distance:'Distancia m√°xima lineal en kil√≥metros a la que realizas despachos. Visitas m√°s lejos de esta distancia quedar√°n marcadas como "Demasiado lejos de la bodega"',refill_time:"Tiempo que toma cargar tus pedidos dentro del cami√≥n entre ruta y ruta.",enable_jdh:"Activa el nuevo algoritmo de creaci√≥n de rutas. Crea rutas m√°s r√°pido y de forma m√°s eficiente. En fase experimental"},error_input_required:"Campo requerido",error_input_number_valid:"Debe ingresar un valor num√©rico",error_input_number_min:"El valor m√≠nimo es de 1 km",error_input_number_max:"El valor m√°ximo es de 10000 km",error_input_refill_min:"El valor m√≠nimo es de 0"},Drivers:{driver:"Conductor",admin:"Administrador",monitoring:"Monitor",without_drivers_1:"Este es tu panel de usuarios",without_drivers_2:"En estos momentos no tienes usuarios creados. Haz clic en el bot√≥n ",without_drivers_3:"Nuevo usuario",without_drivers_4:" para crear uno.",new_driver_btn:"Nuevo conductor",new_driver:"Nuevo usuario",information_user:"Informaci√≥n de Usuario",username_error:"El nombre de usuario no debe contener espacios.",email_format:"Formato no v√°lido.",email_repeated:"Email ya se encuentra registrado.",match_password:"Las contrase√±as no coinciden, por favor intente de nuevo.",error_password:"Contrase√±a actual es incorrecta, por favor intente de nuevo.",name_table_header:"Nombre",class_table_header:"Clase",username_table_header:"Nombre de usuario",phone_table_header:"Tel√©fono",email_table_header:"Email",edit:"Editar",previous:"Anterior",next:"Siguiente","import":"Importar",driver_information:"Nombre",user_lbl:"Nombre de usuario",user_exist:"El usuario ya existe.",phone_lbl:"Tel√©fono",email:"Correo electr√≥nico",invalid_format:"Formato no v√°lido.",change_password:"Cambiar contrase√±a",password:"Contrase√±a",repeat_password:"Repetir Contrase√±a",close:"Cerrar",save:"Guardar",delete_driver:"Eliminar conductor",irreversible_action:"Esta acci√≥n es irreversible",want_continue:"¬øDeseas continuar?",cancel:"Cancelar","delete":"Eliminar",optional:"Opcional",required:"Requerido",name_required:"Nombre de usuario requerido",username_required:"Username de usuario requerido",password_required:"Contrase√±a de usuario requerido",footer_message:"Los conductores deben descargar la aplicaci√≥n m√≥vil para poder hacer seguimiento de tus visitas y despachos."},Skills:{add:"Agregar",edit:"Editar",name:"Nombre",cancel:"Cancelar","delete":"Eliminar",required:"Nombre de la habilidad requerida",repeated:"Habilidad ya se encuentra registrada",select_all:"Seleccionar todos",skill_holder:"Escribe una habilidad",without_skill_1:"No se han creado habilidades.",without_skill_2:"Utiliza la barra superior para crear tu primera habilidad.",empty_skills_title:"Este es tu panel de habilidades",empty_skills_paragraph:"Las habilidades son etiquetas que puedes crear para categorizar tipos de veh√≠culos y visitas, as√≠ podemos asignar el veh√≠culo correcto para una visita especial.",empty_skills_note:"Ejemplo: los productos congelados son asignados al cami√≥n en fr√≠o porque ambos poseen la misma habilidad."},Mobile_general:{title_form_1:"Nueva Observaci√≥n",title_form_2:"Informaci√≥n de la observaci√≥n",label:"Nombre",status:"Tipo",required:"Requerido",type:"Estado",save:"Guardar",select_observation:"--Seleccione observaci√≥n--",completed:"Realizado",failed:"Fallido",without_observations_1:"No hay observaciones creadas",without_observations_2:"por favor cree una.",error_create_observations:"Error creando la observaci√≥n, por favor intente nuevamente.",delete_observation:"Eliminar observaci√≥n",irreversible_action:"Esta acci√≥n es irreversible",want_continue:"¬øDeseas continuar?",cancel:"Cancelar","delete":"Eliminar",error_duplicated_observations:"La observaci√≥n ya se encuentra registrada",Accounts_settings:{enable_observations:"Activar obligaci√≥n de observaciones",error_save_configs:"Hubo un error al guardar la configuraci√≥n, por favor intente de nuevo.",enable_observations_message:"Si haces este campo obligatorio, tus conductores deber√°n escoger una observaci√≥n para seguir avanzando.",checkout_similars:"Unir similares por defecto",checkout_similars_message:"Habilita esta opci√≥n para que tus conductores marquen todas las visitas similares con un solo click en la app m√≥vil.",enable_signature:"Captura de firmas",enable_signature_message:"Permite que tus clientes firmen la entrega de su pedido directamente en el celular de tus conductores"}},General:{reports:"Reportes",optimization:"Optimizaci√≥n",report_from:"Desde",report_to:"Hasta","export":"Exportar",routes_report:"Reporte de Rutas",visits_report:"Reporte de Visitas",excel_name:"Reporte_",excel_headers_id:"Id",excel_headers_reference_id:"Id de referencia",excel_headers_planned_date:"Fecha Planificada",excel_headers_driver:"Conductor",excel_headers_vehicle:"Veh√≠culo",excel_headers_title:"T√≠tulo",excel_headers_address:"Direcci√≥n",excel_headers_eta:"ETA",excel_headers_etd:"ETD",excel_headers_checkin_time:"Checkin",excel_headers_checkout_time:"Checkout",excel_headers_time_service:"Tiempo de servicio",excel_headers_time_advance:"Anticipo",excel_headers_time_delay:"Atraso",excel_headers_latitude:"Latitud",excel_headers_longitude:"Longitud",excel_headers_checkout_lat:"Checkout latitud",excel_headers_checkout_lng:"Checkout longitud",excel_headers_load:"Carga",excel_headers_status:"Estado",excel_headers_comment:"Comentarios",excel_headers_observation:"Observaciones",excel_headers_time_windowStart:"Inicio de ventana horaria 1",excel_headers_time_windowEnd:"Final de ventana horaria 1 ",excel_headers_time_windowStart2:"Inicio de ventana horaria 2",excel_headers_time_windowEnd2:"Final de ventana horaria 2",excel_headers_load_2:"Carga 2",excel_headers_load_3:"Carga 3",excel_headers_skills_required:"Habilidades requeridas",excel_headers_skills_optional:"Habilidades opcionales","optimization.all_vehicles":"Minimizar veh√≠culos","optimization.balance":"Balancear","optimization.open_ended":"Rutas abiertas","optimization.join":"Unir similares","optimization.big_cluster":"Cluster con optimizaci√≥n por ruta","optimization.last_position_optimize":"Usar posici√≥n actual","optimization.displayed_options":"Visualizar en men√∫","optimization.default_values":"Valores por defecto","optimization.fmv":"Factor de Tr√°fico","optimization.fmv.high":"Lento","optimization.fmv.normal":"Normal","optimization.fmv.low":"R√°pido","optimization.single_tour":"Una ruta por veh√≠culo",saving:"Guardando",notes:"Notas",error_between_dates:"* El rango de fechas no puede superar los 31 d√≠as",error_date_start:"* La fecha inicial es mayor a la fecha final",tracking_codes_visits_report:"Reporte de visitas",excel_tracking_codes_name:"Reporte_tracking_codes_",TC_REPORT:{tracking_id:"Tracking ID",planned_date:"Fecha planeada",title:"T√≠tulo",address:"Direcci√≥n",window_start:"Inicio de ventana horaria 1",window_end:"Final de ventana horaria 1 ",window_start_2:"Inicio de ventana horaria 2",window_end_2:"Final de ventana horaria 2",comment:"Comentarios",contact_name:"Persona de contacto",contact_phone:"Tel√©fono de contacto",contact_email:"Correo electr√≥nico de contacto",reference:"Id de referencia",time_service:"Tiempo de servicio calculado",visit_checking:"Checkin",report_tc_success:"Su reporte se est√° generando. Llegar√° a su correo en breve.",report_tc_error:"Hubo un error generando su reporte."},optimization_requests_report:"Reporte de llamadas al servicio de optimizaci√≥n",error_creating_report:"Error al generar el reporte",RK_REPORT:{date:"Fecha",plan_name:"Nombre de Plan",vehicle_name:"Nombre de Vehiculo",real_kms:"Kilometros Reales",total_dispatchs:"Visitas Totales",pending_dispatchs:"Visitas Pendientes",completed_dispatchs:"Visitas Completadas",failed_dispatchs:"Visitas Fallidas",start_time:"Hora Inicio Ruta",end_time:"Hora Termino Ruta"},save_changes:"Guardar Cambios","optimization.parameters":"Par√°metros de Optimizaci√≥n","optimization.parameters.slow":"lento","optimization.parameters.fast":"r√°pido","optimization.parameters.traffic_factor":"Factor de tr√°fico",tracking_code_user_email:"Email destinatario"},Toast_skill:{unselected_skill:"Debe seleccionar al menos una habilidad"},Toast_vehicles:{error_path_skills:"Hubo problemas al consultar las habilidades",error_path_drivers:"Hubo problemas al consultar los conductores",error_path_vehicles:"Hubo problemas al consultar los veh√≠culos",vehicle_not_found:"Veh√≠culo no encontrado",error_set_position_marker:"No se pudo obtener la ubicaci√≥n, por favor intente nuevamente.",error_set_address:"La direcci√≥n introducida no es correcta, por favor corrija e intente de nuevo",error_set_address_origin_country:"Direcci√≥n de origen incorrecta, pa√≠s diferente al pa√≠s escogido en la configuraci√≥n de su cuenta.",error_set_address_destiny_country:"Direcci√≥n de destino incorrecta, pa√≠s diferente al pa√≠s escogido en la configuraci√≥n de su cuenta.",error_set_address_origin_latlng0:"Direcci√≥n de origen incorrecta, por favor corrija e intente de nuevo",error_set_address_destiny_latlng0:"Direcci√≥n de destino incorrecta, por favor corrija e intente de nuevo",can_create_routes:"Ya puedes ir a crear rutas!",error_invalid_address_1:"La direcci√≥n",error_invalid_address_2:"no existe",success_import_vehicles:"Los veh√≠culos han sido importados",error_empty_vehicles_list:"Lista de veh√≠culos vac√≠a",error_driver_not_found_1:"El conductor",error_driver_not_found_2:"no se encuentra registrado",error_data_format:"El archivo que subiste no est√° en el formato correcto. Por favor corrige e intenta nuevamente",error_duplicate_vehicle_name_1:"El nombre de veh√≠culo",error_duplicate_vehicle_name_2:"ya existe",error_import:"Hubo problemas para importar los veh√≠culos. Por favor, asegura que los datos est√°n correctos"},Communication:{title:"notificaciones al cliente final",title_detail:"Mensaje al cliente final",delete_property_sms:"Borrar SMS",label_sms:"Mensaje",warning_text_too_large:"El contenido de su mensaje es demasiado largo",warning_maxlength:"Texto demasiado largo",warning_required:"Campo requerido",preview_title:"Previsualizaci√≥n del mensaje",close:"Cerrar",cancel:"Cancelar",save:"Guardar","delete":"Eliminar",modal_delete_event_title:"Eliminar evento",modal_message_1:"Esta acci√≥n es irreversible",modal_message_2:"¬øDesea continuar?",visit_scheduled:"Pedido programado",route_started:"Pedido en ruta",checkout_success:"Pedido exitoso",checkout_failed:"Pedido fallido",insert:"Insertar",delete_property_email:"Borrar EMAIL",label_email_subject:"asunto",label_email_msg:"mensaje",comments:"Comentarios",attachment:"Adjuntar fotos",attachment_tooltip:"Adjunta al mail las fotos tomadas por el conductor cuando realiz√≥ la visita al lugar",id_reference:"ID-REF-123",warning_repeated_tag:"Ya existe la etiqueta en el asunto",livetracking_widget:"Livetracking Widget",generate_insertion_code:"Generar c√≥digo de inserci√≥n",insertion_code:"C√≥digo de inserci√≥n",copy_code:"Copiar c√≥digo",search:"Buscar",custom_tracking_code:"Usar ID de visita como c√≥digo de seguimiento",custom_tracking_code_tooltip:'Al usar esta opci√≥n, Live Tracking usar√° el texto que ingreses en cada visita en el campo "ID de Referencia". Debes asegurarte que ese campo sea √∫nico y que no contenga caracteres extra√±os o Live Tracking no funcionar√° correctamente'},Zones:{button_edit:"Editar",add_zone:"Crear nueva zona",Map:{clear:"Resetear Zonas"},Edit:{input_placeholder:"Nombre de Zona",cancel:"Cancelar",save:"Guardar",save_success:"Zona guardada exitosamente",save_fail:"Hubo un problema al guardar la zona"},Items_list:{title:"veh√≠culos",msg_items_empty:"no tienes veh√≠culos",call_action:"Crear veh√≠culo",msg_empty_filter:"Su b√∫squeda no gener√≥ resultados, por favor intente nuevamente."},Delete:{title:"Borrar Zona",button_cancel:"Cancelar",button_delete:"Borrar",irreversible_action:"Esta acci√≥n es irreversible",want_continue:"¬øDeseas continuar?",delete_success:"Zona borrada exitosamente",delete_fail:"Hubo un problema al borrar la zona"},Bulk:{btn_download_zones:"Descargar Zonas",btn_import_zones:"Asignar Zonas",excel_header_vehicles:"Veh√≠culos",excel_header_zones:"Zonas",error_no_data:"El archivo no tiene datos v√°lidos",error_upload_failure:"Error enviando el archivo de asignaci√≥n de Zonas",result_modal_title:"Zonas asignadas",result_modal_upload_success:"Tus asignaciones de zonas se realizaron correctamente",resut_modal_upload_with_errors:"Estas filas presentaron problemas:",result_modal_row_header:"Fila",result_modal_error_header:"Error",result_modal_error_vehicle_not_found:"Veh√≠culo no existe en la cuenta",result_modal_error_zone_not_found:"Zona no existe en la cuenta"},validation_error_name:"Ya existe una zona con este nombre.",Actions:{use_zones:{title:"optimizaci√≥n de rutas",use_zones:"Usar Zonas",hide_zones:"Ocultar"},save_actions_zones:"Guardar cambios",success_zone_property:"Cambios guardados exitosamente",error_zone_property:"Hubo un problema al guardar los cambios, intente de nuevo"}}}),e.translations("en",{settings:"Settings",drivers:"Users",vehicles:"Vehicles",skills:"Skills",generals:"Routing options",account:"Account",mobile:"Mobile App",communication:"Communication",zones:"Zones",Settings:{account:"Account",billing:"Billing info",vehicles:"Vehicles",users:"Drivers",empty_data:"No hay data que mostrar",required:"Required",optional:"Optional",first_text:"First",last_text:"Last",next_text:"Next",previous_text:"Previous"},Users:{type_1:"Driver",type_2:"Admin",type_3:"Owner",type_4:"Monitor",without_drivers_1:"There are no users created",without_drivers_2:" please click <br>",without_drivers_3:" here <br>",without_drivers_4:"to create one.",just_admin_user_1:"There are no users drivers created",just_admin_user_2:" please click <br>",just_admin_user_3:" here <br>",just_admin_user_4:"to create one.",title:"Driver information",noUsersTitle:"No drivers",noUsers:"There are no drivers created",createUser:"Create one",btn_more_info:"Optional information"},Vehicles:{without_vehicle_1:"This is your vehicle panel",without_vehicle_2:"At the moment you do not have vehicles created. Click the button",without_vehicle_3:"New vehicle",without_vehicle_4:" and start building your fleet.",title:"Vehicles information",no_vehicles:"No vehicles",no_vehicles_msg_1:"There aren't vehicles in your account.",no_vehicles_msg_2:"create one",head_title:"Vehicle information",error_name_vehicle_required:"Name vehicle is required",error_name_required:"Name is required",error_name_duplicated:"Name already exists",error_capacity_required:"Load capacity is required",error_capacity_min:"Load capacity must be greater or equals to zero",error_limit_capacity:"Load capacity of vehicle is very high",error_address_origin:"Address origin is required",error_address_end:"Destination address is required",without_drivers_1:"There is no drivers available, please click ",without_drivers_2:"here",without_drivers_3:"to create drivers",without_skill_1:"There is no skills registered, please click",without_skill_2:"here",without_skill_3:"to create skills",save:"Save",cancel:"Cancel",new_vehicle_btn:"New vehicle","import":"Import",title_table_header:"Name",capacity_table_header:"Load",capacity_2_table_header:"Load 2 (Optional)",capacity_3_table_header:"Load 3 (Optional)",origin_table_header:"Start",destination_table_header:"Destination (Optional)",driver_table_header:"Driver (Optional)",shift_start_table_header:"Shift Start (Optional)",shift_end_table_header:"Shift End (Optional)",skills_table_header:"Skills (Skills)",edit:"Edit",previous:"Back",next:"Next",title_lbl:"Name*",capacity_lbl:"Load*",capacity_lbl_2:"Load 2",capacity_lbl_3:"Load 3",origin_lbl:"Start*",use_address_detination:"Use origin address as destination address",destination_lbl:"Destination",driver_lbl:"Driver",select_driver:"--Select driver--",skills_lbl:"Skills",close:"Close",delete_vehicle:"Delete vehicle",irreversible_action:"This vehicle will be deleted",want_continue:"Do you want to continue?","delete":"Delete",default_start_shift:"HH:MM",default_end_shift:"HH:MM",error_format_date:"* Wrong time format -- HH:MM",error_between_date:"* Start time must be less than the final hour.",error_empty_date:"* You must enter two hours.",required_empty_fields_message:"Please fill in the required fields",placeholder_name_vehicle:"Name your vehicle.",placeholder_name_capacity:"10,000",placeholder_name_capacity_2:"10,000",placeholder_name_capacity_3:"10,000",placeholder_origin:"1152 Valencia St, San Francisco, CA 94110",placeholder_end:"5801 Geary Blvd, San Francisco, CA 94121",tooltip_capacity:"Quantity of products, weight or load that this vehicle can carry at most.",tooltip_capacity_2:"Fill in this field in case you have capacity restrictions and would like to add an optional capacity to the first one.",tooltip_schedule:"Fill in this field if this vehicle works on a specific schedule other than your other vehicles.",tooltip_skills:"The special skills of the vehicle. For example, this vehicle has a cold container, or it can enter areas of the city that others can not.",tooltip_addres_origin:"The address where this vehicle begins the day.",tooltip_addres_end:"The address where this vehicle ends its day.",tooltip_driver_default:"Fill this field if this vehicle is always handled by the same person.",confirm_leave:"Attention",confirm_leave_message_1:"If you leave the editing of the form you can lose the data that has not been saved",confirm_leave_message_2:"Are you sure to quit?",confirm_leave_close:"Close",confirm_leave_yes:"Quit",confirm_leave_message_3:"Skills is optional informationl",confirm_leave_message_4:"The default driver is optional information",btn_more_loads:"Optional information",btn_download_list:"Download list",import_vehicles:"Import vehicles",btn_new_vehicles:"New Vehicles",btn_edit_vehicles:"Edit Vehicles"},Account:{options:"Options",btn_save:"save",configs_saved_success:"Options saved successfully",configs_saved_fail:"There was an error saving the account options, please try again",default_values:"Default values",setupOptions:{send_gps:"Enable GP sending",enable_observations:"Optional or mandatory reasons",max_distance:"Maximum distance (KM)",vehicle_refill_time:"Vehicle refill time (MIN)",enable_jdh:"New Optimization Algorithm "},tooltipsOptions:{send_gps:"When you deactivate this option, your drivers' cell phones will stop sending GPS data. Turn it off only if you have an external GPS provider.",enable_observations:"If you make this field mandatory, your drivers should choose an observation to keep moving forward.",max_distance:'Maximum linear distance in kilometers to which you make dispatches. Visits further from this distance will be marked as "Too far from the depot"',refill_time:"Time that takes to load your orders inside the truck between routes",enable_jdh:"Turn on our new route's creation algorithm. Create routes faster and more efficiently. In Experimental Phase"},error_input_required:"Required field",error_input_number_valid:"You did not enter a valid number",error_input_number_min:"Your field value is lesser minimum value",error_input_number_max:"Your field value is greater maximum value",error_input_refill_min:"The minimum value is 0"},Drivers:{driver:"Driver",admin:"Admin",monitoring:"Monitoring",without_drivers_1:"This is your user panel",without_drivers_2:"you currently have no users created. Click the button ",without_drivers_3:"New user",without_drivers_4:"to created one.",new_driver_btn:"New driver",new_driver:"New user",information_user:"Information user",username_error:"The username must not contain spaces.",email_format:"Invalid format",email_repeated:"Email already registered.",match_password:"Passwords do not match, please try again.",error_password:"Current password is incorrect, please try again.",name_table_header:"Name",class_table_header:"Class",username_table_header:"Username",phone_table_header:"Phone",email_table_header:"Email",edit:"Edit",previous:"Back",next:"Next","import":"Import",driver_information:"Fullname",user_lbl:"Username",user_exist:"Username already taken",phone_lbl:"Phone",email:"Email",invalid_format:"Invalid format.",change_password:"Change password",password:"Password",repeat_password:"Repeat password",close:"Cancel",save:"Save",delete_driver:"Delete driver",irreversible_action:"This action can't be undo.",want_continue:"Do you want to continue?",cancel:"Cancel","delete":"Delete",optional:"Optional",required:"Required",name_required:"Name required",username_required:"Username required",password_required:"Pasword required",footer_message:"Drivers must download the mobile application in order to track their visits and dispatches."},Skills:{add:"Add",edit:"Edit",name:"Name",cancel:"Cancel","delete":"Delete",skill_holder:"Write a skill",required:"Name of skill is required",repeated:"Skill is already registered",select_all:"Select all",without_skill_1:"No skills have been created.",without_skill_2:"Use the top bar to create your first skill.",empty_skills_title:"This is your skill panel",empty_skills_paragraph:"Skills are labels that you can create to categorize vehicle types and visits, so we can assign the right vehicle for a special visit.",
empty_skills_note:"Example: frozen products are assigned to the cold truck because both have the same ability."},Mobile_general:{title_form_1:"New Observation",title_form_2:"Information observation",label:"Name",status:"Type",required:"Required",type:"Status",save:"Save",select_observation:"--Select Observation--",completed:"Completed",failed:"Failed",name_required:"Nombre de la observaci√≥n es requerido",type_required:"Tipo de la observaci√≥n es requerido",without_observations_1:"There are no observations created",without_observations_2:"please created one.",error_create_observations:"Error creating observation, please try again.",delete_observation:"Delete Observation",irreversible_action:"This action can't be undo.",want_continue:"Do you want to continue?",cancel:"Cancel","delete":"Delete",error_duplicated_observations:"The observation already exists",Accounts_settings:{enable_observations:"Enable obligation of observations",error_save_configs:"There was an error saving settings, please try again.",enable_observations_message:"If you make this field mandatory, your drivers should choose an observation to keep moving forward.",checkout_similars:"Join similars by default",checkout_similars_message:"Turn on this option so your drivers can select all of their similar visits on one click on their mobile app.",enable_signature:"Signature Capture",enable_signature_message:"Allow your customers to sign the delivery of your order directly on the cell phone of your drivers"}},General:{reports:"Reports",optimization:"Optimization",report_from:"From",report_to:"To","export":"Export",routes_report:"Routes Report",visits_report:"Visits Report",excel_name:"Report_",excel_headers_id:"Id",excel_headers_reference_id:"Reference Id",excel_headers_planned_date:"Planned Date",excel_headers_driver:"Driver",excel_headers_vehicle:"Vehicle",excel_headers_title:"Title",excel_headers_address:"address",excel_headers_eta:"ETA",excel_headers_etd:"ETD",excel_headers_checkin_time:"Checkin Time",excel_headers_checkout_time:"Checkout Time",excel_headers_time_service:"Service time",excel_headers_time_advance:"Advance",excel_headers_time_delay:"Delay",excel_headers_latitude:"Latitude",excel_headers_longitude:"Longitude",excel_headers_checkout_lat:"Checkout latitude",excel_headers_checkout_lng:"Checkout longitude",excel_headers_load:"Load",excel_headers_status:"Status",excel_headers_comment:"Comments",excel_headers_observation:"Observations",excel_headers_time_windowStart:"Start of time window 1",excel_headers_time_windowEnd:"End of time window 1 ",excel_headers_time_windowStart2:"Start of time window 2",excel_headers_time_windowEnd2:"End of time window 2",excel_headers_load_2:"Load 2",excel_headers_load_3:"Load 3",excel_headers_skills_required:"Required skills",excel_headers_skills_optional:"Optional skills","optimization.all_vehicles":"Minimize vehicles","optimization.balance":"Balance","optimization.open_ended":"Open routes","optimization.join":"Join similars","optimization.big_cluster":"Cluster with optimization","optimization.last_position_optimize":"Use current location","optimization.displayed_options":"Visualize on menu","optimization.default_values":"Default values","optimization.fmv":"Traffic factor","optimization.fmv.high":"Slow","optimization.fmv.normal":"Normal","optimization.fmv.low":"Speedy","optimization.single_tour":"Single tour",saving:"Saving",notes:"Notes",error_between_dates:"* Date range can not exceed 31 days",error_date_start:"* The start date is greater than the end date",tracking_codes_visits_report:"Visits report",excel_tracking_codes_name:"Tracking_codes_report_",TC_REPORT:{tracking_id:"Tracking ID",planned_date:"Planned date",title:"Title",address:"Address",window_start:"Start of time window 1",window_end:"End of time window 1",window_start_2:"Start of time window 2",window_end_2:"End of time window 2",comment:"Comments",contact_name:"Contact name",contact_phone:"Contact phone",contact_email:"Contact email",reference:"Reference ID",time_service:"Calculated service time",visit_checking:"Checkin",report_tc_success:"Your report is being generated. It will arrive to your mail soon.",report_tc_error:"There was an error generating your report."},optimization_requests_report:"Requests of optimization service report",error_creating_report:"Error creating report",RK_REPORT:{date:"Date",plan_name:"Plan's Name",vehicle_name:"Vehicles Name",real_kms:"Real KMs",total_dispatchs:"Total Visits",pending_dispatchs:"Pending Visits",completed_dispatchs:"Completed Visits",failed_dispatchs:"Failed Visits",start_time:"Route Start Time",end_time:"Route End Time"},save_changes:"Save Changes","optimization.parameters":"Optimization Parameters","optimization.parameters.traffic_factor":"Traffic Factor","optimization.parameters.slow":"slow","optimization.parameters.fast":"fast",tracking_code_user_email:"Email recipient"},Toast_skill:{unselected_skill:"You must select at least one skill"},Toast_vehicles:{error_path_skills:"There were problems when querying skills path",error_path_drivers:"There were problems when querying drivers path",error_path_vehicles:"There were problems when querying vehicles path",vehicle_not_found:"Vehicle not found",error_set_position_marker:"Could not get the location, please try again.",error_set_address:"The address you entered is not correct, please correct and try again",error_set_address_origin_country:"Incorrect origin address, different from the country selected in setting up your account country.",error_set_address_destiny_country:"Incorrect destination address, different from the country selected in setting up your account country.",error_set_address_origin_latlng0:"Incorrect origin address, please correct and try again",error_set_address_destiny_latlng0:"Destination address incorrect, please correct and try again",can_create_routes:"You can now create routes!",error_invalid_address_1:"Address",error_invalid_address_2:"doesn't exists",success_import_vehicles:"Vehicles imported",error_empty_vehicles_list:"Empty vehicles list",error_driver_not_found_1:"Driver",error_driver_not_found_2:"is not registered",error_data_format:"The file you uploaded has the wrong format. Please make the corrections and try again",error_duplicate_vehicle_name_1:"Vehicle name",error_duplicate_vehicle_name_2:"already exists",error_import:"There were problems importing the vehicles. Plase make sure the data is correct"},Communication:{title:"Notifications to the final client",title_detail:"Message to the final client",delete_property_sms:"Delete SMS",label_sms:"Message",warning_text_too_large:"The content of your message is too long",warning_maxlength:"Text too long",warning_required:"required field",preview_title:"Preview the message",close:"Close",cancel:"Cancel",save:"Save","delete":"Delete",modal_delete_event_title:"Delete event",modal_message_1:"This action is irreversible",modal_message_2:"Do you want to continue?",visit_scheduled:"Scheduled order",route_started:"Order in route",checkout_success:"Successful order",checkout_failed:"Failed order",insert:"Insert",delete_property_email:"Delete EMAIL",label_email_subject:"subject",label_email_msg:"message",comments:"Comments",attachment:"Attach photos",attachment_tooltip:"Attach to the mail the photos taken by the driver when he made the visit to the place",id_reference:"ID-REF-123",warning_repeated_tag:"The tag already exists in the subject",livetracking_widget:"Livetracking Widget",generate_insertion_code:"Generate insertion code",insertion_code:"Insertion code",copy_code:"Copy code",search:"Search",custom_tracking_code:"Use visit ID as tracking code",custom_tracking_code_tooltip:"By using this option, Live Tracking will use the text that you enter on each visit on the field \"Reference ID\". You must make sure that the code you enter is unique for each visit, and that it doesn't contain spaces or other non conventional characters, or Live Tracking won't work properly"},Zones:{button_edit:"Edit",add_zone:"Create new zone",Map:{clear:"Reset Zones"},Edit:{input_placeholder:"Name of Zone",cancel:"Cancel",save:"Save",save_success:"Zone successfully saved",save_fail:"There was a problem saving the zone"},Items_list:{title:"Vehicles",msg_items_empty:"you do not have vehicles",call_action:"Create vehicle",msg_empty_filter:"Your search did not produce results, please try again."},Delete:{title:"Delete Zone",button_cancel:"Cancel",button_delete:"Delete",irreversible_action:"This action can't be undo.",want_continue:"Do you want to continue?",delete_success:"Zone successfully deleted",delete_fail:"There was a problem deleting the zone"},Bulk:{btn_download_zones:"Download Zones",btn_import_zones:"Import Assignations",excel_header_vehicles:"Vehicles",excel_header_zones:"Zones",error_no_data:"The file doesn't have any valid data",error_upload_failure:"Error sending Zones asignation file",result_modal_title:"Zones assigned",result_modal_upload_success:"Your zones assignations have been made correctly",resut_modal_upload_with_errors:"There were problems with these files",result_modal_row_header:"Row",result_modal_error_header:"Error",result_modal_error_vehicle_not_found:"Vehicle doesn't exist on your account",result_modal_error_zone_not_found:"Zone doesn't exist in your account"},validation_error_name:"A zone with this name already exists.",Actions:{use_zones:{title:"route optimization",use_zones:"Use Zones",hide_zones:"Hide"},save_actions_zones:"Save changes",success_zone_property:"Successfully saved changes",error_zone_property:"There was a problem saving changes, try again"}}}),e.translations("pt",{settings:"Ajustes",drivers:"Usu√°rios",vehicles:"Ve√≠culos",skills:"Habilidades",generals:"Op√ß√µes de roteamento",account:"Conta",mobile:"App Mobile",communication:"Comunica√ß√£o",zones:"Zonas",Settings:{account:"Cuenta",billing:"Faturamento",vehicles:"Ve√≠culos",users:"Motoristas",required:"Solicitado",optional:"Opcional",first_text:"Primeiro",last_text:"√öltimo",next_text:"Seguinte",previous_text:"Anterior"},Users:{type_1:"Motorista",type_2:"Administrador",type_3:"Propriet√°rio",type_4:"Monitor",without_drivers_1:"N√£o h√° usu√°rios",without_drivers_2:"fa√ßa ",without_drivers_3:"clique ",without_drivers_4:"para criar um.",just_admin_user_1:"N√£o h√° usu√°rios",just_admin_user_2:" fa√ßa <br>",just_admin_user_3:" clique <br>",just_admin_user_4:"para criar um.",title:"Configura√ß√£o do motorista",noUsersTitle:"N√£o motoristas",noUsers:"No existen motorista",createUser:"Criar um",btn_more_info:"Informa√ß√µes opcionais"},Vehicles:{without_vehicle_1:"Este √© o seu painel de ve√≠culo",without_vehicle_2:"No momento voc√™ n√£o possui ve√≠culos cadastrados. Clique no bot√£o ",without_vehicle_3:"Novo ve√≠culo",without_vehicle_4:" para come√ßar a construir a sua frota.",title:"Configura√ß√£o do ve√≠culos",no_vehicles:" ve√≠culos",no_vehicles_msg_1:"N√£o h√° ve√≠culos.",no_vehicles_msg_2:"criar um",head_title:"Informa√ß√£o do ve√≠culo",error_name_vehicle_required:"Nome do ve√≠culo √© solicitado",error_name_required:"Nome √© solicitado",error_name_duplicated:"Nome de ve√≠culo ja existe",error_capacity_required:"A capacidade √© necess√°ria",error_capacity_min:"Capacidade deve ser maior que zero",error_limit_capacity:"A capacidade de carga do ve√≠culo √© muito alta",error_address_origin:"Endere√ßo de origem √© necess√°ria",error_address_end:"Endere√ßo de destino √© necess√°ria",without_drivers_1:"N√£o h√° motoristas dispon√≠veis, por favor clique ",without_drivers_2:"aqui",without_drivers_3:"para criar motorista",without_skill_1:"N√£o h√° habilidades registradas, clique aqui para criar habilidades",without_skill_2:"aqui",without_skill_3:"para criar habilidades",save:"Salvar",cancel:"Fechar",new_vehicle_btn:"Novo ve√≠culo","import":"Importar",title_table_header:"Nome",capacity_table_header:"Capacidade",capacity_2_table_header:"Capacidade 2 (Opcional)",capacity_3_table_header:"Capacidade 3 (Opcional)",origin_table_header:"Origem",destination_table_header:"Destino (Opcional)",driver_table_header:"Motorista (Opcional)",shift_start_table_header:"In√≠cio do turno (Opcional)",shift_end_table_header:"Fin do turno (Opcional)",skills_table_header:"Habilidades (Opcional)",edit:"Editar",previous:"Anterior",next:"Seguinte",title_lbl:"Nome*",capacity_lbl:"Capacidade*",origin_lbl:"Origem*",use_address_detination:"Utilizar o endere√ßo de origem como endere√ßo de destino",destination_lbl:"Destino",driver_lbl:"Motorista",select_driver:"--Seleccione motorista--",skills_lbl:"Habilidades",close:"Fechar",delete_vehicle:"Excluir ve√≠culo",irreversible_action:"Esta a√ß√£o √© irrevers√≠vel",want_continue:"Deseja continuar?","delete":"Excluir",default_start_shift:"HH:MM",default_end_shift:"HH:MM",error_format_date:"* Formato da hora incorreto -- HH:MM",error_between_date:"* A hora de in√≠cio deve ser menor do que a √∫ltima hora.",error_empty_date:"* Voc√™ deve digitar duas horas.",capacity_lbl_2:"Capacidade 2",capacity_lbl_3:"Capacidade 3",error_limit_capacity_2:"A capacidade 2 do ve√≠culo √© muito alta",error_limit_capacity_3:"A capacidade 3 do ve√≠culo √© muito alta",required_empty_fields_message:"Por favor, preencha os campos obrigat√≥rios",placeholder_name_vehicle:"Atribuir um nome ao seu ve√≠culo.",placeholder_name_capacity:"10,000",placeholder_name_capacity_2:"10,000",placeholder_name_capacity_3:"10,000",placeholder_origin:"1152 Valencia St, San Francisco, CA 94110",placeholder_end:"5801 Geary Blvd, San Francisco, CA 94121",tooltip_capacity:"N√∫mero de produtos, o peso ou carga que o ve√≠culo pode transportar um m√°ximo.",tooltip_capacity_2:"Preencha este campo se voc√™ tiver restri√ß√µes de capacidade e gostaria de adicionar um capacidade opcional para o primeiro.",tooltip_schedule:"Preencha este campo se este ve√≠culo funciona em um diferente espec√≠fica agenda para seus outros ve√≠culos.",tooltip_skills:"As habilidades especiais do ve√≠culo. Por exemplo, este ve√≠culo tem um recipiente de frio, ou pode entrar em √°reas da cidade que outros n√£o podem.",tooltip_addres_origin:"O endere√ßo em que o ve√≠culo come√ßa o dia.",tooltip_addres_end:"O endere√ßo onde este ve√≠culo termina o seu dia",tooltip_driver_default:"preencher este campo se este ve√≠culo √© sempre manipulados pela mesma pessoa.",confirm_leave:"Aten√ß√£o",confirm_leave_message_1:"Se voc√™ deixar o formul√°rio de edi√ß√£o voc√™ poder√° perder dados que n√£o foram salvos",confirm_leave_message_2:"Tem certeza que deseja sair?",confirm_leave_close:"Fechar",confirm_leave_yes:"Sair",confirm_leave_message_3:"Habilidades √© uma informa√ß√£o opcional",confirm_leave_message_4:"O padr√£o √© de informa√ß√£o de motorista opcional",btn_more_loads:"Informa√ß√µes opcionais",btn_download_list:"Baixar lista",import_vehicles:"Importar ve√≠culos",btn_new_vehicles:"Novos Ve√≠culos",btn_edit_vehicles:"Editar Ve√≠culos"},Account:{options:"Op√ß√µes",btn_save:"salvar",configs_saved_success:"Op√ß√µes salvas com sucesso",configs_saved_fail:"Houve um erro ao salvar as op√ß√µes da conta, por favor tente novamente",default_values:"Default",setupOptions:{send_gps:"Permitir o envio GPS",enable_observations:"Motivos opcionais ou obrigat√≥rios",max_distance:"A dist√¢ncia m√°xima (KM)",vehicle_refill_time:"Tempo de recarga de ve√≠culos (MIN)",enable_jdh:"Nova Otimiza√ß√£o Algorithm"},tooltipsOptions:{send_gps:"Desativar essa op√ß√£o, os drivers de c√©lulas ir√° parar de enviar dados de GPS. Deslig√°-lo somente se voc√™ tiver um provedor de GPS externo.",enable_observations:"Se voc√™ fizer esse campo de preenchimento obrigat√≥rio, os controladores devem escolher uma observa√ß√£o para avan√ßar.",max_distance:'Dist√¢ncia m√°xima linear em quil√¥metros que realizam escrit√≥rios. Visitas mais longe esta dist√¢ncia ser√° marcado como "Muito longe da adega".',refill_time:"Tempo que leva para carregar suas ordens dentro do caminh√£o entre rotas",enable_jdh:"Ative o novo algoritmo para a criacao de rotas. Cria rotas mais rapidas e mais eficientes. Fase de teste"},error_input_required:"campo obrigat√≥rio",error_input_number_valid:"Voc√™ deve digitar um valor num√©rico",error_input_number_min:"O valor m√≠nimo √© de 1 km",error_input_number_max:"O valor m√°ximo √© 10000 km",error_input_refill_min:"O valor m√≠nimo √© 0"},Drivers:{driver:"Motorista",admin:"Administrador",monitoring:"Monitoramento",without_drivers_1:"Este √© o seu painel de usu√°rio",without_drivers_2:"No momento voc√™ n√£o possui usu√°rios cadastrados. Clique no bot√£o ",without_drivers_3:"Novo usu√°rio",without_drivers_4:" para criar um.",new_driver_btn:"Novo motorista",new_driver:"Novo usu√°rio",information_user:"Informa√ß√£o do usu√°rio",username_error:"O nome de usu√°rio n√£o deve conter espa√ßos.",email_format:"formato inv√°lido.",email_repeated:"E-mail j√° registrados.",match_password:"As senhas n√£o correspondem, por favor tente novamente.",error_password:"senha atual est√° incorreto, por favor, tente novamente",name_table_header:"Nome",class_table_header:"Classe",username_table_header:"Nome de usu√°rio",phone_table_header:"Telefone",email_table_header:"E-mail",edit:"Editar",previous:"Anterior",next:"seguinte","import":"Importar",driver_information:"Informa√ß√£o do motorista",user_lbl:"Usuario",user_exist:"O usu√°rio j√° existe.",phone_lbl:"Telefone",email:"E-mail",invalid_format:"formato inv√°lido.",change_password:"mudan√ßa de senha",password:"Senha",repeat_password:"Repetir a senha",close:"Fechar",save:"Salvar",delete_driver:"Excluir motorista",irreversible_action:"Esta a√ß√£o √© irrevers√≠vel",want_continue:"Voc√™ deseja continuar?",cancel:"Cancelar","delete":"Excluir",optional:"Opcional",required:"Requerido",name_required:"Nome de usu√°rio requerido",username_required:"Nome de usu√°rio requerido",password_required:"Senha de usu√°rio requerido",footer_message:"Os motoristas deve baixar o aplicativo m√≥vel para rastrear suas visitas e despachos."},Skills:{add:"Adicionar",edit:"Editar",name:"Nome",cancel:"Cancelar","delete":"Excluir",skill_holder:"Escrever uma habilidade",required:"Nomeie a habilidade necess√°ria",repeated:"Habilidade j√° est√° registrado",select_all:"selecionar tudo",without_skill_1:"N√£o houve habilidades.",without_skill_2:"Use a barra de cima para criar a sua primeira habilidade.",empty_skills_title:"Este √© o seu painel de habilidades",empty_skills_paragraph:"Habilidades s√£o r√≥tulos que voc√™ pode criar para categorizar os tipos de ve√≠culos e visita, por isso podemos atribuir o ve√≠culo correto para uma visita especial.",empty_skills_note:"Exemplo: congelado produtos s√£o atribu√≠dos ao frio caminh√£o porque ambos t√™m a mesma capacidade."},Mobile_general:{title_form_1:"Nova Observa√ß√£o",title_form_2:"Informa√ß√£o da observa√ß√£o",label:"Nome",status:"Tipo",required:"Requerido",type:"estado",save:"Salvar",select_observation:"--Selecionar Observa√ß√£o--",completed:"Realizado",failed:"Fracassado",name_required:"Nome da observa√ß√£o √© requerido",type_required:"Tipo de observa√ß√£o √© requerido",without_observations_1:"N√£o h√° obersa√ß√µes criadas",without_observations_2:"Por favor, crie uma.",error_create_observations:"Erro ao criar a observa√ß√£o, por favor tente novamente.",delete_observation:"Excluir observa√ß√£o",irreversible_action:"Esta a√ß√£o √© irrevers√≠vel",want_continue:"Voc√™ deseja continuar?",cancel:"Cancelar","delete":"Excluir",error_duplicated_observations:"A observa√ß√£o j√° est√° registrado",Accounts_settings:{enable_observations:"Ative observa√ß√µes obriga√ß√£o",error_save_configs:"Ocorreu um erro ao salvar suas configura√ß√µes, por favor tente novamente.",enable_observations_message:"Se voc√™ fizer este campo de preenchimento obrigat√≥rio, os motoristas devem escolher uma observa√ß√£o a fazer mais progressos.",checkout_similars:"Mesclar padr√£o semelhante",checkout_similars_message:"Ative esta op√ß√£o para que seus drivers possam selecionar todas as suas visitas semelhantes com um clique em seu aplicativo.",enable_signature:"Signature Capture",enable_signature_message:"Permita que seus clientes assinem a entrega do seu pedido diretamente no celular de seus motorista"}},General:{reports:"Relat√≥rios",optimization:"Otimiza√ß√£o",report_from:"De",report_to:"√Ä","export":"Exportar",excel_name:"Relat√≥rios",routes_report:"Relat√≥rio Rotas",visits_report:"Relat√≥rio Entregas",excel_headers_id:"Id",excel_headers_reference_id:"refer√™ncia ID",excel_headers_planned_date:"Data prevista",excel_headers_driver:"Motorista",excel_headers_vehicle:"Ve√≠culo",excel_headers_title:"T√≠tulo",excel_headers_address:"Endere√ßo",excel_headers_eta:"ETA",excel_headers_etd:"ETD",excel_headers_checkin_time:"Checkin",excel_headers_checkout_time:"Checkout",excel_headers_time_service:"Tempo de servi√ßo",excel_headers_time_advance:"Antecipa√ß√£o",excel_headers_time_delay:"Atraso",excel_headers_latitude:"Latitude",excel_headers_longitude:"Longitude",excel_headers_checkout_lat:"Checkout latitude",excel_headers_checkout_lng:"Checkout longitude",excel_headers_load:"Carga",excel_headers_status:"Estado",excel_headers_comment:"Coment√°rios",excel_headers_observation:"Observa√ß√µes",excel_headers_time_windowStart:"Janela de hor√°rio Inicial 1",excel_headers_time_windowEnd:"Janela de hor√°rio Final 1",excel_headers_time_windowStart2:"Janela de hor√°rio Inicial 2",excel_headers_time_windowEnd2:"Janela de hor√°rio Final 2",excel_headers_load_2:"Carga 2",excel_headers_load_3:"Carga 3",excel_headers_skills_required:"Habilidades necess√°rias",excel_headers_skills_optional:"Habilidades adicionais","optimization.all_vehicles":"Minimizar veiculos","optimization.balance":"Balancear","optimization.open_ended":"Rotas abertas","optimization.join":"Unir similares","optimization.big_cluster":"Cluster com otimiza√ß√£o de rotas","optimization.last_position_optimize":"Usar localiza√ß√£o atual","optimization.displayed_options":"Menu exibi√ß√£o","optimization.default_values":"Valores","optimization.fmv":"tr√°fego fator","optimization.fmv.high":"Lento","optimization.fmv.normal":"Normal","optimization.fmv.low":"R√°pido","optimization.single_tour":"Uma rota por ve√≠culo",saving:"Guardando",notes:"Notas",error_between_dates:"* O intervalo de datas n√£o pode exceder 31 dias",error_date_start:"* A data de in√≠cio √© maior do que a data de t√©rmino",tracking_codes_visits_report:"Relat√≥rio de visitas",excel_tracking_codes_name:"Relat√≥rio_de_tracking_codes_",TC_REPORT:{tracking_id:"Tracking ID",planned_date:"Data prevista",title:"T√≠tulo",address:"Endere√ßo",window_start:"Janela de hor√°rio Inicial 1",window_end:"Janela de hor√°rio Final 1",window_start_2:"anela de hor√°rio Inicial 2",window_end_2:"Janela de hor√°rio Final 2",comment:"Coment√°rios",contact_name:"Nome de contato",contact_phone:"Telefone de contato",contact_email:"Correio eletr√¥nico de contato",reference:"Refer√™ncia ID",time_service:"tempo de servi√ßo calculado",visit_checking:"Checkin",report_tc_success:"Seu relat√≥rio foi gerado, em breve voc√™ receber√° um e-mail",report_tc_error:"Houve um erro ao gerar o relat√≥rio."},tracking_code_user_email:"E-MAIL DO DESTINAT√ÅRIO",optimization_requests_report:"Relat√≥rio chamadas servi√ßo de otimiza√ß√£o",error_creating_report:"Erro ao criar o relat√≥rio",RK_REPORT:{date:"Data",plan_name:"Nome do Plano",vehicle_name:"Nome do Ve√≠culo",real_kms:"KMs Reais",total_dispatchs:"Entregas totais",pending_dispatchs:"Entregas pendentes",completed_dispatchs:"Entregas realizadas",failed_dispatchs:"Entregas √±ao realizadas",start_time:"Hora inicial da rota",end_time:"Hora final da rota"},save_changes:"Salvar Altera√ß√µes","optimization.parameters":"par√¢metros de otimiza√ß√£o","optimization.parameters.traffic_factor":"Fator de Tr√°fego","optimization.parameters.slow":"lento","optimization.parameters.fast":"r√°pido"},Toast_skill:{unselected_skill:"Voc√™ deve selecionar pelo menos uma habilidade"},Toast_vehicles:{error_path_skills:"Houve problemas ao consultar habilidades",error_path_drivers:"Houve problemas ao consultar os motoristas",error_path_vehicles:"Houve problemas ao consultar os ve√≠culos",vehicle_not_found:"Ve√≠culo n√£o encontrado",error_set_position_marker:"N√£o foi poss√≠vel obter o endere√ßo, por favor, tente novamente.",error_set_address:"O endere√ßo digitado est√° incorreto, corrija e tente novamente",error_set_address_origin_country:"Endere√ßo de origem incorreto, diferente do pa√≠s selecionado na constru√ß√£o do seu pr√≥prio pa√≠s.",error_set_address_destiny_country:"Endere√ßo de destino incorreto, diferente do pa√≠s selecionado na constru√ß√£o do seu pr√≥prio pa√≠s.",error_set_address_origin_latlng0:"Endere√ßo de origem incorreto, corrija e tente novamente",error_set_address_destiny_latlng0:"Endere√ßo de destino incorreto, corrija e tente novamente",can_create_routes:"Voc√™ pode ir para criar rotas!",error_invalid_address_1:"O endere√ßo",error_invalid_address_2:"n√£o existe",success_import_vehicles:"Os ve√≠culos foram importados",error_empty_vehicles_list:"Lista dos ve√≠culos vazios",error_driver_not_found_1:"O motorista",error_driver_not_found_2:"n√£o est√° registado",error_data_format:"O arquivo enviado n√£o est√° no formato correto. Corrija e tente novamente",error_duplicate_vehicle_name_1:"O nome do ve√≠culo",error_duplicate_vehicle_name_2:"j√° existe",error_import:"Houve problemas para importar os ve√≠culos. Certifique-se de que os dados est√£o corretos"},Communication:{title:"notifica√ß√µes ao cliente final",title_detail:"Mensagem para o cliente final",delete_property_sms:"Excluir SMS",label_sms:"Mensagem",warning_text_too_large:"O conte√∫do da sua mensagem √© muito longo",warning_maxlength:"Texto muito longo",warning_required:"Campo obrigat√≥rio",preview_title:"Visualiza√ß√£o da mensagem",close:"Fechar",cancel:"Cancelar",save:"Salvar","delete":"Excluir",modal_delete_event_title:"Remover evento",modal_message_1:"Esta a√ß√£o √© irrevers√≠vel",modal_message_2:"Voc√™ deseja continuar?",visit_scheduled:"Rota criada",route_started:"Iniciar Rota",checkout_success:"Entregue com sucesso",checkout_failed:"Entrega √±ao realizada",insert:"Inserir",delete_property_email:"Suprimir o EMAIL",label_email_subject:"assunto",label_email_msg:"mensagem",comments:"Coment√°rios",attachment:"Anexar fotos",attachment_tooltip:"Anexou ao correio as fotos tiradas pelo motorista quando fez a visita ao lugar",id_reference:"ID-REF-123",warning_repeated_tag:"A etiqueta j√° existe no assunto",livetracking_widget:"Livetracking Widget",generate_insertion_code:"Gerar c√≥digo de inser√ß√£o",insertion_code:"C√≥digo de inser√ß√£o",copy_code:"C√≥digo de c√≥pia",search:"Pesquisar",custom_tracking_code:"Use o ID da visita como c√≥digo de rastreamento",custom_tracking_code_tooltip:'Ao usar esta op√ßao, Live Tracking usar√° o texto que vo√ße inserium em cada visita no campo "Refer√™ncia ID". Vo√ße debe certificar-se de que este campo √© exclusivo e que nao cont√©m caracteres extranhos ou Live Tracking n√£o funcionar√° corretamente'},Zones:{button_edit:"Editar",add_zone:"Criar nova zona",Map:{clear:"Redefinir zonas"},Edit:{input_placeholder:"Nome da zona",cancel:"Cancel",save:"Salvar",save_success:"Zona salva-se com sucesso",save_fail:"Houve um problema ao salvar a zona"},Items_list:{title:"Ve√≠culos",msg_items_empty:"voc√™ n√£o tem ve√≠culos",call_action:"Criar ve√≠culo",msg_empty_filter:"Sua pesquisa n√£o produziu resultados, tente novamente."},Delete:{title:"Excluir Zona",button_cancel:"Cancel",button_delete:"Excluir",irreversible_action:"Esta a√ß√£o √© irrevers√≠vel",want_continue:"Voc√™ deseja continuar?",delete_success:"Zona eliminada com sucesso",delete_fail:"Houve um problema ao excluir a zona"},Bulk:{btn_download_zones:"Baixe Zonas",btn_import_zones:"Atribui√ß√µes de importa√ß√£o",excel_header_vehicles:"Ve√≠culos",excel_header_zones:"ZoZonanes",error_no_data:"O arquivo n√£o possui dados v√°lidos",error_upload_failure:"Erro ao enviar o arquivo de atribui√ß√£o das Zonas",result_modal_title:"Zonas atribu√≠das",result_modal_upload_success:"Suas atribui√ß√µes de zonas foram feitas corretamente",resut_modal_upload_with_errors:"Ocorreram problemas ao carregar o arquivo",result_modal_row_header:"Linha",result_modal_error_header:"Error",result_modal_error_vehicle_not_found:"O ve√≠culo n√£o existe na sua conta",result_modal_error_zone_not_found:"A zona n√£o existe na sua conta"},validation_error_name:"Uma zona com este nome j√° existe.",Actions:{use_zones:{title:"otimiza√ß√£o de rota",use_zones:"Use Zones",hide_zones:"Esconder"},save_actions_zones:"Salvar",success_zone_property:"Cambios guardados exitosament",error_zone_property:"Ocorreu um problema, tente novamente"}}})}e.$inject=["$translateProvider"],angular.module("icarus.settings").config(e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c){function d(){u()}function u(){l.listAddons().then(function(e){m.enableLiveTracking=p(e,g),m.enableZones=p(e,h)})["catch"](function(e){n.info(e)})}function p(e,t){return c.result(c.find(e,function(e){return e.key===t}),"enable")}var m=this,v=a("translate"),g="live_tracking",h="zones";i.SettingsController=m,m.activeTab="vehicles",m.state=t,m.enableLiveTracking=!1,m.enableZones=!1,e.pagination={firstText:v("Settings.first_text"),lastText:v("Settings.last_text"),nexText:v("Settings.next_text"),previousText:v("Settings.previous_text")},d(),e.$on("$destroy",function(){s.clear(),o.clear(),r.clear()})}e.$inject=["$scope","$state","$window","$filter","$log","driversService","vehicleService","skillsService","addonsService","lodash"],angular.module("icarus.settings").controller("SettingsController",e)}(),function(){"use strict";function e(e){e.state("planner",{parent:"main",url:"/planner",controller:"PlannerController",controllerAs:"vm",templateUrl:"app/planner/planner.html",data:{authentication:!0},redirectTo:"planner.vehicles-list"}).state("planner.vehicles-list",{url:"/vehicles",views:{"left-planner":{controller:"PlannerVehiclesListController",controllerAs:"vm",templateUrl:"app/planner/vehicles/vehicles-list.html"}}}).state("planner.vehicles-list.plans",{url:"/plans",views:{"plans@planner":{controller:"PlannerPlansController",controllerAs:"vm",templateUrl:"app/planner/plans/plans-list.html"}}}).state("planner.vehicles-list.plans-detail",{url:"/plans/:planId?isCopy",views:{"plans@planner":{controller:"PlannerPlansDetailController",controllerAs:"vm",templateUrl:"app/planner/plans/plans-detail.html"}}}).state("planner.vehicles-detail",{url:"/vehicles/:vehicleId",views:{"left-planner":{controller:"PlannerVehiclesDetailController",controllerAs:"vm",templateUrl:"app/planner/vehicles/vehicles-detail.html"}}}).state("planner.visits-list",{url:"/visits?recent&fstatus&page",views:{"left-planner":{controller:"PlannerVisitsListController",controllerAs:"vm",templateUrl:"app/planner/visits/visits-list.html"}}}).state("planner.visits-bulk-edit",{url:"/visits/bulk-edit?page",params:{visitsId:[]},views:{"left-planner":{controller:"PlannerVisitsBulkEditController",controllerAs:"vm",templateUrl:"app/planner/visits/visits-bulk-edit.html"}}}).state("planner.visits-create",{url:"/visits/create?fstatus&page",views:{"left-planner":{controller:"PlannerVisitsDetailController",controllerAs:"vm",templateUrl:"app/planner/visits/visits-detail.html"}}}).state("planner.visits-detail",{url:"/visits/:visitId?fstatus&page",views:{"left-planner":{controller:"PlannerVisitsDetailController",controllerAs:"vm",templateUrl:"app/planner/visits/visits-detail.html"}}}).state("planner.routes",{url:"/routes?optimize&jdh",params:{options:null},views:{"left-planner":{controller:"PlannerRoutesController",controllerAs:"vm",templateUrl:"app/planner/routes/routes.html"}}}).state("planner.routes-detail",{url:"/routes/edit/?route_opened&out_of_route_opened",views:{"left-planner":{controller:"PlannerRoutesDetailController",controllerAs:"vm",templateUrl:"app/planner/routes/routes-detail.html"}}})}e.$inject=["$stateProvider"],angular.module("icarus.planner").config(e)}(),function(){"use strict";function e(e){e.translations("es",{Planner:{visits:"Visitas",routes:"Rutas",to:"a",btn_save:"Guardar",btn_cancel:"Cancelar",btn_next:"Siguiente",btn_back:"Anterior",btn_finish:"Finalizar",btn_export:"Exportar",btn_duplicate:"Duplicar Plan",input_planName:"Ingrese un nombre para el plan.",used_vehicles:"Veh√≠culos utilizados",of_your_fleet:"de tu flota",created_routes:"Rutas creadas",total_departures:"Salidas Totales",average_load:"Carga 1 promedio",by_route:"Por Ruta",average_time:"Tiempo promedio",vehicles:"Veh√≠culos",load_plans:"Cargar planes anteriores",
plan:"plan",start_date:"fecha de inicio",end_date:"fecha de t√©rmino",empty_plans_msg:"No existen planes creados.",plan_resume:"Resumen del plan",no_exist_plans_msg:"No existe el plan seleccionado.",select_vehicle:"Seleccione un veh√≠culo",upload:"Subir",btn_download:"Descargar",btn_load:"Cargar",success_update_plan:"Plan actualizado exitosamente!",error_update_plan:"Error al actualizar los datos del plan, por favor intente nuevamente.",visits_edited:"Visitas editadas",total_visits:"Visitas totales",drivers:"Conductores",success_plan_uploaded:"Tu plan se ha subido exitosamente.",success_plan_uploaded_but_no_changes:"No hubo cambios en los registros subidos.",btn_confirm:"Confirmar",plan_name:"nombre del plan",delete_plan:"Eliminar plan",delete_modal_message:"¬øEst√° seguro que desea eliminar este plan?",delete_modal_message_2:"Este plan est√° en modo edicion, esta seguro que desea eliminarlo?",close:"Cerrar","delete":"Eliminar",select_day:"Seleccione el d√≠a",sunday:"Domingo",monday:"Lunes",thursday:"Martes",wednesday:"Mi√©rcoles",tuesday:"Jueves",friday:"Viernes",saturday:"S√°bado",weekend_start_day:"inicio de semana",editing_plan:"editando plan",planned_date:"fecha plan actual",infowindow_since:"Desde las",infowindow_to:"a",infowindow_until_to:"Hasta las",average_load_2:"Carga 2 promedio",average_load_3:"Carga 3 promedio",visit_singular:"visita",visit_plural:"visitas",average_kms:"Kilometros",average_by_route:"Promedio por ruta",headers_editing_plan:"Editando plan",headers_step_1:"1. Veh√≠culos",headers_step_2:"2. Visitas",headers_step_3:"3. Rutas",MSOMC:{alert_msg:"Borrar selecci√≥n"}},Vehicles:{origin:"Origen",origin_placehd:"Direcci√≥n de salida",use_label:"Usar como direcci√≥n de destino",schedule:"Horario",destination:"Destino",dest_placehd:"Direcci√≥n de destino",label_vehicles:"Escoja los veh√≠culos a utilizar",active:"activo",inactive:"inactivo",keep_routes:"Mantener rutas",delete_routes:"Eliminar rutas",set_visits:"Visitas",empty:"No has agregado veh√≠culos a√∫n.",create:"Crea un",new_vehicle:"nuevo veh√≠culo",select_all:"Seleccionar todos",select_none:"Deseleccionar todos",initial_information:"Informaci√≥n inicial",date:"Fecha",to:"Hasta",vehicle:"veh√≠culo",capacity:"capacidad",driver:"conductor",manage_vehicles:"Administrar mis veh√≠culos",no_vehicles_selected:"No posee veh√≠culos seleccionados.",origin_or_destiny_error_msg:"Alguno de los veh√≠culos seleccionados no posee origen o destino.",disabled_vehicles_selected:"Alguno de los veh√≠culos seleccionados no se encuentra disponible en el horario indicado.",title_edit_vehicle:"Editar Veh√≠culo",vehicle_name:"Nombre",vehicle_capacity:"@:Vehicles.capacity",vehicle_driver:"@:Vehicles.driver",vehicle_origin:"@:Vehicles.origin",vehicle_destination:"@:Vehicles.destination",vehicle_skills:"Habilidades",select_driver:"--- Seleccione un conductor ---",more_vehicles:"M√°s veh√≠culos",minus_vehicles:"Menos Veh√≠culos",error_format_date:"* Formato de Hora incorrecto -- HH:MM",error_between_date:"* Hora de inicio debe ser menor a la Hora final.",error_empty_date:"* Debe ingresar ambas horas.",optional:"Opcional",vehicle_capacity_2:"Capacidad 2",vehicle_capacity_3:"Capacidad 3",error_limit_capacity:"La capacidad de carga del veh√≠culo es muy alta",error_limit_capacity_2:"La capacidad 2 de carga del veh√≠culo es muy alta",error_limit_capacity_3:"La capacidad 3 de carga del veh√≠culo es muy alta",required:"Requerido",empty_vehicles_1:"A√∫n no tienes veh√≠culos creados.",empty_vehicles_2:" Crear tu primer veh√≠culo","available.until":"Veh√≠culo disponible hasta ","notAvailable.endOfWorkingDay":"Veh√≠culo ha terminado jornada","notAvailable.until":"Veh√≠culo ocupado hasta ","available.default":"Veh√≠culo disponible"},Visits:{all_visits:"Todas",warnings:"Alertas",btn_import:"Importar",btn_new:"+ Nueva visita",btn_remove:"Borrar todas",lbl_title:"T√≠tulo",lbl_address:"Direcci√≥n",btn_more:"M√°s opciones",lbl_load:"Carga",lbl_time:"Ventana de Tiempo",lbl_time_2:"Ventana de Tiempo 2",lbl_service:"Tiempo de servicio",lbl_minutes:"Minutos",lbl_notes:"Notas",lbl_contact_name:"Persona de Contacto",lbl_contact_phone:"Tel√©fono de contacto",lbl_contact_email:"Correo electr√≥nico de contacto",lbl_priority:"Prioridad",georeferencing:"Georeferenciando",of:"de",lbl_reference:"Id de referencia",remove_all:"Remover todas",back:"Atr√°s",optimize_btn:"Crear rutas",no_visits:"No existen visitas",may_use:"Puedes usar esta ",sample_template:"plantilla de ejemplo",or:"√≥",create_visit:"Crear una visita",error_country:"Pais diferente",error_distance:"Demasiado lejos de la bodega",error_area_center:"Centro de la comuna",error_wrong_area:"Diferente comuna a la se√±alada en la direcci√≥n",error_not_found:"No hemos encontrado esta direcci√≥n",title:"Visitas",errors:"Errores","import":"Importar visitas",warning_msg:"Continuar a pesar de las alertas activas.",edit_title:"Editar visita",create_title:"Crear visita",btn_less:"Menos opciones",to:"Hasta",required_skills:"Habilidades requeridas",optional_skills:"Habilidades opcionales",no_visits_for_date:"No hay pedidos programados para la fecha seleccionada.",please:"Por favor",other_date:"elige otra fecha",or_go_to:"o dirigete a",orders:"Pedidos",to_add_new_visits:"para ingresar nuevas visitas.",not_available_vehicles:"Vehiculos no disponibles.",invalid_date_plan:"Fecha de plan inv√°lida.",msg_error_email_valid:"* Formato de correo electr√≥nico inv√°lido",msg_error_service_time:"* Formato de tiempo de servicio incorrecto.",msg_error_plan_date:"Para utilizar las posiciones actuales de los veh√≠culos la fecha del plan debe incluir el d√≠a de hoy.",error_workday_exceeded:"Los siguientes veh√≠culos no pueden ser utilizados ya que est√°n pr√≥ximos a terminar su jornada laboral.",delete_all_modals:"Borrar todas las visitas",delet_modal_message:"¬øEst√°s seguro de querer eliminar las visitas programadas para esta fecha?.",close:"Cerrar","delete":"Eliminar",cancel_loading:"Cancelar",excel_name:"example",excel_title:"T√≠tulo*   Requerido",excel_address:"Direcci√≥n completa*   Requerido",import_no_address:"Direcci√≥n no especificada",excel_load:"Carga",excel_hour_start:"Hora inicial",excel_hour_end:"Hora final",excel_service_time:"Tiempo de servicio",excel_notes:"Notas",excel_latitude:"Latitud",excel_longitude:"Longitud",excel_reference:"Id de referencia",excel_requires_skills:"Habilidades requeridas",excel_optional_skills:"Habilidades Opcionales",excel_contact_name:"Persona de contacto",excel_contact_phone:"Tel√©fono de contacto",excel_contact_email:"Correo electr√≥nico de contacto",excel_hour_start_2:"Hora inicial 2",excel_hour_end_2:"Hora final 2",excel_load_2:"Carga 2",excel_load_3:"Carga 3",excel_priority:"Prioridad",delete_visits:"Eliminar visitas",excel_sms:"SMS",bulk_edit:"Edici√≥n M√∫ltiple",deselect_all:"Deseleccionar Todos",bulk_edit_message_1:"Est√°s editando",bulk_edit_message_2:"Las modificaciones sobreescribir√°n tus datos anteriores.",contact_email_placeholder:"A√±ade un correo",delete_error_visits_message:"¬øEst√°s seguro de querer eliminar las visitas con errores?",delete_warning_visits_message:"¬øEst√°s seguro de querer eliminar las visitas con alertas?",error_msg_routes_not_completed:"Los vehiculos seleccionados a√∫n no terminan sus entregas.",error_format_date:"* Formato de hora incorrecto -- HH:MM",error_between_date:"* Hora de inicio debe ser menor a la hora final.",error_empty_date:"* Debe ingresar ambas horas.",error_format_duration:"Formato incorrecto en duraci√≥n para la visita ",error_format_capacity:"Formato incorrecto en capacidad para la visita ",error_email_length_message:"Uno de los correos es demasiado largo",error_max_emails_message_1:"Puedes a√±adir",error_max_emails_message_2:"correos como m√°ximo",address_required:"Direcci√≥n requerida",load_required:"Carga requerida",title_required:"T√≠tulo requerido",lbl_load_2:"Carga 2",lbl_load_3:"Carga 3",required:"Requerido",optional:"Opcional",load_2_invalid:"Carga 2 en mal formato, solo n√∫meros son v√°lidos.",load_3_invalid:"Carga 3 en mal formato, solo n√∫meros son v√°lidos.",attention:"Atenci√≥n",remove_route_optimize_1:"Usted posee rutas creadas, elija una opci√≥n para continuar: ",remove_route_optimize_2:"Al continuar las rutas se sobrescribir√°n.",remove_route_cancel:"Cancelar",remove_route_accept:"Aceptar",btn_more_options:"M√°s opciones",btn_less_options:"Menos opciones",btn_more_loads:"Otras cargas",btn_less_loads:"Una carga",btn_optional_window_time:"Ventana opcional",btn_one_window_time:"Una ventana",excel_sms_enable:"Enviar SMS",alert_notification:{error_country:"Pa√≠s diferente",error_wrong_area:"Diferente comuna a la se√±alada en la direcci√≥n",error_area_center:"Centro de la comuna",error_doubt:"Direcci√≥n dudosa",error_distance:"Demasiado lejos de la bodega",error_not_found:"No hemos encontrado esta direcci√≥n",error_window:"Problema con las ventanas horarias",error_overlapping:"Ventanas horarias superpuestas",country_center:"No se encontraron resultados"},no_title:"Visita sin t√≠tulo",error_window_start_greater_than_window_end:"Hora inicio es mayor a hora final",optimize_btn_jdh:"Crear rutas JDH",create_visit_btn:'Agregar visitas <span class="caret"></span>',create_visit_manual:"Manual",create_visit_excel:"Desde excel",create_visit_integration:"Desde integraci√≥n",component_visits_import:{title_visits_integration:"Agregar visitas desde integraci√≥n",button_title:"Importar",visits_failed_label:"visitas fallidas",visits_pending_label:"visitas pendientes",title_visits_integration_not_completed:"Agregar visitas no completadas"},remove_route_overwrite_routes_option:"Sobreescribir rutas",remove_route_keep_routes_option:"Mantener rutas",remove_route_optimize_3:"Al continuar las rutas y veh√≠culos actuales del plan se mantendr√°n.",out_of_route:"Fuera de ruta",priority_levels:{first_of_day:"Primero del d√≠a",last_of_route:"√öltimo de su ruta",high_priority:"Prioridad alta",medium_priority:"Prioridad media",low_priority:"Prioridad baja"},select_priority_level:"-- Seleccione una prioridad --",tooltip_priority_level:"Usa prioridades para definir si una visita es m√°s importante que otra. O para escoger si quieres que la visita vaya primera o √∫ltima en una ruta.",create_visit_integration_not_completed:"No completadas"},Routes:{btn_edition:"Editar",btn_moveTo:"Mover a",btn_cancelMoveTo:"Cancelar edici√≥n",btn_optimize:"Optimizar",unassigned:"Sin Asignar",route:"Salida",start:"Inicio",end:"Fin",back:"Atr√°s",optimize:"Optimizar","export":"Exportar",assign:"Asignar","assignments.title":"Asignaci√≥n de rutas","assignments.date":"Fecha de salida","assignments.assignBtn":"Asignar","assignments.endBtn":"Finalizar","assignments.unassigned":"Sin Asignar","assignments.successMessage":"Todas las rutas fueron asignadas!",the_vehicle:"El veh√≠culo","assignments.errorMessage":"ya posee alguna ruta con la misma fecha y hora de inicio.","assignments.isErrorInPlanInstance":"Ya existe un plan con la misma fecha de inicio y fin a estas.","assignments.data_format_error.title":"Error en los datos de las visitas","assignments.data_format_error.message":"Verifique que los datos de visitas se encuentren en el formato correcto","assignments.default_error.title":"Se ha producido un error","assignments.default_error.message":"Ha ocurrido un error al momento de guardar el plan, int√©ntalo m√°s tarde","assignments.plan_name_error.title":"Ya existe un plan con el mismo nombre",pleaseCorrects:"Por favor corrige esta inconsistencia y vuelve a intentarlo.",go_back:"Volver",goToRouteTracking:"Si quieres comenzar a monitorear tus entregas ve al ",routeTracking:"Monitor de Rutas",new_routes:" Rutas",cancel_creation:"Cancelar Creaci√≥n",btn_addTo:"Crear en",routes_title:"Rutas",routes_title_edit:"Editando Rutas",btn_new:"+ Nueva ruta",btn_remake_routes:"Rehacer rutas",visits_out_of_route_title:"Visitas fuera de ruta",select_all:"Seleccionar todas",hide_routes:"Ocultar rutas",show_routes:"Mostrar rutas",route_text:"Ruta",reorder:"Reordenar",from:"Salida desde",to:"LLegada a",finish_title:"Terminar dise√±o de rutas",finish_title_success:"Tus rutas fueron enviadas a los conductores",vehicle:"@:Vehicles.vehicle",driver:"@:Vehicles.driver",routes:"Rutas",visits:"Visitas",time:"Tiempo",select_driver:"--- Seleccione un conductor ---",confirm:"Confirmar",out_of_route:"Fuera de ruta",unselected_routes_remake:"Debe seleccionar al menos un veh√≠culo",delete_route:"Eliminar ruta",delete_modal_message:"¬øEst√° seguro que desea eliminar esta ruta?",close:"Cerrar","delete":"Eliminar","optimize.balance":"Balancear","optimize.all_vehicles":"Minimizar veh√≠culos","optimize.big_cluster":"Cluster con optimizaci√≥n por ruta","optimize.join":"Unir similares","optimize.open_ended":"Rutas abiertas","optimize.last_position_optimize":"Usar posici√≥n actual","optimize.single_tour":"Una ruta por veh√≠culo",remake_visits_out_of_route_error:"No existen visitas fuera de ruta.",remake_vehicles_error:"Alguno de los veh√≠culos seleccionados no posee visitas.",no_vehicles_selected:"Debe seleccionar al menos un veh√≠culo.","finish_modal.tracking_module":"M√≥dulo de seguimiento","finish_modal.planning_module":"M√≥dulo de dise√±o","finish_modal.btn_tracking_module":"Monitoreo de flota","finish_modal.btn_planning_module":"Dise√±o de Rutas","finish_modal.text_tracking_module":"Si quieres comenzar a monitorear tus entregas ve al","finish_modal.text_planning_module":"Tambien puedes crear un nuevo plan volviendo al",comments:"Comentario de la ruta (s)",body_1:"Este comentario se aplica a las siguientes rutas: ",save_comments:"Guardar",route_name:"Ruta","finish_modal.footer_message":"Recuerda decirle a tus conductores que descarguen la aplicaci√≥n m√≥vil.",assign_driver:"Asignar conductor",comments_route:"Comentario",visits_and:"visitas y",selected_routes:"rutas seleccionadas",single_tour:"Una ruta por veh√≠culo"},Excel_Header:{driver:"Conductor",vehicle:"Veh√≠culo",route_Index:"√çndice de ruta",stop:"Parada",arrival_Time:"Tiempo estimado de llegada",title:"T√≠tulo",address:"Direcci√≥n",load:"Carga",window_Start:"Inicio de ventana horaria 1",window_End:"Final de ventana horaria 1",window_Start2:"Inicio de ventana horaria 2",window_End2:"Final de ventana horaria 2",service_Time:"Tiempo de servicio",notes:"Notas",latitude:"Latitud",longitude:"Longitud",reference:"Id de referencia",requires_Skills:"Habilidades requeridas",optional_Skills:"Habilidades Opcionales",contact_Name:"Persona de contacto",contact_Phone:"Tel√©fono de contacto",contact_email:"Correo electr√≥nico de contacto",distance:"Distancia",order_size:"Carga",total_size:"Carga total",warnings:"Advertencias",visit_load2:"Capacidad 2",visit_load3:"Capacidad 3",priority:"Prioridad",route_coment:"Comentario de la ruta"},Pdf:{detailed_pdf:"PDF Detallado",vehicle:"Veh√≠culo",to:" a ",name:"NOMBRE",id:"ID",coments:"COMENTARIOS U OBSERVACIONES",signature:"FIRMA DE QUIEN RECIBE",address:"UBICACI√ìN",contact:"CONTACTO",windows:"VENTANAS HORARIAS",phone:"TEL√âFONO",skills_required:"HABILIDADES REQUERIDAS",route_comment:"COMENTARIO DE LA RUTA",no_route_comments:"Sin comentarios",notes:"Notas"},Summarized_Pdf:{summarized_pdf:"PDF Resumen",title:"T√≠tulo",address:"Direcci√≥n",time_windows:"Ventanas Horarias",arrival:"Llegada"},Planner_toast:{error_get_plans_1:"Error en la carga de planes, ruta no existe",error_get_plans_2:"Error en la carga de planes desde el servidor",error_get_plans_3:"Plan no existe",wrong_path:"Error en la solicitud, ruta no existe",not_permission:"Usted no tiene permiso para acceder a route design",vehicle_not_found:"Veh√≠culo no encontrado",error_delete_plan:"Error eliminando plan, por favor intente de nuevo",error_put_plan_found:"Error actualizando plan, ruta no existe",error_call_osrm:"Error cargando el plan seleccionado",error_visit_update_plan:"Error editando las visitas del plan",error_optimize_capacity_vehicles:"Error en la capacidad de los veh√≠culos, por favor corrija e intente nuevamente.",empty_file_excel:"Archivo excel vac√≠o, revise el archivo e intentelo nuevamente.",wrong_row_excel:"Se encontraron algunos errores en la informaci√≥n de visitas del archivo excel.",error_optimize_500:"Hubo un problema al optimizar, por favor intentelo nuevamente.",error_order_route:"Hubo un error al reordenar la ruta, por favor intentelo nuevamente.",error_remake_routes:"Hubo un error al rehacer rutas, por favor intentelo nuevamente.",error_save_plan_finish:"Hubo un error al guardar el plan, por favor intentelo nuevamente.",error_delete_route:"Error eliminando la ruta",error_no_vehicles_for_reoptimize:"No hay veh√≠culos disponibles para ejecutar esta acci√≥n",error_no_visits_for_reoptimize:"No hay visitas disponibles para ejecutar esta acci√≥n",error_save_plan_finish_planned_date:"Ya existe un plan para la misma fecha, por favor corrija e intente de nuevo",error_save_plan_finish_plan_name:"Ya existe un plan con el mismo nombre, por favor corrija e intente de nuevo",visits_imported:"Total de visitas importadas: "},Log:{actions:{delete_plan:"Eliminacion de plan",editing_plan:"Edicion de plan"}},Plan:{modal_cancel_edit_message_1:"Abandonar√°s la edici√≥n de planes y perder√°s los cambios que no hayas guardado.",modal_cancel_edit_message_2:"¬øDeseas continuar?",modal_cancel_edit_title:"Cancelar edici√≥n de Plan",button_cancel_modal:"Cancelar",button_accept_modal:"Aceptar"},Driver:{group_available:"",group_assigned:"‚úì"}}),e.translations("en",{Planner:{visits:"Visits",routes:"Routes",to:"to",btn_save:"Save",btn_cancel:"Cancel",btn_next:"Next",btn_back:"Back",btn_finish:"Finish",btn_export:"Export",btn_duplicate:"Duplicate Plan",input_planName:"Entry a name for the plan",used_vehicles:"Used Vehicles",of_your_fleet:"of your fleet",created_routes:"Created Routes",total_departures:"Total routes",average_load:"Average Load",average_load_2:"Average Load 2",average_load_3:"Average Load 3",by_route:"Per Route",average_time:"Average Time",vehicles:"Vehicles",load_plans:"Load older plans",plan:"plan",start_date:"starting date",end_date:"end date",empty_plans_msg:"There aren't created plans.",plan_resume:"Plan summary",no_exist_plans_msg:"Selected plan was'nt found.",select_vehicle:"Select a vehicle",upload:"Upload",btn_download:"Download",btn_load:"Load",success_update_plan:"Plan was updated successfully!",error_update_plan:"Failed to update data plan, please try again.",visits_edited:"Visits were edited",total_visits:"Total visitis",drivers:"Drivers",success_plan_uploaded:"Your plan has been successfully uploaded.",success_plan_uploaded_but_no_changes:"There were no changes in the records uploaded.",btn_confirm:"Confirm",plan_name:"Plan Name",delete_plan:"Remove plan",delete_modal_message:"Are you sure you want to delete this plan?",delete_modal_message_2:"This plan is in edit mode, are you sure you want to delete it?",close:"Close","delete":"Delete",select_day:"Select a day",sunday:"Sunday",monday:"Monday",thursday:"Thrusday",wednesday:"Wednesday",tuesday:"Tuesday",friday:"Friday",saturday:"Saturday",weekend_start_day:"Week Start",editing_plan:"editing plan",planned_date:"date current plan",infowindow_since:"Since",infowindow_to:"to",infowindow_until_to:"Until",visit_singular:"visit",visit_plural:"visits",average_kms:"Kilometers",average_by_route:"Average per route",headers_editing_plan:"Editing plan",headers_step_1:"1. Vehicles",headers_step_2:"2. Visits",headers_step_3:"3. Routes",MSOMC:{alert_msg:"Delete selected items"}},Vehicles:{origin:"Origin",origin_placehd:"Start address",use_label:"To use as a destination address",schedule:"Schedule",destination:"Destination",dest_placehd:"Desination address",label_vehicles:"Choose your vehicles to use",active:"active",inactive:"inactive",keep_routes:"Keep routes",delete_routes:"Delete routes",set_visits:"Set visits",empty:"You haven‚Äôt added any vehicles yet.",create:"Create a",new_vehicle:"new vehicle",select_all:"Select All",select_none:"Select None",initial_information:"Initial information",date:"Date",to:"To",vehicle:"vehicle",capacity:"capacity",vehicle_capacity_2:"capacity 2",vehicle_capacity_3:"capacity 3",driver:"driver",manage_vehicles:"Manage my vehicles",no_vehicles_selected:"No selected vehicles.",origin_or_destiny_error_msg:"Some of the selected vehicles don't have start or destination address.",disabled_vehicles_selected:"Some of the selected vehicles are not available at the indicated time.",title_edit_vehicle:"Edit Vehicle",vehicle_name:"Name",vehicle_capacity:"@:Vehicles.capacity",vehicle_driver:"@:Vehicles.driver",vehicle_origin:"@:Vehicles.origin",vehicle_destination:"@:Vehicles.destination",vehicle_skills:"Skills",select_driver:"--- Select a driver ---",more_vehicles:"More vehicles",minus_vehicles:"Less vehicles",error_format_date:"* Wrong hour format -- HH:MM",error_between_date:"* Start hour must be less than the final hour.",error_empty_date:"* You must enter two hours.",empty_vehicles_1:"You do not have vehicles created yet.",empty_vehicles_2:" Create your first vehicle","available.until":"Vehicle available until","notAvailable.endOfWorkingDay":"Vehicle has finished day","notAvailable.until":"Vehicle busy until","available.default":"Vehicle available",required:"Required",optional:"Optional"},Visits:{all_visits:"All",warnings:"Warnings",required:"Required",optional:"Optional",btn_import:"Import",btn_new:"New visit",btn_remove:"Remove All",lbl_title:"Title",lbl_address:"Address",address_placehd:"Address",btn_more:"More options",lbl_load:"Load",lbl_load_2:"Load 2",lbl_load_3:"Load 3",lbl_time:"Time Window",lbl_time_2:"Time Window 2",lbl_service:"Service time",lbl_minutes:"Minutes",lbl_notes:"Notes",lbl_contact_name:"Contact Name",lbl_contact_phone:"Contact Phone",lbl_contact_email:"Contact Email",lbl_priority:"Priority",georeferencing:"Geocoding",of:"of",lbl_reference:"Reference id",remove_all:"Remove all",back:"Back",optimize_btn:"Create routes",no_visits:"No visits yet",may_use:"You may use this ",sample_template:"sample template",or:"or",create_visit:"Create a visit",error_country:"Different country",error_distance:"too far from depot",error_area_center:"Center of administrative area",error_wrong_area:"Different area between  address and geopoint",error_not_found:"We can not find this address",title:"Visits",errors:"Errors","import":"Import visits",warning_msg:"Continue despite active alerts.",edit_title:"Edit visits",create_title:"Create visit",btn_less:"Less options",to:"to",required_skills:"Required Skills",optional_skills:"Optional Skills",no_visits_for_date:"There are not visits for the selected date.",please:"Please",other_date:"choose another date",or_go_to:"or go to",orders:"Visits module",to_add_new_visits:" and add a new visit.",not_available_vehicles:"Not available vehicles",invalid_date_plan:"Invalid date plan",msg_error_email_valid:"* Invalid email format",msg_error_service_time:"* Wrong time format service.",msg_error_plan_date:"To use last locations of vehicules the plan date must contain the current day.",error_workday_exceeded:"The following vehicles can not be used because they are close to finishing their workday.",delete_all_modals:"Delete all visits",delet_modal_message:"Do you really want to delete shipments scheduled for this date ?.",close:"Close","delete":"Delete",cancel_loading:"Cancel",excel_name:"example",excel_title:"Title*   Required",excel_address:"Full address*   Required",import_no_address:"Unspecified address",excel_load:"Load",excel_hour_start:"Hour start",excel_hour_end:"Hour end",excel_service_time:"Service Time",excel_notes:"Notes",excel_latitude:"Latitude",excel_longitude:"Longitude",excel_reference:"Id reference",excel_requires_skills:"Required skills",excel_optional_skills:"Optional skills",excel_contact_name:"Contact name",excel_contact_phone:"Phone contact",excel_contact_email:"Email contact",excel_hour_start_2:"Hour start 2",excel_hour_end_2:"Hour end 2",excel_priority:"Priority",delete_visits:"Delete visits",excel_load_2:"Load 2",excel_load_3:"Load 3",excel_sms:"SMS",bulk_edit:"Bulk Edit",deselect_all:"Deselect All",bulk_edit_message_1:"You are editing",bulk_edit_message_2:"Modifications will overwrite previous data.",contact_email_placeholder:"Add an email",delete_warning_visits_message:"Do you want to delete the visits with warning?",delete_error_visits_message:"Do you want to delete the visits with errors?",error_msg_routes_not_completed:"Selected vehicles are still making deliveries.",error_format_date:"* Incorrect format hours -- HH:MM",error_between_date:"* Start time must be less than the final hour.",error_empty_date:"* You must enter two hours.",error_format_duration:"Incorrect visit duration format",error_format_capacity:"Incorrect visit capacity format",error_email_length_message:"One of the emails is too long",error_max_emails_message_1:"You can add up to",error_max_emails_message_2:"emails",address_required:"Address required",load_required:"Load required",title_required:"Title required",attention:"Attention",remove_route_optimize_1:"You have created routes, choose an option to continue: ",remove_route_optimize_2:"Continuing routes will be overwritten",remove_route_cancel:"Cancel",remove_route_accept:"Accept",btn_more_options:"More options",btn_less_options:"Less options",excel_sms_enable:"Send SMS",alert_notification:{error_country:"Different country",error_wrong_area:"Different commune to the one indicated in the direction",error_area_center:"Center of the commune",error_doubt:"Doubtful address",error_distance:"Too far from depot",error_not_found:"We could not find this address",error_window:"Problem with time windows",error_overlapping:"Overlapping time windows",country_center:"No results found"},no_title:"Untitled Visit",error_window_start_greater_than_window_end:"Start time is greater than end time",optimize_btn_jdh:"Create routes JDH",create_visit_btn:'Add visits <span class="caret"></span>',create_visit_manual:"Single visit",create_visit_excel:"Import excel",create_visit_integration:"From integration",component_visits_import:{title_visits_integration:"Add integration visits",button_title:"Import",visits_failed_label:"failed visits",visits_pending_label:"pending visits",title_visits_integration_not_completed:"Add uncompleted visits"},remove_route_overwrite_routes_option:"Overwrite routes",remove_route_keep_routes_option:"Keep routes",remove_route_optimize_3:"Continuing the current routes and vehicles of the plan will be maintained.",out_of_route:"Out of route",priority_levels:{first_of_day:"First of the day",last_of_route:"Last of its route",high_priority:"High priority",medium_priority:"Medium priority",low_priority:"Low Priority"},select_priority_level:"-- Select a priority --",tooltip_priority_level:"Use priorities to define whether a visit is more important than another. Or to choose if you want the visit to go first or last in a route.",create_visit_integration_not_completed:"Not completed"},Routes:{btn_edition:"Edit",btn_moveTo:"Move to",btn_cancelMoveTo:"Done edit",btn_optimize:"Optimize",unassigned:"Unassigned",route:"Route",start:"Start",end:"End",back:"Back",optimize:"Optimize","export":"Export",assign:"Assign","assignments.title":"Route assignments","assignments.date":"Delivery date","assignments.assignBtn":"Assign","assignments.endBtn":"Finish","assignments.unassigned":"Unassigned","assignments.successMessage":"All routes were assigned!",the_vehicle:"The vehicle","assignments.errorMessage":"already has routes with the same date and start time.","assignments.isErrorInPlanInstance":"There is a plan with the same starting and ending date.","assignments.data_format_error.title":"There is an error in visits data.","assignments.data_format_error.message":"Please check out that visits data is in the correct format","assignments.default_error.title":"There is an error ","assignments.default_error.message":"An error occurred while saving the plan, try again later","assignments.plan_name_error.title":"A plan with the same name already exists",pleaseCorrects:"Please correct the inconsistences and try again.",go_back:"Back",goToRouteTracking:"If you want to start tracking your deliveries, go to",routeTracking:"Route Tracking",new_routes:" Routes",cancel_creation:"Done create",btn_addTo:"Create into",routes_title:"Routes",routes_title_edit:"Editing Routes",btn_new:"+ New route",btn_remake_routes:"Redo routes",visits_out_of_route_title:"Unassigned visits",select_all:"Select all",hide_routes:"Hide routes",show_routes:"Show routes",route_text:"Route ",reorder:"Re-order",from:"Starting from",to:"To ",finish_title:"Finish route design",finish_title_success:"Your routes were sent to your drivers",vehicle:"@:Vehicles.vehicle",driver:"@:Vehicles.driver",routes:"Routes",visits:"Visits",time:"Time",select_driver:"-- Select a driver --",confirm:"Confirm",out_of_route:"Unassigned visits",unselected_routes_remake:"You must select at least one vehicle",delete_route:"Remove route",delete_modal_message:"Are you sure you want to delete this route?",close:"Close","delete":"Delete",remake_vehicles_error:"Some of the selected vehicles don't has visits","finish_modal.tracking_module":"Tracking module","finish_modal.planning_module":"Design module","finish_modal.btn_tracking_module":"Fleet monitoring","finish_modal.btn_planning_module":"Route design","finish_modal.text_tracking_module":"If your want to start to monitoring your deliveries go to","finish_modal.text_planning_module":"You can creat a new plan going to","optimize.balance":"Balance","optimize.all_vehicles":"Minimize vehicles","optimize.open_ended":"Open routes","optimize.join":"Join similars","optimize.big_cluster":"Cluster with optimization","optimize.last_position_optimize":"Use current location","optimize.single_tour":"Single tour","optimization.all_vehicles":"Minimize vehicles","optimization.balance":"Balance","optimization.open_ended":"Open routes","optimization.join":"Join similars","optimization.big_cluster":"Cluster with optimization","optimization.last_position_optimize":"Use current location","optimization.displayed_options":"Visualize on menu","optimization.default_values":"Default values",comments:"Comment of the routes",body_1:"This comment applies to the following routes: ",save_comments:"Save",route_name:"Route","finish_modal.footer_message":"Remember to tell your drivers to download the mobile app.",assign_driver:"Assign driver",comments_route:"Comment",visits_and:"visits and",selected_routes:"selected routes",single_tour:"Single tour"},Excel_Header:{driver:"Driver",vehicle:"Vehicle",route_Index:"Index route",stop:"Stop",arrival_Time:"Estimated time of arrival",title:"Title",address:"Address",load:"Load",window_Start:"Start of time window 1",window_End:"End of time window 1",window_Start2:"Start of time window 2",window_End2:"End of time window 2",service_Time:"Service time",notes:"Notes",latitude:"Latitude",longitude:"Longitude",reference:"Id Reference",requires_Skills:"Required skills",optional_Skills:"Additional Skills",contact_Name:"Contact person",contact_Phone:"Phone contact",contact_email:"Email contact",distance:"Distance",order_size:"Load",total_size:"Total load",warnings:"Warnings",priority:"Priority",visit_load2:"Load 2",visit_load3:"Load 3",route_coment:"Route comment"},Pdf:{detailed_pdf:"Detailed PDF",vehicle:"Vehicle",to:" to ",name:"NAME",id:"ID",coments:"COMMENTS OR OBSERVATIONS",signature:"SIGNATURE OF WHO RECEIVES",address:"ADDRESS",contact:"CONTACT",windows:"TIME WINDOWS",phone:"PHONE",skills_required:"REQUIRED SKILLS",route_comment:"ROUTE COMMENT",no_route_comments:"No comments",notes:"Notes"},Summarized_Pdf:{summarized_pdf:"Summary PDF",title:"Title",address:"Address",time_windows:"Time Windows",arrival:"Arrival"},Planner_toast:{error_get_plans_1:"Error loading plans, path does not exist",error_get_plans_2:"Error loading plans from the servers",wrong_path:"Error in the request path does not exist",not_permission:"You do not have permission to access route design",vehicle_not_found:"Vehicle not found",error_get_plans_3:"Plan not found",error_delete_plan:"Error removing plan, please try again",error_put_plan_found:"Error updating plan, path does not exist",error_call_osrm:"Error loading the selected plan",error_visit_update_plan:"Error editing visits plan",
error_optimize_capacity_vehicles:"Error in vehicle capacity, please edit it and try again.",empty_file_excel:"Empty excel file, check the file and try again.",wrong_row_excel:"Some errors were found in the file.",error_optimize_500:"There was a problem when optimizing, please try again.",error_order_route:"There was an error in ordering the route, please try again.",error_remake_routes:"There was an error when making routes, please try again.",error_save_plan_finish:"There was an error saving plan, please try again.",error_delete_route:"Error removing the route",error_no_vehicles_for_reoptimize:"No vehicles are available to execute this action",error_no_visits_for_reoptimize:"No visits available to execute this action",error_save_plan_finish_planned_date:"A plan already exists for the same date, please correct and try again",error_save_plan_finish_plan_name:"A plan with the same name already exists, please correct and try again",visits_imported:"Total visits imported: "},Log:{actions:{delete_plan:"Plan removal",editing_plan:"Edit Plan"}},Plan:{modal_cancel_edit_message_1:"If you exit Plan Edition any unsaved change will be lost.",modal_cancel_edit_message_2:"Do you want to continue?",modal_cancel_edit_title:"Cancel Plan edit",button_cancel_modal:"Cancel",button_accept_modal:"Accept"},Driver:{group_available:"",group_assigned:"‚úì"}}),e.translations("pt",{Planner:{visits:"Visitas",routes:"Rotas",to:"√†s",btn_save:"Salvar",btn_cancel:"Cancelar",btn_next:"Pr√≥ximo",btn_back:"Voltar",btn_finish:"Finalizar",btn_export:"Exporta√ß√£o",btn_duplicate:"Plano Duplicado",input_planName:"Digite um nome para o plano",used_vehicles:"Ve√≠culos usados",of_your_fleet:"sua frota",created_routes:"Rotas criadas",total_departures:"Sa√≠das Totais",average_load:"Capacidade 1 m√©dia",by_route:"Por Rota",average_time:"Tempo m√©dio",vehicles:"Ve√≠culos",load_plans:"Carregar planos anteriores",plan:"plano",start_date:"data de in√≠cio",end_date:"data de t√©rmino",empty_plans_msg:"N√£o h√° planos criados.",plan_resume:"Resumo plano",no_exist_plans_msg:"No plano selecionado.",select_vehicle:"Selecione um ve√≠culos",upload:"Carregar",btn_download:"Baixar",btn_load:"Carregar",success_update_plan:"plano actualizado com sucesso!",error_update_plan:"Falha ao atualizar o plano de dados, por favor, tente novamente.",visits_edited:"visitas editados",total_visits:"Total de visitas",drivers:"Motoristas",success_plan_uploaded:"Seu plano foi enviada com sucesso.",success_plan_uploaded_but_no_changes:"N√£o houve mudan√ßas nos registros enviados.",btn_confirm:"Confirmar",plan_name:"nome do plano",delete_plan:"Excluir plano",delete_modal_message:"Tem certeza de que deseja excluir este plano?",delete_modal_message_2:"Este plano est√° em modo de edi√ß√£o, voc√™ tem certeza que deseja excluir essa?",close:"Fechar","delete":"Excluir",select_day:"Escolha um dia",sunday:"Domingo",monday:"Segunda-feira",thursday:"Ter√ßa-feira",wednesday:"Quarta-feira",tuesday:"Quinta-feira",friday:"Sexta-feira",saturday:"S√°bado",weekend_start_day:"In√≠cio da semana",editing_plan:"plano de edi√ß√£o",planned_date:"plano na data corrente",infowindow_since:"Desde as",infowindow_to:"a",infowindow_until_to:"At√©",average_load_2:"Capacidade 2 m√©dia",average_load_3:"Capacidade 3 m√©dia",visit_singular:"visita",visit_plural:"visitas",average_kms:"Quil√¥metros",average_by_route:"M√©dia por rota",headers_editing_plan:"Plano de edi√ß√£o",headers_step_1:"1. Ve√≠culos",headers_step_2:"2. Visitas",headers_step_3:"3. Rotas",MSOMC:{alert_msg:"Excluir sele√ß√£o"}},Vehicles:{origin:"Origem",origin_placehd:"Endere√ßo inicial",use_label:"Para usar como endere√ßo de destino",schedule:"Das",destination:"Destino",dest_placehd:"Endere√ßo de destino",label_vehicles:"Escolha seus ve√≠culos para uso",active:"ativo",inactive:"inativo",keep_routes:"Mantenha rotas",delete_routes:"Excluir rotas",set_visits:"Definir visitas",empty:"Voc√™ ainda n√£o adicionou nenhum ve√≠culo.",create:"Criar um",new_vehicle:"novo ve√≠culo",select_all:"Selecionar Todos",select_none:"Selecionar Nenhum",initial_information:"Informa√ß√µes iniciais",date:"Data",to:"√†s",vehicle:"ve√≠culo",capacity:"capacidade",vehicle_capacity_2:"capacidade 2",vehicle_capacity_3:"capacidade 3",driver:"motorista",manage_vehicles:"Gerenciar os meus ve√≠culos",no_vehicles_selected:"Sem ve√≠culos escolhidos.",origin_or_destiny_error_msg:"Alguns dos ve√≠culos seleccionados n√£o tem origem ou destino.",disabled_vehicles_selected:"Alguns dos ve√≠culos seleccionados n√£o est√° dispon√≠vel no momento indicado.",title_edit_vehicle:"Editar ve√≠culo",vehicle_name:"Nome",vehicle_capacity:"@:Vehicles.capacity",vehicle_driver:"@:Vehicles.driver",vehicle_origin:"@:Vehicles.origin",vehicle_destination:"@:Vehicles.destination",vehicle_skills:"Habilidades",select_driver:"--- Selecione um motorista ---",more_vehicles:"Mais Ve√≠culos",minus_vehicles:"Menos Ve√≠culos",error_format_date:"* Formato da hora incorreta -- HH:MM",error_between_date:"* A hora de in√≠cio deve ser menor do que a hora final.",error_empty_date:"* Deve digitar duas horas.",empty_vehicles_1:"Voc√™ n√£o tem ve√≠culos criados",empty_vehicles_2:"Criar o seu primeiro ve√≠culo","available.until":"Ve√≠culo dispon√≠vel at√© √†s","notAvailable.endOfWorkingDay":"Ve√≠culo terminou o dia","notAvailable.until":"Ve√≠culo  ocupado at√© √†s","available.default":"Ve√≠culo dispon√≠vel",required:"Requerida",optional:"Opcional"},Visits:{all_visits:"Todas",warnings:"Advert√™ncia",btn_import:"Importar",btn_new:"+ Nova Visita",btn_remove:"Remover tudo",lbl_title:"T√≠tulo",lbl_address:"Endere√ßo",required:"Requerido",optional:"Opcional",btn_more:"Mais op√ß√µes",btn_less:"Menos op√ß√µes",lbl_load:"Carga",lbl_load_2:"Carga 2",lbl_load_3:"Carga 3",lbl_time:"Das",lbl_time_2:"Das",lbl_service:"Tempo de Servi√ßo",lbl_minutes:"Minutos",lbl_notes:"Notas",lbl_contact_name:"Pessoa de contato",lbl_contact_phone:"N√∫mero de contato",lbl_contact_email:"E-mail",lbl_priority:"Prioridade",georeferencing:"Geocodifica√ß√£o",of:"de",lbl_reference:"Identifica√ß√£o de refer√™cia",required_skills:"Habilidades necess√°rias",optional_skills:"Habilidades opcionais",remove_all:"Remover todas",back:"Voltar",optimize_btn:"Criar rotas",no_visits:"Sem visitas ainda",may_use:"Voc√™ pode usar este ",sample_template:"modelo de exemplo",or:"ou",create_visit:"Crie uma visita",error_country:"Pa√≠s diferente",error_distance:"muito longe do dep√≥sito",error_area_center:"Centro da √°rea administrativa",error_wrong_area:"√Årea diferente entre o endere√ßo e GeoPoint",error_not_found:"N√£o podemos encontrar este endere√ßo",title:"Visitas",errors:"Erros","import":"Importar visitas",warning_msg:"Continue apesar alertas ativos",edit_title:"Editar visita",create_title:"Criar visita",to:"√Äs",no_visits_for_date:"Sem visitas agendadas para esta data.",please:"Por favor",other_date:"escolha outra data",or_go_to:"o dirigete a",orders:"Pedidos",to_add_new_visits:"para introduzir novas visitas.",msg_error_email_valid:"* e-mail formato inv√°lido",msg_error_service_time:"* Formato de tempo de servi√ßo incorreto.",delete_all_modals:"Excluir todas as visitas",delet_modal_message:"Tem certeza de que deseja excluir as visitas programados para esta data?.",close:"Fechar","delete":"Excluir",cancel_loading:"Cancelar",excel_name:"example",excel_title:"Titulo*    Solicitado",excel_address:"endere√ßo completo*    Solicitado",import_no_address:"Endere√ßo indeterminado",excel_load:"Carga",excel_hour_start:"Janela de hor√°rio inicial",excel_hour_end:"Janela de hor√°rio final",excel_service_time:"Tempo de servi√ßo",excel_notes:"Anota√ß√µes",excel_latitude:"Latitude",excel_longitude:"Longitude",excel_reference:"Identifica√ß√£o de refer√™ncia",excel_requires_skills:"Habilidade necess√°ria",excel_optional_skills:"Habilidade Opcional",excel_contact_name:"Pessoa de contato",excel_contact_phone:"Telefone de contato",excel_contact_email:"Correio eletr√¥nico de contato",excel_hour_start_2:"Janela de hor√°rio inicial 2",excel_hour_end_2:"Janela de hor√°rio final 2",excel_load_2:"Capacidade 2",excel_load_3:"Capacidade 3",excel_priority:"Prioridade",delete_visits:"Eliminar visitas",excel_sms:"SMS",bulk_edit:"Edi√ß√£o em Massa",deselect_all:"Desmarcar Todos",bulk_edit_message_1:"Voc√™ est√° editando",bulk_edit_message_2:"As mudan√ßas ir√£o substituir os dados anteriores.",contact_email_placeholder:"Adicionar um e-mail",delete_error_visits_message:"Tem certeza de que deseja excluir visitas com erros?",delete_warning_visits_message:"Tem certeza de que deseja excluir visitas com alertas?",error_format_date:"* Formato de hora incorreta -- HH:MM",error_between_date:"* A hora de in√≠cio deve ser maior do que a √∫ltima hora.",error_empty_date:"* Voc√™ deve digitar duas horas.",error_format_duration:"dura√ß√£o malformado para a visita",error_format_capacity:"capacidade malformado de visita ",error_email_length_message:"Um dos e-mails √© muito longo",error_max_emails_message_1:"Voc√™ pode adicionar at√©",error_max_emails_message_2:"e-mails",address_required:"Endere√ßo necess√°rio",load_required:"Carga solicitada",title_required:"Titulo Solicitado",attention:"Aten√ß√£o",remove_route_optimize_1:"voc√™ tenha criado rotas, escolha uma op√ß√£o para continuar: ",remove_route_optimize_2:"Ao continuar as rotas ser√£o substitu√≠dos.",remove_route_cancel:"Cancelar",remove_route_accept:"Aceitar",btn_more_options:"Mais op√ß√µes",btn_less_options:"Menos op√ß√µes",btn_more_loads:"Ver mais capacidades de carga",btn_less_loads:"Ver menos capacidades de carga",btn_optional_window_time:"Janela de hor√°rio opcional",btn_one_window_time:"Janela de hor√°rio √∫nica",excel_sms_enable:"Enviar SMS",alert_notification:{error_country:"Pa√≠s diferente",error_wrong_area:"Commune diferente para o endere√ßo indicado no",error_area_center:"Centro Commune",error_doubt:"Endere√ßo duvidoso",error_distance:"Muito longe do ponto de partida",error_not_found:"N√≥s n√£o encontrar este endere√ßo",error_window:"Problema com janelas de tempo",error_overlapping:"janelas de tempo sobreposto",country_center:"Nenhum resultado encontrado"},no_title:"Visita sem t√≠tulo",error_window_start_greater_than_window_end:"A hora de in√≠cio √© maior do que o tempo final",optimize_btn_jdh:"Criar rotas JDH",create_visit_btn:'Adicionar visitas <span class="caret"></span>',create_visit_manual:"Manualmente",create_visit_excel:"Excel",create_visit_integration:"Integra√ß√£o",component_visits_import:{title_visits_integration:"Adicionar a integra√ß√£o visitas",button_title:"Importa√ß√£o",visits_failed_label:"visitas fracassadas",visits_pending_label:"visitas pendentes",title_visits_integration_not_completed:"Adicionar visitas incompletas"},remove_route_overwrite_routes_option:"Substituir rotas",remove_route_keep_routes_option:"Manter rotas",remove_route_optimize_3:"Ao continuar as rotas e ve√≠culos do plano ser√° mantida.",out_of_route:"Fora da rota",priority_levels:{first_of_day:"Primeiro dia",last_of_route:"√öltimo da sua rota",high_priority:"Prioridade m√°xima",medium_priority:"Prioridade m√©dia",low_priority:"Baixa prioridade"},select_priority_level:"-- Selecione uma prioridade --",tooltip_priority_level:"Use prioridades para definir se uma visita √© mais importante do que outra. Ou para escolher se voc√™ deseja que a visita entre primeiro ou a √∫ltima em uma rota.",create_visit_integration_not_completed:"N√£o completadas"},Routes:{btn_edition:"Editar",btn_moveTo:"Mover para",btn_cancelMoveTo:"Edi√ß√£o realizada",btn_optimize:"Otimizar",visits_out_of_route_title:"Sem atribui√ß√£o",route:"Rotas",start:"Start",end:"End",back:"Voltar",optimize:"Otimizar","export":"Exportar",assign:"Atribuir","assignments.title":"Rotas atribu√≠das","assignments.date":"Data de entrega","assignments.assignBtn":"Atribu√≠do","assignments.endBtn":"Terminar","assignments.unassigned":"N√£o atribu√≠do","assignments.successMessage":"Todas as rotas foram atribu√≠das!",the_vehicle:"O ve√≠culo","assignments.errorMessage":"J√° tem um percurso com a mesma data e hora de in√≠cio.","assignments.isErrorInPlanInstance":"Um plano com a mesma data de in√≠cio e fim destes j√° existe.","assignments.data_format_error.title":"H√° um erro nos dados de visitas.","assignments.data_format_error.message":"Verifique se os dados das visitas est√£o no formato correto","assignments.default_error.title":"Ocorreu um erro","assignments.default_error.message":"Ocorreu um erro enquanto se guardava o plano, mais tarde","assignments.plan_name_error.title":"J√° existe um plano com o mesmo nome",pleaseCorrects:"Por favor, corrija esta inconsist√™ncia e tente novamente.",go_back:"Voltar",goToRouteTracking:"Se voc√™ quiser iniciar o controle de suas entregas, v√° para o",routeTracking:"Acompanhamento de Rotas",new_routes:" Rotas",cancel_creation:"Feito criar",btn_addTo:"Criar em",routes_title:"Rotas",routes_title_edit:"Editando rotas",btn_new:"+ Nova rota",btn_remake_routes:"Reotimizar",select_all:"Selecionar tudo",hide_routes:"Esconder rotas",show_routes:"Mostrar rotas",route_text:"Rota ",reorder:"Otimizar",from:"De",to:"Para ",finish_title:"Plano de rotas final",finish_title_success:"Suas rotas foram enviados para os motoristas",vehicle:"@:Vehicles.vehicle",driver:"@:Vehicles.driver",routes:"Rotas",visits:"Visitas",time:"Tempo",select_driver:"-- Selecione um motorista --",confirm:"Confirmar",out_of_route:"Fora da rota",unselected_routes_remake:"Voc√™ deve selecionar pelo menos um ve√≠culo",delete_route:"Excluir rota",delete_modal_message:"Tem certeza de que deseja excluir esta rota?",close:"Cerrar","delete":"Excluir",remake_vehicles_error:"Alguns dos ve√≠culos selecionados tem visitas.","finish_modal.tracking_module":"Rastreamento","finish_modal.planning_module":"Planejador de rotas","finish_modal.btn_tracking_module":"Rastreamento","finish_modal.btn_planning_module":"Planejador de rotas","finish_modal.text_tracking_module":"Se voc√™ quiser come√ßar a monitorar suas entregas, v√° para","finish_modal.text_planning_module":"Voc√™ pode criar um novo plano para","optimize.balance":"Balancear","optimize.all_vehicles":"Minimizar ve√≠culos","optimize.big_cluster":"Cluster com otimiza√ß√£o de rotas","optimize.join":"Unir similares","optimize.open_ended":"Rotas abertas","optimize.last_position_optimize":"Usar posici√≥n actual","optimize.single_tour":"Uma rota por ve√≠culo","optimization.all_vehicles":"Minimizar veiculos","optimization.balance":"Balan√ßea","optimization.open_ended":"Rotas abertas","optimization.join":"Unir similares","optimization.big_cluster":"Cluster com otimiza√ß√£o de rotas","optimization.last_position_optimize":"Usar localiza√ß√£o atual",comments:"Rotas Coment√°rio",body_1:"Este coment√°rio se aplica aos seguintes rotas: ",save_comments:"Salvar",route_name:"Rota","finish_modal.footer_message":"Lembre-se de dizer a seus motoristas para baixar o aplicativo m√≥vel.",assign_driver:"Atribuir motorista",comments_route:"Coment√°rio",visits_and:"visitas e",selected_routes:"rotas selecionas",single_tour:"Uma rota por veiculo"},Excel_Header:{driver:"Motorista",vehicle:"Ve√≠culo",route_Index:"√çndice de rota",stop:"Ordem de entrega",arrival_Time:"Tempo estimado de chegada",title:"T√≠tulo",address:"Endere√ßo",load:"Carga",window_Start:"Janela de hor√°rio Inicial",window_End:"Janela de hor√°rio Final",window_Start2:"Janela de hor√°rio Inicial 2",window_End2:"Janela de hor√°rio Final 2",service_Time:"Tempo de servi√ßo",notes:"Anota√ß√µes",latitude:"Latitude",longitude:"Longitude",reference:"ID de refer√™ncua",requires_Skills:"Habilidades requeridas",optional_Skills:"Habilidades Operacionais",contact_Name:"Pessoa de contato",contact_Phone:"Telefone de contato",contact_email:"Correio eletr√¥nico de contato",distance:"Dist√¢ncia",order_size:"Carga",total_size:"Carga total",warnings:"Advert√™ncias",priority:"Prioridade",visit_load2:"Capacidade 2",visit_load3:"Capacidade 3",route_coment:"Rota coment√°rio"},Pdf:{detailed_pdf:"PDF Detalhado",vehicle:"Ve√≠culo",to:" a ",name:"NOME",id:"ID",coments:"COMENT√ÅRIOS OU OBSERVA√á√ïES",signature:"ASSINATURA DO RECEBIMENTO",address:"LOCALIZA√á√ÉO",contact:"CONTATO",windows:"JANELA DE HOR√ÅRIO",phone:"TELEFONE",skills_required:"HABILIDADES NECESS√ÅRIAS",route_comment:"ROTA COMENT√ÅRIO",no_route_comments:"No coment√°rio",notes:"Anota√ß√µes"},Summarized_Pdf:{summarized_pdf:"PDF Resumo",title:"T√≠tulo",address:"Endere√ßo",time_windows:"Janela de hor√°rio",arrival:"Chegada"},Planner_toast:{error_get_plans_1:"Planos de carregamento com erro, rota n√£o existe",error_get_plans_2:"Erro: plano de carregamento no servidor",wrong_path:"Erro na aplica√ß√£o, rota n√£o existe",not_permission:"Voc√™ n√£o tem permiss√£o para acessar a roteirizador",vehicle_not_found:"Ve√≠culo n√£o encontrado",error_get_plans_3:"Plano n√£o existe",error_delete_plan:"Erro: Plano eliminado, por favor tente novamente",error_put_plan_found:"Erro: Plano atualizado, rota n√£o existe",error_call_osrm:"Erro: carregando plano selecionao",error_visit_update_plan:"Erro: editando as visitas do plano",error_optimize_capacity_vehicles:"Erro na capacidade dos ve√≠culos, por favor corrija e tente novamente.",empty_file_excel:"Arquivos de excel vazio, revise o arquivo e tente novamente.",wrong_row_excel:"Foram encontrados alguns erros na informa√ß√£o de visitas do arquivo de excel",error_optimize_500:"Houve um problema ao otimizar, por favor tente novamente",error_order_route:"Houve um erro ao reordenar a rota, por favor tente novamente",error_remake_routes:"Houve um erro ao refazer as rotas, por favor tente novamente",error_save_plan_finish:"Houve um erro ao salvar o plano, por favor tente novamente",error_delete_route:"Erro ao remover rota",error_no_vehicles_for_reoptimize:"Nenhum ve√≠culo est√° dispon√≠vel para executar esta a√ß√£o",error_no_visits_for_reoptimize:"Nenhuma visita dispon√≠vel para executar esta a√ß√£o",error_save_plan_finish_planned_date:"Um plano j√° existe para a mesma data, corrija e tente novamente",error_save_plan_finish_plan_name:"J√° existe um plano com o mesmo nome, corrija e tente novamente",visits_imported:"Total de visitas importadas: "},Log:{actions:{delete_plan:"Plano eliminado",editing_plan:"Plano atualizado"}},Plan:{modal_cancel_edit_message_1:"Voc√© abandonara a edi√ßao de planos e perder√° o que n√£o tenha salvo.",modal_cancel_edit_message_2:"Deseja continuar?",modal_cancel_edit_title:"Anular edi√ß√£o Plano",button_cancel_modal:"Rejeitar",button_accept_modal:"Aceitar"},Driver:{group_available:"",group_assigned:"‚úì"}}),e.determinePreferredLanguage()}e.$inject=["$translateProvider"],angular.module("icarus.planner").config(e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h){function _(){function e(e){re.visits=e.visits,re.vehicles=e.vehicles,re.routes=e.routes,me=p.localOptimizationOptions,H(),b(e),re.steps={vehicle:{title:le("Planner.headers_step_1"),visible:!0,link:"planner.vehicles-list"},visit:{title:le("Planner.headers_step_2"),visible:!1,link:"planner.visits-list"},route:{title:le("Planner.headers_step_3"),visible:!1,link:"planner.routes"}},re.msomAlertData.callToActionMsg=le("Planner.MSOMC.alert_msg"),y()}function t(e){403===e.status&&(o.push("error",le("Planner_toast.not_permission")),a.go("uprofile.info")),404===e.status&&o.push("error",le("Planner_toast.wrong_path")),500===e.status&&o.push("error",le("Planner_toast.error_get_plans_2"))}return p.setPlanDate(n()),p.getPlan().then(e,t)}function f(e){var i=re.infoBoxVisits.findIndex(function(t){return t.id===e});-1!==i&&t.$broadcast("Planner:Visit:deselectEditVisit",{visitId:e})}function b(e){re.planName=p.getPlanName(),re.planName&&(re.editingPlan=!0,re.planDate=r.formatTime(e.planDate.start,"DD MMMM, YYYY"))}function y(){h.getConfigByKey("draw_cluster").then(function(e){t.drawCluster=e||me.big_cluster})}function w(){re.averageLoadsTooltip.load1=0,re.averageLoadsTooltip.load2=0,re.averageLoadsTooltip.load3=0,re.routes.forEach(function(e){re.averageLoadsTooltip.load1+=e.totalLoad,re.averageLoadsTooltip.load2+=e.totalLoad2,re.averageLoadsTooltip.load3+=e.totalLoad3}),re.averageLoadsTooltip.load1=s("formatNumber")(re.averageLoadsTooltip.load1,2,".",","),re.averageLoadsTooltip.load2=s("formatNumber")(re.averageLoadsTooltip.load2,2,".",","),re.averageLoadsTooltip.load3=s("formatNumber")(re.averageLoadsTooltip.load3,2,".",",")}function A(){re.headerStatics.averageKms=0,re.routes.forEach(function(e){re.headerStatics.averageKms+=e.totalDistance}),re.headerStatics.averageKms=(re.headerStatics.averageKms/re.routes.length).toFixed(1),re.headerStatics.averageKms=s("formatNumber")(re.headerStatics.averageKms,2,".",",")}function x(e){p.disableStep.vehicleDisabled||!p.disableStep.next&&re.state.current.name.includes("vehicles")||a.go(e)}function k(){t.isLoading=!0;var e=p.getGmap();0===Object.keys(ce).length&&re.vehicles.map(function(t){var i=v.getGoogleMapsLatLng(t.locationStart.latitude,t.locationStart.longitude);ce[t.id+"-start"]=new MarkerWithLabel({ident:t.id+"-start",title:t.name,icon:t.options.icon,animation:v.googleMapsAnimationDrop(),position:i,map:e,labelAnchor:t.options.anchor,draggable:t.options.draggable,visible:t.options.visible,labelClass:"vehicle-marker-class",labelContent:'<i class="sp-icon-home"></i>',color:t.color}),ce[t.id+"-start"].addListener("dragend",t.updateLocationStart.bind(t));var a=v.getGoogleMapsLatLng(t.locationEnd.latitude,t.locationEnd.longitude);ce[t.id+"-end"]=new MarkerWithLabel({ident:t.id+"-end",title:t.name,icon:t.options.icon,animation:v.googleMapsAnimationDrop(),position:a,map:e,labelAnchor:t.options.anchor,draggable:t.options.draggable,visible:t.options.visible,labelClass:"vehicle-marker-class",labelContent:'<i class="sp-icon-flag-notification"></i>',color:t.color})}),0===Object.keys(re.visitsMarkers).length&&re.visits.map(function(e){var t=v.getGoogleMapsLatLng(e.latitude,e.longitude),i="";(a.includes("*.routes")||a.includes("*.routes-detail"))&&(i=e.options.labelContent),re.visitsMarkers[e.id]=new MarkerWithLabel({ident:e.id,title:e.name,icon:e.options.icon,animation:v.googleMapsAnimationDrop(),position:t,map:p.getGmap(),labelAnchor:e.options.labelAnchor,labelClass:e.options.labelClass,labelContent:i,labelStyle:{zIndex:e.zIndex+1},visible:e.options.visible,zIndex:e.zIndex,color:e.defaultColor}),re.visitsMarkers[e.id].addListener("dragend",e.updateLocation.bind(e)),re.visitsMarkers[e.id].addListener("click",P),re.visitsMarkers[e.id].addListener("mouseover",C),re.visitsMarkers[e.id].addListener("mouseout",D)}),t.drawCluster?0===Object.keys(ue).length&&re.routes.map(function(t){p.getVehicle(t.vehicleId).then(function(i){var a=i;t.stroke.color=a.color,ue[t.id]=v.createPolygon({ident:t.id,paths:t.path,map:e,strokeColor:t.stroke.color,strokeOpacity:t.stroke.opacity,strokeWeight:t.stroke.weight,fillColor:t.stroke.color,fillOpacity:.35,visible:t.visible}),ue[t.id].addListener("click",B)})}):0===Object.keys(de).length&&re.routes.map(function(t){p.getVehicle(t.vehicleId).then(function(i){var a=i;t.stroke.color=a.color,de[t.id]=v.createPolyline({path:t.path,map:e,geodesic:t.geodesic,strokeColor:t.stroke.color,strokeOpacity:t.stroke.opacity,strokeWeight:t.stroke.weight,visible:t.visible})})}),a.current.name.includes("planner")&&(t.isLoading=!1)}function I(e){var t=v.getGoogleMapsLatLng(e.latitude,e.longitude),i="";(a.includes("*.routes")||a.includes("*.routes-detail"))&&(i=e.options.labelContent),re.visitsMarkers[e.id]=new MarkerWithLabel({ident:e.id,title:e.name,icon:e.options.icon,position:t,map:p.getGmap(),labelAnchor:e.options.labelAnchor,labelClass:e.options.labelClass,labelContent:i,labelStyle:{zIndex:e.zIndex+1},zIndex:e.zIndex,color:e.defaultColor}),re.visitsMarkers[e.id].addListener("dragend",e.updateLocation.bind(e)),re.visitsMarkers[e.id].addListener("click",P),re.visitsMarkers[e.id].addListener("mouseover",C),re.visitsMarkers[e.id].addListener("mouseout",D)}function S(e){var t=re.visitsMarkers[e.id];if(t){var i=t.getIcon();i.fillColor=tinycolor(t.color).darken(25).toString(),t.setIcon(i),t.setZIndex(v.googleMapsMarkerMaxZIndex())}}function E(e){var t=re.visitsMarkers[e.id];if(t){var i=t.getIcon();e.selected?i.fillColor=tinycolor(t.color).darken(25).toString():i.fillColor=t.color,t.setIcon(i),t.setZIndex(e.zIndex)}}function C(e){var t=this,i=p.getVisit(t.ident);i&&S(i)}function D(e){var t=this,i=p.getVisit(t.ident);i&&E(i)}function P(e){var i=this,a=p.getVisit(i.ident);if(a)if(p.isEditModeActive()){var n=g.getSimilar(p.visits,a,me.join);n.map(function(e){e.selected=!e.selected,L(e)}),a.selected=!a.selected,L(a)}else O(a),t.$broadcast("visitClickedOnMap",{visit:a})}function L(e){t.$broadcast("Planner:Visit:toggleSelectedEditVisit",{visit:e,multipleSelectionMode:re.isMultipleEditingModeActivated})}function O(t){t.editMode||t.highlight||t.getInfoWindowHTML(p.skills).then(function(e){var a=e;pe.setContent(a),pe.open(p.getGmap(),re.visitsMarkers[t.id]);var n=v.googleMapsAddListener(pe,"closeclick",function(){t.setActive(!1),t.setHighlight(!1,!0),u.removeAlertNotification(),p.hideInfoWindow(),v.googleMapsRemoveListener(n),i.$$phase||i.$apply()});p.showInfoWindow(t)},function(t){e.info(t)})}function T(){for(var e in re.visitsMarkers)re.visitsMarkers.hasOwnProperty(e)&&re.visitsMarkers[e].setMap(null);re.visitsMarkers={}}function V(e){e.visits.map(function(e){e.options.visible=!0,I(e)})}function R(e){e.visits.map(function(e){N(e)})}function M(e){e.map(function(e){e.options.visible=!0,I(e)})}function z(e){e.map(function(e){re.visitsMarkers[e.id]&&(re.visitsMarkers[e.id].setMap(null),delete re.visitsMarkers[e.id])})}function F(){for(var e in re.visitsMarkers)re.visitsMarkers.hasOwnProperty(e)&&re.visitsMarkers[e].setMap(null)}function N(e){if(re.visitsMarkers[e.id]){e.options.visible=!1;var t={visible:e.options.visible};re.visitsMarkers[e.id].setOptions(t)}}function $(){for(var e in re.visitsMarkers)re.visitsMarkers.hasOwnProperty(e)&&re.visitsMarkers[e].setMap(p.getGmap())}function j(e){var t=v.getGoogleMapsLatLng(e.latitude,e.longitude),i={url:"../../assets/images/"+e.options.icon.fillColor.replace("#","")+".png",size:v.createMapSize(16,16),origin:v.createPoint(0,0),anchor:v.createPoint(0,16)};re.visitsMarkers[e.id]=v.createMarker({ident:e.id,title:e.name,position:t,map:p.getGmap(),icon:i,visible:e.options.visible,zIndex:e.zIndex,color:e.defaultColor})}function B(e){var i=this,a=p.getRouteObjById(i.ident);T(),t.$broadcast("Planner:Route:toggleCollapseRoute",{route:a})}function H(){m.getMapOptions().then(function(t){try{var i=v.createMap(document.getElementById("map"),t.options);i.setCenter(v.getGoogleMapsLatLng(t.center.latitude,t.center.longitude)),v.googleMapsEventTrigger(i,"resize"),p.setGmap(i),re.map=i,a.current.name.includes("planner")&&k(),pe=v.createInfoWindow({maxWidth:250})}catch(n){e.error(n)}},function(t){e.info(t),t.message&&o.push("error",le("Toast.error_get_options_map_1")),404===t.status&&o.push("error",le("Toast.error_get_options_map_2"))})}function U(e,t){var i=!1;angular.isUndefined(t)||angular.isUndefined(t.mergePlan)||(i=t.mergePlan);for(var a in re.visitsMarkers)re.visitsMarkers.hasOwnProperty(a)&&re.visitsMarkers[a].setMap(null);re.visitsMarkers={};for(var n in de)de.hasOwnProperty(n)&&de[n].setMap(null);if(!i){for(var s in ce)ce.hasOwnProperty(s)&&ce[s].setMap(null);ce={}}de={};for(var o in ue)ue.hasOwnProperty(o)&&ue[o].setMap(null);ue={}}function q(e){re.steps.vehicle.visible=!0,re.steps.visit.visible=!1,re.steps.route.visible=!1}function G(){i.cancelEditPlan=J,l.open({template:"app/planner/routes/cancel-edit-plan-modal.html",scope:i})}function J(){U(),p.clearPlan(),q(),re.editingPlan=!1,re.planName=null,a.current.name.includes("vehicles")?i.$broadcast("Vehicles:Init-activate"):a.go("planner",{}),p.setUserVisualState({})}function Y(){W()&&(re.infoBoxesPage+=1,re.noPrevPage=!1,W()||(re.noNextPage=!0))}function W(){var e=!1;return re.infoBoxesPerPage*(re.infoBoxesPage+1)<re.infoBoxVisits.length&&(e=!0),e}function Q(){re.infoBoxVisits[re.infoBoxesPerPage*(re.infoBoxesPage-1)]&&(re.infoBoxesPage-=1,re.noNextPage=!1,re.infoBoxVisits[re.infoBoxesPerPage*(re.infoBoxesPage-1)]||(re.noPrevPage=!0))}function Z(){re.infoBoxCollapse=!0}function K(){Ye(),We(),Qe(),Te(),Je(),Ve(),Me(),we(),ze(),be(),fe(),ye(),ge(),he(),_e(),Ze(),je(),He(),qe(),Ge(),Ue(),Se(),Re(),et(),Xe(),Ke(),xe(),ke(),Ee(),Ie(),Fe(),$e(),Oe(),Pe(),Le(),Ne(),De(),Ce(),Ae(),tt(),Be()}function X(e){p.setMultipleVisitsSelected(e)}function ee(){p.deselectVisitsSelected(),re.isMultipleEditingModeActivated=!0,re.infoBoxVisits=[],p.setZoomControlPosition("RIGHT_BOTTOM"),i.$broadcast("Planner:Plan:returnIsMultipleEditingModeActivated",re.isMultipleEditingModeActivated)}function te(){p.deselectVisitsSelected(),re.isMultipleEditingModeActivated=!1,re.msomAlertData.msg=null,re.infoBoxVisits=[],p.setZoomControlPosition("RIGHT_BOTTOM"),i.$broadcast("Planner:Plan:returnIsMultipleEditingModeActivated",re.isMultipleEditingModeActivated)}function ie(){p.deselectVisitsSelected()}function ae(e,t){re.msomAlertData.msg=t.msg}function ne(){var e=re.getElement("#info-boxes-area");e.context&&(re.infoBoxesPerPage=parseInt(e.context.offsetWidth/ve),i.$$phase||i.$apply())}function se(){re.infoBoxesPage>0&&re.infoBoxesPerPage*re.infoBoxesPage>=re.infoBoxVisits.length&&(re.infoBoxesPage-=1,0===re.infoBoxesPage&&(re.noPrevPage=!0)),W()?re.noNextPage=!1:re.noNextPage=!0}function oe(e){return angular.element(document.querySelector(e))}var re=this,le=s("translate"),ce={},de={},ue={},pe={},me={},ve=188;re.infoBoxesPerPage=2,re.infoBoxesPage=0,re.noPrevPage=!0,re.noNextPage=!0,re.visits=[],re.vehicles=[],re.routes=[],re.infoBoxVisits=[],re.state=a,re.visitsMarkers={},re.headerStatics=p.headerStatics,re.activateMapOnTour={"planner-routes":["welcome"]},re.planDate=null,re.editingPlan=!1,re.infoBoxCollapse=!0,re.isMultipleEditingModeActivated=!1,re.drawingManager=null,re.map=null,re.msomAlertData={msg:"",callToActionMsg:""},re.changeState=x,re.hightlightMarker=S,re.backwardMarker=E,re.openModalCancelEditPlan=G,re.cancelEditPlan=J,re.removeVisitInfoBox=f,re.onMultipleSelectionCompleted=X,re.onEnterOnMultipleSelectionMode=ee,re.onExitMultipleSelectionMode=te,re.deselectVisits=ie,re.nextPage=Y,re.prevPage=Q,re.getElement=oe,re.averageLoadsTooltip={load1:0,load2:0,load3:0};var ge=i.$on("Planner:Plan:info",function(e,t){re.planDate=r.formatTime(t.planDate,"DD MMMM, YYYY"),re.planName=t.planName}),he=i.$on("Planner:Plan:steps",function(e,t){re.steps[t.key].visible=t.value}),_e=i.$on("Planner:Plan:steps-reset",q),fe=i.$on("Planner:Plan:calculate-indicator-tooltip",w),be=i.$on("Planner:Plan:calculate-indicator-average-kms",A),ye=i.$on("Planner:Plan-editing",function(e,t){re.editingPlan=t.value,re.editingPlan||(re.planName=null)}),we=i.$on("Planner:Reset:InfoBoxCollapse",Z),Ae=i.$on("Planner:Plan:ShowAlertMSC",ae),xe=i.$on("Planner:Vehicle:Create",function(t,i){var a=i.vehicle;try{var n=v.getGoogleMapsLatLng(a.locationStart.latitude,a.locationStart.longitude);ce[a.id+"-start"]=new MarkerWithLabel({ident:a.id+"-start",title:a.name,icon:a.options.icon,animation:v.googleMapsAnimationDrop(),position:n,map:p.getGmap(),labelAnchor:a.options.anchor,draggable:a.options.draggable,visible:a.options.visible,labelClass:"vehicle-marker-class",labelContent:'<i class="sp-icon-home"></i>',color:a.color}),ce[a.id+"-start"].addListener("dragend",a.updateLocationStart.bind(a));var s=v.getGoogleMapsLatLng(a.locationEnd.latitude,a.locationEnd.longitude);ce[a.id+"-end"]=new MarkerWithLabel({ident:a.id+"-end",title:a.name,icon:a.options.icon,animation:v.googleMapsAnimationDrop(),position:s,map:p.getGmap(),labelAnchor:a.options.anchor,draggable:a.options.draggable,visible:a.options.visible,labelClass:"vehicle-marker-class",labelContent:'<i class="sp-icon-flag-notification"></i>',color:a.color}),ce[a.id+"-end"].addListener("dragend",a.updateLocationEnd.bind(a))}catch(o){e.error(o)}}),ke=i.$on("Planner:Vehicle:Update",function(e,t){var i=t.vehicle;if(ce[i.id+"-start"]&&ce[i.id+"-end"]){var a=v.getGoogleMapsLatLng(i.locationStart.latitude,i.locationStart.longitude),n={position:a,map:p.getGmap(),draggable:i.options.draggable,visible:i.options.visible,icon:i.options.icon};ce[i.id+"-start"].setOptions(n);var s=v.getGoogleMapsLatLng(i.locationEnd.latitude,i.locationEnd.longitude),o={position:s,map:p.getGmap(),draggable:i.optionsEnd.draggable,visible:i.optionsEnd.visible,
icon:i.optionsEnd.icon};ce[i.id+"-end"].setOptions(o)}}),Ie=i.$on("Planner:Visit:Create",function(e,t){var i=t.visit;I(i)}),Se=i.$on("Planner:Visit:CreateMarkerLight",function(e,t){j(t.visit)}),Ee=i.$on("Planner:Visit:ifMarkerNotCreatedThenCreate",function(e,t){var i=t.visit;re.visitsMarkers[i.id]||I(i)}),Ce=i.$on("Planner:Visit:UpdateMarkerLight",function(e,t){var i=t.visit;if(re.visitsMarkers[i.id]){var n="";(a.includes("*.routes")||a.includes("*.routes-detail"))&&(n=i.options.labelContent);var s=v.getGoogleMapsLatLng(i.latitude,i.longitude),o={position:s,visible:i.options.visible,icon:re.visitsMarkers[i.id].icon,labelAnchor:i.options.labelAnchor,labelClass:i.options.labelClass,labelContent:n,draggable:i.options.draggable};o.icon.strokeColor=i.options.icon.strokeColor,o.icon.fillColor=i.options.icon.fillColor,o.icon.fillOpacity=i.options.icon.fillOpacity,re.visitsMarkers[i.id].setOptions(o)}}),De=i.$on("Planner:Visit:Update",function(e,t){var i=t.visit;if(re.visitsMarkers[i.id]){var n="";(a.includes("*.routes")||a.includes("*.routes-detail"))&&(n=i.options.labelContent);var s=v.getGoogleMapsLatLng(i.latitude,i.longitude),o={position:s,draggable:i.options.draggable,visible:i.options.visible,icon:i.options.icon,labelAnchor:i.options.labelAnchor,labelClass:i.options.labelClass,labelContent:n,color:i.options.icon.fillColor};re.visitsMarkers[i.id].setOptions(o),re.visitsMarkers[i.id].setShape()}}),Pe=i.$on("Planner:Visit:Remove",function(e,t){var i=t.visit;re.visitsMarkers[i.id]&&(re.visitsMarkers[i.id].setMap(null),delete re.visitsMarkers[i.id])}),Le=i.$on("Planner:Visit:showInfoWindow",function(e,t){var i=t.visit;O(i)}),Oe=i.$on("Planner:Visit:hideInfoWindow",function(){try{pe.setContent&&(pe.setContent(""),pe.close())}catch(t){e.error(t)}}),Te=i.$on("Planner:Clear:Visits",function(){T()}),Ve=i.$on("Planner:Hide:Visits",function(){F()}),Re=i.$on("Planner:Show:Visits",function(){$()}),Me=i.$on("Planner:Highlight:Visit",function(e,t){var i=t.visit;S(i)}),ze=i.$on("Planner:notHighlight:Visit",function(e,t){var i=t.visit;E(i)}),Fe=i.$on("Planner:CreateVisitsFromArray:Visit",function(e,t){var i=t.visits;M(i)}),Ne=i.$on("Planner:RemoveVisitsFromArray:Visit",function(e,t){var i=t.visits;z(i)}),$e=i.$on("Planner:AddVisitInfoBoxContainer:Visit",function(e,t){var i=t.visit,a=re.infoBoxVisits.findIndex(function(e){return e.id===i.id});-1===a?(re.infoBoxVisits.push(i),1===re.infoBoxVisits.length&&p.setZoomControlPosition("RIGHT_CENTER")):i.selected||(re.infoBoxVisits.splice(a,1),0===re.infoBoxVisits.length&&p.setZoomControlPosition("RIGHT_BOTTOM")),se(),d(function(){ne()},10)}),je=i.$on("Planner:Reset:InfoBoxContainer",function(){re.infoBoxVisits=[],re.noNextPage=!0,re.noNextPage=!0,p.setZoomControlPosition("RIGHT_BOTTOM")}),Be=i.$on("Planner:Update:InfoBoxColors",function(e,t){t.visits.forEach(function(e){var i=re.infoBoxVisits.findIndex(function(t){return t.id===e.id});-1!==i&&(re.infoBoxVisits[i].color=t.color,re.infoBoxVisits[i].order="")})}),He=i.$on("Planner:Route:Create",function(e,i){var a=i.route,n={};p.getVehicle(a.vehicleId).then(function(e){n=e,a.stroke.color=n.color,t.drawCluster?(ue[a.id]=v.createPolygon({ident:a.id,paths:a.path,map:p.getGmap(),strokeColor:a.stroke.color,strokeOpacity:a.stroke.opacity,strokeWeight:a.stroke.weight,fillColor:a.stroke.color,fillOpacity:.35,visible:a.visible}),ue[a.id].addListener("click",B)):de[a.id]=v.createPolyline({ident:a.id,path:a.path,map:p.getGmap(),geodesic:a.geodesic,strokeColor:a.stroke.color,strokeOpacity:a.stroke.opacity,strokeWeight:a.stroke.weight,visible:a.visible})})}),Ue=i.$on("Planner:Route:Update",function(e,i){var a=i.route;if(t.drawCluster){if(ue[a.id]){var n={path:a.path,map:p.getGmap(),strokeColor:a.stroke.color,strokeOpacity:a.stroke.opacity,strokeWeight:a.stroke.weight,fillColor:a.stroke.color,fillOpacity:.35,visible:a.visible};ue[a.id].setOptions(n)}}else if(de[a.id]){var s={path:a.path,map:p.getGmap(),geodesic:a.geodesic,strokeColor:a.stroke.color,strokeOpacity:a.stroke.opacity,strokeWeight:a.stroke.weight,visible:a.visible};de[a.id].setOptions(s)}}),qe=i.$on("Planner:Route:Remove",function(e,i){var a=i.route;t.drawCluster?ue[a.id]&&(ue[a.id].setMap(null),delete ue[a.id]):de[a.id]&&(de[a.id].setMap(null),delete de[a.id])}),Ge=i.$on("Planner:Routes:showMarkersOfRoute",function(e,t){var i=t.route;T(),V(i)}),Je=i.$on("Planner:Routes:hideMarkersOfRoute",function(e,t){var i=t.route;R(i)}),Ye=i.$on("Planner:Clear:Map",U),We=i.$on("Planner:Clear:Polygons",function(){for(var e in ue)ue.hasOwnProperty(e)&&(ue[e].setMap(null),delete ue[e])}),Qe=i.$on("Planner:Clear:Polylines",function(){for(var e in de)de.hasOwnProperty(e)&&(de[e].setMap(null),delete de[e])}),Ze=t.$on("positionNavigator",function(){t.mapInitCoord&&p.setMapCenterOn(t.mapInitCoord)});i.$on("Planner:Plan:isMultipleEditingModeActivated",function(){i.$broadcast("Planner:Plan:returnIsMultipleEditingModeActivated",re.isMultipleEditingModeActivated)});var Ke=i.$on("TOUR:UPDATE_STADISTICS",function(e,t){angular.extend(re.headerStatics,t)}),Xe=i.$on("TOUR:END_ALL_TOURS",function(e){angular.extend(re.headerStatics,{averageTime:0,averageLoad:0,averageLoad2:0,averageLoad3:0,usedVehicles:0,createdRoutes:0,averageKms:void 0})}),et=i.$on("TOUR:ROUTE:CREATE",function(e,t){var i=t.route;de[i.id]=v.createPolyline({ident:i.id,path:i.path,map:p.getGmap(),geodesic:i.geodesic,strokeColor:i.stroke.color,strokeOpacity:i.stroke.opacity,strokeWeight:i.stroke.weight,visible:i.visible})}),tt=i.$on("Planner:Visit:UpdateMarkerColor",function(e,t){var i=t.visit,a=re.visitsMarkers[i.id];a&&(a.color=i.defaultColor)});i.$on("$destroy",K),angular.element(c).on("resize",function(){ne(),se()}),_()}e.$inject=["$log","$rootScope","$scope","$state","moment","$filter","Toasts","timeUtils","ngDialog","$window","$timeout","alertNotificationService","plannerService","mapService","googleService","visitSimilarService","accountConfigsService"],angular.module("icarus.planner").controller("PlannerController",e)}(),function(){"use strict";function e(e){function t(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g){this.id=e,this.route_id=t,this.status=i,this.title=a,this.address=n,this.latitude=s,this.longitude=o,this.checkout_time=r,this.estimated_time_arrival=l,this.order=c,this.reference=d,this.hasAlert=u,this.windowStart=p,this.windowEnd=m,this.windowStart2=v,this.windowEnd2=g}return t.fromJson=function(i){if(!(i&&i.id&&i.title&&i.address&&i.route_id&&i.status))throw new Error("Json is not a valid VisitModel");return i.checkout_time=i.checkout_time?e.createTime(i.checkout_time).format("HH:mm"):i.checkout_time,new t(i.id,i.route_id,i.status,i.title,i.address,i.latitude,i.longitude,i.checkout_time,i.estimated_time_arrival,i.order,i.reference,i.has_alert,i.window_start,i.window_end,i.window_start_2,i.window_end_2)},t.fromStringJson=function(e){var i=angular.fromJson(e);return t.fromJson(i)},t}e.$inject=["timeUtils"],angular.module("icarus.shared").factory("VisitModel",e)}(),function(){"use strict";function e(e){function t(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y,w,A,x,k,I,S,E,C,D,P){this.id=e,this.title=t,this.address=i,this.latitude=a,this.longitude=n,this.planned_date=s,this.reference=o,this.status=r,this.estimated_time_arrival=l,this.order=c,this.pictures=d,this.checkout_observation=u,this.checkin_time=p,this.checkout_time=m,this.checkout_comment=_,this.checkout_latitude=f,this.checkout_longitude=b,this.time_service=v,this.driver_name=g,this.vehicle_name=h,this.window_start=y,this.window_end=w,this.window_start_2=A,this.window_end_2=x,this.duration=k,this.extra_field_values=I,this.notes=S,this.load=E,this.load2=C,this.load3=D,this.calculated_service_time=P}function i(e){return e&&e.id&&e.title&&e.address&&e.status}function a(t,i){return e("limitTo")(t,i)}function n(t){t.time_service&&(t.time_service=a(t.time_service,5)),t.calculated_service_time&&(t.calculated_service_time=a(t.calculated_service_time,5)),t.checkout_time?t.checkout_time=moment(t.checkout_time).format("LT"):t.checkout_time,t.checkin_time?t.checkin_time=moment(t.checkin_time).format("LT"):t.checkin_time,t.estimated_time_arrival&&(t.estimated_time_arrival=e("limitTo")(t.estimated_time_arrival,5)),t.window_start&&(t.window_start=e("limitTo")(t.window_start,5)),t.window_end&&(t.window_end=e("limitTo")(t.window_end,5)),t.window_start_2&&(t.window_start_2=e("limitTo")(t.window_start_2,5)),t.window_end_2&&(t.window_end_2=e("limitTo")(t.window_end_2,5)),t.signature&&t.pictures.push(t.signature)}return t.fromJson=function(e){if(!i(e))throw new Error("Json is not a valid VisitDetailModel");return n(e),new t(e.id,e.title,e.address,e.latitude,e.longitude,e.planned_date,e.reference,e.status,e.estimated_time_arrival,e.order,e.pictures,e.checkout_observation,e.checkin_time,e.checkout_time,e.time_service,e.driver_name,e.vehicle_name,e.checkout_comment,e.checkout_latitude,e.checkout_longitude,e.window_start,e.window_end,e.window_start_2,e.window_end_2,e.duration,e.extra_field_values,e.notes,e.load,e.load_2,e.load_3,e.calculated_service_time)},t}e.$inject=["$filter"],angular.module("icarus.shared").factory("VisitDetailModel",e)}(),function(){"use strict";function e(){function e(e,t,i,a,n){this.id=e,this.name=t,this.driver=i,this.routes=n,this.progress=0,this.color=a,this.isActive=!1}return e.fromJson=function(t){if(!t||!t.id||!t.name||!angular.isObject(t.driver)&&null!==t.driver||!angular.isArray(t.routes))throw new Error("Json is not a valid VehicleModel");return new e(t.id,t.name,t.driver,t.color,t.routes)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.shared").factory("VehicleModel",e)}(),function(){"use strict";function e(){function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_){this.id=e,this.location_start_address=t,this.location_start_latitude=i,this.location_start_longitude=a,this.location_end_address=n,this.location_end_latitude=s,this.location_end_longitude=o,this.driver_id=r,this.vehicle_id=l,this.plan_id=c,this.status=d,this.visits=u,this.estimatedTimeStart=p,this.startTime=m,this.totalTimeFormatted=v&&v.length?v.slice(0,-3):"",this.totalLoadPercentage=g,this.totalLoad2Percentage=h,this.totalLoad3Percentage=_,this.expandedIndicators=!1}return e.fromJson=function(t){if(!(t&&t.id&&t.location_start_address&&t.location_start_latitude&&t.location_start_longitude&&t.location_end_address&&t.location_end_latitude&&t.location_end_longitude&&t.vehicle_id&&t.plan_id&&t.status&&t.visits))throw new Error("Json is not a valid RouteModel");return new e(t.id,t.location_start_address,t.location_start_latitude,t.location_start_longitude,t.location_end_address,t.location_end_latitude,t.location_end_longitude,t.driver_id,t.vehicle_id,t.plan_id,t.status,t.visits,t.estimated_time_start,t.start_time,t.total_duration,t.total_load_percentage,t.total_load_2_percentage,t.total_load_3_percentage)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.shared").factory("RouteModel",e)}(),function(){"use strict";function e(){function e(e,t,i,a){this.plan_id=e,this.name=t,this.account_id=i,this.routes=a}return e.fromJson=function(t){if(!(t&&t.plan_id&&t.name&&t.account_id&&t.routes))throw new Error("Json is not a valid PlanModel");return new e(t.plan_id,t.name,t.account_id,t.routes)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.shared").factory("PlanModel",e)}(),function(){"use strict";function e(){function e(e,t,i,a,n){this.accountId=e,this.userId=t,this.username=i,this.json=a,this.typeAction=n}return e.fromJson=function(t){return new e(t.account_id,t.user_id,t.username,t.json,t.type_action)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.log",[]).factory("Log",e)}(),function(){"use strict";function e(){function e(e,t,i,a,n,s){this.account_id=e,this.label=t,this.key=i,this.order=a,this.enable=n,this.type=s}return e.fromJson=function(t){return new e(t.account_id,t.label,t.key,t.order,t.enable,t.type)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.extraFieldDefinition",[]).factory("ExtraFieldDefinition",e)}(),function(){"use strict";function e(){function e(e,t,i,a){this.occurred_on=e,this.version=t,this.data=i,this.aggregate_id=a}function t(e){var t=moment(e.checkout_time),a=e.window_start_time?moment(e.planned_date+" "+e.window_start_time):moment(e.planned_date+" 00:00:00",i),n=e.window_end_time?moment(e.planned_date+" "+e.window_end_time):moment(e.planned_date+" 23:59:59",i);if(!e.window_start_time&&!e.window_end_time)return!0;if(t.isBetween(a,n,"[]"))return!0;var s=e.window_start_2_time?moment(e.planned_date+" "+e.window_start_2_time):moment(e.planned_date+" 00:00:00",i),o=e.window_end_2_time?moment(e.planned_date+" "+e.window_end_2_time):moment(e.planned_date+" 23:59:59",i);return e.window_start_2_time||e.window_end_2_time?t.isBetween(s,o,"[]")?!0:!1:!0}var i="YYYY-MM-DD HH:mm:ss";return e.fromJson=function(i){if(!(i&&i.occurred_on&&i.version&&i.data&&i.aggregate_id))throw new Error("Json is not a valid EventModel");return i.data=JSON.parse(i.data),"VISIT_CHECKOUT"===i.data.type&&(i.data.isCheckoutOnTime=t(i.data)),i.data.service_time=moment.duration(i.data.service_time).asMinutes(),i.occurred_on=moment(i.occurred_on).format("LT"),i.checkout_time?i.checkout_time=moment(i.checkout_time).format("LT"):i.checkout_time,new e(i.occurred_on,i.version,i.data,i.aggregate_id)},e.fromStringJson=function(t){var i=angular.fromJson(t);return e.fromJson(i)},e}angular.module("icarus.shared").factory("EventModel",e)}(),function(){"use strict";function e(e){e.translations("es",{profile:"Perfil",settings:"Ajustes",logout:"Salir",visits:"Visitas",routes:"Rutas",tracking:"Seguimiento",dashboard:"Reportes","smchat.headerText":"¬øC√≥mo podemos ayudar?","smchat.inputPlaceholder":"Escriba un mensaje...","smchat.sendButtonText":"Enviar","smchat.introductionText":"Est√°mos aqu√≠ para hablar, preg√∫ntanos lo que sea.",test_will_end:"Tu prueba gratuita terminar√°",test_button_active_account:"Activa tu cuenta","in":"en",days:"d√≠as"}),e.translations("en",{profile:"Profile",settings:"Settings",logout:"Log out",visits:"Visits",routes:"Route",tracking:"Tracking",dashboard:"Dashboards","smchat.headerText":"How can we help?","smchat.inputPlaceholder":"Type a message...","smchat.sendButtonText":"Send","smchat.introductionText":"We're here to talk, so ask us anything!",test_will_end:"Your trial account will end",test_button_active_account:"Activate your account","in":"in",days:"days"}),e.translations("pt",{profile:"Perfil",settings:"Configura√ß√µes",logout:"Sair",visits:"Visitas",routes:"Rotas",tracking:"Rastreamento",dashboard:"Dashboards","smchat.headerText":"How can we help?","smchat.inputPlaceholder":"Type a message...","smchat.sendButtonText":"Send","smchat.introductionText":"We're here to talk, so ask us anything!",test_will_end:"Seu teste gratuito se encerrar√°",test_button_active_account:"ativar sua conta","in":"em",days:"dias"})}e.$inject=["$translateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d,u,p,m,v,g,h,_,f,b,y,w){function A(){function e(e){if(!e)throw"No user!.";if(R.user=e,R.isNotDriver=e.is_admin||e.is_monitor||e.is_owner||e.is_staff,"trialing"===e.account.status){var t=s();R.trial=s(e.account.active_until).diff(t,"days"),a.showTrial=!0}else a.showTrial=!1;w.setOptimizationOptions(R.user.account.optimization_options,l.optimizationOptions,l.localOptimizationOptions,l.optimizationOptionsDisplayed,R.user).then(function(e){l.setOptimizationOptionsDisplayed(e.optionsPlannerDisplayed),l.setOptimizationOptions(e.optionsPlanner),l.setlocalOptimizationOptions(e.optionsPlannerLocal)}),"past_due"===R.user.account.status?R.showPaymentPending=!0:"trialing"===R.user.account.status?(R.isInTrial=!0,R.trialEndTime=s().to(e.account.active_until,!0)):"canceled"===R.user.account.status&&i.go("uprofile.info"),x(e),P(e)}function n(e){t.info(e),i.go("auth.login")}return a.$locale&&D(),r.getUser().then(e)["catch"](n)}function x(e){y.setDataWindowIntercom(e)}function k(){var t=u.use();t===M?e.srcVideo="https://www.youtube.com/embed/hNOZlX4oTgA":t===z?e.srcVideo="//www.youtube.com/embed/u341_B4LTSU":t===F?e.srcVideo="//www.youtube.com/embed/RDhlMwO_AlA?ecver=2":e.srcVideo="//www.youtube.com/embed/u341_B4LTSU";var i=n.open({templateUrl:"app/main/video.html",size:"lg",scope:e});return i.result}function I(){y.initChatIntercom(),L("send","event","chat","click","Abrir el chat")}function S(){y.closeSessionIntercom(),l.clearPlan(),p.clear(),m.clear(),v.clear(),g.clear(),f.remove("activatedTour"),f.remove("activeTour"),a.onTour=!1,r.logout(),i.go("auth.login"),a.drawCluster=null}function E(){o.close()}function C(){L("send","event","register","click","Abrir secci√≥n de pago"),i.go("uprofile.info.add-payment")}function D(){var e={es:{DATETIME_FORMATS:{AMPMS:["a. m.","p. m."],DAY:["domingo","lunes","martes","mi√©rcoles","jueves","viernes","s√°bado"],ERANAMES:["antes de Cristo","despu√©s de Cristo"],ERAS:["a. C.","d. C."],FIRSTDAYOFWEEK:0,MONTH:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],SHORTDAY:["dom.","lun.","mar.","mi√©.","jue.","vie.","s√°b."],SHORTMONTH:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],STANDALONEMONTH:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d MMM y H:mm:ss",mediumDate:"d MMM y",mediumTime:"H:mm:ss","short":"d/M/yy H:mm",shortDate:"d/M/yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"‚Ç¨",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"¬†¬§",posPre:"",posSuf:"¬†¬§"}]},id:"es",localeID:"es",pluralCat:function(e,t){return 1===e?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},en:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¬§",negSuf:"",posPre:"¬§",posSuf:""}]},id:"en",localeID:"en",pluralCat:function(e,t){var i=0|e,a=getVF(e,t);return 1==i&&0===a.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}},pt:{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","ter√ßa-feira","quarta-feira","quinta-feira","sexta-feira","s√°bado"],ERANAMES:["Antes de Cristo","Ano do Senhor"],ERAS:["a.C.","d.C."],FIRSTDAYOFWEEK:6,MONTH:["janeiro","fevereiro","mar√ßo","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","s√°b"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],STANDALONEMONTH:["janeiro","fevereiro","mar√ßo","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d 'de' MMM 'de' y HH:mm:ss",mediumDate:"d 'de' MMM 'de' y",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¬§",negSuf:"",posPre:"¬§",posSuf:""}]},id:"pt",localeID:"pt",pluralCat:function(e,t){return e>=0&&2>=e&&2!=e?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}}},t=a.$locale.substring(0,2).toLowerCase();e[t]&&angular.copy(e[t],d)}function P(e){if(r.checkUserLastLogin(e)){var t=f.get("activatedTour");(angular.isUndefined(t)||null===t||t)&&(f.set("activatedTour",!0),_.startTour("planner-vehicles"))}}function L(e,t,i,a,n){var s={type:e,events:{name:t,category:i,action:a,label:n}};h.sendEventGoogle(s)}function O(){V(i.current)?b.openConfirm({templateUrl:"app/main/tour-warning.html",className:"tour-dialog"}).then(function(){T()}):T()}function T(){i.go("planner.vehicles-list",{},{location:"replace"}),setTimeout(function(){f.set("activatedTour",!0),_.startTour("planner-vehicles")},1e3)}function V(e){var t=["planner.visits-list","planner.routes"];return-1!==t.indexOf(e.name)&&(l.visits.length>0||l.routes.length>0)}var R=this,M="es",z="en",F="pt";R.user=null,R.state=i,R.isNotDriver=!0,R.openVideo=k,R.chatInit=I,R.closeChat=E,R.openTour=O,R.logout=S,R.goStateUprofile=C,A()}e.$inject=["$scope","$log","$state","$rootScope","$uibModal","moment","Smooch","sessionService","plannerService","__env","$locale","$translate","vehicleService","skillsService","mobileGeneralService","driversService","marketingService","TourManager","store","ngDialog","intercomService","optimizeService"],angular.module("icarus").controller("MainController",e)}(),function(){"use strict";function e(e){e.state("dashboard",{parent:"main",url:"/dashboard",controller:"DashboardController",controllerAs:"vm",templateUrl:"app/dashboard/dashboard.html",data:{authentication:!0},redirectTo:"dashboard.visits-graphics"}).state("dashboard.visits-graphics",{parent:"dashboard",url:"/visits",controller:"VisitsGraphicsController",controllerAs:"vm",templateUrl:"app/dashboard/visits/visits-graphics.html",resolve:{PermissionToGraphics:["accountConfigsService",function(e){return e.getConfigByKey("dashboards").then(function(e){return e},function(){return!1})}]}}).state("dashboard.reports",{parent:"dashboard",url:"/reports",controller:"ReportsController",controllerAs:"vm",templateUrl:"app/dashboard/reports/reports.html"})}e.$inject=["$stateProvider"],angular.module("icarus.dashboard").config(e)}(),function(){"use strict";function e(e){e.translations("es",{Dashboard:{reports:"Reportes",current_period:"Per√≠odo actual",BarGraph:{title:"Estado de visitas por d√≠a",visits_failed:"Visitas fallidas",visits_completed:"Visitas exitosas",visits_pending:"Visitas pendientes"},ObservationPieGraph:{title_failed:"Motivo de visitas fallidas",title_completed:"Motivo de visitas completadas",failed:"fallidas",completed:"completadas",total_text_failed:"visitas<br>fallidas",total_text_completed:"visitas<br>completadas"},Indicators:{total_visits_title:"Total de visitas ruteadas",max_vehicles_title:"Total de veh√≠culos utilizados",visits_completed_title:"Visitas exitosas",checkouts_in_time_window_title:"Visitas dentro de ventana horaria",message_tooltip:"En relaci√≥n con el mes anterior",vehicle_average_load_title:"Promedio de carga por veh√≠culo"},Reports:{title:"Descargas",visits_report_title:"Reporte de Visitas",report_from:"Desde",report_to:"Hasta",recipient_email:"Email Destinatario",send_report:"Enviar Reporte",report_sending_success:"Su reporte se est√° generando. Llegar√° a su correo en breve.",report_sending_error:"Hubo un error generando su reporte.",error_between_dates:"* El rango de fechas no puede superar los 31 d√≠as",error_date_start:"* La fecha inicial es mayor a la fecha final",error_invalid_email:"* No has ingresado una direcci√≥n de correo correcta"},checkoutGraph:{title:"Comportamiento de visitas por hora",visits_total:"Total de visitas",visits_window:"Visitas en ventana horaria"},Visits:{title:"Visitas",Modal:{title:"No tienes activada la visualizaci√≥n de reportes","footer-message":"Activa la secci√≥n de Reportes y revisa el estado de tus visitas mensuales, por qu√© fallan tus entregas, c√≥mo han cumplido tus ventanas horarias y m√°s!","footer-button":"Quiero saber m√°s","confirm-message":"Te enviaremos un email para contarte m√°s sobre los reportes que SimpliRoute ofrece","confirm-title":"Confirmaci√≥n",close:"Cerrar",error_email:"Hubo un problema al contactarnos, por favor intente de nuevo.",success_email:"Su solicitud se registro con exito, pronto lo contactaremos."}}}}),e.translations("en",{Dashboard:{reports:"Reports",current_period:"Current period",BarGraph:{title:"State of visits per day",visits_failed:"Failed visits",visits_completed:"Successful visits",visits_pending:"Pending visits"},ObservationPieGraph:{title_failed:"Observations of failed visits",title_completed:"Observations of completed visits",failed:"failed",completed:"completed",total_text_failed:"failed<br>visits",total_text_completed:"completed<br>visits"},Indicators:{total_visits_title:"Total routed visits",max_vehicles_title:"Total used vehicles",visits_completed_title:"Successful visits",checkouts_in_time_window_title:"Visits inside of time window",message_tooltip:"In Relation to the previous month",vehicle_average_load_title:"Vehicle average load"},Reports:{title:"Downloads",visits_report_title:"Visits Report",report_from:"From",report_to:"To",recipient_email:"Recipient Email",send_report:"Send Report",report_sending_success:"Your report is being generated. It will arrive to your mail soon.",report_sending_error:"There was an error generating your report.",error_between_dates:"* Date range can not exceed 31 days",error_date_start:"* The start date is greater than the end date",error_invalid_email:"* You didn't enter a valid email"},checkoutGraph:{title:"Visits behavior per hour",visits_total:"Total visits",visits_window:"Visits in time window"},Visits:{title:"Visits",Modal:{title:"You do not have report viewing enabled","footer-message":"Activate the Reports section and check the status of your monthly deliveries, why your deliveries fail, how your windows have been fulfilled and more!","footer-button":"I want more info","confirm-message":"We will send you an email to tell you more about the reports that SimpliRoute offers","confirm-title":"Confirmation",close:"Close",error_email:"There was a problem, please try again.",success_email:"Your request has been registered successfully, we will contact you."}}}}),e.translations("pt",{Dashboard:{reports:"Relat√≥rios",current_period:"Per√≠odo atual",BarGraph:{title:"Estado das visitas por dia",visits_failed:"Visitas falharam",visits_completed:"Visitas bem sucedidas",visits_pending:"Visitas pendentes"},ObservationPieGraph:{title_failed:"Observa√ß√µes de visitas com uma falha",title_completed:"Observa√ß√µes de visitas conclu√≠das",failed:"falhou",completed:"conclu√≠das",total_text_failed:"visitas<br>fallidas",total_text_completed:"visitas<br>completadas"},Indicators:{total_visits_title:"Visitas roteadas totais",max_vehicles_title:"Total de ve√≠culos usados",visits_completed_title:"Visitas bem sucedidas",checkouts_in_time_window_title:"Janela de tempo visitantes",message_tooltip:"Relacionamento com o m√™s anterior",vehicle_average_load_title:"Carga m√©dia por ve√≠culo"},Reports:{title:"Downloads",visits_report_title:"Relat√≥rio Entregas",report_from:"Das",report_to:"√°S",recipient_email:"Email Destinat√°rio",send_report:"Enviar Reporte",report_sending_success:"Seu relat√≥rio est√° sendo gerado. Voc√™ vai chegar ao seu correio em breve",report_sending_error:"Houve um erro ao gerar o relat√≥rio.",error_between_dates:"* O intervalo de datas n√£o pode exceder 31 dias",error_date_start:"* A data de in√≠cio √© maior do que a data de t√©rmino",error_invalid_email:"* Voc√™ n√£o inserir um email v√°lido"},checkoutGraph:{title:"Comportamento de visitas por hora",visits_total:"Total de visitas",visits_window:"Janela de tempo visitantes"},Visits:{title:"Visitas",Modal:{title:"Voc√™ n√£o possui visualiza√ß√£o de relat√≥rios ativada","footer-message":"Ative a se√ß√£o Relat√≥rios e verifique o status de suas visitas mensais, por que suas entregas falham, como seu Windows foi cumprido e muito mais!","footer-button":"Mas informa√ßao","confirm-message":"N√≥s lhe enviaremos um e-mail para lhe informar mais sobre os relat√≥rios que a SimpliRoute oferece","confirm-title":"Confirma√ß√£o",close:"Fechar",error_email:"Houve um problema, tente novamente",success_email:"Seu pedido foi registrado com sucesso, entraremos em contato em breve."}}}})}e.$inject=["$translateProvider"],angular.module("icarus.dashboard").config(e)}(),function(){"use strict";function e(e){var t=this;t.state=e}e.$inject=["$state"],angular.module("icarus.dashboard").controller("DashboardController",e)}(),function(){"use strict";function e(e){function t(e){for(var t="",i=0,a=10240;i<e.byteLength/a;++i)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a,i*a+a)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(i*a)))}function i(i){var a=e.defer(),n="undefined"!=typeof FileReader&&"undefined"!=typeof FileReader.prototype&&"undefined"!=typeof FileReader.prototype.readAsBinaryString,s=new FileReader;return s.onload=function(e){var i,s=e.target.result;if(n)i=XLSX.read(s,{type:"binary"});else{var o=t(s);i=XLSX.read(btoa(o),{type:"base64"})}a.resolve({SheetNames:i.SheetNames,Sheets:i.Sheets})},s.readAsBinaryString(i),a.promise}return{handleFile:i}}e.$inject=["$q"],angular.module("icarus.bulk").factory("xlsUploaderService",e)}(),function(){"use strict";function e(e){function t(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0,a=e.length-1,n=0;n<e.length;n+=1,a-=1)i+=Math.pow(t.length,a)*(t.indexOf(e[n])+1);return i}function i(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),a=e%26,n=t[a],s=parseInt(e/26);return s>0?i(s-1)+n:n}function a(e){return e.replace(/^\D+/g,"")}function n(e){return e.replace(/[0-9]/g,"")}function s(t){var i=[],a=t.headers;return e.forEach(t.data,function(e){for(var t={},n=0;n<a.length;n++)t[a[n]]=e[n];i.push(t)}),i}function o(e,t,i){var a=e[i+t],n="";return a&&(a.w?n=a.w:a.v&&(n=a.v)),n}function r(e,t,a,n,s){for(var r=2;e>=r;r++){for(var l=[],c=t;a>=c;c++){var d=i(c-1);l.push(o(n,r,d))}var u=l.every(function(e){return!e});u||(l.push(r),s.push(l))}}function l(e,i){var s={headers:[],data:[]},o=e.SheetNames[0],l=e.Sheets[o],c=e.Sheets[o]["!ref"];if(c){var d=c.split(":"),u=n(d[0]),p=parseInt(a(d[1])),m=n(d[1]),v=t(u),g=t(m);s.headers=i,s.headers.push("!row"),r(p,v,g,l,s.data)}return s}function c(e,t){var i=e.map(function(e){return t.forEach(function(t){e[t]=String(e[t]).split(",").map(function(e){return e.trim()})}),e});return i}return{createGrid:l,gridToList:s,convertToArray:c}}e.$inject=["lodash"],angular.module("icarus.bulk").factory("xlsParserService",e)}(),function(){"use strict";function e(e,t,i,a,n,s){function o(t){var a=i.defer();t=c(t);var n=g(t);return h(n.start).then(function(i){h(n.end).then(function(n){var s={start:i,end:n};m(s).then(function(i){i.error||(t=v(t,s),e.post(_,t).then(function(e){a.resolve(e)},function(e){a.reject(e)}))},function(e){a.reject(e)})},r)},r),a.promise}function r(e){a.info(e)}function l(t){var a=i.defer();t=c(t);var n=g(t);return h(n.start).then(function(i){h(n.end).then(function(n){var s={start:i,end:n};m(s).then(function(i){i.error||(t=v(t,s),e.put(f,t).then(function(e){a.resolve(e)},function(e){a.reject(e)}))},function(e){a.reject(e)})},r)},r),a.promise}function c(e){return e.map(function(e,t){return e.tempId=t,e})}function d(e){for(var t={error:!1},i=0;i<e.start.length&&(t=p(e.start[i]),!t.error);i++)if(t=p(e.end[i]),t.error){t.type="LOCATION_ERROR";break}return t}function u(e){var t=i.defer(),n={error:!1};return s.getUser().then(function(i){for(var a=i.account,s=0;s<e.start.length;s++)e.start[s].country!==a.country&&(n.error=!0,n.type="LOCATION_ERROR",n.location=e.start[s]),
e.end[s].country!==a.country&&(n.error=!0,n.type="LOCATION_ERROR",n.location=e.end[s]);n.error?t.reject(n):t.resolve(n)},function(e){t.reject(e),a.info(e)}),t.promise}function p(e){var t={error:!1};return e.administrative_area_level_1||e.administrative_area_level_2||e.administrative_area_level_3?t:(t.error=!0,t.location=e,t.type="LOCATION_ERROR",t)}function m(e){var t=i.defer();return u(e).then(function(){var i=d(e);i.error?t.reject(i):t.resolve(i)},function(e){t.reject(e)}),t.promise}function v(e,t){return e.map(function(e,i){var a={start:n.find(t.start,{ref_id:e.tempId.toString()}),end:n.find(t.end,{ref_id:e.tempId.toString()})};return e.location_start_latitude=a.start.latitude,e.location_start_longitude=a.start.longitude,e.location_end_latitude=a.end.latitude,e.location_end_longitude=a.end.longitude,e})}function g(e){for(var t=[],i=[],a=0;a<e.length;a++){var n={address:e[a].location_start_address,ref_id:e[a].tempId},s={address:e[a].location_end_address,ref_id:e[a].tempId};t.push(n),i.push(s)}return{start:t,end:i}}function h(a){var n=i.defer();return e.post(t.API_URL+"directory/geocode/",a).then(function(e){n.resolve(e.data)},function(e){n.reject(e)}),n.promise}var _=t.API_URL+"bulk/upload/vehicles/",f=t.API_URL+"bulk/update/vehicles/";return{uploadVehicles:o,updateVehicles:l}}e.$inject=["$http","__env","$q","$log","lodash","sessionService"],angular.module("icarus.planner").factory("bulkService",e)}(),function(){"use strict";function e(e){function t(e,t){t.open({controller:"AccountNotConfirmedController",controllerAs:"vm",template:"app/authentication/account/not-confirmed.html",closeByEscape:!1,closeByDocument:!1,showClose:!1})}function i(e,t){var i=t.open({controller:"AccountConfirmedController",controllerAs:"vm",template:"app/authentication/account/confirmed.html",closeByEscape:!1,closeByDocument:!1});i.closePromise.then(function(){e.go("auth.login",{})})}e.state("auth",{"abstract":!0,url:"",controller:"AuthenticationController",controllerAs:"vm",templateUrl:"app/authentication/authentication.html",data:{authentication:!1}}).state("auth.login",{url:"/login",controller:"LoginController",controllerAs:"vm",templateUrl:"app/authentication/login/login.html"}).state("auth.password-reset",{url:"/password/reset",controller:"PasswordResetController",controllerAs:"vm",templateUrl:"app/authentication/password-reset/password-reset.html"}).state("auth.password-reset-confirm",{url:"/password/reset/confirm/:uid/:token",controller:"PasswordResetConfirmController",controllerAs:"vm",templateUrl:"app/authentication/password-reset-confirm/password-reset-confirm.html"}).state("auth.signup",{url:"/signup",controller:"SignupController",controllerAs:"vm",templateUrl:"app/authentication/signup/signup.html"}).state("auth.account-not-confirmed",{url:"/account/not-confirmed",onEnter:["$state","ngDialog",t.bind(this)]}).state("auth.account-confirmed",{url:"/account/activate/:uid/:token/",onEnter:["$state","ngDialog",i.bind(this)]})}e.$inject=["$stateProvider"],angular.module("icarus.authentication").config(e)}(),function(){"use strict";function e(e){var t=this;t.state=e}e.$inject=["$state"],angular.module("icarus.authentication").controller("AuthenticationController",e)}(),function(){"use strict";function e(e){e.translations("es",{Login:{login:"Entrar",login_link:"¬øTienes una cuenta?",email:"Correo electr√≥nico",password:"Contrase√±a",welcome:"Bienvenido a SimpliRoute",forgotPassword:"¬øOlvid√≥ su contrase√±a?",recoverEmail:"Ingrese su email",send:"Enviar",cancel:"Cancelar",logout:"Salir",back:"Volver",signup:"Ingresa a la aplicaci√≥n",signup_email:"Correo electr√≥nico",signup_passwd:"Contrase√±a",get_started:"CREA TU CUENTA",wrong_password:"No es posible entrar, revisa las credenciales.",existing_user:"El usuario ya existe, por favor intentelo de nuevo",field_required:"Este campo es requerido",username:"Usuario",reset_message_success:""},PasswordReset:{incorrect_email:"Email incorrecto",new_password:"Nueva contrase√±a",repeat_password:"Repetir contrase√±a",reset_password:"Restablecer la contrase√±a",error_reset_password:"Su solicitud de cambio de contrase√±a expiro",reset_message_success:"En unos minutos recibir√° un correo electr√≥nico con las instrucciones para restablecer la contrase√±a de su cuenta.",reset_password_message:"Haz cambiado tu contrase√±a."},Signin:{signin:"Ingresa a la aplicaci√≥n"},Signup:{quantity:"Veh√≠culos",quantity_more:"o m√°s veh√≠culos",signup:"Registrarse",title:"Comienza hoy a optimizar tus rutas de despacho",title_more_data:"S√≥lo unas preguntas antes de comenzar...",signup_name:"Nombre completo",message_footer:'Para m√°s informaci√≥n puedes escribirnos a <br><span class="sp-enhance">contacto@simpliroute.com</span>',more_data_company:"Empresa",more_data_country:"Pa√≠s",more_data_unselected_country:"Debe seleccionar un pa√≠s",more_data_vehicle:"Cantidad de veh√≠culos",wrong_form:"Algo fall√≥. Por favor intentalo nuevamente.",message_reason_li_1:"Obt√©n toda la informaci√≥n en tiempo real.",message_reason_li_2:"Monitorea todo tu equipo log√≠stico",message_reason_li_3:"Reduce un 30% de tus costos de log√≠stica.",message_reason_li_4:"otras 10 razones m√°s.",incorrect_email:"No has ingresado una direcci√≥n de correo correcta."},Confirmation:{not_confirmed_title:"¬°Estas a un click de comenzar tu demo!",not_confirmed_subject:"Verifica tu correo electr√≥nico",not_confirmed_body:"Te hemos enviado un e-mail. Por favor valida <br> tu correo para activar tu demo de SimpliRoute",not_confirmed_link:"Reenviar correo","not-confirmed-logout":"Ir al login",confirmed_subject:"¬°Bienvenido a Simpliroute!",confirmed_body:"Gracias por activar tu cuenta. Desde <br> hoy puedes comenzar tu prueba <br> gratis de 14 d√≠as de Simpliroute",confirmed_loading:"Confirmando cuenta ...",confirmed_link_error:"Estimado usuario, el link de activaci√≥n es inv√°lido",confirmed_link_error_subject:"¬°Opps!",mail_resend:"Te hemos enviado un nuevo email de validaci√≥n"}}),e.translations("en",{Login:{login:"Log in",login_link:"Do you have an account?",email:"Email",password:"Password",welcome:"Welcome to SimpliRoute",forgotPassword:"Forgot your password?",recoverEmail:"Enter your email",send:"Send",cancel:"Cancel",logout:"Logout",back:"Back",signup:"Sign up",signup_passwd:"Password",username:"Username",get_started:"CREATE YOUR ACCOUNT",wrong_password:"Unable to login with provided credentials.",existing_user:"Username already taken, please try again",field_required:"This field is required",message_footer:'For more information you can write us to <br><span class="sp-enhance">contact@simpliroute.com</span>'},PasswordReset:{email_incorrect:"Incorrect email, please correct it.",new_password:"New password",repeat_password:"Repeat password",reset_password:"Reset password",error_reset_password:"Your request for password change just expired",reset_message_success:"You should receive an email shortly with instructions on how to reset your account password.",reset_password_message:"You have changed your password."},Signin:{signin:"Log in"},Signup:{signup:"Sign up",quantity:"Vehicles",quantity_more:"or more vehicles",title:"Start today optimizing your <br> delivery routes",title_more_data:"Just a few more questions...",signup_name:"Full name",message_footer:'For more information you can write us to <br><span class="sp-enhance">contact@simpliroute.com</span>',more_data_company:"Company",more_data_country:"Country",more_data_unselected_country:"You must select a country",more_data_vehicle:"Number of vehicles",wrong_form:"Something is wrong. Please try again.",message_reason_li_1:"Get information in real time.",message_reason_li_2:"Give visibility of your complete logistics chain.",message_reason_li_3:"Reduce 30% your logistics costs.",message_reason_li_4:"10 other reasons.",incorrect_email:"You didn't enter a valid email "},Confirmation:{not_confirmed_title:"You are one click away from starting your demo!",not_confirmed_subject:"Verify your email",not_confirmed_body:"We have sent you an e-mail. Please validate <br> your account before you can start your SimpliRoute's trial",not_confirmed_link:"Resend mail","not-confirmed-logout":"Go to login",confirmed_subject:"¬°Welcome to Simpliroute!",confirmed_body:"Thank you for activating your account. <br> From today you can start <br> your free 14 day trial of Simpliroute",confirmed_loading:"Confirming account ...",confirmed_link_error:"Dear user, the activation link is invalid",confirmed_link_error_subject:"¬°Opps!",mail_resend:"We¬¥ve sent you a new validation email"}}),e.translations("pt",{Login:{login:"Acessar",login_link:"Voc√™ tem uma conta?",email:"E-mail",password:"Senha",welcome:"Bem-vindo a SimpliRoute",forgotPassword:"Esqueceu sua senha?",recoverEmail:"Insira seu e-mail",send:"Enviar",cancel:"Cancelar",logout:"Sair",back:"Voltar",signup:"Efetue login no aplicativo",signup_passwd:"Senha",username:"Usu√°rio",get_started:"CRIAR SEUS CONTA",wrong_password:"N√£o √© poss√≠vel iniciar a sess√£o com as credenciais fornecidas.",existing_user:"Nome de usu√°rio j√° tomadas, por favor, tente novamente",field_required:"Este campo √© obrigat√≥rio",message_footer:'Para mais informa√ß√µes escreva-nos para <br> <span class ="sp-enhance">contato@simpliroute.com</span>'},PasswordReset:{email_incorrect:"E-mail incorreto, por favor corrigi-lo.",new_password:"Nova sehna",repeat_password:"Repita a senha",reset_password:"Trocar a senha",error_reset_password:"O seu pedido de altera√ß√£o de senha caducado",reset_message_success:"Em breve voc√™ receber√° um e-mail com instru√ß√µes para redefinir a senha de sua conta",reset_password_message:"Voc√™ mudou sua senha."},Signin:{signin:"Acessar"},Signup:{signup:"Inscrever-se",quantity:"Ve√≠culos",quantity_more:"o m√°s ve√≠culos",title:"Otimize hoje mesmo suas rotas de entregas",title_more_data:"Apenas algumas perguntas antes de come√ßar...",signup_name:"Nome completo",message_footer:'Para mais informa√ß√µes escreva-nos para <br> <span class ="sp-enhance">contato@simpliroute.com</span>',more_data_company:"Companhia",more_data_country:"Pa√≠s",more_data_unselected_country:"Voc√™ deve selecionar um pa√≠s",more_data_vehicle:"N√∫mero de ve√≠culos",wrong_form:"Algo est√° errado. Por favor, tente novamente.",message_reason_li_1:"Obtenha informa√ß√£o em tempo real",message_reason_li_2:"D√™ total visibilidade a sua cadeia log√≠stica",message_reason_li_3:"Reduza em at√© 30% seus custos log√≠sticos",message_reason_li_4:"10 outras raz√µes.",incorrect_email:"Voc√™ n√£o inserir um email v√°lido"},Confirmation:{not_confirmed_title:"¬°Voc√™ est√° a um clique de dist√¢ncia da sua demonstra√ß√£o!",not_confirmed_subject:"Verifique seu e-mail",not_confirmed_body:"Enviamos um e-mail para voc√™. Valide seu e-mail <br> para ativar sua demonstra√ß√£o do Simpliroute",not_confirmed_link:"Reenviar o correio","not-confirmed-logout":"V√° para o login",confirmed_subject:"¬°Bem-vindo ao Simpliroute!",confirmed_body:"Obrigado para ativar sua conta. <br> A partir de hoje voc√™ pode come√ßar a sua vers√£o <br> gratuita de 14 dias do Simpliroute",confirmed_loading:"Confirmar conta ...",confirmed_link_error:"Caro usu√°rio, o link de ativa√ß√£o √© inv√°lido",confirmed_link_error_subject:"¬°Opps!",mail_resend:"Enviamos um novo e-mail de valida√ß√£o"}})}e.$inject=["$translateProvider"],angular.module("icarus.authentication").config(e)}(),function(){"use strict";function e(e){e.state("addons",{parent:"main",url:"/addons",controller:"AddonsController",controllerAs:"vm",templateUrl:"app/addons/addons.html",data:{authentication:!0}}).state("addons.checkout-sms",{url:"/checkout-sms",views:{"viewForm@addons":{controller:"CheckoutSmsController",controllerAs:"vm",templateUrl:"app/addons/sms/checkout-sms.html"}}}).state("addons.email",{url:"/email",views:{"viewForm@addons":{templateUrl:"app/addons/email/email.html"}}})}e.$inject=["$stateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e){e.translations("es",{Addons:{title:"Complementos",options:"Opciones",selection:"Selecci√≥n",option_name:{checkout_sms:"Checkout SMS"}},checkout_sms:{btn_save:"Guardar",title:"Mensaje SMS",description:"Mensaje que estara en el cuerpo del SMS",success_message:"El contenido de su mensaje ha sido guardado exitosamente",without_option_sms:"Su cuenta no tiene opci√≥n de Env√≠o de SMS, por favor comunicarse con el equipo de soporte.",error_save_sms:"Ha ocurrido un error guardando su mensaje, por favor intente de nuevo."}}),e.translations("en",{Addons:{title:"Addons",options:"Options",selection:"Selection",option_name:{checkout_sms:"Checkout SMS"}},checkout_sms:{btn_save:"Save",title:"Message SMS",description:"Message that will be in the body of the SMS",success_message:"Your message content has been successfully saved",without_option_sms:"Your account has no option to Send SMS, please contact the support team.",error_save_sms:"An error occurred while saving your message, please try again."}}),e.translations("pt",{Addons:{title:"Complementos",options:"options",selection:"Selecci√≥n",option_name:{checkout_sms:"Checkout SMS"}},checkout_sms:{btn_save:"Salvar",title:"mensagem SMS",description:"Mensagem de raiva no corpo de SMS",success_message:"O conte√∫do da sua mensagem foi salva com sucesso",without_option_sms:"A sua conta n√£o tem op√ß√£o Envio de SMS, entre em contato com a equipe de suporte.",error_save_sms:"Um erro ao salvar a sua mensagem, por favor, tente novamente ocorreu."}})}e.$inject=["$translateProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e){function t(){}function i(t){e.go(t.view)}var a=this;a.addonsOptions={sms_checkout:{value:!1,view:".sms-checkout"}},a.activeView=i,t()}e.$inject=["$state"],angular.module("icarus").controller("AddonsController",e)}(),function(){"use strict";function e(e){e.translations("es",{"tour-dialogs":{tourOnProgressTitle:"Tour en curso",tourOnProgressBody:"Recargar o cambiar la p√°gina desactivar√° el tour en curso. ¬øDeseas salir?",btnExit:"Salir",btnContinueTour:"Continuar tour",goToTourTitle:"Iniciar Tour",goToTourBody:"Tu progreso se guardar√° temporalmente y lo recuperar√°s al finalizar el tour. ¬øDeseas ir al tour?",btnCancel:"Cancelar",btnGoToTour:"Ir al tour"},tour:{"default":{btnFinishText:"Terminar Tour",btnNextText:"Continuar",btnDismissText:"Salir",btnBackText:"Volver"},"planner-vehicles":{welcome:{title:"Bienvenido al Dise√±o de Rutas",body:"En 3 simples etapas podr√°s crear y asignar tus rutas",btnNextText:"Comenzar Tour",btnDismissText:"Quiz√°s luego"},step1:{title:"PASO 1: Informaci√≥n inicial",body:"Selecciona la fecha en que saldr√°n tus veh√≠culos a la calle y el horario de trabajo de tus veh√≠culos para ese d√≠a."},step2:{title:"PASO 1: Selecci√≥n de veh√≠culos",body:"Selecciona los veh√≠culos que usar√°s en estas rutas. Por ser tu primera vez, creamos un veh√≠culo de ejemplo llamado 'VEH1'."},step3:{title:"PASO 1: Continuar al paso siguiente",body:"Podemos pasar al siguiente paso presionando el bot√≥n 'siguiente'."}},"planner-visits":{welcome:{title:"PASO 2: Importa tus visitas",body:"Aqu√≠ podr√°s agregar los lugares que se visitar√°n en tus rutas. Las llamaremos visitas. Puedes insertarlas manualmente o a trav√©s de un archivo excel. Recuerda respetar el formato de la 'plantilla de ejemplo'. A modo de ejemplo importaremos unas visitas por ti."},step1:{title:"PASO 2: Revisa tus visitas",body:"Ahora que tienes visitas creadas puedes revisar su informaci√≥n en la lista o el mapa. Puedes editar o eliminar las visitas que quieras."},step2:{title:"PASO 2: Continuar al paso siguiente",body:"Presiona el bot√≥n 'Crear rutas' y SimpliRoute crear√° las rutas √≥ptimas para tu flota de veh√≠culos."}},"planner-routes":{welcome:{title:"PASO 3: Rutas",body:"Aqu√≠ podr√°s ver las rutas sugeridas por SimpliRoute y editarlas a tu gusto."},step1:{title:"PASO 3: Continuar al paso siguiente",body:"Cuando est√©s satisfecho con las rutas presiona el bot√≥n 'Finalizar' para pasar a la ventana de asignaci√≥n de conductores."},step2:{title:"PASO 3: Asigna conductores a veh√≠culos",body:"Aqu√≠ ver√°s un resumen de tus rutas antes de asignarlas. Le llamaremos a esto un plan. Ponle un nombre a tu plan y escoge qu√© conductores manejar√°n cada veh√≠culo. A modo de prueba lo llamaremos 'Plan 1'. Para terminar presiona el bot√≥n Confirmar."},step3:{title:"¬°Hemos terminado! ¬°Eres un maestro ruteador!",body:"Tus rutas se han asignado correctamente a tus conductores. Ahora puedes ir al m√≥dulo de Monitoreo de Rutas o volver al m√≥dulo de Dise√±o de Rutas para seguir creando m√°s rutas.",btnNextText:"Finalizar Tour"}}}}),e.translations("pt",{"tour-dialogs":{tourOnProgressTitle:"Tour em curso",tourOnProgressBody:"Recarregue ou alterar a p√°gina da turn√™ em andamento. Quer ir?",btnExit:"Sa√≠da",btnContinueTour:"Continuar tour",goToTourTitle:"Come√ßar a Tour",goToTourBody:"O seu progresso ser√° salvo temporariamente e obt√™-lo de volta no final da turn√™. Quer ir para a tour?",btnCancel:"Cancelar",btnGoToTour:"Ir tour"},tour:{"default":{btnFinishText:"Terminar Tour",btnNextText:"Continuar",btnDismissText:"Sair",btnBackText:"Voltar"},"planner-vehicles":{welcome:{title:"Bem-vindo ao Planejamento de Rotas",body:"Em 3 simples etapas poder√° criar e atribuir rotas",btnNextText:"Come√ßar Tour",btnDismissText:"Depois"},step1:{title:"PASSO 1: Informa√ß√£o Inicial",body:"Selecione a data em que sair√£o seus ve√≠culos para a rua e o hor√°rio de trabalho dos mesmos para este dia."},step2:{title:"PASSO 1: Sele√ß√£o de ve√≠culos",body:"Selecione os ve√≠culos que ser√£o utilizados nestas rotas. Por ser sua primeira vez, criamos um ve√≠culo de exemplo chamado 'VEH1'."},step3:{title:"PASSO 1: Continue ao PASSO seguinte",body:"Podemos passar ao seguinte PASSO pressionando o bot√£o seguinte"}},"planner-visits":{welcome:{title:"PASSO 2: Importar suas visitas",body:"Aqui voc√™ pode adicionar os locais a serem visitados em suas rotas. As visitas de chamada. Voc√™ pode inseridas manualmente ou atrav√©s de um arquivo excel. Lembre-se de respeitar o formato do 'planilha de exemplo'. Como exemplo vamos importar algumas visitas para voc√™."},step1:{title:"PASSO 2: Revise suas visitas",body:"Agora que tem visitas criadas, pode revisar suas informa√ß√µes na lista e no mapa. √â poss√≠vel editar ou excluir as visitas que desejar."},step2:{title:"PASSO 2: Continuar ao PASSO seguinte",body:"Pressione o bot√£o 'Criar rotas' e SimpliRoute criar√° as rotas √≥timas para sua frota de ve√≠culos."}},"planner-routes":{welcome:{title:"PASSO 3: Rotas",body:"Aqui ser√° poss√≠vel ver as rotas sugeridas por SimpliRoute e editar as mesmas de acordo com seu gosto."},step1:{title:"PASSO 3: Continuar ao PASSO seguinte",body:"Quando estiver satisfeito com as rotas, pressione o bot√£o 'Finalizar' para passar a janela de atribui√ß√£o de motoristas"},step2:{title:"PASSO 3: Atribuir motoristas aos ve√≠culos",body:"Aqui ser√° apresentado um resumo das suas rotas, antes de atribuir. Chamaremos isto de um Plano de Rota. Insira um nome para o seu plano de rota e escolha os motoristas que conduzir√£o cada ve√≠culo.  A modo de teste chamaremos o mesmo de \"Plan 1\". Para terminar pressione o bot√£o 'Confirmar'."},step3:{title:"N√≥s Terminamos! Agora voc√™ √© um expert em roteiriza√ß√£o!",body:"Suas rotas foram atribu√≠das corretamente a seus motoristas. Agora pode ir ao m√≥dulo de Monitoramento de Rotas e voltar ao m√≥dulo de Planejamento de Rotas para seguir criando mais rotas.",btnNextText:"Finalizar Tour"}}}}),e.translations("en",{"tour-dialogs":{tourOnProgressTitle:"Tour in progress",tourOnProgressBody:"Reloading or changing the page will disable the current tour. Do you want exit anyway?",btnExit:"Exit",btnContinueTour:"Continue tour",goToTourTitle:"Start Tour",goToTourBody:"Your progress will be temporarily saved and you will recover it at the end of the tour. Do you want to start the tour?",btnCancel:"Cancel",btnGoToTour:"Start tour"},tour:{"default":{btnFinishText:"End Tour",btnNextText:"Next",btnDismissText:"Exit",btnBackText:"Back"},"planner-vehicles":{welcome:{title:"Welcome to Route Designer",body:"You'll be able to create and assign your routes with 3 simple steps.",btnNextText:"Begin Tour",btnDismissText:"Maybe Later"},step1:{title:"STEP 1: Initial Info",body:"Select the date for your routes and the schedule your vehicles will be on the street."},step2:{title:"STEP 1: Select your Vehicles",body:"Select the vehicles you'll dispatch today. For this tour, we'll create an example vehicle called 'VEH1'."},step3:{title:"STEP 1: Continue to the next step",body:"Now that you have a vehicle we can proceed to the next step by clicking on 'Next'"}},"planner-visits":{welcome:{title:"STEP 2: Import your Visits",body:"Add all the places you need to visit today, we'll call them visits. You can insert them manually or through an excel file. Remember to respect the format of the 'sample template '. By way of example we will import some visits for you."},step1:{title:"STEP 2: Check your visits",body:"Now  that your visits have been imported you can check their information either on the list or on the map. You can edit or delete any visit."},step2:{title:"STEP 2: Continue to the next step",body:"Once you are ready click on 'Create Routes' and Simpliroute will create optimal routes for your vehicles."}},"planner-routes":{welcome:{title:"STEP 3: Routes",body:"You can see here the routes proposed by SimpliRoute and edit them as you please."},step1:{title:"STEP 3: Continue to the next step",body:"Once you are ready with your routes you can click on 'Finish' to go the Driver Assignment Window."},step2:{title:"STEP 3: Assign drivers to your vehicles",body:"Here you can see a final summary of your routes. This si called plan. Type a name for your plan and choose which driver will drive each vehicle. For this tour, we'll call it 'Plan 1' and we will assign it for today. Click on 'confirm' to save your plan."},step3:{title:"We've finished! You are a routing master!",body:"Your routes have been assigned succesfully to your drivers. You can now go to Route Tracking or go back to Route Designer to create another plan of routes.",btnNextText:"End Tour"}}}})}e.$inject=["$translateProvider"],angular.module("icarus.planner").config(e)}(),function(){"use strict";function e(e){e.registerTour("planner-vehicles",{nextTour:"planner-visits",defaultBtnFinishText:"tour.default.btnFinishText",defaultBtnNextText:"tour.default.btnNextText",defaultBtnDismissText:"tour.default.btnDismissText",defaultBtnBackText:"tour.default.btnBackText",setGlobalEnumeration:!0}).step("welcome",{titleText:"tour.planner-vehicles.welcome.title",bodyText:"tour.planner-vehicles.welcome.body",nextStep:"select-date",url:"/planner/vehicles",options:{allowCloseBtn:!1,enableDismissBtn:!0,nextBtnText:"tour.planner-vehicles.welcome.btnNextText",dismissBtnText:"tour.planner-vehicles.welcome.btnDismissText"}}).step("select-date",{titleText:"tour.planner-vehicles.step1.title",bodyText:"tour.planner-vehicles.step1.body",previousStep:"welcome",nextStep:"vehicle-info",url:"/planner/vehicles",attachTo:{target:"selectDate",attachment:"top left",targetAttachment:"top right",offset:"0 -10px"},options:{enumerate:!0}}).step("vehicle-info",{titleText:"tour.planner-vehicles.step2.title",bodyText:"tour.planner-vehicles.step2.body",previousStep:"select-date",nextStep:"goto-visits",attachTo:{target:"vehiclesEmpty",attachment:"middle left",targetAttachment:"top right",offset:"0 -10px"},url:"/planner/vehicles",options:{enumerate:!0}}).step("goto-visits",{titleText:"tour.planner-vehicles.step3.title",bodyText:"tour.planner-vehicles.step3.body",previousStep:"vehicle-info",attachTo:{target:"goToVisitBtn",attachment:"bottom left",targetAttachment:"top right",offset:"35px -10px"},url:"/planner/vehicles",options:{allowOverrideFunctions:["next","back"],allowChangeState:{from:"planner.vehicles-list",to:"planner.visits-list"},enumerate:!0}}),e.registerTour("planner-visits",{previousTour:"planner-vehicles",nextTour:"planner-routes",defaultBtnFinishText:"tour.default.btnFinishText",defaultBtnNextText:"tour.default.btnNextText",defaultBtnDismissText:"tour.default.btnDismissText",defaultBtnBackText:"tour.default.btnBackText",setGlobalEnumeration:!0}).step("welcome",{titleText:"tour.planner-visits.welcome.title",bodyText:"tour.planner-visits.welcome.body",url:"/planner/visits",nextStep:"visits-list",options:{allowOverrideFunctions:["back","next"],allowChangeState:{from:"planner.visits-list",to:"planner.vehicles-list"},enumerate:!0}}).step("visits-list",{titleText:"tour.planner-visits.step1.title",bodyText:"tour.planner-visits.step1.body",previousStep:"welcome",nextStep:"optimize",url:"/planner/visits",options:{enumerate:!0,allowOverrideFunctions:["back"]}}).step("optimize",{titleText:"tour.planner-visits.step2.title",bodyText:"tour.planner-visits.step2.body",previousStep:"visits-list",attachTo:{target:"split-button",attachment:"bottom left",targetAttachment:"middle right",offset:"50px -50px"},url:"/planner/visits",options:{allowOverrideFunctions:["next"],enumerate:!0,allowChangeState:{from:"planner.visits-list",to:"planner.routes"}}}),e.registerTour("planner-routes",{previousTour:"planner-visits",defaultBtnFinishText:"tour.default.btnFinishText",defaultBtnNextText:"tour.default.btnNextText",defaultBtnDismisText:"tour.default.btnDismissText",defaultBtnBackText:"tour.default.btnBackText",setGlobalEnumeration:!0}).step("welcome",{titleText:"tour.planner-routes.welcome.title",bodyText:"tour.planner-routes.welcome.body",nextStep:"goToAssign",url:"/planner/routes",attachTo:{target:"assignBtn",attachment:"bottom left",targetAttachment:"top right",offset:"30px -25px"},options:{allowOverrideFunctions:["back","next"],enumerate:!0,allowChangeState:{from:"planner.routes",to:"planner.visits-list"}}}).step("goToAssign",{titleText:"tour.planner-routes.step1.title",bodyText:"tour.planner-routes.step1.body",previousStep:"welcome",nextStep:"assignPanel",url:"/planner/routes",attachTo:{target:"assignBtn",attachment:"bottom left",targetAttachment:"top right",offset:"50px -25px"},options:{allowOverrideFunctions:["next","back"],enumerate:!0}}).step("assignPanel",{titleText:"tour.planner-routes.step2.title",bodyText:"tour.planner-routes.step2.body",previousStep:"goToAssign",nextStep:"endTour",url:"/planner/routes",attachTo:{target:"assignModal",attachment:"middle left",targetAttachment:"middle right",offset:"20px -5px"},options:{allowOverrideFunctions:["next","back"],enumerate:!0}}).step("endTour",{titleText:"tour.planner-routes.step3.title",bodyText:"tour.planner-routes.step3.body",url:"/planner/routes",previousStep:"assignPanel",attachTo:{target:"assignModal",attachment:"middle left",targetAttachment:"middle right",offset:"0px -5px"},options:{allowCloseBtn:!1,allowOverrideFunctions:["next","back"],nextBtnText:"tour.planner-routes.step3.btnNextText",allowChangeState:{from:"planner.routes",to:"planner.vehicles-list"}}})}e.$inject=["TourManagerProvider"],angular.module("icarus").config(e)}(),function(){"use strict";function e(e,t,i,a,n,s,o,r,l,c,d){function u(i,n,s,l,u){function p(e,t){var i=c.getActiveTour(),a=i.getCurrentStep(),n=a.options&&a.options.allowChangeState?a.options.allowChangeState:{to:null,from:null};return""===e.name&&"^"===e.url&&"planner.vehicles-list"!==t.name||n.to!==t.name||n.from!==e.name}if(n.data.authentication){if(n.retryInProgress)return void(n.retryInProgress=!1);i.preventDefault(),r.getUser().then(function(e){if(!e)throw"No user!.";if("registered"===e.account.status)a.go("auth.account-not-confirmed");else if("canceled"===e.account.status||e.is_driver&&!e.is_admin&&!e.is_owner)a.go("uprofile.info");else if(t.onTour&&p(l,n)){var i=c.getActiveTour(),o=i.getCurrentStep();o.hide(),d.openConfirm({templateUrl:"app/shared/tour/tour-dialog.html",className:"tour-dialog"}).then(function(){c.endTours(),a.go("planner.vehicles-list",{})},function(){o.show()})}else n.redirectTo?a.go(n.redirectTo,s):(n.retryInProgress=!0,a.go(n,s))})["catch"](function(t){e.info(t),a.go("auth.login")}),l.name.includes("vehicles")&&n.name.includes("routes")&&o.getPlan().then(function(e){0===e.visits.length&&(i.preventDefault(),a.go(l,u))},function(){t.isLoading=!1}),n.redirectTo&&(i.preventDefault(),a.go(n.redirectTo,s))}}function p(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(i){e.log("Your latitude is :"+i.coords.latitude+" and longitude is "+i.coords.longitude),t.mapInitCoord={latitude:i.coords.latitude,longitude:i.coords.longitude},t.$broadcast("positionNavigator")},function(t){e.log(t)})}var m=i("translate");t.online=navigator.onLine,n.addEventListener("offline",function(){t.$apply(function(){t.online=!1,s.push("error",m("Toast.error_connection_internet"))})},!1),n.addEventListener("online",function(){t.$apply(function(){t.online=!0})},!1),n.addEventListener("beforeunload",function(e){t.onTour&&c.endTours()}),t.$locale=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,t.$on("$stateChangeStart",u),t.$on("$stateChangeSuccess",function(e,i,a,n,s){t.previousStateObj=n,"planner.routes-detail"===n.name&&"planner.routes-detail"!==i.name&&t.$broadcast("Planner:MSOMC:CLEAR_DRAWING_MANAGER")}),l.googleAnalyticsHeader(),p()}e.$inject=["$log","$rootScope","$filter","$state","$window","Toasts","plannerService","sessionService","marketingService","TourManager","ngDialog"],angular.module("icarus").run(e)}(),function(){"use strict";function e(e,t){e.state("main",{"abstract":!0,url:"",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm",resolve:{translateAdwordsGoogle:["$translate",function(e){window.translateAdwords=e.use()}]}}),t.otherwise(function(e,t){var i=e.get("$state");i.go("planner.vehicles-list")})}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("icarus").config(e)}(),function(){"use strict";var e={},t={};window&&(Object.assign(e,window.__env),Object.assign(t,window.CLEANER_CONFIG)),angular.module("icarus").constant("__env",e).constant("CLEANER_CONFIG",t).constant("tinycolor",tinycolor).constant("moment",moment).constant("lodash",_).constant("Smooch",Smooch).constant("Raven",Raven).constant("XLSX",XLSX).constant("AMOUNT_PER_VEHICLE",40).constant("DEFAULT_SHIFT_START","09:00").constant("DEFAULT_SHIFT_END","17:00").constant("ROUTE_TRACKING_URL","http://web.simpliroute.com/#/estadoActual").constant("DATE_FORMAT","YYYY-MM-DD").constant("PRIORITY_LEVELS",[{label_name:"first_of_day",value:1},{label_name:"last_of_route",value:2},{label_name:"high_priority",value:3},{label_name:"medium_priority",value:4},{label_name:"low_priority",value:5}]).constant("MAP_OPTIONS",{center:{longitude:-70.6072,latitude:-33.4217454},control:{},options:{zoom:11,zoomControl:!0,scaleControl:!0,streetViewControl:!1,mapTypeControlOptions:{position:3,style:1},styles:[{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#f7f1df"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#d0e3b4"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{color:"#fbd3da"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#bde6ab"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffe15f"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efd151"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"white"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{color:"#cfb2db"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#a2daf2"}]}]}}).constant("JOINED_EMAILS_MAX_LENGTH",244).constant("MAX_EMAILS_INPUT",3);try{angular.constant("Keen",Keen)}catch(i){console.log("Keen not defined")}}(),function(){"use strict";function e(e){
var t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;-1===t.indexOf("en")&&-1===t.indexOf("es")&&-1===t.indexOf("pt")&&(t="en"),e.locale(t)}function t(e){e.decorator("$locale",["$delegate",function(e){var t=e.DATETIME_FORMATS;return t.SHORTDAY=["S","M","T","W","T","F","S"],e}])}function i(e,t){t.useSanitizeValueStrategy("escaped");var i={"en-AU":"en","en-BZ":"en","en-CA":"en","en-GB":"en","en-IE":"en","en-IN":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-TT":"en","en-US":"en","en-ZA":"en","en-ZW":"en",es_ES:"es",es_CA:"es",es_MX:"es",es_CL:"es","es-CO":"es","es-CR":"es","es-DO":"es","es-EC":"es","es-ES":"es","es-GT":"es","es-HN":"es","es-MX":"es","es-NI":"es","es-PA":"es","es-PE":"es","es-PR":"es","es-PY":"es","es-SV":"es","es-US":"es","es-UY":"es","es-VE":"es","pt-BR":"pt","pt-PT":"pt"};t.registerAvailableLanguageKeys(["en","es","pt"],i).determinePreferredLanguage().fallbackLanguage(["en"])}function a(e,t){e.setPublishableKey(t.STRIPE_KEY)}function n(e){e.decorator("$q",["$delegate",function(e){function t(t){var i=e.defer(),a=0,n=angular.isArray(t)?[]:{};return angular.forEach(t,function(t,s){a++,e.when(t).then(function(e){n.hasOwnProperty(s)||(n[s]={status:"fulfilled",value:e},--a||i.resolve(n))},function(e){n.hasOwnProperty(s)||(n[s]={status:"rejected",reason:e},--a||i.resolve(n))})}),0===a&&i.resolve(n),i.promise}return e.allSettled=t,e}])}function s(e){e.interceptors.push(["$q","Raven",function(e,t){return{responseError:function(i){return i.hasOwnProperty("status")&&/^4[0-5][0-9]$/.test(i.status.toString())&&t.captureException(i),e.reject(i)}}}])}e.$inject=["moment"],t.$inject=["$provide"],i.$inject=["$logProvider","$translateProvider"],a.$inject=["stripeProvider","__env"],n.$inject=["$provide"],angular.module("icarus").config(e).config(["$provide",t]).config(i).config(["$provide",n]).config(a).config(["$httpProvider",s])}(),angular.module("icarus.env",[]).constant("API_URL","https://dev-1.simpliroute.com/api/").constant("OSRM_URL","https://osrm.simpliroute.com/").constant("GOOGLE_MAPS_KEY","AIzaSyAEbu_rnYdsbSwVM8KWUIyG75cB4Zvdjh4").constant("SMOOCH_TOKEN","220i8i416fja4j43gg8k74bgu").constant("STRIPE_KEY","pk_test_zyWHJjXkDVo3APH5z0c9gd5H").constant("MAP_OPTIONS","/app/shared/map-options.json").constant("APP_MOBILE_GOOGLEPLAY_LINK","https://play.google.com/store/apps/details?id=com.simpliroute.mobile").constant("DEFAULT_BATCH",1).constant("GIT_COMMIT","c414a3255cdae6768db7da734d708d6b30123842"),angular.module("icarus").run(["$templateCache",function(e){e.put("app/addons/addons.html",'<div class=sp-addons-container><div class=sp-addons-headers><span translate=Addons.title></span></div><div class="row sp-addons-body"><div class="col-md-4 sp-addons-form-right"><div ui-view=viewForm></div></div></div></div>'),e.put("app/authentication/authentication.html",'<div class="row sp-auth-container"><div class=row><div class=col-md-4><img src=../../assets/images/logo_oficial.png class="img-responsive sp-auth-logo" alt="Responsive image"></div><div class="col-md-4 col-md-offset-4 button-sign"><a ng-show="vm.state.includes(\'auth.login\')" ui-sref=auth.signup class="btn btn-primary sign" translate=Signup.signup></a> <a ng-show="vm.state.includes(\'auth.signup\')" ui-sref=auth.login class="btn btn-primary sign" translate=Signin.signin></a></div></div><div ui-view class=row></div></div>'),e.put("app/dashboard/dashboard.html","<div class=sp-dashboard-container><div class=sp-dashboard-header><span translate=Dashboard.reports></span></div><div class=sp-dashboard-content><ul class=sp-dashboard-tab><li class=tab ng-class=\"{'active': vm.state.includes('**.visits-graphics.**')}\"><a ui-sref=dashboard.visits-graphics translate=Dashboard.Visits.title></a></li><li class=tab ng-class=\"{'active': vm.state.includes('**.reports.**')}\"><a ui-sref=dashboard.reports translate=Dashboard.Reports.title></a></li></ul></div><div class=sp-dashboard-tab-content ui-view></div></div>"),e.put("app/main/main.html",'<nav class="navbar navbar-default sp-navbar"><div class=container-fluid><div class=navbar-header><a class=navbar-brand ui-sref=planner><img src=../../assets/images/logo-horizontal-simpliroute.svg alt="SimpliRoute logo"></a></div><ul class="nav navbar-nav navbar-right"><li class=sp-call-to-action-pay ng-show=showTrial><span translate=test_will_end></span> <span class=date><span translate=in></span>&nbsp;{{vm.trial}}&nbsp;<span translate=days></span></span> <button class="btn btn-warning" ng-click=vm.goStateUprofile() translate=test_button_active_account></button></li><li><a href="" ng-click=vm.openTour()><i class=sp-icon-tour><svg aria-hidden=true viewbox="0 0 28 28" preserveAspectRatio="xMaxYMin meet"><use x=-2 y=2 width=14 height=10 xlink:href=/assets/images/tour.svg#tour></use></svg></i></a></li><li><a href="" ng-click=vm.openVideo()><i class="sp-icon-top-bar-help sp-icon-video"></i></a></li><li><a href="" ng-click=vm.chatInit()><i class="sp-icon-top-bar-help sp-icon-chat"></i></a></li><li uib-dropdown><a href="" uib-dropdown-toggle><i class="sp-icon-user sp-icon-top-bar"></i> {{vm.user.name}}</a><ul uib-dropdown-menu><li><a ui-sref=uprofile.info><i class="sp-icon-small sp-icon-user"></i> <span translate=profile></span></a></li><li><a ui-sref=^.settings ng-show="vm.user.is_admin || vm.user.is_owner"><i class="sp-icon-small sp-icon-settings"></i> <span translate=settings></span></a></li><li class=divider></li><li><a href="" ng-click=vm.logout()><i class="sp-icon-small sp-icon-logout"></i> <span translate=logout></span></a></li></ul></li><!-- end user-dropdown --></ul></div><!-- end container-fluid --></nav><!-- end top navbar --><div class=sp-main-container><ul class="nav nav-pills nav-stacked sp-main-sidebar"><li id=plannerBtn ui-sref-active=active ng-if="vm.user.is_admin || vm.user.is_owner"><a ui-sref=planner><i class="sp-icon-rutas sp-icon-left-bar"></i><br><span class=sp-responsive-menu-title translate=routes></span></a></li><li id=trackingBtn ng-if=vm.isNotDriver ng-class="{\'active\': vm.state.includes(\'tracking\')}"><a ui-sref=tracking.vehicles><i class="sp-icon-tracking sp-icon-left-bar"></i><br><span class=sp-responsive-menu-title translate=tracking></span></a></li><li id=dashboardBtn ng-if=vm.isNotDriver ng-class="{\'active\': vm.state.includes(\'dashboard\')}"><a ui-sref=dashboard><i class="sp-icon-reportes sp-icon-left-bar"></i><br><span class=sp-responsive-menu-title translate=dashboard></span></a></li></ul><div class=sp-loader ng-if=isLoading><img src=../../assets/images/loading.gif></div><div class=sp-main-content ui-view></div><toast></toast></div>'),e.put("app/main/tour-warning.html",'<div class="info modal-content sp-finish-modal"><div class=modal-header><h3 class=modal-title translate=tour-dialogs.goToTourTitle></h3></div><div class=modal-body><p translate=tour-dialogs.goToTourBody></p></div><div class=modal-footer><div class=sp-action-button><button class="btn btn-default" ng-click=closeThisDialog()><span translate=tour-dialogs.btnCancel></span></button> <button class="btn btn-primary pull-right" ng-click=confirm()><span translate=tour-dialogs.btnGoToTour></span></button></div></div></div>'),e.put("app/main/video.html",'<div class=modal-body><div class="embed-responsive embed-responsive-16by9"><iframe class=embed-responsive-item ng-src="{{srcVideo | trusted}}" allowfullscreen></iframe></div></div>'),e.put("app/planner/planner.html","<div class=sp-planner-content on-tour-block=vm.activatePanelOnTour ui-view=left-planner></div><div class=sp-planner-content-overlay ng-if=\"vm.state.includes('*.vehicles-list.plans') || vm.state.includes('*.vehicles-list.plans-detail')\"></div><div class=sp-planner-map-container on-tour-block=vm.activateMapOnTour><div class=\"row sp-planner-map-header\"><div class=\"col-sm-5 sp-planner-plan\"><div class=sp-planner-plan-info ng-if=\"vm.state.includes('*.visits-list') || vm.state.includes('*.visits-create')\n         || vm.state.includes('*.visits-detail') || vm.state.includes('*.routes')\n         || vm.state.includes('*.routes-detail') || vm.editingPlan\"><div class=info><div class=title><p translate=Planner.planned_date></p></div><div class=body-info>{{vm.planDate}}</div></div><div class=info><div class=title ng-if=vm.editingPlan><span translate=Planner.editing_plan></span></div><div class=body-info>{{vm.planName}}</div></div></div><div class=sp-planner-cancel-edition ng-if=\"vm.editingPlan && !vm.state.includes('*.routes-detail')\"><div class=info><div class=content-view-route-list><div class=sp-cancel-edit-plan><a ng-click=vm.openModalCancelEditPlan()><i class=sp-icon-close></i></a></div></div></div></div></div><div class=\"col-sm-7 sp-planner-bread-crumbs\"><bread-crumbs data=vm.steps on-change-step=vm.changeState(state) class=sp-list-arrow></bread-crumbs></div></div><div id=mapContainer class=sp-planner-map><div id=indicatorBar class=sp-planner-indicators ng-if=\"(vm.state.includes('*.routes-detail') || vm.state.includes('*.routes'))\"><div class=sp-indicator-container><div class=sp-indicator-header><div class=sp-indicator-texts><i class=sp-icon-vehiculos></i> <span class=sp-indicator-title translate=Planner.used_vehicles></span> <span class=sp-indicator-subtitle>{{100 * vm.headerStatics.usedVehicles/vm.vehicles.length | number:0}}% <span translate=Planner.of_your_fleet></span></span></div></div><div class=sp-indicator-value>{{vm.headerStatics.usedVehicles}}</div></div><div class=sp-indicator-container><div class=sp-indicator-header><div class=sp-indicator-texts><i class=sp-icon-tiempo-servicio></i> <span class=sp-indicator-title translate=Planner.average_time></span> <span class=sp-indicator-subtitle translate=Planner.by_route></span></div></div><div class=sp-indicator-value>{{vm.headerStatics.averageTime}}</div></div><div class=sp-indicator-container ng-if=\"vm.headerStatics.averageLoad !== '0.0' && vm.headerStatics.averageLoad !== 0\" uib-tooltip={{vm.averageLoadsTooltip.load1}}><div class=sp-indicator-header><div class=sp-indicator-texts><i class=sp-icon-carga-peso></i> <span class=sp-indicator-title translate=Planner.average_load></span> <span class=sp-indicator-subtitle translate=Planner.by_route></span></div></div><div class=sp-indicator-value><span>{{vm.headerStatics.averageLoad | formatNumber:2:'.':','}}</span></div></div><div class=sp-indicator-container ng-if=\"vm.headerStatics.averageLoad2 !== '0.0' && vm.headerStatics.averageLoad2 !== 0\" uib-tooltip={{vm.averageLoadsTooltip.load2}}><div class=sp-indicator-header><div class=sp-indicator-texts><i class=sp-icon-carga-volumen></i> <span class=sp-indicator-title translate=Planner.average_load_2></span> <span class=sp-indicator-subtitle translate=Planner.by_route></span></div></div><div class=sp-indicator-value><span>{{vm.headerStatics.averageLoad2 | formatNumber:2:'.':','}}</span></div></div><div class=sp-indicator-container ng-if=\"vm.headerStatics.averageLoad3 !== '0.0' && vm.headerStatics.averageLoad3 !== 0\" uib-tooltip={{vm.averageLoadsTooltip.load3}}><div class=sp-indicator-header><div class=sp-indicator-texts><i class=sp-icon-carga-valor></i> <span class=sp-indicator-title translate=Planner.average_load_3></span> <span class=sp-indicator-subtitle translate=Planner.by_route></span></div></div><div class=sp-indicator-value><span>{{vm.headerStatics.averageLoad3 | formatNumber:2:'.':','}}</span></div></div><div class=sp-indicator-container><div class=sp-indicator-header><div class=sp-indicator-texts><svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox=\"0 0 32 32\" enable-background=\"new 0 0 32 32\" xml:space=preserve><g id=kms><path d=\"M21.9,17.5L21.9,17.5c0.1-0.2,0.2-0.4,0.2-0.6c0-0.6-0.4-1-1-1c-0.3,0-0.5,0.1-0.7,0.3l-5.4,4c-0.2,0.1-0.3,0.2-0.5,0.4\n                l0,0l0,0C14.2,21,14,21.5,14,22c0,1.1,0.9,2,2,2c0.6,0,1.1-0.3,1.5-0.7l0,0l0.1-0.1c0.1-0.1,0.1-0.1,0.1-0.2L21.9,17.5z\"/><path d=\"M30,22c0-7.7-6.3-14-14-14C8.3,8,2,14.3,2,22c0,0.7,0.1,1.4,0.2,2h0c0,0.5,0.5,1,1,1c0.5,0,1-0.4,1-1h0c0,0,0,0,0,0\n                c0,0,0,0,0,0c0,0,0,0,0,0C4.1,23.3,4,22.7,4,22c0-6.6,5.4-12,12-12c6.6,0,12,5.4,12,12c0,0.7-0.1,1.4-0.2,2h0c0,0.5,0.5,1,1,1\n                c0.5,0,1-0.4,1-1h0C29.9,23.4,30,22.7,30,22z\"/></g></svg> <span class=sp-indicator-title translate=Planner.average_kms></span> <span class=\"sp-indicator-subtitle km-svg\" translate=Planner.average_by_route></span></div></div><div class=sp-indicator-value>{{vm.headerStatics.averageKms}}</div></div></div><div class=sp-plans-container ui-view=plans ng-if=\"vm.state.includes('*.vehicles-list.plans') || vm.state.includes('*.vehicles-list.plans-detail')\"></div><alert-notification></alert-notification><multiple-selection-on-map class=planner-edit-step-3 alert-data=vm.msomAlertData show-if=\"vm.state.includes('*.routes-detail')\" map=vm.map on-multiple-selection-completed=vm.onMultipleSelectionCompleted(polygon) on-enter-on-mode=vm.onEnterOnMultipleSelectionMode() on-exit-mode=vm.onExitMultipleSelectionMode() alert-call-to-action=vm.deselectVisits()></multiple-selection-on-map><div id=map></div><div class=sp-planner-info-box-container ng-if=vm.infoBoxVisits.length ng-class=\"{'collapse': vm.infoBoxCollapse}\"><div class=container-relative id=container-info-box><div class=expand-button ng-click=\"vm.infoBoxCollapse = !vm.infoBoxCollapse\"><i class=sp-icon-chevron-thin-up ng-if=vm.infoBoxCollapse></i> <i class=sp-icon-chevron-thin-down ng-if=!vm.infoBoxCollapse></i></div><div class=container-absolute><div class=pagination-button ng-click=vm.prevPage() ng-class=\"{'disabled': vm.noPrevPage}\"><i class=sp-icon-chevron-thin-left></i></div><div class=info-boxs-area id=info-boxes-area><info-box ng-repeat=\"visit in vm.infoBoxVisits | limitTo: vm.infoBoxesPerPage : vm.infoBoxesPerPage * vm.infoBoxesPage\" data=visit call-to-close=vm.removeVisitInfoBox(visitId) view-collapse=vm.infoBoxCollapse></info-box></div><div class=pagination-button ng-click=vm.nextPage() ng-class=\"{'disabled': vm.noNextPage}\"><i class=sp-icon-chevron-thin-right></i></div></div></div></div></div></div>"),e.put("app/planner/visit-infowindow.tpl.html",'<div class=sp-planner-infowindow><div class=sp-planner-infowindow-title><!-- {{model.title}} --> {{parameter.title}}</div><div class=sp-planner-infowindow-content><div class=sp-planner-infowindow-prop><div class=sp-planner-infowindow-icon-container><i class=sp-icon-map-pin></i></div><div class=sp-planner-infowindow-desc-container ng-if=parameter.address><span style="font-style: italic">{{parameter.address}}</span></div></div><div class=sp-planner-infowindow-prop ng-if=parameter.load><div class=sp-planner-infowindow-icon-container><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': parameter.capacityError}"></i></div><div class=sp-planner-infowindow-desc-container><span>{{parameter.load}}</span></div></div><!-- vehiculo --><div class=sp-planner-infowindow-prop ng-if=parameter.vehicle><div class=sp-planner-infowindow-icon-container><i class=sp-icon-vehiculos></i></div><div class=sp-planner-infowindow-desc-container><span>{{parameter.vehicle}}</span></div></div><!-- ruta --><div class=sp-planner-infowindow-prop ng-if=parameter.numRoute><div class=sp-planner-infowindow-icon-container><i class=sp-icon-rutas></i></div><div class=sp-planner-infowindow-desc-container><span>{{parameter.numRoute}}</span></div></div><div class=sp-planner-infowindow-prop ng-if="parameter.windowStart || parameter.windowEnd"><div class=sp-planner-infowindow-icon-container><i class=sp-icon-ventana-horaria ng-class="{\'sp-text-color-danger\': parameter.timeError}"></i></div><div class=sp-planner-infowindow-desc-container><span ng-show="parameter.windowStart && !parameter.windowEnd">{{ \'Planner.infowindow_since\' | translate }} {{parameter.windowStart}}</span> <span ng-show="parameter.windowStart && parameter.windowEnd">{{parameter.windowStart}} {{ \'Planner.infowindow_to\' | translate }} {{parameter.windowEnd}}</span> <span ng-show="!parameter.windowStart && parameter.windowEnd">{{ \'Planner.infowindow_until_to\' | translate }} {{parameter.windowEnd}}</span></div></div><div class=sp-planner-infowindow-prop ng-if=parameter.duration><div class=sp-planner-infowindow-icon-container><i class=sp-icon-tiempo-servicio></i></div><div class=sp-planner-infowindow-desc-container><span>{{parameter.duration}}</span></div></div><div class=sp-planner-infowindow-prop><div class=sp-planner-infowindow-icon-container><i class="fa fa-level-up"></i></div><div class=sp-planner-infowindow-desc-container><span>{{parameter.priority}}</span></div></div><div class=sp-planner-infowindow-prop ng-if="parameter.requiredSkills.length > 0"><div class=sp-planner-infowindow-icon-container><i class=sp-icon-skills ng-class="{\'sp-text-color-danger\': parameter.skillsError}"></i></div><div class=sp-planner-infowindow-desc-container><span ng-repeat="skill in parameter.requiredSkills">{{skill}}{{$last ? \'\' : \', \'}}</span></div></div><div class=sp-planner-infowindow-prop ng-if=parameter.notes><div class=sp-planner-infowindow-icon-container><i class=sp-icon-notes></i></div><div class=sp-planner-infowindow-desc-container>{{parameter.notes}}</div></div></div></div>'),e.put("app/settings/settings.html","<div class=sp-settings-container><div class=sp-settings-header><span translate=settings></span></div><div class=sp-settings-content><ul class=sp-settings-tab><li class=tab ng-class=\"{'active': vm.state.includes('**.users.**')}\"><a ui-sref=settings.users.list translate=drivers></a></li><li class=tab ng-class=\"{'active': vm.state.includes('**.vehicles.**')}\"><a ui-sref=settings.vehicles.list translate=vehicles></a></li><li class=tab ng-class=\"{'active': vm.state.includes('**.skills.**')}\"><a ui-sref=settings.skills.list translate=skills></a></li><li class=\"tab mobile-general\" ng-class=\"{'active': vm.state.includes('**.mobile-general.**')}\"><a ui-sref=settings.mobile-general.list translate=mobile></a></li><li class=tab ng-class=\"{'active': vm.state.includes('**.communication.**')}\" ng-if=vm.enableLiveTracking><a ui-sref=settings.communication.list translate=communication></a></li><li class=tab ng-class=\"{'active': vm.state.includes('**.zones.**')}\" ng-if=vm.enableZones><a ui-sref=settings.zones.list translate=zones></a></li><li class=\"tab mobile-general\" ng-class=\"{'active': vm.state.includes('**.generals.**')}\"><a ui-sref=settings.generals.list translate=generals></a></li><li class=\"tab mobile-general\" ng-class=\"{'active': vm.state.includes('**.account.**')}\"><a ui-sref=settings.account.list translate=account></a></li></ul><div class=sp-settings-tab-content ui-view></div></div></div>"),e.put("app/tracking/tracking.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=-23ECMDsmG0QndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=sp-tracking><div class="sp-tracking-panel sp-tracking-drivers"><div class=sp-tracking-header><span translate=Tracking.tracking></span></div><div class=sp-tracking-scrollable><ul class=sp-tracking-tabs-container><li class=tab ng-class="{\'active\': vm.state.includes(\'tracking.vehicles\')}"><a ui-sref=tracking.vehicles translate=Tracking.vehicles></a></li><li class=tab ng-class="{\'active\': vm.state.includes(\'tracking.all-dispatchs\')}"><a ui-sref=tracking.all-dispatchs translate=Tracking.visits></a></li><li class=tab ng-class="{\'active\': vm.state.includes(\'tracking.events\')}"><a ui-sref=tracking.events translate=Tracking.events></a></li></ul><div class=sp-tracking-tabs-content ui-view=tab-content></div></div><!-- end sp-tracking-scrollable --></div><!-- end sp-tracking-drivers --><div class=sp-tracking-map-container><div class=sp-tracking-indicators><!-- Div barra de progreso despachos --><div class=sp-tracking-progress><!-- <h5 translate="{{ \'Indicators.progress_bar\' }}"></h5> --><h5 translate=Indicators.progress_bar></h5><div class=progreso-despachos><div class=progress tooltip-placement=bottom uib-tooltip="{{vm.totalVisitsDone}} / {{vm.totalVisits }}"><div class=progress-bar role=progressbar aria-valuenow="{{ vm.visitProgress}}" aria-valuemin=0 aria-valuemax=100 style="width:{{ vm.visitProgress}}%"><strong class=strong>{{ vm.visitProgress}}%</strong></div></div></div></div><!-- Div alertas --><div class="btn-group sp-tracking-alerts" uib-dropdown><button type=button class="alertas alertas-danger" uib-dropdown-toggle><span>{{vm.totalVisitsAlerts}}</span></button> <button type=button class="alertas alertas-default" uib-dropdown-toggle><h5 translate=Indicators.alerts_title></h5><p translate=Indicators.alerts_message></p></button><ul uib-dropdown-menu><li><a href=""><b>{{vm.totalCustomAlerts}}</b> <span translate=Visits.custom_alerts></span> </a><a href=""><b>{{vm.totalCheckoutFailedAlert}}</b> <span translate=Visits.visits_failed></span></a></li></ul></div><!-- Div fecha datepicker --><div class=sp-tracking-date><button type=button class="btn-group alertas alertas-ok filter-icon" ng-click="vm.trackingDateFilterOpened=!vm.trackingDateFilterOpened"><svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve ng-if=vm.isFilterActive><path class=sp-filter-icon id=FILTRO d="M29.929,2.576C29.785,2.228,29.444,2,29.066,2H2.933C2.556,2,2.215,2.228,2.071,2.576\n              c-0.145,0.349-0.065,0.75,0.202,1.017L13.5,14.82v14.198c0,0.856,0.458,1.189,1,1l3-1c0.656-0.222,1-0.447,1-1V14.82L29.727,3.593\n              C29.993,3.326,30.074,2.925,29.929,2.576z"/></svg> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve ng-if=!vm.isFilterActive><g id=no_filter><g><path class=sp-filter-icon d=M13.846,22.71v5.51c0,0.687,0.451,0.983,0.862,0.861l2.585-1c0.504-0.253,0.861-0.386,0.861-0.861V15.985L13.846,22.71z /><path class=sp-filter-icon d=M18.116,4.938H4.74c-0.325,0-0.619,0.196-0.743,0.497C3.873,5.735,3.942,6.08,4.172,6.311l7.963,7.963L18.116,4.938z /><path class=sp-filter-icon d="M28.002,5.434c-0.123-0.3-0.417-0.497-0.742-0.497h-2.343c-0.052,0.355-0.162,0.703-0.343,1.026l-6.419,10.02l9.673-9.673\n                  C28.058,6.08,28.128,5.735,28.002,5.434z"/></g><path class=sp-filter-icon d="M7.75,26.836c-0.711-0.425-0.983-1.317-0.579-2.04L20.646,3.769c0.402-0.724,1.317-0.982,2.041-0.579\n                c0.723,0.404,0.981,1.318,0.577,2.041L9.791,26.259C9.476,26.805,8.449,27.255,7.75,26.836z"/></g></svg></button><div class="btn-group sp-filter-info"><button type=button class="btn-group alertas date-info-button" ng-click="vm.trackingDateFilterOpened=!vm.trackingDateFilterOpened"><p>{{vm.showDate}}</p><span class="sp-icon-triangle-down expand-filter"></span></button></div><div class=sp-filter-container ng-show=vm.trackingDateFilterOpened><button type=button class="alertas alertas-default date-info" ng-click="vm.popupOpened=!vm.popupOpened"><h5 translate=Indicators.date_title></h5><p><span class="sp-icon-calendario calendar-icon"></span>{{vm.showDate}}</p></button><div class=btn-group ng-model=vm.date ng-change=vm.dateChanged(vm.date) uib-datepicker show-button-bar=false datepicker-options=vm.dateOptions ng-show=vm.popupOpened></div><rzslider class=custom-slider rz-slider-model=vm.timeSlider.min rz-slider-high=vm.timeSlider.max rz-slider-options=vm.timeSlider.options></rzslider><button type=button class="filter-button-reset btn" translate=Indicators.date_reset_button_title ng-click=vm.resetTimeFilter()></button> <button type=button class="filter-button-submit btn" translate=Indicators.date_submit_button_title ng-click=vm.applyTimeFilter()></button></div></div></div><!-- end sp-tracking-indicators --><!-- Div mapa --><div class=sp-tracking-map ng-class="{\'active\': vm.state.includes(\'tracking.vehicles.driver-dispatchs\')}"><div class=sp-tracking-panel ui-view=item-detail></div><!-- end sp-tracking-dispatchs --><div id=map></div></div></div><!-- end sp-tracking-map-container --></div>'),e.put("app/uprofile/uprofile.html",'<div class=sp-uprofile-container><div class=sp-uprofile-header><span translate=Uprofile.profile></span></div><div class=sp-uprofile-content><!-- Informacion de la cuenta --><div class="sp-uprofile-content-account col-md-5" ui-view=viewAccount></div><!-- Informacion del pago --><div class="sp-uprofile-content-payment col-md-7"><div class=sp-uprofile-content-title><h2 translate=Uprofile.payment_information></h2></div><div class=sp-uprofile-content-payment-body><div class=info><!-- facturacion --><div class=payment-left><div class=payment-left-content><!-- Cuando el usuario tiene cuenta de prueba --><div class=empty ng-show="vm.user.account.status === \'trialing\'"><div class=row><div class=col-sm-12><span translate=Uprofile.test_will_end></span> <span>{{vm.trial}}</span></div></div><div class=row><div class=col-sm-12><a class="btn btn-success" ng-class="{\'disabled\': !vm.user.is_owner}" ui-sref=.info.add-payment translate=Uprofile.select_payment_method></a></div></div></div><!-- Cuando la cuenta del usuario ha vencido su tiempo--><div class=empty ng-show="vm.user.account.status === \'canceled\'"><div class=row><div class=col-sm-12><p translate=Uprofile.test_finished></p><span translate=Uprofile.select_payment_method_to_continue></span></div></div><div class=row><div class=col-sm-12><a class="btn btn-success" ng-class="{\'disabled\': !vm.user.is_owner}" ui-sref=.info.add-payment translate=Uprofile.select_payment_method></a></div></div></div><!-- Cuando la cuenta del usuario esta activa y tiene un metodo de pago--><div class=active ng-show="vm.user.account.status === \'active\'"><h4 class=title translate=Uprofile.next_billing></h4><span translate=Uprofile.next_payment_will_be></span> <span>{{vm.trial}}</span> <a class="btn btn-primary" ng-class="{\'disabled\': !vm.user.is_owner}" ng-disabled=vm.editing ui-sref=.info.add-payment translate=Uprofile.update_payment_method></a></div><!-- Cuando la cuenta del usuario esta en past_due y tiene un metodo de pago--><div class=active ng-show="vm.user.account.status === \'past_due\'"><div class=row><div class=col-sm-12><h4 class=title translate=Uprofile.next_billing></h4><span translate=Uprofile.unpaid_msg></span> <span>{{vm.past_due}}</span></div></div><div class=row><div class=col-sm-12><a class="btn btn-primary" ng-class="{\'disabled\': !vm.user.is_owner}" ng-disabled=vm.editing ui-sref=.info.add-payment translate=Uprofile.update_payment_method></a></div></div></div></div><div class=payment-left-footer ng-show=vm.user.has_suscription_id><span ng-hide=!vm.user.is_owner><span translate=Uprofile.wish></span> <a href="" ng-click=vm.showSubscriptionModal() translate=Uprofile.cancel_subscription></a></span></div></div><!-- metodo de pago --><div class=payment-right ui-view=viewPayment></div></div></div></div></div></div>'),e.put("app/addons/email/email.html","<h1>email</h1>"),e.put("app/addons/sms/checkout-sms.html",'<div class=container-sms-checkout><form ng-show=!vm.messageNotSMS class="form-inline form-sms-checkout" name=vm.formSkills id=form-sms-checkout ng-submit=vm.saveSmsCheckout() novalidate><div class="form-group row"><label class="control-label col-md-3">{{vm.checkoutSms.title}}</label><div class="text-area-sms col-md-9"><textarea name=comment class=text-area-sms maxlength=70 ng-model=vm.checkoutSms.value placeholder={{vm.checkoutSms.description}}></textarea></div></div><button type=submit class="btn btn-primary btn-save-sms" translate=checkout_sms.btn_save></button></form><div><h1 ng-show="vm.messageNotSMS && !$rootScope.isLoading" translate=checkout_sms.without_option_sms></h1></div></div>'),e.put("app/authentication/account/confirmed.html",'<div class=confirmed><div class="modal-body sp-restrict-height-to-400 min-height-400"><div><div class=picture><img src=../../../assets/images/Alvaro.svg alt=Alvaro></div><div class=message><div class=subject translate=Confirmation.confirmed_loading ng-if="!vm.showConfirmMessage && !vm.showErrorMessage"></div><div class=subject translate=Confirmation.confirmed_subject ng-if=vm.showConfirmMessage></div><div class=body translate=Confirmation.confirmed_body ng-if=vm.showConfirmMessage></div><div class=subject translate=Confirmation.confirmed_link_error_subject ng-if=vm.showErrorMessage></div><div class=body translate=Confirmation.confirmed_link_error ng-if=vm.showErrorMessage></div></div></div></div></div>'),e.put("app/authentication/account/not-confirmed.html",'<div class=not-confirmed><div class=modal-header><h3 class=modal-title translate=Confirmation.not_confirmed_title></h3></div><div class="modal-body sp-restrict-height-to-400"><div class=picture><img src=../../../assets/images/Fede.svg alt=Fede></div><div class=message><div class=subject translate=Confirmation.not_confirmed_subject></div><div class=body translate=Confirmation.not_confirmed_body></div><div class=link><a href="" ng-click=vm.resendConfirmationEmail() ng-disabled=vm.disabledLink translate=Confirmation.not_confirmed_link></a> <span class=text-success translate=Confirmation.mail_resend ng-if=vm.mailResend></span></div></div></div><div class="modal-footer sp-modal-footer"><a href="" ng-click=vm.goOut() ng-disabled=vm.disabledLink translate=Confirmation.not-confirmed-logout></a></div></div>'),e.put("app/authentication/login/login.html",'<div class="col-md-5 col-md-offset-7 sp-auth-content"><div class=sp-auth-content-right><div class=sp-auth-panel cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}"><div class=sp-auth-panel-title><center><h4 translate=Login.welcome></h4></center></div><div class="login-form sp-auth-panel-body"><form name=vm.loginForm class=form-horizontal ng-submit=vm.login(vm.credentials)><div class=form-group><label class="login-field-icon fui-user" for=loginUser></label><input type=text id=loginUser class="form-control login-field" name=username translate translate-attr-placeholder=Login.username ng-model=vm.credentials.username required><ng-messages for=vm.loginForm.username.$error class=sp-form-messages role=alert ng-if=vm.loginForm.username.$dirty><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=form-group><label class="login-field-icon fui-lock" for=loginPass></label><input type=password id=loginPass class="form-control login-field" name=password translate translate-attr-placeholder=Login.password ng-model=vm.credentials.password required><ng-messages for=vm.loginForm.password.$error class=sp-form-messages role=alert ng-show=vm.loginForm.password.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message><ng-message class=sp-error-txt when=invalid translate=Login.wrong_password></ng-message></ng-messages></div><span class=error-flag ng-show=vm.errorMsg>{{vm.errorMsg}}</span><div class=action-group><button type=submit class="btn btn-block btn-auth"><!-- The "span" solves the animation duration from font-awesome spinner --> <span ng-show=vm.submiting><i class="fa fa-spinner fa-spin"></i> </span><span translate=Login.login></span></button></div><center><a class=login-link ui-sref=^.password-reset translate=Login.forgotPassword></a></center></form></div><div ng-show=vm.reseted><div class="alert alert-success" translate=Login.reset_message_success></div></div></div></div></div>'),e.put("app/authentication/password-reset/password-reset.html",'<div class=sp-auth-content><div class=sp-auth-content-left></div><div class="col-md-4 col-md-offset-4 sp-auth-content-right"><div class=sp-auth-panel><div class=sp-auth-panel-title><center><h4 translate=Login.welcome></h4><center></center></center></div><div class="login-form sp-auth-panel-body" ng-hide=vm.reseted><form name=vm.resetForm class=form-horizontal ng-submit="vm.resetForm.$valid && vm.reset(vm.email)" novalidate><div class=form-group><label class="login-field-icon fui-user" for=resetEmail></label><input type=email id=resetEmail class="form-control login-field" name=email translate translate-attr-placeholder=Login.recoverEmail ng-model=vm.email required><ng-messages for=vm.resetForm.email.$error class=sp-form-messages role=alert ng-if=vm.resetForm.$dirty><ng-message class=sp-error-txt when=pattern translate=PasswordReset.incorrect_email></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message><ng-message class=sp-error-txt when=invalid trnaslate=PasswordReset.incorrect_email></ng-message></ng-messages></div><div class=action-group><button type=submit class="btn btn-block btn-auth" ng-disabled=vm.submiting><span ng-show=vm.submiting><i class="fa fa-spinner fa-spin"></i> </span><span translate=Login.send></span></button></div><center><a class=login-link ui-sref=^.login translate=Login.back></a></center></form></div><div ng-show=vm.reseted><div class="alert alert-success" translate=PasswordReset.reset_message_success></div></div></div></div></div>'),
e.put("app/authentication/password-reset-confirm/password-reset-confirm.html",'<div class=sp-auth-content><div class=sp-auth-content-left></div><div class="col-md-4 col-md-offset-4 sp-auth-content-right"><div class=sp-auth-panel><div class=sp-auth-panel-title><center><h4 translate=Login.welcome></h4></center></div><div class="login-form sp-auth-panel-body" ng-hide=vm.confirmed><form name=confirmForm class=form-horizontal ng-submit="confirmForm.$valid && vm.confirm(vm.new_password, vm.new_password_repeat)" novalidate><div class=form-group><label class=login-field-icon for=newPassword></label><input type=password id=newPassword class="form-control login-field" name=new_password translate translate-attr-placeholder=PasswordReset.new_password ng-model=vm.new_password required><ng-messages for=confirmForm.new_password.$error class=sp-form-messages role=alert ng-show=confirmForm.new_password.$touched><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=form-group><label class=login-field-icon for=newPasswordRepeat></label><input type=password id=newPasswordRepeat class="form-control login-field" name=new_password_repeat translate translate-attr-placeholder=PasswordReset.repeat_password ng-model=vm.new_password_repeat required><ng-messages for=confirmForm.new_password_repeat.$error class=sp-form-messages role=alert ng-show=confirmForm.new_password_repeat.$touched><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=action-group><button type=submit class="btn btn-block btn-auth" ng-disabled=vm.submiting><!-- The "span" solves the animation duration from font-awesome spinner --> <span ng-show=vm.submiting><i class="fa fa-spinner fa-spin"></i> </span><span translate=PasswordReset.reset_password></span></button></div></form></div><div ng-show=vm.confirmed><div class="alert alert-success" ng-show=vm.success><center translate=PasswordReset.reset_password_message></center></div><div class="alert alert-danger" ng-show=!vm.success><center translate=PasswordReset.error_reset_password></center></div></div><center><a class=login-link ui-sref=^.login translate=Login.login></a></center></div></div></div>'),e.put("app/authentication/signup/signup.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=AawOCMf4k20QndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=sp-auth-content ng-if=!vm.moreData><div class="col-md-7 sp-auth-content-left"><ul><li><span class=sp-icon-check></span><span translate=Signup.message_reason_li_1></span></li><li><span class=sp-icon-check></span><span translate=Signup.message_reason_li_2></span></li><li><span class=sp-icon-check></span><span translate=Signup.message_reason_li_3></span></li><li class=sp-reasons><a translate=Signup.message_reason_li_4 ng-href={{vm.linkToOtherReasons}}></a></li></ul></div><div class="col-md-5 sp-auth-content-right"><div class=sp-auth-panel><div class=sp-auth-panel-title><!-- <h2>{{\'Login.get_started\'  }}</h2> --><h2 translate=Signup.title></h2></div><div class=sp-auth-panel-body><form name=vm.signupForm class=form-horizontal ng-submit=vm.signup(vm.user) novalidate><div class=form-group><input type=text id=signup_name class="form-control signup-name" name=signup_name translate translate-attr-placeholder=Signup.signup_name ng-model=vm.user.name required><ng-messages for=vm.signupForm.signup_name.$error class=sp-form-messages role=alert ng-show=vm.signupForm.signup_name.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=form-group><input type=email id=signup_email class="form-control signup-email" name=signup_email translate translate-attr-placeholder=Login.email ng-model=vm.user.email required><ng-messages for=vm.signupForm.signup_email.$error class=sp-form-messages role=alert ng-show=vm.signupForm.signup_email.$dirty><ng-message class=sp-error-txt when=pattern translate=Signup.incorrect_email></ng-message><ng-message class=sp-error-txt when=invalid translate=Login.existing_user></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=form-group><input type=password id=password class="form-control signup-password" name=password translate translate-attr-placeholder=Login.password ng-model=vm.user.password required><ng-messages for=vm.signupForm.signup_password.$error class=sp-form-messages role=alert ng-show=vm.signupForm.signup_password.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><button type=submit class="btn btn-block btn-auth" ng-disabled=vm.signupForm.$invalid translate=Login.signup></button></form></div><div class=sp-auth-panel-footer><p translate=Signup.message_footer></p></div></div></div></div><div class=sp-auth-content ng-if=vm.moreData><div class="col-md-5 col-md-offset-7 sp-auth-content-right"><div class=sp-auth-panel cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}"><div class=sp-auth-panel-title><!-- <h2>{{\'Login.get_started\'  }}</h2> --><h2 translate=Signup.title_more_data></h2></div><div class=sp-auth-panel-body><form name=vm.moreDataForm class=form-horizontal ng-submit=vm.saveMoreData(vm.user) novalidate><div class=form-group><input type=text id=moreData_company class="form-control moreData-company" name=moreData_company translate translate-attr-placeholder=Signup.more_data_company ng-model=vm.user.company required><ng-messages for=vm.moreDataForm.moreData_company.$error class=sp-form-messages role=alert ng-show=vm.moreDataForm.moreData_company.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class="form-group country"><country-select class=form-control name=moreData_country ng-model=vm.user.country cs-priorities="CL,US, BR, PE, ES, MX" cs-required></country-select><label translate=Signup.more_data_country></label><ng-messages for=vm.moreDataForm.moreData_country.$error class=sp-form-messages role=alert ng-show=vm.moreDataForm.moreData_country.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message><ng-message class=sp-error-txt when=invalid translate=Signup.more_data_unselected_country></ng-message></ng-messages></div><div class=form-group><select name=moreData_vehicle ng-model=vm.user.vehicle class=form-control id=moreData_vehicle required><option value="" selected disabled translate=Signup.more_data_vehicle></option><option value="1 - 5">1 - 5 {{ \'Signup.quantity\' | translate}}</option><option value="6 - 10">6 - 10 {{ \'Signup.quantity\' | translate}}</option><option value="11 - 20">11 - 20 {{ \'Signup.quantity\' | translate}}</option><option value=20>20 {{ \'Signup.quantity_more\' | translate}}</option></select><ng-messages for=vm.moreDataForm.moreData_country.$error class=sp-form-messages role=alert ng-show=vm.moreDataForm.moreData_vehicle.$dirty><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=required translate=Login.field_required></ng-message></ng-messages></div><div class=form-group><input class=form-control type=text ng-model=vm.user.phone international-phone-number default-country=cl preferred-countries="br, cl, mx, pe, es, us" required></div><button type=submit class="btn btn-block btn-auth" ng-disabled=vm.moreDataForm.$invalid translate=Signup.signup></button><ng-messages for=vm.moreDataForm.$error class=sp-form-messages role=alert><ng-message class=sp-error-txt when=pattern></ng-message><ng-message class=sp-error-txt when=invalidForm translate=Signup.wrong_form></ng-message></ng-messages></form></div></div></div></div>'),e.put("app/dashboard/components/areaGraph.html",'<div class="sp-dashboards-widget visit-checkouts-widget"><div class=widget-title><span translate=Dashboard.checkoutGraph.title></span></div><div class=widget-body><div class=row><div class=col-sm-3><div class=sp-legend-item><div class="color-box in-window"></div><div class=text translate=Dashboard.checkoutGraph.visits_total></div></div></div><div class="col-sm-7 pull-right"><div class=sp-legend-item><div><hr></div><div class=text translate=Dashboard.checkoutGraph.visits_window></div></div></div></div></div></div><div class=sp-checkout-wrapper><nvd3 options=$ctrl.data.options data=$ctrl.data.data></nvd3></div>'),e.put("app/dashboard/components/barGraph.html",'<div class=sp-dashboards-widget><div class=widget-title><span translate=Dashboard.BarGraph.title></span></div><div class=widget-body><div class=sp-legends><div class=sp-legend-item><div class="color-box succeded"></div><div class=text translate=Dashboard.BarGraph.visits_completed></div></div><div class=sp-legend-item><div class="color-box failed"></div><div class=text translate=Dashboard.BarGraph.visits_failed></div></div><div class=sp-legend-item><div class="color-box pending"></div><div class=text translate=Dashboard.BarGraph.visits_pending></div></div></div></div></div><div class=sp-graphic-wrapper><nvd3 options=$ctrl.data.options data=$ctrl.data.data></nvd3></div>'),e.put("app/dashboard/components/indicator.html",'<div class=sp-indicator-widget><div class=sp-indicator-title>{{$ctrl.data.title}}</div><div class=sp-indicator-value>{{$ctrl.data.value}}</div><div class="row sp-indicator-icons"><div class=col-sm-6><span class=sp-indicator-icon ng-repeat="eventIcon in $ctrl.data.eventIcons"><i class={{eventIcon.icon}} ng-class="{\'active\' : eventIcon.active}" ng-click=eventIcon.clickEvent(eventIcon.indicatorName)></i></span></div><div class=col-sm-6><div class=sp-indicator-data-improvement><div class={{$ctrl.data.classDiv}}><a href="" class=content tooltip-placement=top uib-tooltip="{{\'Dashboard.Indicators.message_tooltip\' | translate}}"><div class={{$ctrl.data.classIcon}}></div><div class=data>{{$ctrl.data.perceChange}}</div></a></div></div></div></div></div>'),e.put("app/dashboard/components/pieGraph.html",'<div class="sp-dashboards-widget observation-widget"><div class=widget-title><span translate=Dashboard.ObservationPieGraph.title_failed ng-if=$ctrl.data.typeFailedActive></span> <span translate=Dashboard.ObservationPieGraph.title_completed ng-if=!$ctrl.data.typeFailedActive></span><div class=change-view><a href="" ng-click=$ctrl.changeView($ctrl.data.type) ng-class="{\'active\': $ctrl.data.type === \'failed\'}" translate=Dashboard.ObservationPieGraph.failed></a> | <a href="" ng-click=$ctrl.changeView($ctrl.data.type) ng-class="{\'active\': $ctrl.data.type === \'completed\'}" translate=Dashboard.ObservationPieGraph.completed></a></div></div><div class=graph-container><div class=observations-legend><div class=observation ng-repeat="observation in $ctrl.data.data | limitTo:6"><div class=ident-color ng-style="observation.color && {\'border\':\'2px solid\', \'border-color\':observation.color}"></div><span>{{observation.key}}</span></div></div><div class=observations-graph><nvd3 options=$ctrl.data.options data=$ctrl.data.data></nvd3><div class=total ng-if="$ctrl.data.total.total > 0"><div class=number>{{$ctrl.data.total.total}}</div><div class=text ng-if="$ctrl.data.type === \'failed\'" translate=Dashboard.ObservationPieGraph.total_text_failed></div><div class=text ng-if="$ctrl.data.type === \'completed\'" translate=Dashboard.ObservationPieGraph.total_text_completed></div></div></div></div></div>'),e.put("app/dashboard/components/report.html",'<div class="sp-dashboards-widget sp-report-widget"><div class=widget-title><span translate={{$ctrl.data.title}}></span></div><div class=sp-report-widget-container><form class=sp-form name=$ctrl.report><div class=row><label class="col-sm-12 control-label" translate=Dashboard.Reports.report_from></label></div><div class=row><div class="col-sm-12 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=$ctrl.reportStart.model ng-change=$ctrl.validateDates() ng-required=true form-reference=report is-open=$ctrl.reportStart.opened datepicker-options=$ctrl.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':$ctrl.report.startDate.$error.endDate_gt_startDate || $ctrl.report.startDate.$error.invalid_dateRange}" ng-click="$ctrl.reportStart.opened = !$ctrl.reportStart.opened"><span class=sp-icon-calendario></span></button></span></div></div><div class=row><label class="col-sm-1 control-label" translate=Dashboard.Reports.report_to></label></div><div class=row><div class="col-sm-12 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=$ctrl.reportEnd.model ng-change=$ctrl.validateDates() ng-required=true form-reference=report is-open=$ctrl.reportEnd.opened datepicker-options=$ctrl.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':report.endDate.$error.endDate_gt_startDate || $ctrl.report.startDate.$error.invalid_dateRange} " ng-click="$ctrl.reportEnd.opened=!$ctrl.reportEnd.opened"><span class=sp-icon-calendario></span></button></span></div></div><div class=row><label class="col-sm-12 control-label" translate=Dashboard.Reports.recipient_email></label></div><div class="row sp-row-form-report"><div class="col-sm-12 sp-block-relative"><input type=email class=form-control name=email ng-model=$ctrl.emailReport ng-required=true ng-change=$ctrl.validateEmail()></div></div><div class="row warning-section" ng-messages=$ctrl.formErrors><span ng-message=dateRangeError translate=Dashboard.Reports.error_between_dates></span> <span ng-message=startDateError translate=Dashboard.Reports.error_date_start></span> <span ng-message=emailError translate=Dashboard.Reports.error_invalid_email></span></div><div class="row sp-row-form-report"><div class="col-xs-10 col-xs-offset-1"><button type=button class="col-xs-12 btn btn-primary sp-button-tc-report" ng-disabled="!$ctrl.submitButtonActive || $ctrl.data.loading" ng-click="$ctrl.onSubmit($ctrl.reportStart.model, $ctrl.reportEnd.model, $ctrl.emailReport)"><span translate={{$ctrl.data.submitButtonLabel}}></span></button></div></div></form></div></div>'),e.put("app/dashboard/components/visitsGraphicsModal.html",'<div class=sp-image-without-graphics-bg></div><div class=sp-modal><div class=sp-visits-graphic-modal-without><div class=title><span translate=Dashboard.Visits.Modal.title></span></div><div class=sp-image><svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 250 250" enable-background="new 0 0 250 250" xml:space=preserve width=285 height=294><g><g><path fill=#BDDDF4 d=M105.6,211.3v-39.3c0-21.2-18.6-38.6-41.3-38.6h0c-22.7,0-41.3,17.4-41.3,38.6v39.3H105.6z /><circle fill=#616262 cx=64.3 cy=58.4 r=41.9 /><path fill=#CCA181 d="M64.3,155.9L64.3,155.9c-5.4,0-9.9-4.5-9.9-9.9v-22.2c0-5.4,4.5-9.9,9.9-9.9h0c5.4,0,9.9,4.5,9.9,9.9V146\n			C74.3,151.4,69.8,155.9,64.3,155.9z"/><g><circle fill=#EBC19C cx=101 cy=79.1 r=8.3 /><circle fill=#DFB28B cx=101 cy=79.1 r=4.6 /></g><g><circle fill=#EBC19C cx=27.7 cy=79.1 r=8.3 /><circle fill=#DFB28B cx=27.7 cy=79.1 r=4.6 /></g><path fill=#EBC19C d="M64.3,126.3L64.3,126.3c-20.2,0-36.6-16.4-36.6-36.6V61.4c0-20.2,16.4-36.6,36.6-36.6l0,0\n			c20.2,0,36.6,16.4,36.6,36.6v28.3C101,109.9,84.6,126.3,64.3,126.3z"/><path fill=#212121 d="M91.4,56.5c0,1-0.8,1.8-1.8,1.8H77c-1,0-1.8-0.8-1.8-1.8l0,0c0-1,0.8-1.8,1.8-1.8h12.6\n			C90.6,54.7,91.4,55.5,91.4,56.5L91.4,56.5z"/><path fill=#212121 d="M53.4,60.1c0,1-0.8,1.8-1.8,1.8H39c-1,0-1.8-0.8-1.8-1.8l0,0c0-1,0.8-1.8,1.8-1.8h12.6\n			C52.6,58.3,53.4,59.1,53.4,60.1L53.4,60.1z"/><path fill=#263238 d="M47.2,68.8v1.6c0,1-0.8,1.9-1.9,1.9l0,0c-1,0-1.9-0.8-1.9-1.9v-1.6c0-1,0.8-1.9,1.9-1.9l0,0\n			C46.4,66.9,47.2,67.8,47.2,68.8z"/><path fill=#263238 d="M85.2,68.8v1.6c0,1-0.8,1.9-1.9,1.9l0,0c-1,0-1.9-0.8-1.9-1.9v-1.6c0-1,0.8-1.9,1.9-1.9l0,0\n			C84.4,66.9,85.2,67.8,85.2,68.8z"/><path fill=#DC9D95 d="M71.6,91.5c0,4-3.3,7.3-7.3,7.3l0,0c-4,0-7.3-3.3-7.3-7.3V74.2c0-4,3.3-7.3,7.3-7.3l0,0\n			c4,0,7.3,3.3,7.3,7.3V91.5z"/><g><path fill=none d=M44,84.4c6.5,0,12-4.6,13.3-10.7H30.7C32,79.8,37.5,84.4,44,84.4z /><path fill=none d=M71.3,73.7c0.3,1.5,0.9,2.9,1.7,4.2l4.2-4.2H71.3z /><path fill=none d=M84.7,84.4c6.5,0,12-4.6,13.3-10.7H83.7l-7.6,7.6C78.4,83.3,81.4,84.4,84.7,84.4z /><g><path fill=none d=M30.7,73.7c0.3,1.4,0.8,2.7,1.5,3.9l3.9-3.9H30.7z /><path fill=none d=M44,84.4c6.5,0,12-4.6,13.3-10.7H42.5l-7.4,7.4C37.5,83.2,40.6,84.4,44,84.4z /><path fill=#ECEFF0 d=M32.2,77.6c0.8,1.3,1.8,2.5,2.9,3.5l7.4-7.4h-6.4L32.2,77.6z /></g><path fill=#ECEFF0 d=M73.1,78c0.8,1.3,1.8,2.4,3,3.4l7.6-7.6h-6.4L73.1,78z /><path fill=#010101 d="M86.7,70.7h-6.4h-9H68h-7.4h-2.6H45.5h-6.4H27.3c0,3.3,1,6.4,2.7,9c0.8,1.3,1.8,2.4,3,3.4\n				c2.9,2.6,6.8,4.2,11,4.2c8.2,0,15-6,16.4-13.8h7.9c0.4,2.4,1.3,4.6,2.6,6.5c0.9,1.3,1.9,2.4,3,3.4c2.9,2.4,6.6,3.9,10.7,3.9\n				c9.2,0,16.7-7.5,16.7-16.7H86.7z M44,84.4c-3.4,0-6.5-1.2-8.9-3.3c-1.2-1-2.1-2.2-2.9-3.5c-0.7-1.2-1.2-2.5-1.5-3.9h5.4h6.4h14.8\n				C56,79.8,50.5,84.4,44,84.4z M84.7,84.4c-3.2,0-6.2-1.1-8.6-3c-1.2-1-2.2-2.1-3-3.4c-0.8-1.3-1.4-2.7-1.7-4.2h6h6.4H98\n				C96.6,79.8,91.2,84.4,84.7,84.4z"/></g><path fill=#DFB28B d="M114.6,210.9L114.6,210.9c-4.1,1.3-8.5-0.9-9.9-5l-29.6-91.5c-1.3-4.1,0.9-8.5,5-9.9l0,0\n			c4.1-1.3,8.5,0.9,9.9,5l29.6,91.5C121,205.1,118.7,209.6,114.6,210.9z"/><path fill=#DFB28B d="M87.1,91.4L87.1,91.4c-1.7,0-3,1.3-3,3v7.1c-0.3-0.1-0.7-0.2-1-0.2H40.9c-1.6,0-3,1.3-3,3v0.1\n			c0,1.6,1.3,3,3,3l9.6,0c-1.6,0-3,1.3-3,3v0.1c0,1.6,1.3,3,3,3c-1.6,0-3,1.3-3,3v0.1c0,1.6,1.3,3,3,3h3.2c-1.6,0-3,1.3-3,3v0.1\n			c0,1.6,1.3,3,3,3h32.9c1.6,0,3-1.3,3-3v-0.1c0-0.2,0-0.4-0.1-0.5c0.3-0.4,0.4-1,0.4-1.5v-3.8v-0.1v-5.9v-0.1V94.3\n			C90.1,92.7,88.7,91.4,87.1,91.4z"/><g><path fill=#434343 d="M77.6,27.2c-0.5,5.2-2,10-4.3,14.5c3.7,9.7,13.1,16.6,24.1,16.6c1.2,0,2.3-0.1,3.4-0.2\n				C99.6,44,90.3,32.2,77.6,27.2z"/><path fill=#616262 d="M72.8,24.4c-2.7-0.6-5.9-0.1-8.8-0.1c-20.2,0-36.8,17-36.8,37.2l0.4,2.5c2.7,0.5,5.4,0.8,8.2,0.8\n				c16.3,0,30.5-9.4,37.4-23c2.2-4.4,3.9-10.1,4.4-15.2C76.1,25.9,74.5,24.8,72.8,24.4z"/></g></g><g><g><polygon fill=#CDCCCC points="120.2,182.2 94.3,156.3 89.3,156.3 120.2,187.4 			"/><path fill=#CDCCCC d=M114.1,156l-10.8,0.3l16.9,16.8V162C120.2,158.6,117.5,156,114.1,156z /><path fill=#CDCCCC d="M12.1,164l4.6,63.9c0,3.5,2.8,6.3,6.3,6.3l88.7,0c3.2-0.6,5.5-3.3,5.5-6.6l2.9-30.9l-40-40.2H19.2\n				C15.3,156.5,12.1,160,12.1,164z"/><polygon fill=#CDCCCC points="120.2,173.1 103.3,156.3 94.3,156.3 120.2,182.2 			"/><polygon opacity=0.5 fill=#FFFFFF points="120.2,173.1 103.3,156.3 94.3,156.3 120.2,182.2 			"/><polygon fill=#CDCCCC points="89.3,156.3 80.4,156.3 120.2,196.6 120.2,187.4 			"/><polygon opacity=0.5 fill=#FFFFFF points="89.3,156.3 80.3,156.3 120.2,196.6 120.2,187.4 			"/></g><g opacity=0.5><g><g><path fill=#FFFFFF d="M67.6,188.5c0,0.7-0.4,1.2-1,1.5v4.5c0.2,0.1,0.4,0.2,0.6,0.3l3-2.6c0-0.2-0.1-0.3-0.1-0.5\n						c0-0.8,0.5-1.4,1.2-1.7c-1-0.9-2.3-1.6-3.7-1.9C67.6,188.3,67.6,188.4,67.6,188.5L67.6,188.5z"/></g></g><g><g><path fill=#FFFFFF d="M71.8,193.5c-0.3,0-0.6-0.1-0.9-0.3l-2.9,2.6c0.1,0.2,0.1,0.5,0.1,0.7l0,0.1c0,0.4-0.1,0.7-0.2,1\n						l2.2,2.8c0.2-0.1,0.3-0.1,0.5-0.1c0.7,0,1.3,0.5,1.6,1.1c1.1-1.4,1.8-3.2,1.8-5.1c0-1.3-0.3-2.5-0.8-3.6\n						C72.9,193.2,72.4,193.5,71.8,193.5z"/></g></g><g><g><path fill=#FFFFFF d="M68.8,202c0-0.4,0.1-0.8,0.3-1.1l-2.1-2.6c-0.3,0.2-0.8,0.4-1.2,0.4c-0.3,0-0.6-0.1-0.9-0.2l-2.4,2.4\n						c0.1,0.2,0.1,0.4,0.1,0.6l0,0c0,0.7-0.4,1.3-1.1,1.6c0,0,0,0,0,0c0,0,0.1,0.1,0.1,0.1c0,0,0,0,0,0c1.2,0.7,2.6,1.1,4,1.1\n						c1.3,0,2.6-0.3,3.7-0.9C69.1,203.1,68.8,202.6,68.8,202z"/></g></g><g><g><path fill=#FFFFFF d="M61,199.9c0.2,0,0.4,0,0.6,0.1l2.3-2.4c-0.2-0.3-0.3-0.7-0.3-1.1c0-1,0.7-1.9,1.6-2.1V190\n						c-0.6-0.2-1-0.8-1-1.5c0-0.1,0-0.2,0-0.3c-3.8,0.7-6.6,4-6.6,8c0,1.9,0.6,3.6,1.7,5C59.6,200.4,60.3,199.9,61,199.9z\n						 M61.1,193.6c0.6,0,1,0.5,1,1l0,0c0,0.6-0.5,1.1-1,1.1c-0.6,0-1-0.5-1-1.1C60.1,194.1,60.6,193.6,61.1,193.6z"/></g></g></g></g><path fill=#FAFBFB stroke=#90A4AE stroke-miterlimit=10 d="M225.5,95.5h-94.7c-2.8,0-5-2.3-5-5V32.2c0-2.8,2.3-5,5-5h94.7\n		c2.8,0,5,2.3,5,5v58.2C230.5,93.2,228.3,95.5,225.5,95.5z"/><g><polyline fill=#FAFBFB points="131.4,87.3 146.4,44.4 162.9,72.3 167.9,56.5 179.7,64.8 187.4,44.4 199.4,53.6 220.7,35.9 		"/><g><polyline fill=none stroke=#607D8B stroke-width=2 stroke-linecap=round stroke-linejoin=round points="131.4,87.3\n				146.4,44.4 162.9,72.3 167.9,56.5 179.7,64.8 187.4,44.4 199.4,53.6 215.2,40.5 			"/><g><polygon fill=#607D8B points="217.3,45.3 220.7,35.9 210.9,37.6 				"/></g></g></g><circle fill=#A0A8D5 cx=154.6 cy=137.5 r=21.5 /><g><path fill=#5E6BB2 d=M180.5,130.9c-3-11.6-13.4-20.1-25.9-20.1v26.7L180.5,130.9z /></g><g><path fill=#25A69A d="M209.9,184.9l-12.8-12.8c-0.4-0.4-1-0.4-1.4,0l-12.8,12.8c-0.4,0.4-0.4,1,0,1.4h7.5v13\n			c0,0.7,0.6,1.3,1.3,1.3h9.3c0.7,0,1.3-0.6,1.3-1.3v-13h7.5C210.3,185.9,210.3,185.3,209.9,184.9z"/><g><path fill=#4E4E4E d="M222,182c0,2.2-0.4,3.8-1.3,4.9c-0.8,1.1-2.1,1.6-3.7,1.6c-1.6,0-2.8-0.6-3.6-1.7\n				c-0.9-1.1-1.3-2.7-1.3-4.9c0-4.3,1.6-6.5,4.9-6.5c1.6,0,2.8,0.6,3.7,1.7C221.5,178.4,222,180,222,182z M215.7,182.1\n				c0,1.2,0.1,2.1,0.3,2.7s0.6,0.9,1,0.9c0.9,0,1.4-1.2,1.4-3.6c0-2.4-0.5-3.5-1.4-3.5c-0.5,0-0.8,0.3-1,0.9\n				S215.7,180.9,215.7,182.1z M231.7,175.9l-11.5,20.7h-3.4l11.5-20.7H231.7z M236.5,190.3c0,2.2-0.4,3.8-1.3,4.9\n				c-0.8,1.1-2.1,1.6-3.7,1.6c-1.6,0-2.8-0.6-3.6-1.7c-0.9-1.1-1.3-2.7-1.3-4.8c0-4.3,1.6-6.5,4.9-6.5c1.6,0,2.8,0.6,3.7,1.7\n				C236.1,186.6,236.5,188.2,236.5,190.3z M230.2,190.4c0,1.2,0.1,2.1,0.3,2.7c0.2,0.6,0.6,0.9,1,0.9c0.9,0,1.4-1.2,1.4-3.6\n				c0-2.4-0.5-3.5-1.4-3.5c-0.5,0-0.8,0.3-1,0.9C230.3,188.3,230.2,189.2,230.2,190.4z"/></g></g><g><g><line fill=none stroke=#013F52 stroke-miterlimit=10 x1=123.2 y1=204.4 x2=125.7 y2=204.4 /><line fill=none stroke=#013F52 stroke-miterlimit=10 stroke-dasharray=5.2799,5.2799 x1=131 y1=204.4 x2=149.5 y2=204.4 /><polyline fill=none stroke=#013F52 stroke-miterlimit=10 points="152.1,204.4 154.6,204.4 154.6,201.9 			"/><line fill=none stroke=#013F52 stroke-miterlimit=10 stroke-dasharray=4.6019,4.6019 x1=154.6 y1=197.3 x2=154.6 y2=171.9 /><line fill=none stroke=#013F52 stroke-miterlimit=10 x1=154.6 y1=169.6 x2=154.6 y2=167.1 /></g></g><polyline fill=none stroke=#013F52 stroke-miterlimit=10 stroke-dasharray=5,5 points="123.2,175.6 128.2,175.6\n		128.2,104.1 	"/><polyline fill=none stroke=#013F52 stroke-miterlimit=10 stroke-dasharray=5,5 points="123.2,217.6 210.2,217.6\n		210.2,200.6 	"/></g></svg></div><div class=footer-message><span translate=Dashboard.Visits.Modal.footer-message></span></div><div class=footer-buttons><button class="btn btn-primary" translate=Dashboard.Visits.Modal.footer-button ng-click=$ctrl.openModalConfirmation()></button></div></div></div>'),e.put("app/dashboard/reports/reports.html",'<!-- Reports --><div class=sp-dashboard-download-reports><div class=sp-panel-container><div class=row><!-- visit history --><div class="col-xs-12 col-sm-6" sp-toggle=REPORT_VISIT_HISTORY><div class="panel sp-panel-report-dashboard"><div class=panel-heading translate=General.visits_report></div><div class=panel-body><form class=sp-form name=visitHistoryReport><div class=form-group><label class="col-sm-1 control-label" translate=General.report_from></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.visitHistoryReportStart.model ng-change="vm.validateReportDate(vm.visitHistoryReportStart.model, vm.visitHistoryReportEnd.model, \'visitHistoryReport\')" ng-required=true is-open=vm.visitHistoryReportStart.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':visitHistoryReport.startDate.$error.endDate_gt_startDate}" ng-click="vm.visitHistoryReportStart.opened = !vm.visitHistoryReportStart.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label text-center" translate=General.report_to></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.visitHistoryReportEnd.model ng-change="vm.validateReportDate(vm.visitHistoryReportStart.model, vm.visitHistoryReportEnd.model, \'visitHistoryReport\')" ng-required=true is-open=vm.visitHistoryReportEnd.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':visitHistoryReport.endDate.$error.endDate_gt_startDate}" ng-click="vm.visitHistoryReportEnd.opened = !vm.visitHistoryReportEnd.opened"><span class=sp-icon-calendario></span></button></span></div><br><div class="col-md-10 col-md-offset-1 settings-error-between-dates"><span ng-show=vm.visitHistoryReport.settingsErrorBetweenDates translate=General.error_between_dates></span> <span ng-show=vm.visitHistoryReport.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=sp-flex-form-group><button type=button class="btn btn-primary" ng-disabled="!visitHistoryReport.$valid || vm.disableReportBtn" ng-click="vm.exportVisitHistoryReport(vm.visitHistoryReportStart.model, vm.visitHistoryReportEnd.model)"><span translate=General.export></span></button></div></form></div></div></div><!-- kilometers report --><div class="col-xs-12 col-sm-6"><div class="panel sp-panel-report-dashboard"><div class=panel-heading translate=General.routes_report></div><div class=panel-body><form class="form-horizontal sp-form" name=kilometers_report novalidate><div class="form-group sp-margin-bottom-5"><label class="col-sm-1 control-label" translate=General.report_from></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.kmReportStartDate.model ng-change="vm.validateReportDate(vm.kmReportStartDate.model, vm.kmReportEndDate.model, \'kilometers_report\')" ng-required=true is-open=vm.kmReportStartDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':kilometers_report.startDate.$error.endDate_gt_startDate}" ng-click="vm.kmReportStartDate.opened=!vm.kmReportStartDate.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label text-center" translate=General.report_to></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.kmReportEndDate.model ng-change="vm.validateReportDate(vm.kmReportStartDate.model, vm.kmReportEndDate.model, \'kilometers_report\')" ng-required=true is-open=vm.kmReportEndDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':kilometers_report.endDate.$error.endDate_gt_startDate}" ng-click="vm.kmReportEndDate.opened=!vm.kmReportEndDate.opened"><span class=sp-icon-calendario></span></button></span></div><div class="col-md-10 col-md-offset-1 settings-error-between-dates text-center"><span ng-show=vm.kilometers_report.settingsErrorBetweenDates translate=General.error_between_dates></span> <span ng-show=vm.kilometers_report.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=form-group><label for=kmTimeStart class="col-sm-1 control-label" translate=General.report_from></label><div class=col-sm-5><div uib-timepicker id=kmTimeStart ng-model=vm.kmReportTime.start show-spinners=false show-meridian=false required></div></div><label for=kmTimeEnd class="col-sm-1 control-label text-center" translate=General.report_to></label><div class=col-sm-5><div uib-timepicker id=kmTimeEnd ng-model=vm.kmReportTime.end show-spinners=false show-meridian=false required></div></div></div><div class=sp-flex-form-group><button type=button ng-click="kilometers_report.$valid && vm.exportRoutesReport()" ng-disabled="kilometers_report.$invalid || vm.generating_report" class="btn btn-primary btn-large btn-export col-sm-2">Exportar</button></div></form></div></div></div><!-- Tracking code report --><div class="col-xs-12 col-sm-6"><div class="panel sp-panel-report-dashboard"><div class=panel-heading translate=General.tracking_codes_visits_report></div><div class=panel-body><form class=sp-form name=tc_report><div class=row><label class="col-sm-1 control-label" translate=General.report_from></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.tcReportStart.model ng-change="vm.validateReportDate(vm.tcReportStart.model, vm.tcReportEnd.model, \'tc_report\')" ng-required=true is-open=vm.tcReportStart.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':tc_report.startDate.$error.endDate_gt_startDate}" ng-click="vm.tcReportStart.opened = !vm.tcReportStart.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label text-center" translate=General.report_to></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.tcReportEnd.model ng-change="vm.validateReportDate(vm.tcReportStart.model, vm.tcReportEnd.model, \'tc_report\')" ng-required=true is-open=vm.tcReportEnd.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':tc_report.endDate.$error.endDate_gt_startDate}" ng-click="vm.tcReportEnd.opened=!vm.tcReportEnd.opened"><span class=sp-icon-calendario></span></button></span></div><div class="col-md-10 col-md-offset-1 sp-tc-report-span"><span ng-show=vm.tc_report.settingsErrorBetweenDates translate=General.error_between_dates></span> <span ng-show=vm.tc_report.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=form-group><label class="col-sm-3 control-label" translate=General.tracking_code_user_email></label><div class="col-sm-9 sp-block-relative"><input type=email class=form-control name=email ng-model=vm.emailTcReport ng-required=true></div></div><div class=sp-flex-form-group><button type=button class="btn btn-primary sp-button-tc-report" ng-disabled="!tc_report.$valid || vm.disableTcReportBtn" ng-click="vm.exportTcReport(vm.tcReportStart.model, vm.tcReportEnd.model)"><span translate=General.export></span></button></div></form></div></div></div><!-- Optimization report --><div class="col-xs-12 col-sm-6" ng-show=vm.enableOptimizationRequestsReport><div class="panel sp-panel-report-dashboard"><div class=panel-heading translate=General.optimization_requests_report></div><div class=panel-body><form class=sp-form name=or_report><div class=form-group><label class="col-sm-1 control-label" translate=General.report_from></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.orReportStart.model ng-required=true ng-change="vm.validateStartDate(vm.orReportStart.model, vm.orReportEnd.model, \'or_report\')" is-open=vm.orReportStart.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':or_report.startDate.$error.endDate_gt_startDate}" ng-click="vm.orReportStart.opened = !vm.orReportStart.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label text-center" translate=General.report_to></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.orReportEnd.model ng-required=true ng-change="vm.validateStartDate(vm.orReportStart.model, vm.orReportEnd.model, \'or_report\')" is-open=vm.orReportEnd.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':or_report.endDate.$error.endDate_gt_startDate}" ng-click="vm.orReportEnd.opened=!vm.orReportEnd.opened"><span class=sp-icon-calendario></span></button></span></div><div class="col-md-10 col-md-offset-1 settings-error-between-dates"><span ng-show=vm.or_report.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=sp-flex-form-group><button type=button class="btn btn-primary" ng-disabled=vm.disableOrReportBtn ng-click="vm.exportOrReport(vm.orReportStart.model, vm.orReportEnd.model)"><span translate=General.export></span></button></div></form></div></div></div><!-- Logs report --><div class="col-xs-12 col-sm-6" ng-show=vm.enableLogReport><div class="panel sp-panel-report-dashboard"><div class=panel-heading>Reporte de Log en edici√≥n y eliminaci√≥n de planes</div><div class=panel-body><form class="form-horizontal sp-form" name=log_report novalidate><div class=form-group><label class="control-label col-sm-1">Cliente</label><ui-select class=col-sm-11 name=clientName ng-model=vm.logReportClient spinner-enabled=true spinner-class="fa fa-spinner fa-pulse" theme=bootstrap reset-search-input=true ng-click=vm.loadAllClients() required><ui-select-match placeholder="Seleccione un cliente">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="client in vm.clients track by client.id" refresh=vm.refreshClients($select.search) refresh-delay=0 minimum-input-length=3 position="\'auto\'"><div ng-bind-html=client.name></div></ui-select-choices></ui-select><ng-messages for=log_report.clientName.$error class="sp-form-messages col-sm-6 col-sm-offset-3"><ng-message class=sp-settings-invalid-help-block when=required>*Cliente es requerido</ng-message></ng-messages></div><div class=form-group><label class="col-sm-1 control-label" translate=General.report_from></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.logReportStartDate.model ng-change="vm.validateReportDate(vm.logReportStartDate.model, vm.logReportEndDate.model, \'log_report\')" ng-required=true is-open=vm.logReportStartDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':log_report.startDate.$error.endDate_gt_startDate}" ng-click="vm.logReportStartDate.opened=!vm.logReportEndDate.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label text-center" translate=General.report_to></label><div class="col-sm-5 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.logReportEndDate.model ng-change="vm.validateReportDate(vm.logReportEndDate.model, vm.logReportEndDate.model, \'log_report\')" ng-required=true is-open=vm.logReportEndDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':log_report.endDate.$error.endDate_gt_startDate}" ng-click="vm.logReportEndDate.opened=!vm.logReportEndDate.opened"><span class=sp-icon-calendario></span></button></span></div><div class="col-md-10 col-md-offset-1 settings-error-between-dates text-center"><span ng-show=vm.log_report.settingsErrorBetweenDates translate=General.error_between_dates></span> <span ng-show=vm.log_report.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=sp-flex-form-group><button type=button ng-click="log_report.$valid && vm.exportLogReport()" ng-disabled="log_report.$invalid || vm.generating_report" class="btn btn-primary btn-large btn-export">Exportar</button></div></form></div></div></div><!-- Time service report --><div class="col-xs-12 col-sm-6" ng-show=vm.enableTimeServiceReport><div class="panel sp-panel-report-dashboard"><div class=panel-heading>Reporte de tiempo de servicio de visitas</div><div class=panel-body><form class="form-horizontal sp-form" name=ts_report novalidate><div class=form-group><label class="control-label col-sm-3">Cliente</label><ui-select class=col-sm-6 name=clientName ng-model=vm.tsReportClient spinner-enabled=true spinner-class="fa fa-spinner fa-pulse" theme=bootstrap reset-search-input=true ng-click=vm.loadAllClients() required><ui-select-match placeholder="Seleccione un cliente">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="client in vm.clients track by client.id" refresh=vm.refreshClients($select.search) refresh-delay=0 minimum-input-length=3 position="\'auto\'"><div ng-bind-html=client.name></div></ui-select-choices></ui-select><ng-messages for=ts_report.clientName.$error class="sp-form-messages col-sm-6 col-sm-offset-3"><ng-message class=sp-settings-invalid-help-block when=required>*Cliente es requerido</ng-message></ng-messages></div><div class=form-group><label class="control-label col-sm-3">Radio</label><select class="col-sm-6 form-control select-report-settings" ng-model=vm.tsReportRadioGeofence><option value="" selected>---Seleccione radio---</option><option value=50>50</option><option value=100>100</option><option value=300>300</option><option value=500>500</option><option value=700>700</option><option value=1000>1000</option></select></div><div class=form-group><label class="col-sm-3 control-label label-right" translate=General.report_from></label><div class="col-sm-3 col-md-2 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=startDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.tsReportStartDate.model ng-change="vm.validateReportDate(vm.tsReportStartDate.model, vm.tsReportEndDate.model, \'ts_report\')" ng-required=true is-open=vm.tsReportStartDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':ts_report.startDate.$error.endDate_gt_startDate}" ng-click="vm.tsReportStartDate.opened=!vm.tsReportStartDate.opened"><span class=sp-icon-calendario></span></button></span></div><label class="col-sm-1 control-label label-right" translate=General.report_to></label><div class="col-sm-3 col-md-2 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=endDate uib-datepicker-popup=dd-MM-yyyy ng-model=vm.tsReportEndDate.model ng-change="vm.validateReportDate(vm.tsReportStartDate.model, vm.tsReportEndDate.model, \'ts_report\')" ng-required=true is-open=vm.tsReportEndDate.opened datepicker-options=vm.dateOptions on-open-focus=true popup-placement=bottom-left show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-class="{\'btn-border-invalid\':ts_report.endDate.$error.endDate_gt_startDate}" ng-click="vm.tsReportEndDate.opened=!vm.tsReportEndDate.opened"><span class=sp-icon-calendario></span></button></span></div><div class="col-md-10 col-md-offset-1 settings-error-between-dates text-center"><span ng-show=vm.ts_report.settingsErrorBetweenDates translate=General.error_between_dates></span> <span ng-show=vm.ts_report.settingsErrorDateStart translate=General.error_date_start></span></div></div><div class=sp-flex-form-group><button type=button ng-click="ts_report.$valid && vm.exportTimeServiceReport()" ng-disabled="ts_report.$invalid || vm.generating_report" class="btn btn-primary btn-large btn-export col-sm-2">Exportar</button></div></form></div></div></div></div></div></div>'),
e.put("app/dashboard/visits/confirm-modal.html",'<div class="modal-content sp-modal-confirm-dashboard-visits"><div class="modal-header modal-header-success"><h3 class=modal-title translate=Dashboard.Visits.Modal.confirm-title></h3></div><div class=modal-body><p translate=Dashboard.Visits.Modal.confirm-message></p></div><div class=sp-modal-buttons><button type=button class="btn btn-close" ng-click=closeThisDialog(0) translate=Dashboard.Visits.Modal.close></button> <button type=button class="btn btn-success" ng-click="vm.sendEmail(); closeThisDialog(0)">Ok</button></div></div><!-- end modal-content -->'),e.put("app/dashboard/visits/visits-graphics.html",'<div class=visits-graphics-container><div class=graphics ng-if=!vm.userWithoutDashboard><div class=sp-module-body><div class=row><div class=col-sm-2><div class=sp-dashboards-widget><div class=widget-title><span translate=Dashboard.current_period></span></div><div class="widget-body select-date"><div class=row><div class=col-sm-12><select class=form-control name=default_month ng-options="month.name for month in vm.monthDates track by month.id" ng-model=vm.reportsDate ng-change=vm.updateReports()></select><indicator ng-repeat="indicator in vm.indicators" data=indicator></indicator></div></div></div></div></div><div class=row><div class="col-sm-10 padding-left-20"><bar-graph data=vm.graphics.bars ng-if=vm.isDOMRender></bar-graph></div><div class=row><div class="col-xs-5 col-sm-5 padding-left-20"><area-graph data=vm.graphics.area></area-graph></div><div class="col-xs-5 col-sm-5 padding-left-20"><pie-graph data=vm.graphics.pies on-change-view=vm.changeView(type)></pie-graph></div></div></div></div></div></div><div class=sp-user-without-dashboard ng-if=vm.userWithoutDashboard><visits-graphics-modal></visits-graphics-modal></div></div>'),e.put("app/planner/components/breadCrumbs.html",'<div class=sp-planner-steps><div class=sp-planner-steps-list-arrow ng-repeat="step in $ctrl.data"><a href="" ng-click=$ctrl.changeStep(step.link) class="btn btn-primary btn-arrow-right" ng-class="{\'disabled-steps\':!step.visible}">{{step.title}}</a></div></div>'),e.put("app/planner/components/errorFinishModal.html","<div class=sp-confirm-plan><div class=sp-icon-error-container><i class=sp-icon-close></i></div><p class=text><span class=msg-error><span>{{$ctrl.data.vehicleTitle}}</span> <span class=vehicle-name><b>{{$ctrl.data.vehicleName}}</b></span> <span>{{$ctrl.data.title}} </span></span><span class=subtitle><span>{{$ctrl.data.msg}}</span></span></p></div>"),e.put("app/planner/components/infoBox.html",'<div class=sp-planner-info-box ng-class="{\'collapse\': $ctrl.viewCollapse}"><div class=header><div class=order ng-style="{\'background-color\': $ctrl.data.color }">{{$ctrl.data.order}}</div><div class=title>{{$ctrl.data.title}}</div><div class=close><a ng-click=$ctrl.close()><i class=sp-icon-close></i></a></div></div><div class=address><span>{{$ctrl.data.address}}</span></div><div ng-if=!$ctrl.viewCollapse><div class=item ng-if=$ctrl.data.load><i class=sp-icon-carga-outline></i> <span>{{$ctrl.data.load}}</span></div><div class=item ng-if=$ctrl.data.load2><i class=sp-icon-carga-volumen-outline></i> <span>{{$ctrl.data.load2}}</span></div><div class=item ng-if=$ctrl.data.load3><i class=sp-icon-carga-valor-outline></i> <span>{{$ctrl.data.load3}}</span></div><div class=item ng-if=$ctrl.data.numRoute><i class=sp-icon-rutas></i> <span>{{$ctrl.data.numRoute}}</span></div><div class=item ng-if="$ctrl.data.windowStart || $ctrl.data.windowEnd"><i class=sp-icon-ventana-horaria ng-class="{\'sp-text-color-danger\': $ctrl.data.timeError}"></i> <span ng-show="$ctrl.data.windowStart && !$ctrl.data.windowEnd">{{ \'Planner.infowindow_since\' | translate }} {{$ctrl.data.windowStart}}</span> <span ng-show="$ctrl.data.windowStart && $ctrl.data.windowEnd">{{$ctrl.data.windowStart}} {{ \'Planner.infowindow_to\' | translate }} {{$ctrl.data.windowEnd}}</span> <span ng-show="!$ctrl.data.windowStart && $ctrl.data.windowEnd">{{ \'Planner.infowindow_until_to\' | translate }} {{$ctrl.data.windowEnd}}</span></div><div class=item ng-if="$ctrl.data.windowStart2 || $ctrl.data.windowEnd2"><i class=sp-icon-ventana-horaria ng-class="{\'sp-text-color-danger\': $ctrl.data.timeError}"></i> <span ng-show="$ctrl.data.windowStart2 && !$ctrl.data.windowEnd2">{{ \'Planner.infowindow_since\' | translate }} {{$ctrl.data.windowStart2}}</span> <span ng-show="$ctrl.data.windowStart2 && $ctrl.data.windowEnd2">{{$ctrl.data.windowStart2}} {{ \'Planner.infowindow_to\' | translate }} {{$ctrl.data.windowEnd2}}</span> <span ng-show="!$ctrl.data.windowStart2 && $ctrl.data.windowEnd2">{{ \'Planner.infowindow_until_to\' | translate }} {{$ctrl.data.windowEnd2}}</span></div><div class=item ng-if=$ctrl.data.priorityLevel.value><i class="fa fa-level-up"></i> <span>{{$ctrl.data.priorityLevel.name}}</span></div></div></div>'),e.put("app/planner/components/multipleSelectionOnMap.html",'<div class="sp-multiple-edition-button enter" ng-if="$ctrl.showIf && !$ctrl.isMultipleEditingModeActivated" ng-click=$ctrl.enterOnMultipleEditingMode()><img src=../../../assets/images/ambos.png alt=""></div><div class=sp-exit-multiple-edition-button ng-if="$ctrl.showIf && $ctrl.isMultipleEditingModeActivated" ng-click=$ctrl.exitMultipleEditingMode()><i class=sp-icon-close></i></div><div class="sp-multiple-edition-button polygon" ng-if="$ctrl.showIf && $ctrl.isMultipleEditingModeActivated" ng-click=$ctrl.initDrawingManager() ng-class="{\'active\': $ctrl.drawingManager !== null}"><img src=../../../assets/images/poligono.png alt=""></div><div class="sp-multiple-edition-button single" ng-if="$ctrl.showIf && $ctrl.isMultipleEditingModeActivated" ng-click=$ctrl.clearDrawingManager() ng-class="{\'active\': $ctrl.drawingManager === null}"><img src=../../../assets/images/seleccion-unica.png alt=""></div><div class=sp-alert-msc ng-if="$ctrl.showIf && $ctrl.alertData.msg"><div class=relative><span>{{$ctrl.alertData.msg.msg}}</span> <span class=link-to-action><a href=javascript:; ng-click=$ctrl.deselectSelection()>{{$ctrl.alertData.callToActionMsg}}</a></span></div></div>'),e.put("app/planner/components/visitsImport.html",'<div class=sp-visits-import-container><div class=sp-visits-import-title><h1>{{$ctrl.data.title}}</h1></div><div class=sp-visits-import-calendar><div ng-model=$ctrl.data.calendar.model uib-datepicker=dd-MM-yyyy datepicker-options=$ctrl.data.calendar.options show-button-bar=false></div></div><div class="sp-visits-import-status sp-select-all sp-display-flex" ng-if=$ctrl.data.optionsVisitsNotCompleted ng-repeat="option in $ctrl.data.optionsVisitsNotCompleted track by option.key"><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=option.value ng-change=$ctrl.checkIfButtonIsDisabled()><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="option.value = !option.value; $ctrl.checkIfButtonIsDisabled()">{{option.label}}</span></div></div><div class=sp-visits-import-button><button type=button class="btn btn-success" ng-click=$ctrl.getVisits($ctrl.data.calendar.model) ng-disabled=$ctrl.isDisabledSubmitButton>{{$ctrl.data.button.title}}</button></div></div>'),e.put("app/planner/directives/alert-notification-template.html","<div class=\"alert sp-planner-map-alert\" ng-class=\"{'alert-info': notification.type === 1,\n				'alert-warning': notification.type === 2,\n				'alert-warning-dark': notification.type === 3,\n				'alert-danger': notification.type === 4,\n				'alert-success': notification.type === 5 }\" ng-if=\"notification && !hideFlag\"><a href=\"\" class=close data-dismiss=alert aria-label=close title=close ng-click=hide()>√ó</a> {{notification.msg}}</div>"),e.put("app/planner/directives/busy-loading-template.html",""),e.put("app/planner/plans/plans-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Planner.delete_plan></h3></div><div class="modal-body text-center"><p ng-show=vm.isEditingCurrentPlan translate=Planner.delete_modal_message_2></p><p ng-show=!vm.isEditingCurrentPlan translate=Planner.delete_modal_message></p><h4>{{vm.plan.name}}</h4></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Planner.close></button> <button type=button class="btn btn-danger" ng-click="vm.deletePlan(vm.plan); closeThisDialog(0)" translate=Planner.delete></button></div></div>'),e.put("app/planner/plans/plans-detail.html",'<div class=sp-widget-header><div class=left-icon><a ui-sref=planner.vehicles-list.plans><i class=sp-icon-chevron-left></i></a></div><div class=title><span translate=Planner.plan_resume ng-if="vm.plan.name && !vm.isCopy"></span> <span ng-if="vm.plan.name  && !vm.isCopy">{{vm.plan.name}}</span> <input type=text placeholder="{{\'Planner.input_planName\' | translate }}" class=form-control ng-if=vm.isCopy name="" ng-model=vm.plan.name></div><div class=right-icon><a ui-sref=planner.vehicles-list><i class=sp-icon-close></i></a></div></div><form class="form-horizontal sp-plans-form" name=vm.plansForm><div class=sp-widget-body><div class=row ng-if=vm.planUploaded><div class="col-sm-12 sp-msg-container"><span translate=Planner.success_plan_uploaded></span><br><span translate=Planner.success_plan_uploaded_but_no_changes ng-if="vm.visitsUpdated === 0"></span></div><div class="col-sm-12 sp-indicators-container"><div class=sp-indicator-box><div class=title><span translate=Planner.visits_edited></span><hr></div><div class=value><span>{{vm.visitsUpdated}}</span></div></div><div class=sp-indicator-box><div class=title><span translate=Planner.total_visits></span><hr></div><div class=value><span>{{vm.totalExcelVisits}}</span></div></div><div class=sp-indicator-box><div class=title><span translate=Planner.drivers></span><hr></div><div class=value><span>{{vm.driversAfterEdit.length}}</span></div></div></div></div><div class="row sp-row" ng-if=!vm.planUploaded><div class="col-sm-6 text-left"><div class=col-sm-4><span class=sp-small-caps translate=Planner.start_date></span></div><div class="col-sm-6 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=date uib-datepicker-popup=dd-MM-yyyy ng-model=vm.planDate.start ng-required=true is-open=vm.popupPlanDateStart.opened datepicker-options=vm.dateOptions popup-placement=right-top show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-click=vm.openPopupPlanDateStart()><span class=sp-icon-calendario></span></button></span></div></div><div class="col-sm-6 text-right" ng-if=!vm.isCopy><div class=col-sm-5><span class="sp-small-caps pull-right" translate=Planner.end_date></span></div><div class="col-sm-6 sp-block-relative sp-plan-date-input pull-right"><input type=text class=form-control name=date uib-datepicker-popup=dd-MM-yyyy ng-model=vm.planDate.end ng-required=true is-open=vm.popupPlanDateEnd.opened datepicker-options=vm.dateOptions popup-placement=right-top show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-click=vm.openPopupPlanDateEnd()><span class=sp-icon-calendario></span></button></span></div></div></div><div class="row sp-row" ng-if=!vm.planUploaded><div class="col-sm-12 text-center"><div class="col-sm-3 col-sm-offset-2 sp-weekend-start-day-label"><span class="sp-small-caps pull-right" translate=Planner.weekend_start_day></span></div><div class=col-sm-4><select class=form-control ng-options="weekend_day.name for weekend_day in vm.weekend_days track by weekend_day.id" ng-model=vm.resetDay></select></div></div></div><div class="row sp-row modal-body" ng-if=!vm.planUploaded><div class=vehicles-content><div class="table-row header"><div class="wrapper text-4"><div class="wrapper text-2"><div class="text sp-uppercase" translate=Routes.vehicle></div><div class="text sp-uppercase" translate=Routes.driver></div></div><div class="wrapper text-2"><div class="num sp-uppercase sp-text-center" translate=Routes.routes></div><div class="text sp-uppercase sp-text-center" translate=Routes.visits></div></div></div><div class="wrapper num-2"><div class="num sp-uppercase">KMS</div><div class="num sp-uppercase" translate=Routes.time></div></div></div><!-- Data --><div class=table-row ng-repeat="vehicle in vm.plan.vehicles | orderBy:vm.naturalSort(\'name\'):false" ng-show="vehicle.routes.length > 0"><div class="wrapper text-4"><div class="wrapper text-2"><div class=text>{{vehicle.name}}</div><div class=text><select class="form-control sp-select-box" ng-model=vehicle.driverId ng-options="driver.id as driver.name for driver in vm.drivers"><option value="" translate=Routes.select_driver></option></select></div></div><div class="wrapper text-2"><div class="num sp-text-center">{{vehicle.routes.length}}</div><div class="text sp-text-center">{{vm.getVehicleTotalVisits(vehicle)}}</div></div></div><div class="wrapper num-2"><div class=num>{{vm.getVehicleTotalDistance(vehicle) | formatNumber:2:\'.\':\',\'}}</div><div class=num>{{vm.getVehicleTotalTime(vehicle)}}<small class=sp-xx-small-text>HRS</small></div></div></div><!-- End Data --></div></div><!-- error vehiculo--><div class="sp-confirm-plan sp-confirm-plan-sm" ng-show="vm.notSavedPlan && vm.failedVehicle"><p class=text><span class=msg-error><span translate=Routes.the_vehicle></span> <span class=vehicle-name><b>{{vm.failedVehicle.name}}</b></span> <span translate=Routes.assignments.errorMessage></span> </span><!--<span class="subtitle">--><!--<span translate="Routes.pleaseCorrects"></span>--><!--</span>--></p></div><div class=sp-empty-msg ng-if=!vm.plan translate=Planner.no_exist_plans_msg></div></div><div class=row ng-show="vm.planUpdated !== null"><div class="col-sm-12 text-center"><span class=sp-success-msg translate=Planner.success_update_plan ng-show="vm.planUpdated === true"></span> <span class=sp-text-color-danger translate=Planner.error_update_plan ng-show="vm.planUpdated === false"></span></div></div><div class=sp-widget-footer><div class="sp-button sp-align-bottom" ng-if="!vm.planUploaded && !vm.isCopy"><button type=button class="btn btn-primary sp-btn-margin-right-separation" ng-click=vm.exportPlan()><i class=sp-icon-excel></i> <span translate=Planner.btn_download></span></button><div class=sp-btn-file-container><a href="" class="sp-link btn-file" ng-click=$event.preventDefault();><span translate=Planner.upload></span> </a><input type=file onchange="angular.element(this).scope().vm.uploadExcel(this.files); angular.element(this).val(null)"></div></div><div class="sp-button text-right"><button type=button class="btn btn-primary sp-btn-margin-right-separation" ng-click=vm.loadPlan() ng-if="!vm.planUploaded && !vm.isCopy"><span translate=Planner.btn_load></span></button> <button type=button class="btn btn-primary sp-btn-margin-right-separation" ng-click=vm.duplicatePlan() ng-if="!vm.planUploaded && vm.isCopy" ng-disabled="vm.plan.name.length == 0 || !vm.planDate.start"><span translate=Planner.btn_duplicate></span></button> <button type=button class="btn btn-success" ng-click=vm.updatePlanData() ng-disabled="vm.plansForm.$invalid || vm.updatingPlan" ng-if="!vm.planUploaded && !vm.isCopy"><span translate=Planner.btn_save></span></button> <button type=button class="btn btn-success" ng-click=vm.goToPlans() ng-if="vm.planUploaded && !vm.isCopy"><span translate=Planner.btn_confirm></span></button></div></div></form>'),e.put("app/planner/plans/plans-list.html",'<div class=sp-widget-header><div class=left-icon><!-- <i class="sp-icon-chevron-left"></i> --></div><div class=title><span translate=Planner.load_plans></span></div><div class=right-icon><a ui-sref=planner.vehicles-list><i class=sp-icon-close></i></a></div></div><div class=sp-widget-body><div class=table-responsive ng-if="vm.plans.length > 0"><table class=table><thead><tr><th class=sp-widget-table-th translate=Planner.plan></th><th class="sp-widget-table-th text-center" translate=Planner.start_date></th><th class="sp-widget-table-th text-center" translate=Planner.end_date></th><th>&nbsp;</th></tr></thead><tbody><tr class="sp-cursor-pointer sp-plan-row" ng-repeat="plan in vm.plans | orderBy:\'created\':true track by plan.id" ng-click=vm.goToDetail(plan.id)><td class=text-left>{{plan.name}}</td><td class=text-center>{{plan.startDate}}</td><td class=text-center>{{plan.endDate}}</td><td class=text-center><a class="btn btn-link fa fa-files-o" ng-click="vm.duplicatePlan($event, plan.id)" uib-tooltip="{{\'Planner.btn_duplicate\' | translate}}" href=""></a> <a class="btn btn-link sp-delete" ng-click=vm.showDeleteModal($event,plan.id) href=""><i class=sp-icon-delete></i></a></td></tr></tbody></table></div><div class=sp-empty-msg ng-if="vm.plans.length === 0" translate=Planner.empty_plans_msg></div></div><div class=sp-widget-footer></div>'),e.put("app/planner/routes/cancel-edit-plan-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-warning"><h3 class=modal-title translate=Plan.modal_cancel_edit_title></h3></div><div class=modal-body><p translate=Plan.modal_cancel_edit_message_1></p><p translate=Plan.modal_cancel_edit_message_2></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Plan.button_cancel_modal></button> <button type=button class="btn btn-warning-modal-cancel-edit-plan" ng-click="cancelEditPlan(); closeThisDialog(0)" translate=Plan.button_accept_modal></button></div></div>'),e.put("app/planner/routes/finish-modal.html",'<div id=assignModal class="info modal-content sp-finish-modal" on-tour-block=vm.activateModalOnTour><div class=modal-header ng-class="{\'modal-header-info\': !vm.savedPlan}"><h3 class=modal-title translate=Routes.finish_title ng-show=!vm.savedPlan></h3><h3 class=modal-title translate=Routes.finish_title_success ng-show=vm.savedPlan></h3></div><div class="modal-body sp-restrict-height-to-400"><div class=sp-confirm-plan ng-show=vm.savedPlan><div class=sp-icon-success-container><i class=sp-icon-check></i> <img class=sp-image-finish-modal src=../../assets/images/rutasenviadas2.png></div><div class=sp-modal-options><div class=sp-modal-options-block><span><span translate="{{\'Routes.finish_modal.text_tracking_module\'}}"></span> <a href="" ng-click="vm.clearAndGoTo(\'tracking.vehicles\'); vm.closeModal()" translate="{{\'Routes.finish_modal.tracking_module\'}}"></a></span> <button class="btn btn-lg btn-primary sp-btn-left" ng-click="vm.clearAndGoTo(\'tracking.vehicles\'); vm.closeModal()"><i class="sp-icon-tracking sp-icon-xl"></i> <span translate="{{\'Routes.finish_modal.btn_tracking_module\'}}"></span></button></div><div class=sp-modal-options-block><span><span translate="{{\'Routes.finish_modal.text_planning_module\'}}"></span> <a href="" ng-click="vm.clearAndGoTo(\'planner\');  vm.closeModal()" translate="{{\'Routes.finish_modal.planning_module\'}}"></a></span> <button class="btn btn-lg btn-primary sp-btn-right" ng-click="vm.clearAndGoTo(\'planner\'); vm.closeModal()"><i class="sp-icon-rutas sp-icon-xl"></i> <span translate="{{\'Routes.finish_modal.btn_planning_module\'}}"></span></button></div></div><div class=sp-planner-drivers-footer><div class=row><div class="col-sm-7 sp-left-block sp-vcenter"><p translate=Routes.finish_modal.footer_message></p></div><div class="col-sm-4 text-right sp-right-block sp-vcenter"><a href={{::vm.appLink}} target=_blank><img class=sp-footer-android-image src=../../../assets/images/android_playstore.svg alt=playstore></a></div></div></div></div><error-finish-modal data=vm.dataError ng-if=vm.notSavedPlan></error-finish-modal><div class=vehicles-content ng-show="!vm.savedPlan && !vm.notSavedPlan && !vm.isErrorInPlanInstance"><div class=row><form class="form-horizontal sp-form" name=vm.form ng-submit=vm.savePlan()><div class="col-sm-12 text-left sp-padding-10-top-down"><div class=col-sm-3><span class=sp-small-caps translate=Planner.plan_name></span></div><div class=col-sm-6><input type=text class=form-control name=planName ng-model=vm.planName ng-required=true ng-if=!vm.planMergedName> <input type=text class=form-control name=planNameMerged ng-model=vm.planMergedName ng-disabled=true ng-if=vm.planMergedName></div></div></form></div><div class="table-row header"><div class="wrapper text-4"><div class="wrapper text-2"><div class="text sp-subtitle-uppercase-text" translate=Routes.vehicle></div><div class="text sp-subtitle-uppercase-text" translate=Routes.driver></div></div><div class="wrapper text-2"><div class="num sp-subtitle-uppercase-text sp-text-center" translate=Routes.routes></div><div class="text sp-subtitle-uppercase-text sp-text-center" translate=Routes.visits></div></div></div><div class="wrapper num-2"><div class="num sp-subtitle-uppercase-text">KMS</div><div class="num sp-subtitle-uppercase-text" translate=Routes.time></div></div><div class="wrapper text-4"><div class="wrapper text-2"><div class="num sp-subtitle-uppercase-text" translate=Routes.comments_route></div></div></div></div><!-- Data --><div class=sp-data-table-container><div class=table-row ng-repeat="vehicle in vm.vehicles | orderBy:vm.naturalSort(\'name\'):false" ng-show="vehicle.routes.length > 0"><div class="wrapper text-4"><div class="wrapper text-2"><div class=text uib-tooltip={{vehicle.name}}>{{vehicle.name}}</div><div class=text><select class="form-control sp-select-box" name=driver ng-model=vehicle.driver ng-change=vm.updateSelectedDrivers() ng-options="driver as driver.group + \' \' + driver.name for driver in vm.drivers | orderBy:vm.naturalSort(\'name\'):false track by driver.name"><option value="" translate=Routes.select_driver></option></select></div></div><div class="wrapper text-2"><div class="num sp-text-center">{{vehicle.routes.length}}</div><div class="text sp-text-center">{{vm.getVehicleTotalVisits(vehicle)}}</div></div></div><div class="wrapper num-2" ng-if=!vm.onTour><div class=num>{{vm.getVehicleTotalDistance(vehicle) | formatNumber:2:\'.\':\',\'}}</div><div class=num>{{vm.getVehicleTotalTime(vehicle)}}<small class=sp-xx-small-text>HRS</small></div></div><div class="wrapper num-2" ng-if=vm.onTour><div class=num>{{vm.routeDistance}}</div><div class=num>{{vm.routeTime}}<small class=sp-xx-small-text>HRS</small></div></div><div class="wrapper text-4"><div class="wrapper text-2"><div class="text sp-finish-modal-comment-route"><input type=text ng-model=vehicle.routes[0].comment ng-blur=vm.checkRoutesComment(vehicle.routes)></div></div></div></div></div><!-- End Data --></div></div><div class="modal-footer sp-modal-footer" ng-if=!vm.savedPlan><div class=sp-modal-footer-buttons-date><span class=sp-subtitle-uppercase-text translate=Routes.assignments.date></span> <span ng-show="vm.plannedDate !== null && vm.editing">{{vm.plannedDate}}</span><div ng-show=!vm.editing class=sp-planned-datepicker><a href="" ng-show="vm.plannedDate !== null" ng-model=vm.plannedDate uib-datepicker-popup show-button-bar=false is-open=vm.popupOpened datepicker-options=vm.dateOptions ng-click=vm.changeDate() ng-change=vm.setDate()>{{vm.plannedDateLabel}}</a> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-click=vm.changeDate()><span class=sp-icon-calendario></span></button></span></div></div><div class=sp-modal-footer-buttons-right><!-- Reports --> <span uib-dropdown class=pull-right><a class="sp-planner-export-btn pull-right" uib-dropdown-toggle href=""><span translate=Planner.btn_export></span><!--<i class="sp-icon-erp" uib-dropdown-toggle>--></a><ul class="dropdown-multiselection dropdown-bottom dropdown-menu dropdown-menu-right sp-dropdown-container" uib-dropdown-menu aria-haspopup=true aria-expanded=false><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click=vm.downloadReportTxt();><span>TXT</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click=vm.downloadReportExcel();><span>EXCEL</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click=vm.downloadReportPdf();><span>{{\'Pdf.detailed_pdf\' | translate}}</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click=vm.downloadReportSummarizedPdf();><span>{{\'Summarized_Pdf.summarized_pdf\' | translate}}</span> <i class="fa fa-download"></i></a></div></li></ul></span><button type=button class="btn btn-primary pull-right" ng-click=vm.savePlan() translate=Routes.confirm ng-disabled="vm.form.$invalid || vm.saving" ng-show=!vm.notSavedPlan ng-hide=vm.savedPlan></button> <button type=button class="btn btn-primary pull-right" ng-click="vm.notSavedPlan = null; vm.isErrorInPlanInstance = false;  vm.closeModal()" translate=Routes.go_back ng-disabled=vm.saving ng-show=vm.notSavedPlan></button></div></div></div><!-- end modal-content --><div class=ngdialog-close ng-click=ngDialog.close() ng-if=!vm.savedPlan></div>'),e.put("app/planner/routes/routes-comment.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Routes.comments></h3></div><div class=modal-body><span class=sp-routes-comments-body translate=Routes.body_1></span> <span class=sp-routes-comments-p ng-repeat="route in vehicle.routes"><p translate=Routes.route_name></p><p>{{$index+1}}</p><p ng-hide="$index+1 === vehicle.routes.length">,</p><p></p></span><center><textarea class="form-control sp-routes-comments-text-area" rows=3 ng-model=vm.routeComment></textarea></center></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.remove_route_cancel></button> <button type=button class="btn btn-success" ng-click=closeThisDialog(0);saveRouteComments(); translate=Routes.save_comments></button></div></div>'),e.put("app/planner/routes/routes-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Routes.delete_route></h3></div><div class="modal-body text-center"><p translate=Routes.delete_modal_message></p><h4>{{vehicle.name}} -- <span translate=Routes.route_text></span> {{routeIndex}}</h4></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Routes.close></button> <button type=button class="btn btn-danger" ng-click="deleteRoute(vehicle, route); closeThisDialog(0)" translate=Routes.delete></button></div></div>'),e.put("app/planner/routes/routes-detail.html",'<div class=sp-planner-routes-header><div class=sp-planner-routes-edition-actions><div class=title><h2 class=sp-planner-header-title translate=Routes.routes_title_edit></h2></div><div class="sp-planner-routes-edition-buttons-header no-padding"><div class=add-route uib-dropdown><a class="btn btn-primary" uib-dropdown-toggle translate=Routes.btn_new href=""></a><ul class="dropdown-menu dropdown-scrollable" uib-dropdown-menu role=menu><li class=sp-dropdown-menu-item role=menuitem ng-repeat="vehicle in vm.vehiclesAvailable | orderBy:vm.naturalSort(\'name\'):false" ng-mouseenter="vm.fillVehiclesOptions(vehicle, true)" ng-mouseleave="vm.fillVehiclesOptions(vehicle, false)" ng-click=vm.addRouteToVehicle(vehicle)><div class=sp-circle-option ng-style="{\'border-color\': vehicle.color, \'background-color\': vehicle.optionCircleFillColor || \'none\'}"></div><a class=sp-name-option href="">{{vehicle.name}}</a></li></ul></div><div class="btn-group move-to" uib-dropdown dropdown-append-to-body><button id=single-button type=button class="btn btn-primary" uib-dropdown-toggle ng-disabled=disabled><span translate=Routes.btn_moveTo></span> <span class=caret></span></button><ul class="dropdown-menu dropdown-scrollable" uib-dropdown-menu role=menu aria-labelledby=single-button><li class=sp-dropdown-menu-item role=menuitem ng-mouseenter="vm.fillCircleOption(vm.optionOutOfRoute, true)" ng-mouseleave="vm.fillCircleOption(vm.optionOutOfRoute, false)" ng-click="vm.moveVisitTo(vm.optionOutOfRoute.vehicleId, vm.optionOutOfRoute.routeId)"><div class=sp-options-circle ng-style="{\'border-color\': vm.optionOutOfRoute.color, \'background-color\': vm.optionOutOfRoute.background_color}"></div><a class=sp-options-name href="">{{vm.optionOutOfRoute.name}}</a></li><li class=sp-dropdown-menu-item role=menuitem ng-repeat="option in vm.moveToOptions | orderBy:vm.naturalSort(\'name\'):false" ng-mouseenter="vm.fillCircleOption(option, true)" ng-mouseleave="vm.fillCircleOption(option, false)" ng-click="vm.moveVisitTo(option.vehicleId, option.routeId)"><div class=sp-options-circle ng-style="{\'border-color\': option.color, \'background-color\': option.background_color}"></div><a class=sp-options-name href="">{{option.name}}</a></li></ul></div></div></div></div><div class="sp-planner-scrollable sp-planner-scrollable-edit"><div class=sp-planner-routes-content><div class=overflow><div class="sp-planner-routes-dispatchs-out-of-routes-header out-of-routes-detail"><div class="checkbox switcher"><label for=input-outOfRoutes ng-click=$event.stopPropagation();><input type=checkbox id=input-outOfRoutes ng-model=vm.showVisitsOutOfRoutes ng-change=vm.toggleVisitsOutOfRoutes() checked> <span><small></small></span> <small></small></label></div><div class=sp-planner-routes-dispatchs-out-of-routes-title translate=Routes.visits_out_of_route_title></div><div class=sp-planner-routes-dispatchs-out-of-routes-title-indicator><i class=sp-icon-map-pin></i> {{vm.calculateVisitsOutOfRoute(vm.visitsOutOfRoute)}}</div><div class=sp-planner-routes-dispatchs-out-of-routes-collapsed-icon><button class="btn btn-link sp-btn-collapse pull-right" type=button ng-click="vm.visitsOutOfRouteActions.collapsed = !vm.visitsOutOfRouteActions.collapsed; vm.toogleVisitOutOfRoutesCollapse()"><div><i class=sp-icon-chevron-thin-up ng-if=!vm.visitsOutOfRouteActions.collapsed></i> <i class=sp-icon-chevron-thin-down ng-if=vm.visitsOutOfRouteActions.collapsed></i></div></button></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content><div uib-collapse=vm.visitsOutOfRouteActions.collapsed><div class=sp-planner-routes-dispatchs-out-of-routes-content-actions><div class="sp-planner-routes-dispatchs-out-of-routes-content-select-all text-left"><div class=sp-select-all ng-if="vm.visitsOutOfRoute.length > 0"><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.selectAllVisitsOutOfRoute ng-change=vm.toggleSelectAllVisitsOutOfRoute()><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.selectAllVisitsOutOfRoute = !vm.selectAllVisitsOutOfRoute; vm.toggleSelectAllVisitsOutOfRoute()" translate=Routes.select_all></span></div></div></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit id={{::visitOFR.id}} ng-mouseenter="visitOFR.setDarkerHighlight(true, true)" ng-mouseleave="visitOFR.setDarkerHighlight(false, true)" ng-repeat="visitOFR in vm.visitsOutOfRoute track by visitOFR.id"><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-left-side><div class=sp-select-all><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=visitOFR.selected ng-change=vm.toggleVisitOutOfRoute(visitOFR)><label><span class=sp-icon-check></span></label></div></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header-title>{{visitOFR.title}}</div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header-load ng-if="!(visitOFR.load2 || visitOFR.load3)"><i class=sp-icon-carga></i>{{::visitOFR.load | formatNumber:2:\'.\':\',\'}}</div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content-address><div class=sp-left-block><i class=sp-icon-map-pin></i></div><div class=sp-right-block><span>{{visitOFR.address}}</span></div></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content-capacities ng-if="(visitOFR.load2 || visitOFR.load3)"><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visitOFR.capacityError && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError2 && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-volumen ng-class="{\'sp-text-color-danger\': visitOFR.capacityError2 && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load2 | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError3 && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-valor ng-class="{\'sp-text-color-danger\': visitOFR.capacityError3 && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load3 | formatNumber:2:\'.\':\',\'}}</div></div></div></div></div></div></div><div class=sp-planner-routes-vehicle ng-repeat="(vehicleIndex, vehicle) in vm.vehicles | orderBy:vm.naturalSort(\'name\'):false"><div class="sp-planner-routes-vehicle-header edit"><div class="checkbox switcher"><label for=input-{{::vehicle.id}} ng-click=$event.stopPropagation();><input type=checkbox id=input-{{::vehicle.id}} ng-model=vehicle.showRoutes ng-change=vm.toggleShowRoutes(vehicle) checked> <span ng-style="vehicle.showRoutes && {\'background-color\': vehicle.color, \'border-color\': vehicle.color} "><small></small></span> <small></small></label></div><div class="sp-planner-routes-vehicle-header-title edit">{{vehicle.name}}</div><div class=sp-planner-routes-vehicle-header-routes-indicator><i class=sp-icon-rutas></i> {{vehicle.routes.length}}</div></div><div id={{::route.id}} class=sp-planner-routes-vehicle-content ng-repeat="route in vehicle.routes" ng-init="routeIndex = $index"><div uib-collapse=vehicle.collapseRoutes><div class=sp-planner-routes-content-route><div class="sp-planner-routes-vehicle-content-route-detail-header sp-editing" ng-click=vm.toggleCollapseRoute(route)><div class=row><div class=col-xs-1><div class=sp-select-all ng-if=::!vm.optimizationOptions.big_cluster><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=route.editingSelected ng-click=$event.stopPropagation(); ng-change=vm.toggleEditingVisitsOfRoute(route)><label><span class=sp-icon-check></span></label></div></div></div><div class="col-xs-3 route-name-container"><div class=sp-planner-routes-vehicle-content-route-header-collapse-icon><i class=sp-icon-triangle-down ng-hide=route.collapse></i> <i class=sp-icon-triangle-right ng-show=route.collapse></i></div><div class=sp-planner-routes-vehicle-content-route-header-title><span translate=Routes.route_text></span> {{$index+1}}</div></div><div class=col-xs-7><div class=sp-planner-routes-vehicle-content-route-header-statics><i class="sp-icon-skills sp-planner-routes-vehicle-content-route-header-statics-warning-icon" ng-if="::!vm.optimizationOptions.big_cluster && route.skillsError"></i> <i class="sp-icon-ventana-horaria sp-planner-routes-vehicle-content-route-header-statics-warning-icon" ng-if="::!vm.optimizationOptions.big_cluster && route.timeError"></i> <i class=sp-icon-map-pin></i> <span style="margin-right: 6px; margin-left: -6px;  padding-top: 1px">{{vm.calculateRouteVisits(route)}}</span><div class=sp-capacity-container uib-tooltip={{route.formattedLoad}} ng-class="{\'sp-text-color-danger\': (route.capacityError) && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-peso></i> <span style="margin-left: -3px; padding-top: 1px">{{route.totalLoadPercentage | formatNumber:0:\'.\':\',\'}}%</span></div><div class=sp-capacity-container ng-if=route.totalLoad2 uib-tooltip={{route.formattedLoad2}} ng-class="{\'sp-text-color-danger\': (route.capacityError2) && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-volumen></i> <span style="margin-left: -3px; padding-top: 1px">{{route.totalLoadPercentage2 | formatNumber:0:\'.\':\',\'}}%</span></div><div class=sp-capacity-container ng-if=route.totalLoad3 uib-tooltip={{route.formattedLoad3}} ng-class="{\'sp-text-color-danger\': (route.capacityError3) && !vm.optimizationOptions.big_cluster}"><i class="sp-icon-carga-valor ¬ø"></i> <span style="margin-left: -3px; padding-top: 1px">{{route.totalLoadPercentage3 | formatNumber:0:\'.\':\',\'}}%</span></div></div></div><div class=col-xs-1><div class=sp-planner-routes-vehicle-content-route-header-visible-icon><i class="sp-icon-delete margin-left-5 sp-text-color-brand-primary" ng-click="vm.goToDeleteRoute($event, vehicle, route, $index+1)"></i></div></div></div></div><div class=sp-planner-routes-vehicle-content-route-content><div class="sp-collapse-route sp-route-{{vehicle.id}}-{{$index}}" uib-collapse=route.collapse ui-tree=vm.dragControlListeners data-empty-placeholder-enabled=false><div class=sp-planner-routes-vehicle-content-route-content-info><div class=sp-planner-routes-vehicle-content-route-content-info-total-time ng-if=::!vm.optimizationOptions.big_cluster><i class=sp-icon-verificando></i> {{route.totalTimeFormatted}} <small>HRS</small></div><div class=sp-planner-routes-vehicle-content-route-content-info-action><p class=text-left><a href="" ng-click=vm.reorderRoute(route) translate=Routes.reorder></a></p></div></div><!-- INFO VISIT OF ROUTE --><ul class=sp-planner-routes-vehicle-content-route-content-visits-info ui-tree-nodes data-type=visit ng-model=route.visits><li class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start no-drag ng-if=::!vm.optimizationOptions.big_cluster><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side-icon><i class=sp-icon-home ng-style="{\'color\':vehicle.color}"></i></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side-time>{{route.estimatedTimeStart}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-right-side><span translate=Routes.from></span> {{vehicle.locationStart.address}}</div></li><li class=sp-planner-routes-vehicle-content-route-content-visits-info-visit ng-mouseenter="visit.setDarkerHighlight(true, true)" ng-mouseleave="visit.setDarkerHighlight(false, true)" ng-repeat="visit in route.visits" ng-class="{\'sp-error\': (visit.timeError || visit.capacityError || visit.capacityError2 || visit.capacityError3 || visit.skillsError) && !vm.optimizationOptions.big_cluster}" ng-if=route.areVisitsListed ui-tree-node data-scroll-container=.sp-route-{{vehicle.id}}-{{routeIndex}}><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side><div class=sp-select-all><div class=sp-planner-routes-edit-checkbox ng-style="visit.selected ? {\'background-color\': vehicle.colorDarker, \'border-color\': vehicle.color} : {\'border-color\': vehicle.color}" ng-mouseenter="visit.hover = true" ng-mouseleave="visit.hover = false"><input type=checkbox class=sp-checkbox-input ng-model=visit.selected ng-change=vm.toggleSelectedEditVisit(visit)><label ng-if=visit.hover ng-style="visit.selected ? {\'color\': \'white\'} : {\'color\': vehicle.colorDarker}"><span class=sp-icon-check></span></label><label ng-if=!visit.hover ng-style="visit.selected ? {\'color\': \'white\'} : {\'color\': vehicle.color}"><span>{{visit.order}}</span></label></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side-time>{{visit.estimatedTimeArrival}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side ng-style="{\'border-left\': \'6px solid\' + vehicle.color}" ui-tree-handle><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header-title>{{visit.title}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header-visit-load ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}" ng-hide="vm.showLoads.load2 || vm.showLoads.load3"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}"></i>{{visit.load | formatNumber:2:\'.\':\',\'}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content-address><i class=sp-icon-map-pin></i> {{visit.address}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content-capacities><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}" ng-if="(vm.showLoads.load2 || vm.showLoads.load3)"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}"></i> {{visit.load | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError2 && !vm.optimizationOptions.big_cluster}" ng-if=vm.showLoads.load2><i class=sp-icon-carga-volumen ng-class="{\'sp-text-color-danger\': visit.capacityError2 && !vm.optimizationOptions.big_cluster}"></i> {{visit.load2 | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError3 && !vm.optimizationOptions.big_cluster}" ng-if=vm.showLoads.load3><i class=sp-icon-carga-valor ng-class="{\'sp-text-color-danger\': visit.capacityError3 && !vm.optimizationOptions.big_cluster}"></i> {{visit.load3 | formatNumber:2:\'.\':\',\'}}</div></div></div></li><li class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end no-drag ng-if="!(vm.optimizationOptions.open_ended && !vm.optimizationOptions.big_cluster && $last)"><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side-time>{{route.estimatedTimeEnd}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side-icon><i class=sp-icon-destino ng-style="{\'color\':vehicle.color}"></i></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-right-side><span translate=Routes.to></span> {{vehicle.locationEnd.address}}</div></li></ul></div></div></div></div></div></div></div></div></div><!-- end sp-planner-scrollable --><div class=sp-planner-footer><div class=row><a class="btn btn-default pull-left" href="" ng-click=vm.cancelEditing() translate=Planner.btn_cancel></a> <a class="btn btn-success pull-right" ng-click=vm.confirmEditingChanges() translate=Planner.btn_save></a></div></div>'),
e.put("app/planner/routes/routes.html",'<!-- Google Code for PlannerRoutes SR Conversion Page --><script type=text/javascript>/* <![CDATA[ */\n  var translate = window.translateAdwords;\n\n  window.google_trackConversion({\n    google_conversion_id: 944253981,\n    google_conversion_language: translate,\n    google_conversion_format: 3,\n    google_conversion_color: "ffffff",\n    google_conversion_label: "lM5yCIP7_2wQndigwgM",\n    google_remarketing_only: false\n  });\n  /* ]]> */</script><noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=lM5yCIP7_2wQndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=sp-loader-planner ng-if=isLoadingBigData><div class=sp-loader-container><div class=loading style="width: {{vm.widthDynamic}}"><div class=sp-truck-on-move><img class=gif ng-src=../../../assets/images/camion-enmovimiento.gif></div></div><uib-progressbar animate=false max=vm.maxProgressBar value=vm.routesCompleted></uib-progressbar></div></div><div class=sp-planner-routes-header><div class=sp-planner-routes-edition-actions><div class=title><h2 class=sp-planner-header-title translate=Routes.routes_title></h2></div><div class="sp-planner-routes-edition-action text-right"><a class="btn btn-primary" translate=Routes.btn_edition href="" ng-click=vm.goToRoutesDetail()></a></div></div></div><div class=sp-planner-scrollable><div class=sp-planner-routes-content><div class=overflow><div class=sp-planner-routes-dispatchs-out-of-routes-header><div class=sp-planner-routes-vehicle-header-hide-icon><div class="checkbox switcher"><label for=input-outOfRoutes ng-click=$event.stopPropagation();><input type=checkbox id=input-outOfRoutes ng-model=vm.showVisitsOutOfRoutes ng-change=vm.toggleVisitsOutOfRoutes() checked> <span><small></small></span> <small></small></label></div></div><div class="sp-planner-routes-dispatchs-out-of-routes-title text-left sp-planner-routes-section-title" translate=Routes.visits_out_of_route_title></div><div class=sp-planner-routes-dispatchs-out-of-routes-title-indicator><i class=sp-icon-map-pin></i> {{vm.calculateVisitsOutOfRoute(vm.visitsOutOfRoute)}}</div><div class=sp-planner-routes-dispatchs-out-of-routes-collapsed-icon><button class="btn btn-link sp-btn-collapse pull-right" type=button ng-click="vm.visitsOutOfRouteActions.collapsed = !vm.visitsOutOfRouteActions.collapsed; vm.toogleVisitOutOfRoutesCollapse()"><div><i class=sp-icon-chevron-thin-up ng-if=!vm.visitsOutOfRouteActions.collapsed></i> <i class=sp-icon-chevron-thin-down ng-if=vm.visitsOutOfRouteActions.collapsed></i></div></button></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content><div uib-collapse=vm.visitsOutOfRouteActions.collapsed><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit id={{::visitOFR.id}} ng-mouseenter="visitOFR.setDarkerHighlight(true, true)" ng-mouseleave="visitOFR.setDarkerHighlight(false, true)" ng-repeat="visitOFR in vm.visitsOutOfRoute track by visitOFR.id"><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header-title>{{visitOFR.title}}</div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-header-load ng-if="!(visitOFR.load2 || visitOFR.load3)"><i class=sp-icon-carga></i>{{::visitOFR.load | formatNumber:2:\'.\':\',\'}}</div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content-address><div class=sp-left-block><i class=sp-icon-map-pin></i></div><div class=sp-right-block><span>{{visitOFR.address}}</span></div></div></div><div class=sp-planner-routes-dispatchs-out-of-routes-content-visits-info-visit-right-side-content-capacities ng-if="(visitOFR.load2 || visitOFR.load3)"><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visitOFR.capacityError && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError2 && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-volumen ng-class="{\'sp-text-color-danger\': visitOFR.capacityError2 && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load2 | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visitOFR.capacityError3 && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-valor ng-class="{\'sp-text-color-danger\': visitOFR.capacityError3 && !vm.optimizationOptions.big_cluster}"></i> {{visitOFR.load3 | formatNumber:2:\'.\':\',\'}}</div></div></div></div></div></div></div><div class=sp-planner-routes-hide-routes><p class=text-left ng-show=vm.visibleAllRoutes><a href="" ng-click=vm.toggleVisibleAllRoutes() translate=Routes.hide_routes></a></p><p class=text-left ng-show=!vm.visibleAllRoutes><a href="" ng-click=vm.toggleVisibleAllRoutes() translate=Routes.show_routes></a></p></div><div class=sp-planner-routes-vehicle ng-repeat="(vehicleIndex, vehicle) in vm.vehicles | orderBy:vm.naturalSort(\'name\'):false"><div class=sp-planner-routes-vehicle-header><div class=sp-planner-routes-vehicle-header-hide-icon><div class="checkbox switcher"><label for=input-{{::vehicle.id}} ng-click=$event.stopPropagation();><input type=checkbox id=input-{{::vehicle.id}} ng-model=vehicle.showRoutes ng-change=vm.toggleShowRoutes(vehicle) checked> <span ng-style="vehicle.showRoutes && {\'background-color\': vehicle.color, \'border-color\': vehicle.color} "><small></small></span> <small></small></label></div></div><div class=sp-planner-routes-vehicle-header-title>{{vehicle.name}}</div><!-- Icon User --><div class=sp-planner-routes-vehicle-header-routes-indicator><a href="" ng-click=vm.toggleVehicleDriversList(vehicle.id) tooltip-placement=top uib-tooltip={{vm.getNameDriverAssigned(vehicle)}}><i class=sp-icon-user ng-class="{\'route-with-driver\': vehicle.driverId, \'route-without-driver\': !vehicle.driverId} "></i></a></div><!-- Dropdown List Users --><div ng-show=vm.isVehicleDriversListOpen(vehicle.id) class="sp-planner-routes-vehicle-header-routes-indicator list-driver"><select class="form-control sp-select-box" name=driver ng-model=vehicle.driver ng-change=vm.updateSelectedDrivers() ng-options="driver as driver.group + \' \' + driver.name for driver in vm.drivers | orderBy:vm.naturalSort(\'name\'):false track by driver.name"><option value="" translate=Routes.select_driver selected></option></select></div><div ng-show=!vm.isVehicleDriversListOpen(vehicle.id) class=sp-planner-routes-vehicle-header-routes-indicator><i class=sp-icon-rutas></i> {{vehicle.routes.length}}</div></div><div class="row sp-planner-routes-vehicle-content" ng-repeat="route in vehicle.routes" ng-init="routeIndex = $index"><div uib-collapse=vehicle.collapseRoutes><div class=sp-planner-routes-content-route><div class=sp-planner-routes-vehicle-content-route-header ng-click=vm.toggleCollapseRoute(route)><div class=sp-planner-route-collapse-icon><i ng-class="{\'sp-icon-triangle-down\': !route.collapse, \'sp-icon-triangle-right\': route.collapse}"></i></div><div class=sp-planner-route-title><span translate=Routes.route_text></span><span>{{$index + 1}}</span></div><div class=sp-planner-route-alerts><i class="sp-icon-skills sp-planner-routes-vehicle-content-route-header-statics-warning-icon" ng-if="::!vm.optimizationOptions.big_cluster && route.skillsError"></i> <i class="sp-icon-ventana-horaria sp-planner-routes-vehicle-content-route-header-statics-warning-icon" ng-if="::!vm.optimizationOptions.big_cluster && route.timeError"></i></div><div class=sp-planner-route-relevant-indicators><div class=sp-planner-route-single-indicator ng-if=::!vm.optimizationOptions.big_cluster><i class=sp-icon-verificando></i> <span>{{route.totalTimeFormatted}}<small>HRS</small></span></div><div class=sp-planner-route-single-indicator><i class=sp-icon-map-pin></i> <span>{{vm.calculateRouteVisits(route)}}</span></div></div><div class="sp-planner-route-single-indicator sp-capacity-container" uib-tooltip={{route.formattedLoad}} ng-class="{\'sp-text-color-danger\': (route.capacityError) && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-peso></i> <span>{{route.totalLoadPercentage | formatNumber:0:\'.\':\',\'}}%</span></div><div class="sp-planner-route-single-indicator sp-capacity-container" ng-if=route.totalLoad2 uib-tooltip={{route.formattedLoad2}} ng-class="{\'sp-text-color-danger\': (route.capacityError2) && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-volumen></i> <span>{{route.totalLoadPercentage2 | formatNumber:0:\'.\':\',\'}}%</span></div><div class="sp-planner-route-single-indicator sp-capacity-container" ng-if=route.totalLoad3 uib-tooltip={{route.formattedLoad3}} ng-class="{\'sp-text-color-danger\': (route.capacityError3) && !vm.optimizationOptions.big_cluster}"><i class=sp-icon-carga-valor></i> <span>{{route.totalLoadPercentage3 | formatNumber:0:\'.\':\',\'}}%</span></div></div><div class=sp-planner-routes-vehicle-content-route-content><div class="sp-collapse-route sp-route-{{vehicle.id}}-{{$index}}" uib-collapse=route.collapse><ul class=sp-planner-routes-vehicle-content-route-content-visits-info><li class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start ng-if=::!vm.optimizationOptions.big_cluster><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side-icon><i class=sp-icon-home ng-style="{\'color\':vehicle.color}"></i></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side-time>{{route.estimatedTimeStart}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-left-side-line><div class=sp-line ng-style="{\'background-color\':vehicle.color}"></div></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-start-right-side><span translate=Routes.from></span> {{vehicle.locationStart.address}}</div></li><li class=sp-planner-routes-vehicle-content-route-content-visits-info-visit ng-mouseenter="visit.setDarkerHighlight(true, true)" ng-mouseleave="visit.setDarkerHighlight(false, true)" ng-repeat="visit in route.visits" ng-class="{\'sp-error\': (visit.timeError || visit.capacityError || visit.capacityError2 || visit.capacityError3 || visit.skillsError) && !vm.optimizationOptions.big_cluster}" ng-if=route.areVisitsListed><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side-icon-container ng-style="{\'background-color\':vehicle.color}"><i class=sp-icon-ventana-horaria ng-if="!vm.optimizationOptions.big_cluster && visit.timeError"></i> <i class=sp-icon-skills ng-if="!vm.optimizationOptions.big_cluster && visit.skillsError"></i> <span class=sp-visit-number ng-hide="(visit.timeError || visit.skillsError) && !vm.optimizationOptions.big_cluster">{{visit.order}}</span></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side-time>{{visit.estimatedTimeArrival}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-left-side-line><div class=sp-line ng-style="{\'background-color\':vehicle.color}"></div></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side ng-style="{\'border-left\': \'6px solid\' + vehicle.color}"><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header-title>{{visit.title}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-header-visit-load ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}" ng-hide="vm.showLoads.load2 || vm.showLoads.load3"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}"></i> {{visit.load | formatNumber:2:\'.\':\',\'}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content-address><i class=sp-icon-map-pin></i> {{visit.address}}</div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-visit-right-side-content-capacities><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}" ng-if="(vm.showLoads.load2 || vm.showLoads.load3)"><i class=sp-icon-carga ng-class="{\'sp-text-color-danger\': visit.capacityError && !vm.optimizationOptions.big_cluster}"></i> {{visit.load | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError2 && !vm.optimizationOptions.big_cluster}" ng-if=vm.showLoads.load2><i class=sp-icon-carga-volumen ng-class="{\'sp-text-color-danger\': visit.capacityError2 && !vm.optimizationOptions.big_cluster}"></i> {{visit.load2 | formatNumber:2:\'.\':\',\'}}</div><div class=sp-capacity ng-class="{\'sp-text-color-danger\': visit.capacityError3 && !vm.optimizationOptions.big_cluster}" ng-if=vm.showLoads.load3><i class=sp-icon-carga-valor ng-class="{\'sp-text-color-danger\': visit.capacityError3 && !vm.optimizationOptions.big_cluster}"></i> {{visit.load3 | formatNumber:2:\'.\':\',\'}}</div></div></div></li><li class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end ng-if="!(vm.optimizationOptions.open_ended && !vm.optimizationOptions.big_cluster && $last)"><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side-line><div class=sp-line ng-style="{\'background-color\':vehicle.color}"></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side-time>{{route.estimatedTimeEnd}}</div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-left-side-icon><i class=sp-icon-destino ng-style="{\'color\':vehicle.color}"></i></div></div><div class=sp-planner-routes-vehicle-content-route-content-visits-info-location-end-right-side><span translate=Routes.to></span> {{vehicle.locationEnd.address}}</div></li></ul></div></div></div></div></div></div></div></div></div><!-- end sp-planner-scrollable --><div class=sp-planner-footer><div class=row><a ui-sref=^.visits-list class="btn pull-left sp-back-button"><i class=sp-icon-chevron-left></i> <span translate=Planner.btn_back></span> </a><button id=assignBtn type=button class="btn btn-primary pull-right" ng-disabled="vm.routes=== null || vm.routes.length <= 0" ng-click=vm.deployFinishModal() translate=Planner.btn_finish></button></div><div class=row><span uib-dropdown class=pull-right><a class="sp-planner-export-btn pull-right" uib-dropdown-toggle href=""><span translate=Planner.btn_export></span> <i class=sp-icon-triangle-right uib-dropdown-toggle></i></a><ul class="dropdown-multiselection dropdown-up dropdown-menu dropdown-menu-right sp-dropdown-container" uib-dropdown-menu aria-haspopup=true aria-expanded=false><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click="vm.report.txt=true;vm.downloadReport();"><span ng-model=vm.report.txt>TXT</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click="vm.report.excel=true;vm.downloadReport();"><span ng-model=vm.report.excel>EXCEL</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click="vm.report.pdf=true;vm.downloadReport();"><span ng-model=vm.report.pdf>{{\'Pdf.detailed_pdf\' | translate}}</span> <i class="fa fa-download"></i></a></div></li><li role=menuitem><div class=sp-optimize-option><a class=sp-report href="" ng-click="vm.report.summarizedPdf=true;vm.downloadReport();"><span ng-model=vm.report.summarizedPdf>{{\'Summarized_Pdf.summarized_pdf\' | translate}}</span> <i class="fa fa-download"></i></a></div></li></ul></span></div></div>'),e.put("app/planner/vehicles/vehicles-detail.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=rlQ5CJL7_2wQndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=sp-planner-header><div class=sp-planner-header-row><h2 class=sp-planner-header-title translate=Vehicles.title_edit_vehicle></h2></div></div><div class=sp-planner-scrollable><form class="form-horizontal sp-form" id=vehicle-form name=vm.form ng-submit=vm.save() novalidate><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_name></label><div class=col-sm-9><input type=text class=form-control name=title required placeholder=required ng-model=vm.vehicle.name autofocus><ng-messages for=vm.form.title.$error class=sp-form-messages role=alert ng-show="vm.form.title.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_name_vehicle_required></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_capacity></label><div class=col-sm-9><input type=text class=form-control name=capacity required translate translate-attr-placeholder=Vehicles.required ng-model=vm.vehicle.capacity capacity-input-format><ng-messages for=vm.form.capacity.$error class=sp-form-messages role=alert ng-show="vm.form.capacity.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_capacity_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_capacity_2></label><div class=col-sm-9><input type=text class=form-control name=capacity_2 translate translate-attr-placeholder=Vehicles.optional ng-model=vm.vehicle.capacity2 capacity-input-format><ng-messages for=vm.form.capacity_2.$error class=sp-form-messages role=alert ng-show="vm.form.capacity_2.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity_2></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_capacity_3></label><div class=col-sm-9><input type=text class=form-control name=capacity_3 translate translate-attr-placeholder=Vehicles.optional ng-model=vm.vehicle.capacity3 capacity-input-format><ng-messages for=vm.form.capacity_3.$error class=sp-form-messages role=alert ng-show="vm.form.capacity_3.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity_3></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_driver></label><div class=col-sm-9><select class=form-control name=driver ng-model=vm.vehicle.driver ng-options="driver.name for driver in vm.drivers track by driver.id"><option value="" translate=Vehicles.select_driver></option></select></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.schedule></label><div class=col-sm-3><input type=text class=form-control name=shiftStart ng-model=vm.vehicle.shift.start ng-blur=vm.validateTime()></div><label class="col-sm-3 text-center form-control-static" translate=Vehicles.to></label><div class=col-sm-3><input type=text class=form-control name=shiftEnd ng-model=vm.vehicle.shift.end ng-blur=vm.validateTime()></div><div class="planner-error-date settings-error-date"><p ng-if=vm.invalidDate class=sp-settings-invalid-help-block translate=Vehicles.error_format_date></p><p ng-if=vm.timeBetweenDate class=sp-settings-invalid-help-block translate=Vehicles.error_between_date></p><p ng-if=vm.emptyDate class=sp-settings-invalid-help-block translate=Vehicles.error_empty_date></p></div></div><!-- end shift form-group --><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_origin></label><div class=col-sm-9><input type=text class=form-control name=locationStartAddress placeholder=required required autocomplete=off ng-model=vm.vehicle.locationStart.address uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select="vm.startAddressSelected($item, vm.vehicle)"><ng-messages for=vm.form.locationStartAddress.$error class=sp-form-messages role=alert ng-show="vm.form.locationStartAddress.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_address_origin></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_destination></label><div class=col-sm-9><input type=text class=form-control name=locationEndAddress placeholder=required required autocomplete=off ng-model=vm.vehicle.locationEnd.address uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select="vm.endAddressSelected($item, vm.vehicle)"></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.vehicle_skills></label><div class=col-sm-9><div class="btn-group sp-btn-group-abilities"><label class="btn sp-btn-abilities btn-primary" ng-model=vm.skillsVehicle[skill.id] uib-btn-checkbox ng-repeat="skill in vm.skills track by skill.id">{{skill.name}}</label></div></div></div></form></div><!-- end sp-planner-scrollable --><div class=sp-planner-footer><a class="btn btn-default pull-left" ui-sref=^.vehicles-list translate=Planner.btn_cancel></a> <button class="btn btn-success pull-right" type=submit form=vehicle-form translate=Planner.btn_save></button></div>'),e.put("app/planner/vehicles/vehicles-list.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=XzLLCJzsmG0QndigwgM&amp;guid=ON&amp;script=0"></div></noscript><!-- End Google Code for PlanerVehicles SR Conversion Page --><div class=sp-planner-header ng-if=!vm.seeAllVehicles><div class=sp-planner-header-row><h2 class=sp-planner-header-title><span translate=Vehicles.initial_information></span></h2></div></div><form id=selectDate class="form-horizontal sp-form" name=vm.scheduleForm ng-if=!vm.seeAllVehicles><div class=form-group><label class="col-sm-2 control-label" translate=Vehicles.date></label><div class="col-sm-10 sp-block-relative sp-plan-date-input"><input type=text class=form-control name=date uib-datepicker-popup=dd-MM-yyyy ng-model=vm.planDate.start ng-change=vm.selectDate() ng-required=true is-open=vm.popupPlanDate.opened datepicker-options=vm.dateOptions popup-placement=right-top show-button-bar=false datepicker-append-to-body=true readonly> <span class=input-group-btn><button type=button class="btn btn-default btn-plan-date" ng-disabled=vm.isEditingPlan ng-click=vm.openPopupPlanDate()><span class=sp-icon-calendario></span></button></span></div><div class="col-sm-12 text-right"><a ui-sref=planner.vehicles-list.plans class=sp-link translate=Planner.load_plans></a></div></div><div class=form-group><label class="col-sm-2 control-label" translate=Vehicles.schedule></label><div class=col-sm-3><input type=text class=form-control name=shiftStart ng-model=vm.shift.start ng-blur=vm.validateTime()></div><label class="col-sm-3 text-center form-control-static" translate=Vehicles.to></label><div class=col-sm-3><input type=text class=form-control name=shiftEnd ng-model=vm.shift.end ng-blur=vm.validateTime()></div><div class=planner-error-date><p ng-if=vm.invalidDate class=sp-settings-invalid-help-block translate=Visits.error_format_date></p><p ng-if=vm.timeBetweenDate class=sp-settings-invalid-help-block translate=Visits.error_between_date></p></div></div><!-- end shift form-group --></form><!-- end scheduleForm --><div ui-view class=sp-vehicles-content><div class=sp-planner-header><div class=sp-planner-header-row><h2 class=sp-planner-header-title translate=Vehicles.label_vehicles></h2></div></div><div class="sp-fake-table sp-vehicles-table" ng-show="vm.vehicles.length > 0 && !isLoading"><div class=sp-select-all><div class="sp-flex-width-65 sp-display-flex"><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.selectAllVehicles ng-change=vm.toggleSelectAllVehicles()><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.selectAllVehicles = !vm.selectAllVehicles; vm.toggleSelectAllVehicles()" translate=Vehicles.select_all></span> {{vm.getVehiclesActive()}}/{{vm.vehicles.length}}</div></div><div class="sp-flex-width-35 sp-display-flex text-right"><div class="sp-justify-content-space sp-cursor-pointer" ng-if=!vm.seeAllVehicles ng-click="vm.seeAllVehicles = !vm.seeAllVehicles"><span translate=Vehicles.more_vehicles></span> <i class=sp-icon-chevron-thin-up></i></div><div class="sp-justify-content-space sp-cursor-pointer" ng-if=vm.seeAllVehicles ng-click="vm.seeAllVehicles = !vm.seeAllVehicles"><span translate=Vehicles.minus_vehicles></span> <i class=sp-icon-chevron-thin-down></i></div></div></div><div class=sp-thead><div class="sp-tcell sp-icon-column"></div><div class="sp-tcell sp-icon-column sp-icon-available-column"></div><div class="sp-tcell vehicle sp-tcell-header" translate=Vehicles.vehicle></div><div class="sp-tcell capacity sp-tcell-header" translate=Vehicles.capacity></div><div class="sp-tcell driver sp-tcell-header" translate=Vehicles.driver></div></div><div class=sp-tbody><div class="sp-trow sp-item" ng-repeat="vehicle in vm.vehicles | orderBy:vm.naturalSort(\'name\'):false" ng-init="vehicle.collapsed = true"><div class="sp-tcolumn sp-icon-column sp-center-v sp-center-h" ng-style="vehicle.active && {\'background-color\': vehicle.color, \'border-color\': vehicle.color, \'opacity\': 1}\n        || {\'background-color\': vehicle.color, \'border-color\': vehicle.color, \'opacity\': 0.3}"><div class=sp-checkbox><input type=checkbox class=sp-checkbox-input ng-model=vehicle.active ng-change=vm.toggleVehicle(vehicle)><label><span class=sp-icon-check></span></label></div></div><div class="sp-tcolumn sp-icon-available-column sp-center-v sp-center-h"><span class="fa fa-circle" ng-class="{\'available\': vehicle.available.value, \'not-available\': !vehicle.available.value}" uib-tooltip={{vehicle.available.msg}}></span></div><div class="sp-tcolumn sp-clickable" ng-click=vm.toggleSelectedVehicle(vehicle)><div class=sp-trow><div class="sp-tcell vehicle">{{ vehicle.name }}</div><div class="sp-tcell capacity">{{ vehicle.capacity | formatNumber:2}}</div><div class="sp-tcell sp-trow sp-toolbar sp-space-between driver"><div class="sp-tcell-fixed sp-width-50 text-left" uib-tooltip={{::vehicle.driver.name}}><div class=sp-text-ellipsis>{{::vehicle.driver.name}}</div></div><div class="sp-tcell-fixed btn btn-link sp-btn-collapse"><a class="btn btn-link sp-btn-link-edit sp-btn-collapse" ui-sref="^.vehicles-detail({vehicleId: vehicle.id})"><i class=sp-icon-edit></i></a></div></div></div><div class=sp-tcell><div uib-collapse="vehicle !== vm.selectedVehicle"><div class=sp-tcell-row><div class=sp-row><div class=sp-left><span class=sp-icon-origen></span></div><div class=sp-right>{{ vehicle.locationStart.address }}</div></div><div class=sp-row><div class=sp-left><span class=sp-icon-destino></span></div><div class=sp-right>{{ vehicle.locationEnd.address }}</div></div><div class=sp-row><div class=sp-left><span class=sp-icon-ventana-horaria></span></div><div class=sp-right>{{ vehicle.shift.start}} - {{ vehicle.shift.end}}</div></div><div class=sp-row><div class=sp-left><span class=sp-icon-skills></span></div><div class=sp-right><span ng-repeat="skill in vehicle.skills">{{ vm.plannerService.getSkillObjById(skill).name }},</span></div></div></div></div></div></div></div></div><a class=sp-manage-text href=#/settings/vehicles/ ><span translate=Vehicles.manage_vehicles></span></a></div><div id=vehiclesEmpty ng-show="vm.vehicles.length === 0 && !isLoading" class=sp-vehicles-empty><div class=span-vehicles-empty><span translate=Vehicles.empty_vehicles_1></span></div><div class=image-vehicles-empty><img src=../../../assets/images/sin-vehiculos-img.svg></div><div class=button-vehicles-empty><a class="btn btn-primary" ui-sref=settings.vehicles.create translate=Vehicles.empty_vehicles_2></a></div></div><div id=goToVisitBtn class="sp-planner-footer text-right"><p class="sp-text-color-danger sp-error-msg" ng-show="!vm.nextStep && (vm.vehiclesActive !== null && vm.vehiclesActive > 0)">* <span translate=Vehicles.origin_or_destiny_error_msg></span></p><p class="sp-text-color-danger sp-error-msg" ng-show="!vm.nextStep && (vm.vehiclesActive !== null && vm.vehiclesActive === 0) && vm.vehicles.length > 0">* <span translate=Vehicles.no_vehicles_selected></span></p><p class="sp-text-color-danger sp-error-msg" ng-show="vm.vehicleDisabled && !vm.editingPlan">* <span>{{vm.disableVehiclesMsg}}</span></p><button type=button class="btn btn-primary" ng-click=vm.goNext() ng-disabled="!vm.nextStep || vm.scheduleForm.$invalid || (vm.vehicleDisabled && !vm.editingPlan)"><span translate=Planner.btn_next></span> <i class=sp-icon-chevron-right></i></button><!-- <a ui-sref="^.visits-list" class="btn btn-primary pull-right">\n      Next <i class="sp-icon-chevron-small-right"></i>\n    </a> --></div></div>'),e.put("app/planner/visits/visits-bulk-edit.html",'<div class=sp-planner-header><div class=sp-planner-header-row><h2 class=sp-planner-header-title ng-if=!vm.visit.id translate=Visits.bulk_edit></h2></div></div><div class=sp-warning-bulk-edit><span translate=Visits.bulk_edit_message_1></span> {{vm.visitsQty}} <span ng-if="vm.visitsQty === 1" translate=Planner.visit_singular></span> <span ng-if="vm.visitsQty !== 1" translate=Planner.visit_plural></span>. <span translate=Visits.bulk_edit_message_2></span></div><div class=sp-planner-scrollable><form class="form-horizontal sp-form" name=vm.form><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_address></label><div class=col-sm-9><input type=text class=form-control name=address autocomplete=off ng-model=vm.data.address uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select=vm.addressSelected($item) ng-enter=vm.addressSelected($item) ng-required=true ng-blur="vm.checkForm(\'address\')"><p ng-if=vm.invalidAddress class="sp-text-color-danger sp-error-msg" translate=Visits.address_required></p></div></div></form></div><!-- end sp-planner-scrollable --><div class=sp-planner-footer><button class="btn btn-default pull-left sp-button-default" type=button ng-click=vm.cancel() translate=Planner.btn_cancel></button> <button class="btn btn-success pull-right" type=submit ng-click=vm.save() ng-disabled="vm.form.$invalid || vm.saving" translate=Planner.btn_save></button></div>'),
e.put("app/planner/visits/visits-date-error-visits-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.invalid_date_plan></h3></div><div class=modal-body><p translate=Visits.msg_error_plan_date></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button></div></div>'),e.put("app/planner/visits/visits-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.delete_all_modals></h3></div><div class=modal-body><p translate=Visits.delet_modal_message></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button> <button type=button class="btn btn-danger" ng-click="deleteAllVisits(); closeThisDialog(0)" translate=Visits.delete></button></div></div>'),e.put("app/planner/visits/visits-detail.html",'<div class=sp-planner-header><div class=sp-planner-header-row><h2 class=sp-planner-header-title ng-if=vm.visit.id translate=Visits.edit_title></h2><h2 class=sp-planner-header-title ng-if=!vm.visit.id translate=Visits.create_title></h2></div></div><div class=sp-planner-scrollable><form class="form-horizontal sp-form" name=vm.form ng-submit=vm.save() ng-init="vm.visit.collapsed = true"><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_title></label><div class=col-sm-9><input type=text class=form-control name=title ng-model=vm.visit.title autofocus ng-required=true ng-blur="vm.checkForm(\'title\')"><p ng-if=vm.invalidTitle class="sp-text-color-danger sp-error-msg" translate=Visits.title_required></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_address></label><div class=col-sm-9><input type=text class=form-control name=address autocomplete=off ng-model=vm.visit.address uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select="vm.addressSelected($item, vm.visit)" ng-enter="vm.addressSelected($item, vm.visit)" ng-required=true ng-blur="vm.checkForm(\'address\')"><p ng-if=vm.invalidAddress class="sp-text-color-danger sp-error-msg" translate=Visits.address_required></p></div></div><div class=form-group><button class="btn btn-link pull-right sp-btn-collapse" type=button ng-click="vm.moreOptions = !vm.moreOptions"><div class=sp-btn-collapse-text>{{vm.moreOptions ? \'Visits.btn_more_options\': \'Visits.btn_less_options\' | translate}}</div><div><i class=sp-icon-triangle-up ng-hide=vm.moreOptions></i> <i class=sp-icon-triangle-down ng-show=vm.moreOptions></i></div></button></div><div uib-collapse=vm.moreOptions><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_load></label><div class=col-sm-9><input type=number class=form-control name=load translate ng-model=vm.visit.load></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_load_2></label><div class=col-sm-9><input type=number class=form-control name=load_2 translate translate-attr-placeholder=Visits.optional ng-model=vm.visit.load2 ng-blur="vm.checkForm(\'load2\')"><p ng-if=vm.invalidLoad2 class="sp-text-color-danger sp-error-msg" translate=Visits.load_2_invalid></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_load_3></label><div class=col-sm-9><input type=number class=form-control name=load_3 translate translate-attr-placeholder=Visits.optional ng-model=vm.visit.load3 ng-blur="vm.checkForm(\'load3\')"><p ng-if=vm.invalidLoad3 class="sp-text-color-danger sp-error-msg" translate=Visits.load_3_invalid></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_time></label><div class=col-sm-3><input type=text class="form-control text-center" name=window_start placeholder=00:00 ng-model=vm.visit.windowStart ng-blur="vm.validateTime(); vm.validateWindowTimes()"></div><label class="col-sm-3 text-center form-control-static" translate=Visits.to></label><div class=col-sm-3><input type=text class="form-control text-center" name=window_end placeholder=23:59 ng-model=vm.visit.windowEnd ng-blur="vm.validateTime(); vm.validateWindowTimes()"></div><div class="col-sm-9 col-sm-offset-3"><p ng-if=vm.invalidDate class="sp-text-color-danger sp-error-msg" translate=Visits.error_format_date></p><p ng-if=vm.timeBetweenDate class="sp-text-color-danger sp-error-msg" translate=Visits.error_between_date></p><p ng-if=vm.emptyDate class="sp-text-color-danger sp-error-msg" translate=Visits.error_empty_date></p></div></div><div class=form-group ng-if=vm.visit.OverlappingWindowError><div class="col-sm-12 text-center"><p class="sp-text-color-danger sp-error-msg" translate=Visits.alert_notification.error_overlapping></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_time_2></label><div class=col-sm-3><input type=text class="form-control text-center" name=window_start_2 placeholder=00:00 ng-model=vm.visit.windowStart2 ng-blur="vm.validateTime(); vm.validateWindowTimes()"></div><label class="col-sm-3 text-center form-control-static" translate=Visits.to></label><div class=col-sm-3><input type=text class="form-control text-center" name=window_end_2 placeholder=23:59 ng-model=vm.visit.windowEnd2 ng-blur="vm.validateTime(); vm.validateWindowTimes()"></div><div class="col-sm-9 col-sm-offset-3"><p ng-if=vm.invalidDate2 class="sp-text-color-danger sp-error-msg" translate=Visits.error_format_date></p><p ng-if=vm.timeBetweenDate2 class="sp-text-color-danger sp-error-msg" translate=Visits.error_between_date></p><p ng-if=vm.emptyDate2 class="sp-text-color-danger sp-error-msg" translate=Visits.error_empty_date></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_service></label><div class=col-sm-3><input type=text class=form-control name=duration ng-model=vm.visit.duration ng-required=true ng-blur=vm.validateTimeService()></div><div class=col-sm-3><p class=form-control-static translate=Visits.lbl_minutes></p></div><div class="col-sm-9 col-sm-offset-3"><p class="sp-text-color-danger sp-error-msg" ng-show=vm.serviceTimeError translate=Visits.msg_error_service_time></p></div></div><div class=form-group><label class="col-sm-3 control-label">ID</label><div class=col-sm-9><input type=text class=form-control name=reference placeholder="" ng-model=vm.visit.reference></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_priority></label><div class=col-sm-7><select class="form-control sp-select-box" name=priority_level ng-model=vm.visit.priorityLevel ng-options="priority.value as priority.name for priority in vm.priorityLevels | orderBy:priority.value:false"><option value="" translate=Visits.select_priority_level></option></select></div><div class="col-sm-2 text-center priority-level-info"><button tooltip-placement=left tooltip-class=tooltip-visits-priority-level uib-tooltip="{{\'Visits.tooltip_priority_level\' | translate}}" ng-click="$event.preventDefault(); $event.stopPropagation();"><i class="sp-icon-info priority-icon"></i></button></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_contact_name></label><div class=col-sm-9><input type=text class=form-control name=contactName placeholder="" ng-model=vm.visit.contactName></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_contact_phone></label><div class=col-sm-9><input type=text class=form-control name=contactPhone placeholder="" ng-model=vm.visit.contactPhone></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_contact_email></label><div class=col-sm-9><tags-input ng-model=vm.emails placeholder="{{\'Visits.contact_email_placeholder\' | translate}}" class=sp-tags max-tags={{MAX_EMAILS_INPUT}} add-on-space=true add-on-comma=true enable-editing-last-tag=true on-tag-adding=vm.validateEmailInput($tag)></tags-input><p ng-if=vm.emailInputError.invalidFormat class="sp-text-color-danger sp-error-msg" translate=Visits.msg_error_email_valid></p><p ng-if=vm.emailInputError.maxQuantity class="sp-text-color-danger sp-error-msg"><span translate=Visits.error_max_emails_message_1></span> {{vm.maxEmails}} <span translate=Visits.error_max_emails_message_2></span></p><p ng-if=vm.emailInputError.maxLength class="sp-text-color-danger sp-error-msg" translate=Visits.error_email_length_message></p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.lbl_notes></label><div class=col-sm-9><textarea class=form-control name=notes rows=10 ng-model=vm.visit.notes>\n        </textarea></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.required_skills></label><div class=col-sm-9><div class="btn-group sp-btn-group-abilities"><label class="btn sp-btn-abilities btn-primary" ng-repeat="requiredSkill in vm.requiredSkills track by requiredSkill.id" ng-show=requiredSkill.visible ng-click="vm.skillsHandler(requiredSkill.id, vm.visit.skills_required)" ng-class="{active: vm.isInArray(requiredSkill.id, vm.visit.skills_required)}">{{requiredSkill.name}}</label></div></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Visits.optional_skills></label><div class=col-sm-9><div class="btn-group sp-btn-group-abilities"><label class="btn sp-btn-abilities btn-primary" ng-repeat="optionalSkill in vm.optionalSkills track by optionalSkill.id" ng-show=optionalSkill.visible ng-click="vm.skillsHandler(optionalSkill.id, vm.visit.skills_optional)" ng-class="{active: vm.isInArray(optionalSkill.id, vm.visit.skills_optional)}">{{optionalSkill.name}}</label></div></div></div></div></form></div><!-- end sp-planner-scrollable --><div class=sp-planner-footer><button class="btn btn-default pull-left sp-button-default" type=button ng-click=vm.cancel() translate=Planner.btn_cancel></button> <button class="btn btn-success pull-right" type=button ng-click=vm.save() ng-disabled="vm.form.$invalid || vm.invalidForm || vm.saving" translate=Planner.btn_save></button></div>'),e.put("app/planner/visits/visits-incompleted-vehicles-error-visits-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.not_available_vehicles></h3></div><div class=modal-body><p translate=Visits.error_msg_routes_not_completed></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button></div></div>'),e.put("app/planner/visits/visits-list.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=Cs_oCPL5k20QndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=sp-loader-planner ng-if=isLoadingPlanner><div class=sp-loader-container><div class=loading style="width: {{vm.widthDynamic}}"><div class=png><img class=gif ng-src=../../../assets/images/loading-blanco.gif></div></div><uib-progressbar animate=false max=vm.maxProgressBar value=vm.visitsGeoreference></uib-progressbar></div></div><div class=sp-planner-header><div class=sp-planner-header-row><h2 class=sp-planner-header-title translate=Visits.title></h2><div class="btn-group pull-right menu"><button type=button class="btn btn-primary dropdown-toggle" data-toggle=dropdown aria-expanded=false ng-click=vm.openMenuToAddVisits() translate=Visits.create_visit_btn></button><ul class="dropdown-menu sp-visits-import-menu" role=menu ng-if=vm.menuVisitIsOpen><!-- Create Visit--><li><div class=sp-create-visits-option><div class=sp-label><a ui-sref=^.visits-create href="" translate=Visits.create_visit_manual></a></div></div></li><!-- Export Visit--><li><div class=sp-create-visits-option><div class=sp-label><span class=create-visit-btn-file><input type=file onchange="angular.element(this).scope().vm.importExcel(this.files); angular.element(this).val(null)"> <span translate=Visits.create_visit_excel></span></span></div></div></li><!-- Visit Integration API --><li><div class=sp-create-visits-option><div class=sp-label><a href="" ng-click=vm.openComponentVisitsIntegration() translate=Visits.create_visit_integration></a></div></div><ul class="sub-menu dropdown-menu" ng-if=vm.popupVisitsIntegration><li class=sub-menu-open><visits-import data=vm.dataVisitsImport on-get-visits="vm.getVisitsIntegration(date, status)"></visits-import></li></ul></li><!-- Visit Integration API not completed --><li><div class=sp-create-visits-option><div class=sp-label><a href="" ng-click=vm.openComponentVisitsIntegrationNotCompleted() translate=Visits.create_visit_integration_not_completed></a></div></div><ul class="sub-menu dropdown-menu" ng-if=vm.popupVisitsIntegrationNotCompleted><li class=sub-menu-open><visits-import data=vm.dataVisitsImportNotCompleted on-get-visits="vm.getVisitsIntegration(date, status)"></visits-import></li></ul></li></ul></div><a ng-hide="vm.visits.length === 0" href="" class=sp-new-dispatch-btn style="padding-left: 10px" ng-click=vm.showDeleteModal()><i class=sp-icon-delete></i></a></div></div><div class="btn-group sp-planner-visits-filter"><div class="btn sp-filtered active"><label translate=Visits.all_visits></label><span class=sp-short-notification-info ng-if=vm.visits.length>({{vm.totalVisits}})</span></div><div class="btn sp-filtered sp-not-cursor-pointer" ng-click=vm.goToAlertVisits() ng-disabled="vm.warningVisitsQty === 0"><label translate=Visits.warnings></label><span class=sp-short-notification-info ng-if="vm.warningVisitsQty > 0">({{vm.warningVisitsQty}})</span> <span class="close sp-text-color-brand-primary sp-text-opacity-1 sp-margin-top-minus-4" ng-click=vm.showRemoveWarningVisitsModal() ng-if="vm.warningVisitsQty > 0"><i class=sp-icon-delete></i></span></div><div class="btn sp-filtered sp-not-cursor-pointer" ng-click=vm.goToErrorVisits() ng-disabled="vm.errorVisitsQty === 0"><label translate=Visits.errors></label><span class=sp-short-notification-info ng-if="vm.errorVisitsQty > 0">({{vm.errorVisitsQty}})</span> <span class="close sp-text-color-brand-primary sp-text-opacity-1 sp-margin-top-minus-4" ng-click=vm.showRemoveErrorVisitsModal() ng-if="vm.errorVisitsQty > 0"><i class=sp-icon-delete></i></span></div></div><div class=bulk-edit ng-if="vm.visits.length && vm.bulkEdition === false"><a class="sp-link sp-clicked-element" ng-click="vm.bulkEdition = !vm.bulkEdition" translate=Visits.bulk_edit></a></div><div class=sp-bulk-edit-options ng-if="vm.visits.length && vm.bulkEdition === true"><div class=row><div class="col-sm-6 edit-section"><span class="sp-link select-all-visits" ng-click=vm.checkAllVisits(true) ng-if=!vm.allVisitsChecked translate=Vehicles.select_all></span> <span class="sp-link select-all-visits" ng-click=vm.checkAllVisits(false) ng-if=vm.allVisitsChecked translate=Visits.deselect_all></span> <a class="sp-planner-hover-option sp-clicked-element" ng-click=vm.openBulkEdit();><i class=sp-icon-edit></i></a></div><div class=col-sm-6><a class="sp-planner-hover-option pull-right sp-clicked-element"><i class=sp-icon-close ng-click="vm.bulkEdition = false;"></i></a></div></div></div><div class=sp-planner-scrollable><div id=emptyVisits class=sp-planner-empty-data ng-if=!vm.visits.length><i class=sp-icon-map-pin style="color: #bac7ce"></i><h4 translate=Visits.no_visits></h4><p><span class="btn btn-primary btn-file"><input type=file onchange="angular.element(this).scope().vm.importExcel(this.files); angular.element(this).val(null)"> <span translate=Visits.import></span></span></p><p><small translate=Visits.or></small></p><p><span translate=Visits.may_use></span> <a target=_self href="" ng-click=vm.downloadExcelVisit() translate=Visits.sample_template></a></p></div><!-- | plannerVisitsStatusFilter:vm.activeFilter:\'title\' --><div id=visitsList class="list-group sp-planner-visit-list"><div id={{::visit.id}} ng-repeat="visit in vm.visits  | orderBy:[\'-status\', \'title\'] track by visit.id" class=list-group-item-visit><div class="sp-optimize-option visit-checkbox" ng-if=vm.bulkEdition><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=visit.checked ng-click=vm.checkVisit(visit)><label><span class=sp-icon-check></span></label></div></div><div class=list-group-item ng-click=vm.activateVisit(visit) ng-mouseenter=$parent.$parent.vm.hightlightMarker(visit) ng-mouseleave=$parent.$parent.vm.backwardMarker(visit) ng-class="{\'highlight\': visit.active,\n                   \'list-group-item-warning\': visit.status === 2,\n                   \'list-group-item-warning-dark\': visit.status === 3,\n                   \'list-group-item-danger\': visit.status === 4,\n                   \'bulk-edit-activated\': vm.bulkEdition\n                  }"><div class=sp-visits-left-block><div class=sp-planner-hover-options ng-if=!vm.bulkEdition><a class=sp-planner-hover-option ui-sref="^.visits-detail({visitId: \'{{::visit.id}}\', fstatus: {{::vm.activeFilter}}, page: vm.currentPage})" ng-click=$event.stopPropagation();><i class=sp-icon-edit></i></a> <a class=sp-planner-hover-option ng-click="vm.removeAlert($event, visit)"><i class=sp-icon-close></i></a> <a class=sp-planner-hover-option ng-click=vm.remove(visit)><i class=sp-icon-delete></i></a></div><!-- end dp-hover-options  --></div><div class="sp-visits-right-block sp-text-ellipsis"><div class="list-group-item-heading sp-text-ellipsis">{{::visit.title}} <span class=sp-planner-controls><span class=close ng-if=!vm.bulkEdition ng-click=vm.remove(visit)><i class=sp-icon-delete></i></span> <a class=close ng-if=!vm.bulkEdition ui-sref="^.visits-detail({visitId: \'{{::visit.id}}\', fstatus: {{::vm.activeFilter}}, page: vm.currentPage})" ng-click=$event.stopPropagation();><i class=sp-icon-edit></i></a></span></div><div class="list-group-item-text text-muted"><span class="sp-icon-map-pin list-group-item-text-left"></span><div class="list-group-item-text-right sp-text-ellipsis"><small>{{::visit.address}}</small></div></div></div></div></div><!-- end list-group-item --></div><!-- end list-group --></div><!-- end sp-planner-scrollable --><div class=row ng-if="vm.totalVisits > vm.NUM_BATCH"><div class="col-sm-12 text-center sp-pagination-row" ng-if="vm.visits.length > 0"><ul uib-pagination total-items=vm.totalVisits ng-model=vm.currentPage items-per-page=vm.itemsPerPage max-size=3 class=pagination-sm boundary-links=true rotate=false ng-change=vm.refreshVisits()></ul></div></div><div class=sp-planner-footer><div class=sp-planner-footer-confirmation ng-if="vm.warningVisitsQty > 0"><div class=checkbox><label><input type=checkbox ng-model=vm.nextStep> <span class="text-muted sp-planner-footer-confirmation-text" translate=Visits.warning_msg></span></label></div></div><a ui-sref=^.vehicles-list class="btn pull-left sp-back-button"><i class=sp-icon-chevron-left></i> <span translate=Planner.btn_back></span></a><div class="btn-group pull-right" uib-dropdown><button id=split-button type=button class="btn btn-primary" ng-disabled="vm.visits.length === 0 || (vm.warningVisitsQty > 0 && !vm.nextStep) || vm.errorVisitsQty > 0" ng-click=vm.checkAlgorithmToOptimize() translate=Visits.optimize_btn></button> <button type=button class="btn btn-primary" ng-disabled="vm.visits.length === 0 || (vm.warningVisitsQty > 0 && !vm.nextStep) || vm.errorVisitsQty > 0" uib-dropdown-toggle><span class=caret></span></button><ul class="dropdown-multiselection dropdown-up dropdown-menu sp-dropdown-container" uib-dropdown-menu aria-haspopup=true aria-expanded=false><li role=menuitem ng-if="vm.allowedToDisplayOption(\'balance\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.balance ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'balance\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.balance = !vm.optimizationOptions.balance; $event.stopPropagation(); vm.checkOptionOptimize(\'balance\');" translate=Routes.optimize.balance></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'all_vehicles\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.all_vehicles ng-true-value=false ng-false-value=true ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'all_vehicles\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.all_vehicles = !vm.optimizationOptions.all_vehicles; $event.stopPropagation(); vm.checkOptionOptimize(\'all_vehicles\');" translate=Routes.optimize.all_vehicles></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'big_cluster\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.big_cluster ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'big_cluster\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.big_cluster = !vm.optimizationOptions.big_cluster; $event.stopPropagation(); vm.checkOptionOptimize(\'big_cluster\');" translate=Routes.optimize.big_cluster></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'join\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.join ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'join\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.join = !vm.optimizationOptions.join; $event.stopPropagation(); vm.checkOptionOptimize(\'join\');" translate=Routes.optimize.join></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'open_ended\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.open_ended ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'open_ended\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.open_ended = !vm.optimizationOptions.open_ended; $event.stopPropagation(); vm.checkOptionOptimize(\'open_ended\');" translate=Routes.optimize.open_ended></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'last_position_optimize\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.last_position_optimize ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'last_position_optimize\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.last_position_optimize = !vm.optimizationOptions.last_position_optimize; $event.stopPropagation(); vm.checkOptionOptimize(\'last_position_optimize\');" translate=Routes.optimize.last_position_optimize></span></div></div></li><li role=menuitem ng-if="vm.allowedToDisplayOption(\'single_tour\')"><div class=sp-optimize-option><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=vm.optimizationOptions.single_tour ng-true-value=true ng-false-value=false ng-click=$event.stopPropagation(); ng-change="vm.checkOptionOptimize(\'single_tour\')"><label><span class=sp-icon-check></span></label></div><div class=sp-label><span ng-click="vm.optimizationOptions.single_tour = !vm.optimizationOptions.single_tour; $event.stopPropagation(); vm.checkOptionOptimize(\'single_tour\');" translate=Routes.optimize.single_tour></span></div></div></li></ul></div></div>'),e.put("app/planner/visits/visits-modal.html",'<div class="info modal-content"><div class="modal-header modal-header-danger"><button type=button class=close ng-click=$dismiss()>&times;</button><h2 class=modal-title translate=Visits.no_visits></h2></div><div class=modal-body><p translate=Visits.no_visits_for_date></p><p><span translate=Visits.please></span> <a ui-sref=^ ui-sref-opts="{location: \'replace\'}" ng-click=$dismiss() translate=Visits.other_date></a> <span translate=Visits.or_go_to></span> <a ui-sref=^ ng-click=$dismiss() translate=Visits.orders></a> <span translate=Visits.to_add_new_visits></span></p></div></div><!-- end modal-content -->'),e.put("app/planner/visits/visits-remove-error-visits-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.delete_visits></h3></div><div class=modal-body><p translate=Visits.delete_error_visits_message></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button> <button type=button class="btn btn-danger" ng-click="removeErrorVisits(); closeThisDialog(0)" translate=Visits.delete></button></div></div>'),e.put("app/planner/visits/visits-remove-route-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.attention></h3></div><div class=modal-body><center><p translate=Visits.remove_route_optimize_1></p></center><div class=row><div class="col-sm-2 col-sm-offset-2"><!-- check for display --><div class=sp-radio><input type=radio id=overwrite_plan class=sp-checkbox-input ng-model=vm.action ng-value="\'REOPTIMIZE_AND_OVERWRITE_PLAN\'"><label><span class=sp-icon-check></span></label></div></div><div class="col-sm-8 text-left"><label class=no-bold for=overwrite_plan translate=Visits.remove_route_overwrite_routes_option></label></div></div><div class=row><div class="col-sm-2 col-sm-offset-2"><!-- check for display --><div class=sp-radio><input type=radio id=keep_plan class=sp-checkbox-input ng-model=vm.action ng-value="\'KEEP_PLAN_AND_REOPTIMIZE\'"><label><span class=sp-icon-check></span></label></div></div><div class="col-sm-8 text-left"><label class=no-bold for=keep_plan translate=Visits.remove_route_keep_routes_option></label></div></div><div class=row><div class="col-sm-12 text-center margin-top-10"><span class=text-danger ng-if="vm.action === \'REOPTIMIZE_AND_OVERWRITE_PLAN\'" translate=Visits.remove_route_optimize_2></span> <span class=text-danger ng-if="vm.action === \'KEEP_PLAN_AND_REOPTIMIZE\'" translate=Visits.remove_route_optimize_3></span></div></div></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.remove_route_cancel></button> <button type=button class="btn btn-success" ng-click=vm.executeAction(closeThisDialog); ng-disabled="vm.action === null" translate=Visits.remove_route_accept></button></div></div>'),e.put("app/planner/visits/visits-remove-warning-visits-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.delete_visits></h3></div><div class=modal-body><p translate=Visits.delete_warning_visits_message></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button> <button type=button class="btn btn-danger" ng-click="removeWarningVisits(); closeThisDialog(0)" translate=Visits.delete></button></div></div>'),e.put("app/planner/visits/visits-workday-exceeded-visits-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Visits.not_available_vehicles></h3></div><div class=modal-body><p translate=Visits.error_workday_exceeded></p><ul><li ng-repeat="vehicle in vehicles">{{vehicle.name}}</li></ul></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button></div></div>'),e.put("app/settings/account/account.html",'<div class=left-side><section><div class=sp-header><h4 class=sp-header-title translate=Account.options></h4></div><div class="panel panel-default sp-form panel-account-settings"><div class=row><div class="col-xs-12 col-sm-4 col-sm-offset-4 text-center"><label class=control-label translate=Account.default_values></label></div></div><form name=vm.form ng-submit=vm.saveAccountConfigs() novalidate><!-- Send GPS --><div ng-if="vm.accountConfigs.hasOwnProperty(\'send_gps\')" class="row tooltip-input"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Account.setupOptions.send_gps\'}}"></label></div><div class="col-xs-12 col-sm-4 text-center"><sp-switch ng-model=vm.accountConfigs.send_gps></sp-switch></div><div class="col-xs-12 col-sm-4"><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Account.tooltipsOptions.send_gps\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div></div><!-- Enable Observations --><div ng-if="vm.accountConfigs.hasOwnProperty(\'enable_observations\')" class="row tooltip-input"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Account.setupOptions.enable_observations\'}}"></label></div><div class="col-xs-12 col-sm-4 text-center"><sp-switch ng-model=vm.accountConfigs.enable_observations></sp-switch></div><div class="col-xs-12 col-sm-4"><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Account.tooltipsOptions.enable_observations\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div></div><!-- Max Distance Input --><div ng-if="vm.accountConfigs.hasOwnProperty(\'max_distance\')" class="row tooltip-input"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Account.setupOptions.max_distance\'}}"></label></div><div class="col-xs-12 col-sm-4"><!-- selection --><div class=text-input><label for=input-max-distance><input type=number id=input-max-distance ng-required=true name=maxDistance min={{vm.minDistance}} max={{vm.maxDistance}} ng-model=vm.accountConfigs.max_distance></label><div ng-messages=vm.form.maxDistance.$error class=sp-settings-invalid-help-block><div ng-message=required ng-if=vm.form.maxDistance.$dirty><span translate="{{\'Account.error_input_required\'}}"></span></div><div ng-message=number><span translate="{{\'Account.error_input_number_valid\'}}"></span></div><div ng-message=min><span translate="{{\'Account.error_input_number_min\'}}"></span></div><div ng-message=max><span translate="{{\'Account.error_input_number_max\'}}"></span></div></div></div></div><div class="col-xs-12 col-sm-4"><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Account.tooltipsOptions.max_distance\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div></div><!-- Refill Time Input --><div ng-if="vm.accountConfigs.hasOwnProperty(\'vehicle_refill_time\')" class="row tooltip-input"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Account.setupOptions.vehicle_refill_time\'}}"></label></div><div class="col-xs-12 col-sm-4"><!-- selection --><div class=text-input><label for=input-refill-time><input type=number id=input-refill-time ng-required=true name=refillTime min=0 max=10000 ng-model=vm.accountConfigs.vehicle_refill_time></label><div ng-messages=vm.form.refillTime.$error class=sp-settings-invalid-help-block><div ng-message=required ng-if=vm.form.refillTime.$dirty><span translate="{{\'Account.error_input_required\'}}"></span></div><div ng-message=number><span translate="{{\'Account.error_input_number_valid\'}}"></span></div><div ng-message=min><span translate="{{\'Account.error_input_refill_min\'}}"></span></div></div></div></div><div class="col-xs-12 col-sm-4"><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Account.tooltipsOptions.refill_time\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div></div><!-- Enable JDH --><div ng-if="vm.accountConfigs.hasOwnProperty(\'enable_jdh\')" class="row tooltip-input"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Account.setupOptions.enable_jdh\'}}"></label></div><div class="col-xs-12 col-sm-4 text-center"><sp-switch ng-model=vm.accountConfigs.enable_jdh></sp-switch></div><div class="col-xs-12 col-sm-4"><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Account.tooltipsOptions.enable_jdh\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div></div><button type=submit ng-disabled=vm.form.$invalid class="btn btn-success btn-large col-sm-2 btn-account-settings-save">{{\'Account.btn_save\' | translate}}</button></form></div></section></div>'),
e.put("app/settings/billing/change-plan.html",'<div class=billing-module><legend><i class="fa fa-credit-card"></i> <span translate=Billing.title_2></span> - <span translate=Billing.change_plan_lbl></span></legend><form class=form-horizontal name=changePlanForm novalidate><div class=form-group><label class="col-sm-2 control-label" for=vehiclesQty translate=Billing.n_vehicles_lbl></label><div class=col-sm-2><input type=number class="col-sm-2 form-control" id=vehiclesQty name=vehiclesQty min={{vm.minVehiclesQty}} max=1000 ng-model=vm.vehiclesQty></div></div><div class=form-group ng-show=changePlanForm.vehiclesQty.$error><div class="col-sm-offset-2 col-sm-10 text-muted"><small ng-show=changePlanForm.vehiclesQty.$error.min><i class="fa fa-question-circle"></i> <span translate=Billing.error_min_vehicles_lbl_1></span> <a ui-sref=settings.vehicles translate=Billing.error_min_vehicles_lbl_2></a>. <a href=‚Äúvehicles.html‚Äù></a> </small><small ng-show=changePlanForm.vehiclesQty.$error.max><i class="fa fa-question-circle"></i> <span translate=Billing.error_max_vehicles_lbl></span></small></div></div><div class=form-group><label class="col-sm-2 control-label" for=amount translate=Billing.Amount_lbl></label><div class=col-sm-10><p class=form-control-static>{{vm.vehiclesQty * vm.AMOUNT_PER_VEHICLE | currency:"USD$"}}</p></div></div><div class=form-group><div class="col-sm-offset-2 col-sm-10"><button type=button class="btn btn-primary" ng-disabled="changePlanForm.$invalid || vm.updating" ng-click=vm.updatePlan(vm.vehiclesQty)><!-- The "span" solves the animation duration from font-awesome spinner --> <span ng-show=vm.updating><i class="fa fa-spinner fa-spin"></i> </span><span translate=Billing.update_plan_btn></span></button></div></div></form></div>'),e.put("app/settings/billing/info.html",'<div class=billing-module><legend><i class="fa fa-credit-card"></i> <span translate=Billing.title_2></span></legend><p ng-if="vm.user.account.status === \'trialing\'"><span translate=Billing.trial_expire></span> {{ vm.trialExpireTime }}</p><div ng-if="vm.user.account.status === \'trialing\' || vm.user.account.status === \'canceled\'"><a class="btn btn-primary" ui-sref=^.upgrade><span translate=Billing.upgrade></span></a></div><div ng-if="vm.user.account.status === \'active\' || vm.user.account.status === \'past_due\'"><p><span translate=Billing.max_vehicles_lbl></span>: {{vm.user.account.plan_quantity}} <small><a ui-sref=^.change-plan><span translate=Billing.change_btn></span></a></small></p><p><span translate=Billing.next_billing_lbl></span>: {{vm.nextBillingCycle}}</p><p><span translate=Billing.credit_card_lbl></span>: xxxx xxxx xxxx {{vm.user.account.card_last4}} <small><a href="" ng-hide=vm.changingCard stripe-checkout=vm.processChangeCard data-key=pk_test_zyWHJjXkDVo3APH5z0c9gd5H data-allow-remember-me=false data-locale=auto data-name=SimpliRoute data-image=/assets/images/logo-login.png data-description="" data-amount="" data-email={{vm.user.email}} data-panel-label="{{\'Billing.change_card\' | translate }}"><span translate=Billing.change_btn></span> </a><span class="alert alert-info" ng-show=vm.changingCard><i class="fa fa-spinner fa-spin"></i> <span translate=Billing.processing_lbl></span></span></small></p><button type=button class="btn btn-default" ng-hide=vm.canceling ng-click=vm.cancel()><span translate=Billing.cancel_btn></span></button> <span class="alert alert-info" ng-show=vm.canceling><i class="fa fa-spinner fa-spin"></i> <span translate=Billing.canceling_lbl></span></span></div></div>'),e.put("app/settings/billing/upgrade.html",'<div class=billing-module><legend><i class="fa fa-credit-card"></i> <span translate=Billing.title_2></span> - <span translate=Billing.upgrading_lbl></span></legend><form class=form-horizontal name=upgradeForm novalidate><div class=form-group><label class="col-sm-2 control-label" for=vehiclesQty><span translate=Billing.n_vehicles_lbl></span></label><div class=col-sm-2><input type=number class=form-control id=vehiclesQty name=vehiclesQty min={{vm.minVehiclesQty}} max=1000 ng-model=vm.vehiclesQty></div></div><div class=form-group ng-show=upgradeForm.vehiclesQty.$error><div class="col-sm-offset-2 col-sm-10 text-muted"><small ng-show=upgradeForm.vehiclesQty.$error.min><i class="fa fa-question-circle"></i> <span translate=Billing.error_min_vehicles_lbl_1></span> <a ui-sref=settings.vehicles translate=Billing.error_min_vehicles_lbl_2></a>. <a href=‚Äúvehicles.html‚Äù></a> </small><small ng-show=upgradeForm.vehiclesQty.$error.max><i class="fa fa-question-circle"></i> <span translate=Billing.error_max_vehicles_lbl></span></small></div></div><div class=form-group><label class="col-sm-2 control-label" for=amount translate=Billing.Amount_lbl></label><div class=col-sm-10><p class=form-control-static>{{vm.vehiclesQty * vm.AMOUNT_PER_VEHICLE | currency:"USD$"}}</p></div></div><div class=form-group><div class="col-sm-offset-2 col-sm-10"><button type=button class="btn btn-primary" ng-disabled=upgradeForm.$invalid ng-hide="vm.upgrading || vm.upgraded" stripe-checkout=vm.processUpgrade data-key=pk_test_zyWHJjXkDVo3APH5z0c9gd5H data-allow-remember-me=false data-locale=auto data-name=SimpliRoute data-image=/assets/images/logo-login.png data-description="Max {{vm.vehiclesQty}} vehicles per month" data-amount="{{vm.vehiclesQty * vm.AMOUNT_PER_VEHICLE * 100}}" data-email={{vm.user.email}} translate=Billing.upgrade_btn></button><div class="alert alert-info" ng-show=vm.upgrading><i class="fa fa-spinner fa-spin"></i> <span translate=Billing.processing></span></div><div class="alert alert-success" ng-show=vm.upgraded translate=Billing.welcome_lbl></div></div></div></form></div>'),e.put("app/settings/communication/communication-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Communication.modal_delete_event_title></h3></div><div class=modal-body><p style="text-align: center"><span translate=Communication.modal_message_1></span><br><span translate=Communication.modal_message_2></span></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Communication.cancel></button> <button type=button class="btn btn-danger" ng-click="deleteAddonProperty(); closeThisDialog(0)" translate=Communication.delete></button></div></div>'),e.put("app/settings/communication/communication-detail.html",'<div class=right-side-content><div class=sp-settings-right-side-form><div class=sp-addons-detail-title><span translate=Communication.title_detail></span></div><uib-tabset active=active class=sp-addons-tab-container><!-- Tab SMS--><uib-tab index=0 heading=SMS class=sp-addons-tab-items><form name=vm.formSms><div class="row tab-content-row" ng-show=vm.properties.smsBody.id><div class="col-md-10 tab-content-delete"><label translate=Communication.delete_property_sms></label></div><div class="col-md-1 tab-content-delete-icon"><a ng-click="vm.showDeleteModal([\n                  {\'addonId\': vm.properties.smsBody.addonId,\n                  \'id\': vm.properties.smsBody.id,\n                  \'key\': vm.properties.smsBody.key}\n                 ])" href=""><i class=sp-icon-delete></i></a></div></div><div class="row tab-content-row"><div class="col-md-2 tab-content-label"><label translate=Communication.label_sms></label></div><div class="col-md-9 tab-content-input"><textarea name=inputSms ng-model=vm.properties.smsBody.value rows=3 ng-change="vm.updateTextPreview(\'smsBody\')" maxlength=140 ng-required=vm.smsRequired></textarea><div ng-messages=vm.formSms.inputSms.$error class=sp-settings-invalid-help-block><div ng-message=maxlength translate=Communication.warning_text_too_large></div><div ng-message=required translate=Communication.warning_required></div></div></div></div><div class="row tab-content-row"><div class="col-md-2 tab-content-label"><label translate=Communication.insert></label></div><div class="col-md-9 tab-content-tags"><span ng-repeat="(key, tag) in vm.tags"><label ng-if=tag.values.sms class="btn sp-btn-abilities btn-primary" ng-model=tag.checked uib-btn-checkbox ng-click="vm.addTagToInputValue(\'smsBody\', tag.id)">{{tag.label}}</label></span></div></div><div class=sp-addons-property-preview><div class="div sp-addons-detail-title"><span translate=Communication.preview_title></span></div><div class="talk-bubble tri-right round btm-left-in"><div class=talktext><p>{{vm.textSmsPreview}}</p></div></div></div></form></uib-tab><uib-tab index=1 heading=EMAIL class=sp-addons-tab-items><form name=vm.formEmail><div class="row tab-content-row" ng-show=vm.properties.emailSubject.id><div class="col-md-10 tab-content-delete"><label translate=Communication.delete_property_email></label></div><div class="col-md-1 tab-content-delete-icon"><a ng-click="vm.showDeleteModal([\n                  {\'addonId\': vm.properties.emailSubject.addonId,\n                  \'id\': vm.properties.emailSubject.id,\n                  \'key\': vm.properties.emailSubject.key},\n                  {\'addonId\': vm.properties.emailBody.addonId,\n                  \'id\': vm.properties.emailBody.id,\n                  \'key\': vm.properties.emailBody.key}\n                 ])" href=""><i class=sp-icon-delete></i></a></div></div><div class="row tab-content-row"><div class="col-md-2 tab-content-label"><label translate=Communication.label_email_subject></label></div><div class="col-md-9 tab-content-input"><input type=text name=emailSubject ng-model=vm.properties.emailSubject.value maxlength=256 ng-required=vm.emailRequired><div ng-messages=vm.formEmail.emailSubject.$error class=sp-settings-invalid-help-block><div ng-message=required translate=Communication.warning_required></div><div ng-message=maxlength translate=Communication.warning_maxlenght></div></div></div><div class="col-md-10 warning-tabs-subject" ng-if=vm.repeatedSubjectTag><span translate=Communication.warning_repeated_tag></span></div></div><div class="row tab-content-row"><div class="col-md-2 tab-content-label"><label translate=Communication.insert></label></div><div class="col-md-9 tab-content-tags"><span ng-repeat="(key, tag) in vm.tagsSubject"><label ng-if=tag.propertyKeys[vm.addonPropertyKey] class="btn sp-btn-abilities btn-primary btn-tag" ng-model=tag.checked uib-btn-checkbox ng-click=vm.addTagToInputSubjectValue(tag.id)>{{tag.label}}</label></span></div></div><div class="row tab-content-row text-email-body"><div class="col-md-2 tab-content-label"><label translate=Communication.label_email_msg></label></div><div class="col-md-9 tab-content-input"><textarea name=emailMsg ng-model=vm.properties.emailBody.value rows=8 cols=8 ng-change="vm.updateTextPreview(\'emailBody\')" maxlength=1024 ng-required=vm.emailRequired></textarea><div ng-messages=vm.formEmail.emailMsg.$error class=sp-settings-invalid-help-block><div ng-message=required translate=Communication.warning_required></div><div ng-message=maxlength translate=Communication.warning_text_too_large></div></div></div></div><div class="row tab-content-row"><div class="col-md-2 tab-content-label"><label translate=Communication.insert></label></div><div class="col-md-9 tab-content-tags"><span ng-repeat="(key, tag) in vm.tags"><label ng-if="tag.values.email && tag.propertyKeys[vm.addonPropertyKey]" class="btn sp-btn-abilities btn-primary btn-tag" ng-model=tag.checked uib-btn-checkbox ng-click="vm.addTagToInputValue(\'emailBody\', tag.id)">{{tag.label}}</label></span></div></div><div class="row tab-content-row sp-communication-attachment" ng-if=vm.enableSendAttachment><div class="col-md-2 tab-content-label"><label translate=Communication.attachment></label></div><div class=col-md-9><input type=checkbox ng-model=vm.sendAttachment.value> <a tooltip-placement=right uib-tooltip="{{\'Communication.attachment_tooltip\' | translate}}"><i class=sp-icon-help></i></a></div></div><div class=sp-addons-property-preview><div class="div sp-addons-detail-title email"><span translate=Communication.preview_title></span></div><div class=sp-email-preview><p>{{vm.textEmailPreview}}</p></div></div></form></uib-tab></uib-tabset><div class="sp-settings-right-side-form-action-buttons sp-addons-property-buttons"><div class=form-group><button class="btn btn-close pull-left" type=button ng-click=vm.cancel() translate=Communication.close></button> <button class="btn btn-success pull-right" type=submit ng-click=vm.saveProperty() ng-disabled="vm.formSms.$invalid || vm.formEmail.$invalid " translate=Communication.save></button></div></div></div></div>'),e.put("app/settings/communication/communication.html",'<div class=left-side><div class=sp-settings-list-container><div class=sp-settings-action-bar></div><div class=sp-settings-content-list><div class=sp-table><div class="sp-table-row sp-table-header"><div class=sp-table-row-item-property><p class=title translate=Communication.title></p></div><div class=sp-table-row-item-property><i class="sp-icon-info title-icon"></i></div></div><div cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}" ng-if=!vm.ready style=height:200px></div><div class=sp-table-row ng-repeat="property in vm.addonProperties" ng-class="{\'active\': vm.activeRows[property.propertyKey]}" cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}"><div class=sp-table-row-item-property>{{property.label}}</div><div class=sp-table-row-item-property><i class="sp-icon-email sp-icon-property" ng-class="{\'sp-addons-property-active\': property.email.value != \'\'}"></i></div><div class=sp-table-row-item-property><i class="sp-icon-mobile sp-icon-property" ng-class="{\'sp-addons-property-active\': property.sms.value != \'\'}"></i></div><div class=sp-table-row-item-property><a href="" ng-click="vm.changeStateToDetail(property.addonId, property.propertyKey)" class=sp-property-edit><i class=sp-icon-edit></i></a></div></div></div><div class=sp-widget-options><div><!-- labels --><label translate="{{\'Communication.custom_tracking_code\'}}"></label></div><div><sp-switch ng-model=vm.customTrackingCode ng-change=vm.saveCustomTrackingConfig()></sp-switch></div><div><a tooltip-placement=right tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Communication.custom_tracking_code_tooltip\' | translate}}"><i class="sp-icon-info tooltip-icon"></i></a></div><button type=button ng-click=vm.showWidgetModal() class="btn btn-primary btn-large btn-generate-widget">{{\'Communication.generate_insertion_code\' | translate}}</button></div></div></div></div><div class=right-side ng-show="!vm.state.includes(\'**.settings.communication.list\')" ui-view></div>'),e.put("app/settings/communication/widget-code-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-success"><h3 class=modal-title translate=Communication.livetracking_widget></h3></div><div class=modal-body><span class=sp-container-desc translate=Communication.insertion_code></span><div class=row><div class=col-lg-12><div class=sp-widget-code-container><div class=sp-embed-code>{{widgetCode}}</div></div><button type=button sp-copy={{widgetCode}} class="btn btn-success btn-large btn-copy-to-clipboard">{{\'Communication.copy_code\' | translate}}</button></div></div></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button></div></div>'),e.put("app/settings/components/actions-zones.html","<div class=actions-config-zones><div class=actions-header><span class=actions-title>{{$ctrl.data.title}}</span></div><div class=actions-buttons><button class=btn ng-class=\"[{'button-active': $ctrl.data.value}, {'button-deactivated': !$ctrl.data.value}]\" ng-click=\"$ctrl.data.value = true\">{{$ctrl.data.btn1.title}}</button> <button class=btn ng-class=\"[{'button-active': !$ctrl.data.value}, {'button-deactivated': $ctrl.data.value}]\" ng-click=\"$ctrl.data.value = false\">{{$ctrl.data.btn2.title}}</button></div></div>"),e.put("app/settings/components/zone.html",'<div class=sp-comp-zone-list><div class=sp-comp-zone-title><span uib-tooltip={{$ctrl.data.name}}>{{$ctrl.data.name}}</span> <a ng-click=$ctrl.delete()><i class=sp-icon-delete></i></a></div><div class=sp-comp-zone-map><img ng-src={{$ctrl.data.urlMap}}></div><div class=sp-comp-zone-footer><i class=sp-icon-vehiculos></i><p>{{$ctrl.data.vehicles.length}}</p><button class="btn btn-primary" translate=Zones.button_edit ng-click=$ctrl.edit()></button></div></div>'),e.put("app/settings/components/zoneMap.html",'<button class="btn btn-default sp-add-zone-button-reset" ng-click=$ctrl.resetZone() ng-if=$ctrl.resetAvailable translate=Zones.Map.clear></button><div id=map class=sp-add-zone-map></div>'),e.put("app/settings/generals/generals-list.html",'<div class="left-side general-settings"><div class=row><button type=button class="btn btn-success pull-right" ng-click=vm.optimizationChanged(vm.optimizationOptions)><i class="fa fa-spinner fa-pulse" ng-if=vm.optimizationOptionsLoader></i> <span translate=General.save_changes></span></button></div><div class=sp-panel-container><div class=row><div class="col-xs-12 col-sm-6"><div class="panel sp-panel-settings"><div class=panel-heading translate=General.optimization></div><div class=panel-body><ul><li ng-repeat="(key,value) in vm.optimizationOptions" ng-if="key != \'fmv\'"><label translate="{{\'General.optimization.\'+key}}"></label><sp-switch ng-if="key === \'all_vehicles\'" ng-model=value.value ng-true-value=false ng-false-value=true ng-change=vm.checkOptions(key)></sp-switch><sp-switch ng-if="key !== \'all_vehicles\'" ng-model=value.value ng-change=vm.checkOptions(key)></sp-switch><label class=displayed-options-lbl translate=General.optimization.displayed_options></label><sp-switch ng-model=value.editable ng-change=vm.checkOptions(key)></sp-switch></li></ul></div></div></div><div class="col-xs-12 col-sm-6"><div class="panel sp-panel-settings"><div class=panel-heading translate=General.optimization.parameters></div><div class=panel-body><span translate=General.optimization.parameters.traffic_factor></span><div class=sp-traffic-factor><rzslider class=sp-settings-slider rz-slider-model=vm.optimizationOptions.fmv.value rz-slider-options=vm.trafficSlider.options></rzslider><div class=min-limit translate=General.optimization.parameters.slow></div><div class=max-limit translate=General.optimization.parameters.fast></div></div></div></div></div></div></div></div>'),e.put("app/settings/mobile-general/mobile-general-list.html",'<div class=sp-settings-mobile-general-container><div class=sp-mobile-general-activation><div class="panel panel-default sp-form"><div class=row ng-repeat="(key,value) in vm.accountConfigs"><div class="col-xs-12 col-sm-4"><!-- labels --><label translate="{{\'Mobile_general.Accounts_settings.\'+key}}"></label></div><div class="col-xs-12 col-sm-4"><!-- selection --><div class="checkbox switcher text-center"><sp-switch ng-model=vm.accountConfigs[key]></sp-switch></div></div><div class="col-xs-12 col-sm-4"><p class=sp-config-mobile-message translate="{{\'Mobile_general.Accounts_settings.\' + key + \'_message\'}}"></p></div></div><button class="btn btn-success btn-large col-sm-2 btn-account-settings-save" translate="{{\'Account.btn_save\'}}" ng-click=vm.saveConfigsMobile()></button></div></div><div class=sp-mobile-general-table><div class=sp-mobile-table><div class=sp-table><div class="sp-table-row sp-table-header"><div class=sp-table-row-item><span translate=Mobile_general.status></span></div><div class=sp-table-row-item><span translate=Mobile_general.label></span></div><div class=sp-table-row-item>&nbsp;</div></div><div class=sp-table-row ng-repeat="observation in vm.observations.slice((vm.currentPage - 1)*vm.itemsPerPage, vm.currentPage*vm.itemsPerPage) | orderObservationsSettings"><div class=sp-table-row-item><span translate=Mobile_general.{{observation.type}}></span></div><div class=sp-table-row-item><span>{{observation.label}}</span></div><div class=sp-table-row-item><a href="" ng-click=vm.editObservation(observation) translate=Vehicles.edit></a></div></div><div ng-show="vm.observations.length === 0" class="sp-table-row sp-empty-data"><span class=title translate=Mobile_general.without_observations_1></span><div class=content><span translate=Mobile_general.without_observations_2></span></div></div><div ng-if="vm.observations.length > vm.itemsPerPage" class="sp-settings-pagination text-right"><uib-pagination total-items=vm.observations.length ng-model=vm.currentPage max-size=vm.maxSize class=pagination-sm boundary-links=true items-per-page=vm.itemsPerPage first-text={{pagination.firstText}} last-text={{pagination.lastText}} next-text={{pagination.nexText}} previous-text={{pagination.previousText}}></uib-pagination></div></div></div><div class=sp-mobile-form><div class=sp-mobile-form-title><span ng-show=!vm.editing translate=Mobile_general.title_form_1></span> <span ng-show=vm.editing translate=Mobile_general.title_form_2></span> <a class="btn btn-link sp-delete pull-right" ng-show=vm.editing ng-click=vm.showDeleteModal() href=""><i class=sp-icon-delete></i></a></div><form class="form-horizontal sp-form" name=vm.form ng-submit=vm.save() novalidate><div class=form-group><label class="col-sm-3 control-label" translate=Mobile_general.label></label><div class=col-sm-9><input type=text class=form-control name=name required translate translate-attr-placeholder=Mobile_general.required ng-model=vm.mobile.label autofocus><ng-messages for=vm.form.name.$error class="sp-form-messages ng-messages-skills" role=alert ng-if=vm.form.$submitted><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Mobile_general.name_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Skills.repeated></ng-message></ng-messages><!--  <span class="sp-settings-invalid-help-block"\n                              ng-show="vm.nameRequired" translate="Mobile_general.name_required"></span> --></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Mobile_general.type></label><div class=col-sm-9><select class=form-control ng-options="observation.name for observation in vm.typeObservation track by observation.id" ng-model=vm.mobile.type name=type required><option value="" translate=Mobile_general.select_observation></option></select><ng-messages for=vm.form.type.$error class="sp-form-messages ng-messages-skills" role=alert ng-if=vm.form.$submitted><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Mobile_general.type_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Skills.repeated></ng-message></ng-messages></div></div><div class=sp-mobile-form-action-buttons><div class=form-group><button class="btn btn-lg btn-success btn-saved" type=submit ng-click=vm.form.submit() translate=Mobile_general.save></button></div></div></form></div></div></div>'),e.put("app/settings/mobile-general/observation-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Mobile_general.delete_observation></h3></div><div class=modal-body><p style="text-align: center"><span translate=Mobile_general.irreversible_action></span><br><span translate=Mobile_general.want_continue></span></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Mobile_general.cancel></button> <button type=button class="btn btn-danger" ng-click="deleteObservation(); closeThisDialog(0)" translate=Mobile_general.delete></button></div></div>'),e.put("app/settings/skills/skills-list.html",'<div class="skills-panel-list row"><div class="skills-panel-list-left col-md-4"><!-- skills form create --><div ng-show=!vm.editing class="row form-skills"><div class=col-md-10><form class=form-inline name=vm.formSkills ng-submit=vm.saveSkills() novalidate><div class=form-group><input type=text class=form-control id=skill ng-model=vm.skill.name name=name translate translate-attr-placeholder=Skills.skill_holder required></div><button type=submit class="btn btn-primary" translate=Skills.add></button><ng-messages for=vm.formSkills.name.$error class="sp-form-messages ng-messages-skills" role=alert ng-if=vm.formSkills.$submitted><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Skills.required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Skills.repeated></ng-message></ng-messages></form></div><div class=col-md-2><!-- enlace que activa el modo edicion --> <a href="" ng-click="vm.editing = true" ng-show="vm.skills.length > 0" translate=Skills.edit></a></div></div><!-- div "seleccionar todos" que se muestra en modo edicion --><div ng-show=vm.editing class="row select-all-skills"><input ng-show=vm.editing ng-model=vm.select_all_skills ng-change=vm.selectAllSkills() type=checkbox class=col-md-2> <a class=col-md-10 href="" ng-click=vm.selectAllSkillsHref() translate=Skills.select_all></a></div><!-- skills list --><div class="row list-skills"><div class=list-skills-header translate=Skills.name></div><div class=list-skills-body ng-show="vm.skills.length > 0"><div class="list-skills-body-list row" ng-repeat="skill in vm.skills | orderBy:\'skill\'"><!-- input checkbox que se muestra en modo edicion --> <input class=col-md-2 type=checkbox ng-show=vm.editing ng-model=skill.isChecked ng-change=vm.selectSkill()> <span ng-class="{\'col-md-10\':vm.editing || \'col-md-12: !vm.editing\'}">{{skill.skill}}</span></div></div><!-- botones que se muestran al estar en modo edicion--><div ng-show=vm.editing class="list-skills-body buttons"><button class="btn btn-default" ng-click=vm.cancel() translate=Skills.cancel></button> <button class="btn btn-danger" ng-click=vm.deletSkills() translate=Skills.delete></button></div><div ng-show="vm.skills.length === 0" class=empty-skills><span translate=Skills.without_skill_1></span><p translate=Skills.without_skill_2></p></div></div></div><!--skills button --><div ng-show="vm.skills.length > 0" class="col-md-8 skills-panel-button"><div class="btn-group sp-btn-group-abilities"><label class="btn sp-btn-abilities btn-primary" ng-repeat="skill in vm.skills" ng-model=vm.skills_vehicle[skill.id] uib-btn-checkbox ng-class="{\'btn-disabled\': !vm.editing}" ng-click=vm.activeCheckbox()>{{skill.skill}}</label></div></div><div ng-show="vm.skills.length === 0" class="col-md-8 skills-panel-empty"><!--<img src="../../../assets/images/sin-vehiculos-skills.svg">--> <span class=title translate=Skills.empty_skills_title></span> <span class=paragraph translate=Skills.empty_skills_paragraph></span><p class=note translate=Skills.empty_skills_note></p></div></div>'),e.put("app/settings/users/users-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Drivers.delete_driver></h3></div><div class=modal-body><p style="text-align: center"><span translate=Drivers.irreversible_action></span><br><span translate=Drivers.want_continue></span></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Drivers.cancel></button> <button type=button class="btn btn-danger" ng-click="deleteUser(); closeThisDialog(0)" translate=Drivers.delete></button></div></div>'),e.put("app/settings/users/users-detail.html",'<div class=right-side-content><div class=error-update ng-show=vm.errorDeleteOwner><span>Usuario no puede ser eliminado.</span></div><div class=sp-settings-right-side-form><div class=sp-form-title><span ng-show=vm.stateParams.userId translate=Drivers.information_user></span> <span ng-show=!vm.stateParams.userId translate=Drivers.new_driver></span> <a class="btn btn-link sp-delete pull-right" ng-show=vm.stateParams.userId ng-click=vm.showDeleteModal() href=""><i class=sp-icon-delete></i></a></div><form class="form-horizontal sp-form" name=vm.form ng-submit=vm.save() novalidate><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.driver_information></label><div class=col-sm-9><input type=text class=form-control name=name required translate translate-attr-placeholder=Drivers.required ng-model=vm.user.name autofocus> <span class=sp-settings-invalid-help-block ng-show=vm.user.nameRequired translate=Users.name_required></span></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.user_lbl></label><div class=col-sm-9><input type=text class=form-control name=username ng-required=true translate translate-attr-placeholder=Drivers.required ng-model=vm.user.username ng-blur=vm.checkUsername(vm.user) ng-class="{\'sp-settings-invalid-input\': vm.user.usernameDuplicated}"> <span class=sp-settings-invalid-help-block ng-show=vm.user.usernameDuplicated translate=Drivers.user_exist></span> <span class=sp-settings-invalid-help-block ng-show=vm.user.usernameError translate=Drivers.username_error></span> <span class=sp-settings-invalid-help-block ng-show=vm.user.usernameRequired translate=Users.username_required></span></div></div><div class=form-group><div class=col-sm-3></div><div class=col-sm-9><div class=sp-box-check-settings><div class=sp-box-type-user ng-show="vm.isAdmin.value || vm.isOwner.value"><input type=radio ng-model=vm.user.typeUser value=driver> <span class=sp-checkbox-edit-vehicle translate=Drivers.driver></span></div><div class=sp-box-type-user ng-show="vm.isAdmin.value || vm.isOwner.value"><input type=radio ng-model=vm.user.typeUser value=monitor> <span class=sp-checkbox-edit-vehicle translate=Drivers.monitoring></span></div><div class=sp-box-type-user ng-show=vm.isOwner.value><input type=radio ng-model=vm.user.typeUser value=admin> <span class=sp-checkbox-edit-vehicle translate=Drivers.admin></span></div></div><span class=sp-settings-invalid-help-block ng-show=vm.userOwner>Esta accion no puede ser ejecutada, usted es propietario de la cuenta.</span></div></div><div class=form-group ng-show=vm.showViewAdmin><label class="col-sm-3 control-label label-form-permissions">Permisos de edici√≥n</label><div class="col-sm-9 title-form-permissions"><span>Selecciona los m√≥dulos a los que podr√° acceder</span></div><div class=col-sm-3></div><div class="col-sm-9 checkbox-form-permissions"><div class=col-sm-12><input type=checkbox><span>Pedidos</span></div><div class=col-sm-12><input type=checkbox><span>Dise√±o de rutas</span></div><div class=col-sm-12><input type=checkbox><span>Seguimiento</span></div><div class=col-sm-12><input type=checkbox><span>Reportes</span></div></div></div><div class=form-group ng-show="!vm.changePassword && vm.user.id"><label class="col-sm-3 control-label"></label><div class=col-sm-9><button class="btn btn-link sp-btn-collapse" type=button ng-click="vm.changePassword = true"><div class=sp-btn-collapse-text translate=Drivers.change_password></div></button></div></div><div ng-show="vm.changePassword || !vm.user.id"><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.password></label><div class="col-sm-9 sp-block-relative"><input class=form-control ng-attr-type={{vm.user.newPassword.type}} name=password ng-required=!vm.user.id translate translate-attr-placeholder=Drivers.required ng-model=vm.user.newPassword.value autocomplete=off> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=vm.changeTypeInput(vm.user.newPassword)><span class=sp-icon-show-hide></span></button></span></div></div><!--repetir contrasena--><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.repeat_password></label><div class="col-sm-9 sp-block-relative"><input class=form-control ng-attr-type={{vm.user.confirmNewPassword.type}} name=confirm_password ng-required="(vm.changePassword && vm.user.id) || !vm.user.id" translate translate-attr-placeholder=Drivers.required ng-model=vm.user.confirmNewPassword.value autocomplete=off> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=vm.changeTypeInput(vm.user.confirmNewPassword)><span class=sp-icon-show-hide></span></button></span></div></div></div><div><span class=sp-settings-invalid-help-block ng-show=vm.errorMatchPassword translate=Drivers.match_password></span> <span class=sp-settings-invalid-help-block ng-show=vm.errorPassword translate=Drivers.error_password></span> <span class=sp-settings-invalid-help-block ng-show=vm.user.passwordRequired translate=Users.password_required></span></div><div class="col-md-offset-7 col-md-5"><div class=form-group><button class="btn btn-link sp-btn-collapse" type=button ng-click="vm.moreInfo = !vm.moreInfo"><div class=sp-btn-collapse-text>{{\'Users.btn_more_info\'| translate}}</div><div><i class=sp-icon-triangle-up ng-show=vm.moreInfo></i> <i class=sp-icon-triangle-down ng-show=!vm.moreInfo></i></div></button></div></div><div uib-collapse=!vm.moreInfo><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.phone_lbl></label><div class=col-sm-9><bc-phone-number name=phone ng-model=vm.user.phone is-valid=isValid ng-required=false default-country=cl selected-country=cl preferred-countries="cl br co"></bc-phone-number><span class=sp-settings-invalid-help-block ng-show=!vm.user.phoneIsValid translate=Drivers.invalid_format></span></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Drivers.email></label><div class=col-sm-9><input type=email class=form-control name=email translate translate-attr-placeholder=Drivers.optional ng-model=vm.user.email ng-required=false> <span class=sp-settings-invalid-help-block ng-show=!vm.form.email.$valid translate=Drivers.email_format></span> <span class=sp-settings-invalid-help-block ng-show=vm.user.emailError translate=Drivers.email_repeated></span></div></div></div><div class=sp-settings-right-side-form-action-buttons><div class=form-group><button class="btn btn-close pull-left" type=button ng-click=vm.cancel() translate=Drivers.close></button> <button class="btn btn-success pull-right" type=submit ng-click=vm.form.submit() translate=Drivers.save></button></div></div></form></div></div>'),
e.put("app/settings/users/users-list.html",'<div class=left-side><div class=sp-settings-list-container><div class=sp-settings-action-bar><button class="btn btn-primary" type=button ng-click=vm.createUser() ng-disabled="vm.state.includes(\'settings.users.create\') || vm.state.includes(\'settings.users.detail\')"><i class=sp-icon-circle-with-plus></i> <span translate=Drivers.new_driver></span></button></div><div class=sp-settings-content-list><div class=sp-table><div class="sp-table-row sp-table-header"><div class=sp-table-row-item>&nbsp;</div><div class=sp-table-row-item translate=Drivers.name_table_header></div><div class=sp-table-row-item translate=Drivers.class_table_header></div><div class=sp-table-row-item translate=Drivers.phone_table_header></div><div class=sp-table-row-item translate=Drivers.email_table_header></div><div class=sp-table-row-item translate=Drivers.username_table_header></div><div class=sp-table-row-item ng-hide="vm.state.includes(\'settings.users.create\') || vm.state.includes(\'settings.users.detail\')">&nbsp;</div></div><div cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}" ng-show=!vm.ready style=height:200px></div><div class=sp-table-row ng-show="vm.users.length > 0" ng-repeat="user in vm.users.slice(((vm.currentPage-1)*vm.itemsPerPage), ((vm.currentPage)*vm.itemsPerPage))" cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}"><div class="sp-table-row-item text-muted">{{((vm.currentPage-1)*vm.itemsPerPage) + ($index+1) }}</div><div class=sp-table-row-item>{{user.name}}</div><div class=sp-table-row-item ng-show="user.isDriver && !user.isAdmin"><span translate=Users.type_1></span></div><div class=sp-table-row-item ng-show=user.isAdmin><span translate=Users.type_2></span></div><div class=sp-table-row-item ng-show="user.isMonitor && !user.isAdmin"><span translate=Users.type_4></span></div><div class=sp-table-row-item>{{user.phone !== "" ? user.phone: \'---\'}}</div><div class=sp-table-row-item>{{user.email !== "" ? user.email: \'---\'}}</div><div class=sp-table-row-item>{{user.username}}</div><div class=sp-table-row-item ng-hide="vm.state.includes(\'settings.users.create\') || vm.state.includes(\'settings.users.detail\')"><a ui-sref="settings.users.detail({userId: user.id})" translate=Vehicles.edit></a></div></div><div class="sp-settings-pagination text-right" ng-show="vm.users.length > vm.itemsPerPage"><uib-pagination total-items=vm.users.length ng-model=vm.currentPage max-size=vm.maxSize class=pagination-sm boundary-links=true items-per-page=vm.itemsPerPage ng-change=vm.pageChanged() first-text={{pagination.firstText}} last-text={{pagination.lastText}} next-text={{pagination.nexText}} previous-text={{pagination.previousText}}></uib-pagination></div><div ng-if=vm.showNotUsersMessage class="sp-table-row sp-empty-data"><span class=title translate=Drivers.without_drivers_1></span><div class=content><span class=paragraph translate=Drivers.without_drivers_2></span> <a ui-sref=settings.users.create translate=Drivers.without_drivers_3 class=link></a> <span class=paragraph translate=Drivers.without_drivers_4></span></div></div></div></div><div class=sp-settings-drivers-footer><div class=row><div class="sp-left-block sp-vcenter" ng-class="{\'col-sm-5\': vm.state.includes(\'**.settings.users.list\'), \'col-sm-8\': !vm.state.includes(\'**.settings.users.list\')}"><p translate=Drivers.footer_message></p></div><div class="sp-right-block sp-vcenter" ng-class="{\'col-sm-2\': vm.state.includes(\'**.settings.users.list\'), \'col-sm-3 text-right\': !vm.state.includes(\'**.settings.users.list\')}"><a href={{::vm.appLink}} target=_blank><img class=sp-footer-android-image src=../../../assets/images/android_playstore.svg alt=playstore></a></div></div></div></div></div><div class=right-side ng-show="!vm.state.includes(\'**.settings.users.list\')" ui-view></div>'),e.put("app/settings/vehicles/vehicle-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Vehicles.delete_vehicle></h3></div><div class=modal-body><p style="text-align: center"><span translate=Vehicles.irreversible_action></span><br><span translate=Vehicles.want_continue></span></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Vehicles.cancel></button> <button type=button class="btn btn-danger" ng-click="deleteVehicle(); closeThisDialog(0)" translate=Vehicles.delete></button></div></div>'),e.put("app/settings/vehicles/vehicles-confirm-leave.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Vehicles.confirm_leave></h3></div><div class="modal-body text-center"><p translate=Vehicles.confirm_leave_message_1></p><p translate=Vehicles.confirm_leave_message_2></p><p translate=Vehicles.confirm_leave_message_3 ng-show=vm.skillsMessageLeave class=sp-messages-leave-modal></p><p translate=Vehicles.confirm_leave_message_4 ng-show=vm.driverMessageLeave class=sp-messages-leave-modal></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Vehicles.confirm_leave_close></button> <button type=button class="btn btn-danger" ng-click="vm.changeStateVehicle(vm.state); closeThisDialog(0)" translate=Vehicles.confirm_leave_yes></button></div></div>'),e.put("app/settings/vehicles/vehicles-detail.html",'<div class=right-side-content><div class=sp-settings-right-side-header><span ng-show=vm.stateParams.vehicleId>{{vm.vehicle.name}}</span> <span ng-hide=vm.stateParams.vehicleId>--</span> <a class="btn btn-link sp-delete pull-right" ng-show=vm.stateParams.vehicleId ng-click=vm.showDeleteModal() href=""><i class=sp-icon-delete></i></a></div><div class=sp-settings-right-side-map-container><div id=map></div></div><div class=sp-settings-right-side-form><div class=sp-form-title translate=Vehicles.head_title></div><form class="form-horizontal sp-form" name=vm.form ng-submit=vm.save() novalidate><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.title_lbl></label><div class=col-sm-7><input type=text class=form-control name=title required translate translate-attr-placeholder=Vehicles.placeholder_name_vehicle ng-model=vm.vehicle.name autofocus><ng-messages for=vm.form.title.$error class=sp-form-messages role=alert ng-show="vm.form.title.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_name_vehicle_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_name_duplicated></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.capacity_lbl></label><div class=col-sm-7><input type=text class=form-control name=capacity required translate translate-attr-placeholder=Vehicles.placeholder_name_capacity ng-model=vm.vehicle.capacity capacity-input-format><ng-messages for=vm.form.capacity.$error class=sp-form-messages role=alert ng-show="vm.form.capacity.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_capacity_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity></ng-message></ng-messages></div><div class="col-sm-2 capacity-input"><button tooltip-placement=left tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Vehicles.tooltip_capacity\' | translate}}"><i class="sp-icon-info capacity-icon"></i></button></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.origin_lbl></label><div class=col-sm-7><input type=text class=form-control name=originAddress autocomplete=off required id=location_start_address ng-model=vm.vehicle.location_start_address ng-change=vm.mirrorAddresses(vm.vehicle.location_start_address) uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select=vm.setPositionMarker(vm.vehicle.location_start_address) translate translate-attr-placeholder=Vehicles.placeholder_origin ng-focus="vm.changeMarker(\'origin\')"><ng-messages for=vm.form.originAddress.$error class=sp-form-messages role=alert ng-show="vm.form.originAddress.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=pattern></ng-message><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_address_origin></ng-message></ng-messages></div></div><div class="col-md-offset-7 col-md-5"><div class=form-group><button class="btn btn-link sp-btn-collapse" type=button ng-click="vm.moreLoads = !vm.moreLoads"><div class=sp-btn-collapse-text>{{\'Vehicles.btn_more_loads\'| translate}}</div><div><i class=sp-icon-triangle-up ng-hide=vm.moreLoads></i> <i class=sp-icon-triangle-down ng-show=vm.moreLoads></i></div></button></div></div><div uib-collapse=vm.moreLoads><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.capacity_lbl_2></label><div class=col-sm-7><input type=text class=form-control name=capacity_2 translate translate-attr-placeholder=Vehicles.placeholder_name_capacity_2 ng-model=vm.vehicle.capacity2 capacity-input-format><ng-messages for=vm.form.capacity_2.$error class=sp-form-messages role=alert ng-show="vm.form.capacity_2.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity_2></ng-message></ng-messages></div><div class="col-sm-2 capacity-input"><button tooltip-placement=left tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Vehicles.tooltip_capacity_2\' | translate}}"><i class="sp-icon-info capacity-icon"></i></button></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.capacity_lbl_3></label><div class=col-sm-7><input type=text class=form-control name=capacity_3 translate translate-attr-placeholder=Vehicles.placeholder_name_capacity_3 ng-model=vm.vehicle.capacity3 capacity-input-format><ng-messages for=vm.form.capacity_3.$error class=sp-form-messages role=alert ng-show="vm.form.capacity_3.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_capacity_3></ng-message></ng-messages></div><div class="col-sm-2 capacity-input"><button tooltip-placement=left tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Vehicles.tooltip_capacity_2\' | translate}}"><i class="sp-icon-info capacity-icon"></i></button></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.destination_lbl></label><div class=col-sm-7><input type=text class=form-control name=endAddress autocomplete=off ng-required=false id=location_end_address ng-model=vm.vehicle.location_end_address uib-typeahead="place.description as place.description for place in vm.getPlaces($viewValue)" typeahead-min-length=3 typeahead-wait-ms=300 typeahead-on-select=vm.setPositionMarker(vm.vehicle.location_end_address) ng-disabled=vm.shouldMirrorAddresses translate translate-attr-placeholder=Vehicles.placeholder_end ng-focus="vm.changeMarker(\'end\')"><div class=checkbox><label><input type=checkbox ng-model=vm.shouldMirrorAddresses ng-change=vm.mirrorAddresses(vm.vehicle.location_start_address)> <span translate=Vehicles.use_address_detination></span></label></div></div><ng-messages for=vm.form.endAddress.$error class=sp-form-messages role=alert ng-show=vm.form.$submitted></ng-messages></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.driver_lbl></label><div class=col-sm-7><select class=form-control name=default_driver ng-options="driver.name for driver in vm.drivers | orderBy:vm.naturalSort(\'name\'):false track by driver.id" ng-model=vm.vehicle.default_driver ng-show="vm.drivers.length > 0"><option value="" translate=Vehicles.select_driver></option></select><div class="btn-group sp-btn-group-abilities-empty" ng-show="vm.drivers.length === 0"><span translate=Vehicles.without_drivers_1></span> <a href="" ng-click="vm.changeState(\'settings.drivers.create\')" translate=Vehicles.without_drivers_2></a> <span translate=Vehicles.without_drivers_3></span></div><ng-messages for=vm.form.default_driver.$error class=sp-form-messages role=alert ng-show="vm.form.default_driver.$dirty || vm.form.$submitted"><ng-message class=sp-settings-invalid-help-block when=required translate=Vehicles.error_default_driver_required></ng-message><ng-message class=sp-settings-invalid-help-block when=invalid translate=Vehicles.error_limit_default_driver></ng-message></ng-messages></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.schedule></label><div class=col-sm-7><div class=col-sm-4><input type=text class="form-control text-input-schedule" name=shiftStart ng-model=vm.vehicle.shift_start ng-blur=vm.validateTime() translate translate-attr-placeholder=Vehicles.default_start_shift></div><label class="col-sm-4 text-center form-control-static" translate=Vehicles.to></label><div class=col-sm-4><input type=text class="form-control text-input-schedule" name=shiftEnd ng-model=vm.vehicle.shift_end ng-blur=vm.validateTime() translate translate-attr-placeholder=Vehicles.default_end_shift></div><div class="planner-error-date settings-error-date"><p ng-if=vm.invalidDate class=sp-settings-invalid-help-block translate=Vehicles.error_format_date></p><p ng-if=vm.timeBetweenDate class=sp-settings-invalid-help-block translate=Vehicles.error_between_date></p><p ng-if=vm.emptyDate class=sp-settings-invalid-help-block translate=Vehicles.error_empty_date></p></div></div><div class="col-sm-2 capacity-input"><button tooltip-placement=left tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Vehicles.tooltip_schedule\' | translate}}"><i class="sp-icon-info capacity-icon"></i></button></div></div><!-- end shift form-group --><div class=form-group><label class="col-sm-3 control-label" translate=Vehicles.skills_lbl></label><div class="col-sm-7 sp-style-skills"><div class="btn-group sp-btn-group-abilities" ng-show="vm.skills.length > 0"><label class="btn sp-btn-abilities btn-primary" ng-model=vm.skills_vehicle[skill.id] uib-btn-checkbox ng-repeat="skill in vm.skills">{{skill.skill}}</label></div><div class="btn-group sp-btn-group-abilities-empty" ng-show="vm.skills.length === 0"><span translate=Vehicles.without_skill_1></span> <a href="" ng-click="vm.changeState(\'settings.skills.list\')" translate=Vehicles.without_skill_2></a> <span translate=Vehicles.without_skill_3></span></div></div><div class="col-sm-2 capacity-input"><button tooltip-placement=left tooltip-class=tooltip-capacity-vehicles-detail uib-tooltip="{{\'Vehicles.tooltip_skills\' | translate}}"><i class="sp-icon-info capacity-icon"></i></button></div></div></div><div class=form-group><div class="col-md-offset-3 col-md-9"><p class=sp-settings-invalid-help-block ng-show="(vm.form.title.$dirty && vm.form.title.$invalid) ||\n             (vm.form.capacity.$dirty && vm.form.capacity.$invalid) ||\n             (vm.form.originAddress.$dirty && vm.form.originAddress.$invalid)" translate=Vehicles.required_empty_fields_message></p></div></div><div class="col-md-12 sp-settings-right-side-form-action-buttons"><div class=form-group><button class="btn btn-close pull-left" type=button ng-click=vm.cancel() translate=Vehicles.close></button> <button class="btn btn-success pull-right" type=submit ng-click=vm.form.submit() translate=Vehicles.save></button></div></div></form></div></div>'),e.put("app/settings/vehicles/vehicles-list.html",'<div class=left-side><div class=sp-settings-list-container><div class=sp-settings-action-bar><div class=col-md-6><button class="btn btn-primary" type=button ng-click=vm.createVehicle() ng-disabled="vm.state.includes(\'settings.vehicles.create\') || vm.state.includes(\'settings.vehicles.detail\')"><i class=sp-icon-circle-with-plus></i> <span translate=Vehicles.new_vehicle_btn></span></button></div><div class=col-md-6><div class="btn-group pull-right" uib-dropdown><button id=single-button type=button class="btn btn-primary" uib-dropdown-toggle><span translate=Vehicles.import_vehicles></span>&nbsp;<i class=caret></i></button><ul class="dropdown-menu sp-dropdown-container" uib-dropdown-menu aria-haspopup=true aria-expanded=false><li role=menuitem><span class="btn btn-primary btn-file btn-excel-download"><input type=file onchange="angular.element(this).scope().vm.bulkCreate = true; angular.element(this).scope().vm.importVehicles(this.files); angular.element(this).val(null)"> <span translate=Vehicles.btn_new_vehicles></span></span></li><li role=menuitem><span class="btn btn-primary btn-file btn-excel-download"><input type=file onchange="angular.element(this).scope().vm.bulkCreate = false; angular.element(this).scope().vm.importVehicles(this.files); angular.element(this).val(null)"> <span translate=Vehicles.btn_edit_vehicles></span></span></li></ul></div><button class="btn btn-primary pull-right" type=button ng-click=vm.downloadList()><i class=sp-icon-excel></i> <span translate=Vehicles.btn_download_list></span></button></div><!-- <a href="" translate="Vehicles.import"></a> --></div><div class=sp-settings-content-list><div class=sp-table><div class="sp-table-row sp-table-header"><div class=sp-table-row-item>&nbsp;</div><div class=sp-table-row-item translate=Vehicles.title_table_header></div><div class=sp-table-row-item translate=Vehicles.capacity_table_header></div><div class=sp-table-row-item translate=Vehicles.origin_table_header></div><div class=sp-table-row-item translate=Vehicles.destination_table_header></div><div class=sp-table-row-item translate=Vehicles.driver_table_header></div><div class=sp-table-row-item ng-hide="vm.state.includes(\'settings.vehicles.create\') || vm.state.includes(\'settings.vehicles.detail\')">&nbsp;</div></div><div cg-busy="{promise: vm.promiseLoading, backdrop:true, templateUrl:\'app/shared/html/loading.html\'}" ng-show=!vm.ready style=height:200px></div><div ng-show="(vm.vehicles.length > 0) && vm.ready" class=sp-table-row ng-repeat="vehicle in vm.vehicles.slice(((vm.currentPage-1)*vm.itemsPerPage), ((vm.currentPage)*vm.itemsPerPage))"><div class="sp-table-row-item text-muted">{{((vm.currentPage-1)*vm.itemsPerPage) + ($index+1) }}</div><div class=sp-table-row-item>{{vehicle.name}}</div><div class=sp-table-row-item>{{vehicle.capacity | formatNumber:2}}</div><div class=sp-table-row-item alt={{vehicle.location_start_address}}>{{vehicle.location_start_address}}</div><div class=sp-table-row-item>{{vehicle.location_end_address}}</div><div class=sp-table-row-item>{{vehicle.default_driver.name ? vehicle.default_driver.name: vm.getDriverName(vehicle.default_driver)}}</div><div class=sp-table-row-item ng-hide="vm.state.includes(\'settings.vehicles.create\') || vm.state.includes(\'settings.vehicles.detail\')"><a ui-sref="settings.vehicles.detail({vehicleId: vehicle.id})" translate=Vehicles.edit></a></div></div><div ng-show="vm.vehicles.length > 0" class="sp-settings-pagination text-right"><uib-pagination total-items=vm.vehicles.length ng-model=vm.currentPage max-size=vm.maxSize class=pagination-sm boundary-links=true items-per-page=vm.itemsPerPage ng-change=vm.pageChanged() first-text={{pagination.firstText}} last-text={{pagination.lastText}} next-text={{pagination.nexText}} previous-text={{pagination.previousText}}></uib-pagination></div><div ng-show="vm.vehicles.length === 0 && vm.ready && !vm.errorPath" class="sp-table-row sp-empty-data"><span class=title translate=Vehicles.without_vehicle_1></span><div class=content><span class=paragraph translate=Vehicles.without_vehicle_2></span> <a ui-sref=settings.vehicles.create class=link translate=Vehicles.without_vehicle_3></a> <span class=paragraph translate=Vehicles.without_vehicle_4></span></div></div></div></div></div></div><div class=right-side ng-show="!vm.state.includes(\'**.settings.vehicles.list\')" ui-view></div>'),e.put("app/settings/zones/zone-delete-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Zones.Delete.title></h3></div><div class=modal-body><p style="text-align: center"><span translate=Zones.Delete.irreversible_action></span><br><span translate=Zones.Delete.want_continue></span></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog() translate=Zones.Delete.button_cancel></button> <button type=button class="btn btn-danger" ng-click=confirm() translate=Zones.Delete.button_delete></button></div></div>'),e.put("app/settings/zones/zone-edit.html",'<div class=sp-add-zone-container><div class=sp-add-zone-title><input type=text ng-model=vm.zone.name translate translate-attr-placeholder=Zones.Edit.input_placeholder></div><zone-map data=vm.zone></zone-map><selectable-items-list data=vm.dataSelectableItemsList items-selected=vm.dataSelectableItemsSelected></selectable-items-list><div class="row validation-error-name" ng-if=vm.nameError><div class="col-sm-12 text-center"><span class=text-danger translate=Zones.validation_error_name></span></div></div><div class=sp-add-zone-buttons><button class="btn btn-default" ng-click=vm.closeModal() translate=Zones.Edit.cancel></button> <button class="btn btn-success" ng-click=vm.saveZone() ng-disabled="!vm.zone.coordinates || vm.zone.coordinates.length === 0 || !vm.zone.name || vm.dataSelectableItemsList.itemsSelected === 0" translate=Zones.Edit.save></button></div></div>'),e.put("app/settings/zones/zones-bulk-modal.html",'<div class=sp-modal-content><div class="modal-header modal-header-success"><h3 class=modal-title translate=Zones.Bulk.result_modal_title></h3></div><div class=modal-body><p translate=Zones.Bulk.result_modal_upload_success></p><p ng-if="validRequest === \'WITH_ERRORS\'" translate=Zones.Bulk.resut_modal_upload_with_errors></p></div><div class=bulk-result-container ng-if="validRequest === \'WITH_ERRORS\'"><div class="sp-bulk-result-row header"><div class="sp-bulk-result-column row-number"><span translate=Zones.Bulk.result_modal_row_header></span></div><div class="sp-bulk-result-column error"><span translate=Zones.Bulk.result_modal_error_header></span></div></div><div ng-repeat="obj in errorInfo"><div ng-if=obj.errors.length class=sp-bulk-result-data-row><div class=row-number>{{obj.rowNumber}}</div><div class=error-description><div ng-repeat="error in obj.errors"><div ng-if="error.desc === \'VEHICLE_NOT_FOUND\'">{{error.value}}: <span translate=Zones.Bulk.result_modal_error_vehicle_not_found></span></div><div ng-if="error.desc === \'ZONE_NOT_FOUND\'">{{error.value}}: <span translate=Zones.Bulk.result_modal_error_zone_not_found></span></div></div></div></div></div></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Visits.close></button></div></div>'),e.put("app/settings/zones/zones.html",'<div class=sp-zones-container><div class=actions-zones><div class=col-md-12><div class="btn-group pull-left assign-zones-section"><button class="btn btn-primary pull-right" type=button ng-click=vm.downloadZones()><i class=sp-icon-excel></i> <span translate=Zones.Bulk.btn_download_zones></span></button> <button type=button class="btn btn-primary btn-file"><input type=file onchange="angular.element(this).scope().vm.importZones(this.files); angular.element(this).val(null)"> <span translate=Zones.Bulk.btn_import_zones></span></button></div></div><actions-zones data=vm.actionUseZones></actions-zones><div class="btn btn-success save-config-zones" translate=Zones.Actions.save_actions_zones ng-click=vm.saveZoneProperties()></div></div><div class=row><div class="sp-zones-add col-md-3" ng-click=vm.addZone()><div class=sp-zones-add-action><svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=mas><path d="M16,5c6,0,11,4.9,11,11c0,6-4.9,11-11,11c-6,0-11-4.9-11-11C5.1,10,10,5,16,5 M16,2c-7.7,0-14,6.3-14,14\n            c0,7.7,6.3,14,14,14c7.7,0,14-6.3,14-14C30,8.3,23.8,2,16,2L16,2z"/><path d="M22.8,14.7h-5.5V9.3C17.3,8.6,16.7,8,16,8c-0.7,0-1.3,0.6-1.3,1.3v5.4H9.3c-0.7,0-1.3,0.6-1.3,1.3\n            c0,0.7,0.6,1.3,1.3,1.3h5.4v5.5c0,0.7,0.6,1.3,1.3,1.3c0.7,0,1.3-0.6,1.3-1.3v-5.5h5.5c0.7,0,1.3-0.6,1.3-1.3\n            C24.1,15.2,23.5,14.7,22.8,14.7z"/></g></svg> <span translate=Zones.add_zone></span></div></div><zone class="sp-zones-item col-md-3" ng-repeat="zone in vm.zones" data=zone call-to-edit=vm.editZone(zoneObj) call-to-delete=vm.confirmDelete(zoneId)></zone></div></div>'),e.put("app/shared/components/selectableItemsList.html",'<div class=sp-item-container><div class=sp-item-container-top><!-- Title Component --><div class=sp-item-container-title><i class={{$ctrl.data.icon}}></i> <span>{{$ctrl.data.title}}</span> <span>({{$ctrl.data.itemsSelected}})</span></div><div class=sp-item-container-search><input type=text class="form-control dispatchs-input-header" ng-model=$ctrl.searchKeyword> <i class=sp-icon-search ng-if=!$ctrl.searchKeyword></i></div></div><div class="row sp-item-container-list"><div class="col-sm-3 item sp-select-all" ng-repeat="item in $ctrl.listFilter = ($ctrl.data.items | filter:$ctrl.searchKeyword | orderBy:$ctrl.naturalSort(\'name\'):false) |\n         limitTo: $ctrl.itemsPerPage : (($ctrl.currentPage -1) * $ctrl.itemsPerPage)"><div class=sp-checkbox-select-all><input type=checkbox class=sp-checkbox-input ng-model=item.activate ng-change=$ctrl.updateItemSelected(item.activate)><label><span class=sp-icon-check></span></label></div><span class=item-name>{{item.name}}</span></div><div class=sp-item-filter-empty ng-if="$ctrl.listFilter.length === 0 && $ctrl.data.items.length > 0"><span translate=Zones.Items_list.msg_empty_filter></span></div><div class=sp-item-list-empty ng-if="$ctrl.data.items.length === 0"><span>{{$ctrl.data.msgItemsEmpty}}</span> <button class="btn btn-primary" ng-click=$ctrl.goToAction()>{{$ctrl.data.callAction}}</button></div></div><div class=sp-item-pagination ng-show="$ctrl.data.items.length > $ctrl.itemsPerPage"><uib-pagination total-items=$ctrl.listFilter.length class=pagination-sm ng-change=$ctrl.pageChanged() boundary-links=true ng-model=$ctrl.currentPage max-size=$ctrl.maxSize items-per-page=$ctrl.itemsPerPage previous-text="<" next-text=">"></uib-pagination></div></div>'),e.put("app/shared/html/loading.html","<div style=\"background-image:url('../../../assets/images/loading.gif');background-position:50% 50%;background-repeat:no-repeat\"></div>"),e.put("app/shared/toast/toast.html",'<ul class=toasts><li class={{toast.type}} ng-class="{\'dismiss\': toast.dismiss}" ng-repeat="toast in toasts"><div class="toast-icon mg-r-15"><i class="fa {{getIcon(toast.type)}}"></i></div><div class=toast-message ng-bind-html=toast.message></div><div class=dismiss-btn ng-if=toast.dismiss ng-click=remove(toast)>{{ \'Toast.accept\' | translate }}</div></li></ul>'),e.put("app/shared/tour/tour-dialog.html",'<div class="info modal-content sp-finish-modal"><div class=modal-header><h3 class=modal-title translate=tour-dialogs.tourOnProgressTitle></h3></div><div class=modal-body><p translate=tour-dialogs.tourOnProgressBody></p></div><div class=modal-footer><div class=sp-action-button><button class="btn btn-default pull-left" ng-click=confirm()><span translate=tour-dialogs.btnExit></span></button> <button class="btn btn-primary pull-right" ng-click=closeThisDialog()><span translate=tour-dialogs.btnContinueTour></span></button></div></div></div>'),e.put("app/tracking/dispatchs/all-dispatchs.html",'<div class=sp-tracking-dispatchs><div class="sp-tracking-header sp-tracking-search-input" ng-if=!vm.withoutVisits><form class=form-inline ng-submit=vm.searchVisit()><input type=text class="form-control dispatchs-input-header" ng-model=vm.searchKeyword ng-change=vm.checkClearKeyWord()> <button type=submit class="btn btn-primary btn-search-visits" ng-disabled="vm.searchKeyword.length < 3" ng-click=vm.searchVisit()><i class=sp-icon-search></i></button> <button type=button class="btn btn-clear-visit" ng-show=vm.searchKeyword ng-click=vm.clearInputVisit()><i class="fa fa-close"></i></button></form></div><!-- end sp-tracking-header --><div class=sp-tracking-scrollable><div class=list-group ng-if="!vm.withoutVisits && !vm.loadingData"><a class="list-group-item sp-tracking-dispatch-item" ng-repeat="visit in vm.visits | trackingSearchVisits: searchKeyword track by visit.id" ng-class="{\'disabled\':visit.status === \'pending\'}" ng-click=vm.openModal(visit.id) href="" callback=vm.filterVehicles(vm.visits);><div class=sp-tracking-dispatch-content><div class=sp-tracking-dispatch-header><div class=sp-tracking-dispatch-title>{{visit.title}}<div class=has-alert ng-if=::visit.hasAlert></div></div><div class=sp-tracking-dispatch-status><i class=sp-icon-despacho-fallido ng-show="visit.status === \'canceled\'" style=color:gray></i> <i class=sp-icon-despacho-entregado ng-show="visit.status === \'completed\'" style=color:#41D3BD></i> <i class=sp-icon-despacho-fallido ng-show="visit.status === \'failed\'" style=color:#FF5252></i> <i class=sp-icon-despacho-atrasado ng-show="visit.status === \'pending\'"></i></div></div><!-- end sp-tracking-dispatch-header --><div class="text-muted sp-tracking-dispatch-address all">{{visit.address}}</div></div><!-- end sp-tracking-dispatch-content--> </a><!-- end sp-tracking-dispatch-item --></div><!-- end list-group --><div ng-if="vm.withoutVisits && !vm.visitsFiltersEmpty && !vm.loadingData" class=sp-tracking-scrollable-empty-data><h3 translate=Visits.without_visits_title></h3><img ng-src=/assets/images/sin-visitas.svg></div><!-- end empty-data --><div ng-if=vm.visitsFiltersEmpty class=sp-tracking-scrollable-empty-data><h3 translate=Visits.without_visits_filter></h3><p><span translate=Visits.without_visits_filter_message></span></p><img ng-src=/assets/images/sin-visitas.svg></div><!-- end empty-data --><!--Loading Data--><div class=sp-container-loading ng-if=vm.loadingData><img src=/assets/images/loading.gif></div></div><!-- end sp-tracking-scrollable --></div><!-- end sp-tracking-dispatchs -->'),e.put("app/tracking/dispatchs/dispatch-detail.html",'<div class=sp-modal-content><div class=modal-header ng-class="{\'modal-header-danger\': vm.visit.status === \'failed\', \'modal-header-success\': vm.visit.status === \'completed\', \'modal-header-canceled\': vm.visit.status === \'canceled\', \'modal-header-pending\': vm.visit.status === \'pending\'}"><h3 class=modal-title ng-show=" vm.visit.status === \'failed\'" translate=Visits.modal_title_visit_failed></h3><h3 class=modal-title ng-show=" vm.visit.status === \'completed\'" translate=Visits.modal_title_visit_completed></h3><h3 class=modal-title ng-show=" vm.visit.status === \'canceled\'" translate=Visits.modal_title_visit_canceled></h3><h3 class=modal-title ng-show=" vm.visit.status === \'pending\'" translate=Visits.modal_title_visit_pending></h3></div><!-- end modal-header --><div class="modal-body sp-tracking-modal"><div class=sp-tracking-modal-info><div ng-show=!vm.moreData class=info-view><!-- visit title --><div class="title title-visit"><span>{{vm.visit.title}}</span></div><!-- address --><div class=info-row><span class=label-row translate=Visits.modal_body_visit_location></span> <span class=content-row>{{vm.visit.address}}</span></div><!-- reference --><div class=info-row><span class=label-row>id</span> <span class=content-row>{{vm.visit.reference}}</span></div><!-- planned date --><div class=info-row><span class=label-row translate=Visits.modal_body_visit_date></span> <span class=content-row>{{vm.visit.planned_date}}</span></div><!-- Info visit --><div class=title><span class=span-info-visit translate=Visits.modal_body_visit_info></span></div><!-- ETA --><div class=info-row><span class=label-row translate=Visits.modal_body_visit_estimated_time></span> <span class=content-row>{{vm.visit.estimated_time_arrival}}</span></div><!-- Checkin --><div class=info-row ng-if=vm.visit.checkin_time><span class=label-row translate=Visits.modal_body_visit_check_in></span> <span class=content-row>{{vm.visit.checkin_time}}</span></div><!-- Checkout --><div class=info-row><span class=label-row translate=Visits.modal_body_visit_check_out></span> <span class=content-row ng-show="vm.visit.status !== \'pending\' && vm.visit.checkout_time">{{vm.visit.checkout_time}} <a href="" ng-click="active = 1" ng-show=vm.distanceCheckoutVisit class=link-to-map>{{vm.distanceCheckoutVisit}}</a> </span><span class=content-row ng-if="vm.visit.status === \'pending\' && !vm.visit.checkout_time" translate=Visits.modal_checkout_pending></span></div><!-- Service Time --><div class=info-row ng-show=vm.visit.time_service><span class=label-row translate=Visits.modal_body_visit_time_service></span> <span class=content-row>{{vm.visit.calculated_service_time}}</span></div><!-- Window --><div class=info-row ng-show="vm.visit.window_start || vm.visit.window_end || vm.visit.window_start_2 || vm.visit.window_end"><span class=label-row translate=Visits.modal_body_visit_time_window></span><div class=content-row><!-- inicio de ventana horaria 1 --><div class="col-sm-12 sp-tracking-time-window" ng-show="vm.visit.window_start && vm.visit.window_end"><p>{{vm.visit.window_start}}</p><p class=text-separator translate=Visits.modal_time_window_to></p><p>{{vm.visit.window_end}}</p></div><div class="col-sm-12 sp-tracking-time-window" ng-show="!vm.visit.window_start && vm.visit.window_end"><p translate=Visits.modal_time_window_until_to></p><p>{{vm.visit.window_end}}</p></div><div class="col-sm-12 sp-tracking-time-window" ng-show="vm.visit.window_start && !vm.visit.window_end"><p translate=Visits.modal_time_window_since></p><p>{{vm.visit.window_start}}</p></div><!-- fin de ventana horaria 1--><!-- inicio de ventana horaria 2 --><div class="col-sm-12 sp-tracking-time-window" ng-show="vm.visit.window_start_2 && vm.visit.window_end_2 && vm.hasSecondTimeWindow"><p>{{vm.visit.window_start_2}}</p><p class=text-separator translate=Visits.modal_time_window_to></p><p>{{vm.visit.window_end_2}}</p></div><div class="col-sm-12 sp-tracking-time-window" ng-show="!vm.visit.window_start_2 && vm.visit.window_end_2 && vm.hasSecondTimeWindow"><p translate=Visits.modal_time_window_until_to></p><p>{{vm.visit.window_end_2}}</p></div><div class="col-sm-12 sp-tracking-time-window" ng-show="vm.visit.window_start_2 && !vm.visit.window_end_2 && vm.hasSecondTimeWindow"><p translate=Visits.modal_time_window_since></p><p>{{vm.visit.window_start_2}}</p></div><!-- fin de ventana horaria 2--></div></div><!-- Driver--><div class=info-row><span class=label-row translate=Driver.driver></span> <span class=content-row>{{vm.visit.driver_name}}</span></div><!-- Vehicle --><div class=info-row><span class=label-row translate=Vehicle.vehicle></span> <span class=content-row>{{vm.visit.vehicle_name}}</span></div><!-- Checkout observation --><div class=info-row ng-show=vm.visit.checkout_observation><span class=label-row translate=Visits.modal_body_visit_observations></span> <span class=content-row>{{vm.visit.checkout_observation}}</span></div><!-- Checkout comment --><div class=info-row ng-show=vm.visit.checkout_comment><span class=label-row translate=Visits.modal_body_visit_comments></span> <span class="content-row text-oblique">{{vm.visit.checkout_comment}}</span></div></div><!-- Action more data --><div class=action-to-more-data ng-if="(vm.enableMoreData) && !vm.moreData"><a href="" class=sp-link-more-information ng-click="vm.moreData = true" translate=Visits.show_extra_fields></a></div><div ng-show=vm.moreData class="info-view info-more-data"><!-- Title --><div class="title title-visit"><span translate=Visits.extra_fields_value></span></div><div class=info-row ng-show=vm.visit.notes><span class=label-row translate=Visits.notes></span> <span class=content-row>{{vm.visit.notes}}</span></div><div class=info-row ng-show=vm.visit.load><span class=label-row translate=Visits.modal_body_visit_load></span> <span class=content-row>{{vm.visit.load}}</span></div><div class=info-row ng-show=vm.visit.load2><span class=label-row translate=Visits.modal_body_visit_load_2></span> <span class=content-row>{{vm.visit.load2}}</span></div><div class=info-row ng-show=vm.visit.load3><span class=label-row translate=Visits.modal_body_visit_load_3></span> <span class=content-row>{{vm.visit.load3}}</span></div><div class=info-row ng-show=vm.visit.load3><span class=label-row translate=Visits.modal_body_visit_load_3></span> <span class=content-row>{{vm.visit.load3}}</span></div><div ng-repeat="(key, value) in vm.extraFieldsValue"><div class=info-row><span class=label-row>{{key}}</span> <span class=content-row>{{value}}</span></div></div></div><div class=action-to-more-data ng-if=vm.moreData><a href="" class=sp-link-more-information ng-click="vm.moreData = false" translate=Visits.hide_extra_fields></a></div></div><div class=sp-tracking-modal-tab-container><uib-tabset active=active justified=true class=sp-tracking-modal-tab><uib-tab index=0 heading="{{\'Visits.attach\' | translate}}"><div id=image-download class=sp-tracking-modal-carousel ng-if=" vm.visit.pictures.length > 0"><uib-carousel active=active no-wrap=false><uib-slide ng-repeat="slide in  vm.visit.pictures track by $index" index=$index><img ng-src={{slide}} style=margin:auto></uib-slide></uib-carousel><a href="" class=attach-image-carousel id=download-picture ng-click=vm.download(vm.visit) translate=Tracking.download_pictures></a></div><div class=sp-tracking-modal-no-picture ng-if="!vm.visit.pictures.length > 0"><span translate=Tracking.without_pictures></span></div></uib-tab><uib-tab index=1 heading="{{\'Visits.map\' | translate}}"><div class=empty-checkout><div class=tab-not-checkout ng-if=vm.infoNotCheckout><span translate=Visits.pending_checkout></span></div><div class=tab-not-checkout ng-if=vm.infoNotCheckoutLatLng><span translate=Visits.not_checkout></span></div></div><div class=static-map ng-if=vm.showMap><img ng-src={{vm.urlMap}}></div></uib-tab></uib-tabset></div></div></div>'),
e.put("app/tracking/dispatchs/driver-dispatchs.html",'<div class=sp-tracking-dispatchs><div class="sp-tracking-header sp-tracking-dispatchs-driver-heading"><div class=sp-tracking-dispatchs-driver-heading-title><span class=driver-name ng-if=vm.vehicle.driver>{{vm.vehicle.driver.name}}</span> <span class=driver-name-empty ng-if=!vm.vehicle.driver translate=Driver.without_assigned_driver></span> <span class=phone ng-if=vm.vehicle.driver.phone>{{vm.vehicle.driver.phone}}</span></div><div class=sp-tracking-dispatchs-driver-heading-status><!--Status icon SVG--> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=conexion><circle class=status-fill cx=3.981 cy=27.974 r=2 /><path class=status-fill d="M3.873,18.093c-0.014-0.004-0.026-0.014-0.041-0.017c-0.015-0.002-0.03-0.005-0.045-0.007\n            c-0.088-0.017-0.178-0.027-0.271-0.027c-0.831,0-1.503,0.668-1.514,1.496c0-0.007-0.002-0.013-0.002-0.02v0.039\n            c0,0.028,0.012,0.052,0.013,0.079c0.007,0.09,0.021,0.177,0.043,0.262c0.124,0.523,0.505,0.944,1.018,1.101\n            c0.141,0.042,0.287,0.072,0.441,0.072c0.007,0,0.013-0.002,0.021-0.002c1.885,0.324,3.571,1.234,4.866,2.534l2.119-2.118\n            C8.76,19.72,6.454,18.497,3.873,18.093z"/><path class=status-fill d="M13.928,28.177c-0.003-0.015-0.013-0.026-0.017-0.04c-0.403-2.582-1.624-4.889-3.389-6.651l-2.119,2.118\n            c1.299,1.296,2.208,2.982,2.531,4.867c0,0.008-0.002,0.014-0.002,0.021c0,0.154,0.03,0.301,0.072,0.441\n            c0.156,0.512,0.577,0.895,1.1,1.018c0.085,0.022,0.172,0.036,0.262,0.044c0.027,0.001,0.051,0.013,0.079,0.013h0.039\n            c-0.007,0-0.013-0.002-0.02-0.002c0.828-0.01,1.497-0.682,1.497-1.513c0-0.093-0.011-0.184-0.027-0.271\n            C13.933,28.207,13.93,28.191,13.928,28.177z"/><path class=status-fill d="M16.076,15.934c-3.121-3.13-7.271-5.233-11.909-5.736c-0.332-0.036-0.671-0.045-1.009-0.064\n            C2.493,10.311,2,10.913,2,11.634c0,0.719,0.489,1.318,1.151,1.499c0.211,0.015,0.425,0.017,0.633,0.039\n            c3.956,0.417,7.498,2.216,10.164,4.889h0.001c2.671,2.668,4.468,6.211,4.883,10.166c0.021,0.209,0.023,0.423,0.038,0.634\n            c0.18,0.662,0.778,1.151,1.498,1.152c0.722,0.001,1.323-0.493,1.501-1.157c-0.019-0.338-0.027-0.678-0.063-1.01\n            C21.306,23.208,19.205,19.056,16.076,15.934z"/><path class=status-fill d="M3.23,2.19C2.528,2.333,2,2.954,2,3.698c0,0.724,0.501,1.326,1.174,1.491c0.118,0.029,0.239,0.048,0.365,0.048\n            c0.05,0,0.096-0.01,0.145-0.015C9.864,5.639,15.43,8.33,19.552,12.46l2.129-2.127c-4.593-4.6-10.785-7.603-17.675-8.094\n            C3.748,2.22,3.49,2.201,3.23,2.19z"/><path class=status-fill d="M29.765,28.012c-0.487-6.89-3.487-13.083-8.084-17.679l-2.129,2.128c4.128,4.124,6.815,9.691,7.229,15.871\n            c-0.004,0.049-0.015,0.096-0.015,0.145c-0.001,0.127,0.019,0.248,0.048,0.365c0.164,0.674,0.767,1.175,1.49,1.176\n            c0.744,0,1.365-0.527,1.508-1.23C29.803,28.527,29.783,28.27,29.765,28.012z"/></g></svg><!--End Status icon SVG--></div></div><!-- end sp-tracking-header --><!--tracking detail tabs--><div class=sp-tracking-dispatchs-driver-tabs><div class=tab ng-class="{\'selected\': vm.visitsTabSelected}" ng-click="vm.selectTab(\'visits\')" translate=Tracking.visits></div><div class=tab ng-class="{\'selected\': vm.eventsTabSelected}" ng-click="vm.selectTab(\'events\')" translate=Tracking.events></div></div><!--end tracking detail tabs--><div class=sp-tracking-scrollable><div class=list-group ng-if="!vm.loadingData && vm.visitsTabSelected && vm.visits.length > 0"><div class=list-group-route ng-repeat="route in vm.routes track by route.id"><div class=route-title><div><span translate=Tracking.route></span> {{$index+1}}</div><div class=sp-tracking-visits-order-options-container ng-if=!$index><span translate=Tracking.order_by class=sp-tracking-visits-order-text></span> <a class="btn btn-primary order-by-button" ng-click="vm.orderVisitsBy(\'order\')" ng-class="{\'deselected\': vm.orderVisitsProperty === \'order\'}" uib-tooltip="{{\'Tracking.eta_tooltip\' | translate}}"><i class=sp-icon-ventana-horaria></i> </a><a class="btn btn-primary order-by-button" ng-click="vm.orderVisitsBy(\'checkout_time\')" ng-class="{\'deselected\': vm.orderVisitsProperty === \'checkout_time\'}" uib-tooltip="{{\'Tracking.checkout_time_tooltip\' | translate}}"><i class=sp-icon-vehiculos></i></a></div></div><div class=sp-tracking-route-indicators ng-class="{\'expanded\': route.expandedIndicators}"><div class=sp-indicators-container ng-if=route.expandedIndicators><div class=sp-indicator ng-if=route.totalLoadPercentage><i class=sp-icon-carga-peso></i> <span>{{route.totalLoadPercentage | formatNumber:0:\'.\':\',\'}}%</span></div><div class=sp-indicator ng-if=route.totalLoad2Percentage><i class=sp-icon-carga-volumen></i> <span>{{route.totalLoad2Percentage | formatNumber:0:\'.\':\',\'}}%</span></div><div class=sp-indicator ng-if=route.totalLoad3Percentage><i class=sp-icon-carga-valor></i> <span>{{route.totalLoad3Percentage | formatNumber:0:\'.\':\',\'}}%</span></div><div class=sp-indicator ng-if=route.totalTimeFormatted><i class=sp-icon-verificando></i> <span>{{route.totalTimeFormatted}}<small>HRS</small></span></div></div><div class=expand-button ng-click=vm.showRouteIndicators(route)><i class=sp-icon-chevron-thin-up ng-if=route.expandedIndicators></i> <i class=sp-icon-chevron-thin-down ng-if=!route.expandedIndicators></i></div></div><a class="list-group-item sp-tracking-dispatch-item" href="" ng-repeat="visit in vm.visits | orderBy: vm.orderVisitsProperty | filter: { route_id: route.id } : true track by visit.id " ng-class="{\'disabled\':visit.status === \'pending\'}" ng-click=vm.openModal(visit)><div class=sp-tracking-dispatch-timeline><div class=sp-tracking-dispatch-timeline-number style="background-color: {{::vm.vehicle.color}}">{{ visit.order }}</div><div class=sp-tracking-dispatch-timeline-hour ng-show=visit.ETARecalculated>{{visit.ETARecalculated | limitTo : 5}}</div><div class=sp-tracking-dispatch-timeline-hour ng-show=!visit.ETARecalculated>{{visit.estimated_time_arrival | limitTo : 5}}</div><div class=sp-tracking-dispatch-timeline-line style="background-color: {{::vm.vehicle.color}}"></div></div><div class=sp-tracking-dispatch-content><div class=sp-tracking-dispatch-header><div class=sp-tracking-dispatch-title>{{::visit.title}}<div class=has-alert ng-if=visit.hasAlert></div></div></div><!-- end sp-tracking-dispatch-header --><div class="text-muted sp-tracking-dispatch-address">{{::visit.address}}</div></div><!-- end sp-tracking-dispatch-content --><div class=sp-tracking-dispatch-status-container><div class=sp-tracking-dispatch-status><i class=sp-icon-despacho-fallido ng-show="visit.status === \'canceled\'" style=color:gray></i> <i class=sp-icon-despacho-entregado ng-show="visit.status === \'completed\'" style=color:#41D3BD></i> <i class=sp-icon-despacho-fallido ng-show="visit.status === \'failed\'" style=color:#FF5252></i> <i class=sp-icon-despacho-atrasado ng-class="{\'is-delayed\': visit.isDeliveryDelayed}" ng-show="visit.status === \'pending\'"></i></div><div class=sp-tracking-dispatch-checkout-time>{{visit.checkout_time}}</div></div></a><!-- end sp-tracking-dispatch-item --></div></div><!-- end list-group --><div class=list-group ng-if="!vm.loadingData && vm.eventsTabSelected && vm.events.length > 0"><div class=list-group-container><event class=sp-event data=event showdriver=false ng-repeat="event in vm.events track by event.aggregate_id+event.version"></event></div></div><!-- end list-group --><div ng-if="vm.visits.length === 0 && !vm.loadingData && vm.visitsTabSelected" class=sp-tracking-scrollable-empty-data><h3 translate=Visits.without_visits_title></h3><img ng-src=/assets/images/sin-visitas.svg></div><!-- end empty-data --><div ng-if="vm.events.length === 0 && !vm.loadingData && vm.eventsTabSelected" class=sp-tracking-scrollable-empty-data><h3 translate=Events.without_events_title></h3><img ng-src=/assets/images/sin-eventos.svg></div><!-- end empty-data --><!--Loading Data--><div class=sp-container-loading ng-if=vm.loadingData><img src=/assets/images/loading.gif></div></div><!-- end sp-tracking-scrollable --></div><!-- end sp-tracking-dispatchs -->'),e.put("app/tracking/events/events.html",'<div class=list-group ng-if="!vm.loadingData && vm.events.length > 0"><event class=sp-event data=event showdriver=true ng-repeat="event in vm.events track by event.aggregate_id+event.version"></event></div><div ng-if="vm.events.length === 0 && !vm.loadingData" class=sp-tracking-scrollable-empty-data><h3 translate=Events.without_events_title></h3><img ng-src=/assets/images/sin-eventos.svg></div><!-- end empty-data --><!--Loading Data--><div class=sp-container-loading ng-if=vm.loadingData><img src=/assets/images/loading.gif></div>'),e.put("app/tracking/info/info.html",'<div class="info modal-content"><div class="modal-header modal-header-danger"><button type=button class=close data-dismiss=modal ng-click=$dismiss() aria-hidden=true>&times;</button><h2 class=modal-title translate=Info.unavailable_tracking></h2></div><div class=modal-body><p translate=Info.no_day_routes></p><p><span translate=Info.please></span> <a ng-click=$dismiss() href="" translate=Info.select_other_date></a> <span translate=Info.or></span> <a ui-sref=planner ng-click=$dismiss() translate=Info.create_route></a></p></div></div>'),e.put("app/tracking/loading/loading.html","<div style=\"position: absolute; top: 50%; background-image:url('../../assets/images/loading.gif');background-position:50% 20px;background-repeat:no-repeat\"></div>"),e.put("app/tracking/vehicles/vehicles.html",'<div class=list-group ng-if=!vm.loadingData><div class="sp-tracking-header sp-tracking-search-input" ng-if=vm.vehicles.length><input type=text class="form-control dispatchs-input-header" ng-model=vm.searchKeyword ng-keyup=vm.checkKey($event)><!--<i class="fa fa-search dispatchs-icon-header"></i>--> <button type=button class="btn btn-primary btn-search-visits" ng-click=vm.filterVehicles()><i class=sp-icon-search></i></button> <button type=button class="btn btn-clear-visit" ng-show=vm.searchKeyword ng-click=vm.clearFilter()><i class="fa fa-close"></i></button></div><!-- end sp-tracking-header --><div ng-if="vm.vehiclesFilters.length === 0 && vm.vehicles.length > 0" class=sp-tracking-scrollable-empty-data><h3 translate=Vehicle.vehicle_filter_empty_results></h3><p><span translate=Vehicle.vehicle_filter_empty_results_message></span></p><img ng-src=/assets/images/sin-vehiculos-tracking.svg></div><!-- end empty-data --><div class=active-vehicles-div ng-if="vm.vehicles.length > 0 && vm.vehiclesFilters.length > 0"><div class=section-title><span translate=Tracking.active_vehicles></span> <span class=sp-vehicles-number>({{activeVehicles.length}})</span></div><div class=sp-vehicle ng-repeat="vehicle in activeVehicles = (vm.vehiclesFilters | filter:{isActive:true} | trackingOrderVehicles) track by $index" ng-click=vm.toogleListVehicleDriver(vehicle) ng-class="{\'selected\': vm.selectedVehicleId && vm.selectedVehicleId === vehicle.id}"><div class="list-group-item sp-tracking-driver-item" ng-class="{\'disabled\':!vehicle.routes.length && vehicle.locations.length === 0 && !vehicle.driver}"><div class=sp-tracking-driver-item-heading><div class=vehicle-info uib-tooltip={{vehicle.name}}><!--Vehicle Icon--> <svg class=img version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=vehiculos><g><circle style=fill:{{vehicle.color}} cx=22.54 cy=23.501 r=2.499 /><circle style=fill:{{vehicle.color}} cx=9.452 cy=23.501 r=2.499 /></g><path d="M27.844,17.914l-2.584-7.308l-0.006-0.004c-0.144-0.364-0.492-0.62-0.905-0.629l-0.021-0.015h-3.245V8\n                c0-1.104-0.969-2-2.165-2H5.165C3.969,6,3,6.896,3,8v9.914c0,0.201,0.042,0.393,0.102,0.576C3.041,18.62,3,18.761,3,18.914v3.587\n                c0,0.553,0.448,1,1,1h1.452c0-2.205,1.794-3.999,4-3.999s4,1.794,4,3.999h5.089c0-2.205,1.794-3.999,3.999-3.999\n                c2.206,0,4.001,1.794,4.001,3.999h1.303c0.552,0,1-0.447,1-1v-3.587C28.844,18.361,28.396,17.914,27.844,17.914z M24.924,17.5\n                l-0.002,0.002h-3.339L21.58,17.5c-0.274-0.002-0.497-0.225-0.497-0.5v-4.542c0-0.276,0.224-0.5,0.5-0.5h0.001h1.666\n                c0.226,0,0.408,0.152,0.471,0.356c0,0,1.701,4.596,1.701,4.685C25.422,17.275,25.199,17.499,24.924,17.5z" style=fill:{{vehicle.color}} /></g></svg><!--Vehicle Icon--> <span class=subtitle>{{vehicle.name}}</span></div><div class=driver-info><span class=name ng-show=vehicle.driver>{{vehicle.driver.name}}</span> <span class="name sp-tracking-driver-item-empty" ng-show=!vehicle.driver translate=Driver.without_assigned_driver></span></div><span ng-show="vehicle.routes.length === 0" class=sp-tracking-driver-item-empty translate=Driver.driver_without_routes></span></div><div class="text-muted sp-tracking-driver-item-alert"><b>{{vehicle.countAlertedVisits}} </b><i class=sp-icon-flag-notification ng-class="{\'sp-icon-on\': vehicle.hasAlertedVisits}"></i></div></div><div class="progress sp-tracking-driver-item-progress" ng-show=vehicle.routes.length tooltip-placement=bottom uib-tooltip="{{vehicle.madeVisits}} / {{vehicle.totalVisits}}"><div class=progress-container><div class=progress-bar role=progressbar aria-valuenow={{vehicle.progress}} aria-valuemin=0 aria-valuemax=100 style="height: 5px; width:{{vehicle.progress}}%; background-color:{{vehicle.color}}"></div></div></div></div></div><div class=inactive-vehicles-div ng-if="vm.vehicles.length > 0 && vm.vehiclesFilters.length > 0"><div class=section-title><span translate=Tracking.inactive_vehicles></span> <span class=sp-vehicles-number>({{inactiveVehicles.length}})</span></div><div class="sp-vehicle inactive" ng-repeat="vehicle in inactiveVehicles = (vm.vehiclesFilters | filter:{isActive:false} | trackingOrderVehicles) track by $index" ng-click=vm.toogleListVehicleDriver(vehicle) ng-class="{\'selected\': vm.selectedVehicleId && vm.selectedVehicleId === vehicle.id}"><div class="list-group-item sp-tracking-driver-item" ng-class="{\'disabled\':!vehicle.routes.length && vehicle.locations.length === 0 && !vehicle.driver}"><div class=sp-tracking-driver-item-heading><div class=vehicle-info uib-tooltip={{vehicle.name}}><!--Vehicle Icon--> <svg class=img version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=vehiculos><g><circle style=fill:{{vehicle.color}} cx=22.54 cy=23.501 r=2.499 /><circle style=fill:{{vehicle.color}} cx=9.452 cy=23.501 r=2.499 /></g><path d="M27.844,17.914l-2.584-7.308l-0.006-0.004c-0.144-0.364-0.492-0.62-0.905-0.629l-0.021-0.015h-3.245V8\n                c0-1.104-0.969-2-2.165-2H5.165C3.969,6,3,6.896,3,8v9.914c0,0.201,0.042,0.393,0.102,0.576C3.041,18.62,3,18.761,3,18.914v3.587\n                c0,0.553,0.448,1,1,1h1.452c0-2.205,1.794-3.999,4-3.999s4,1.794,4,3.999h5.089c0-2.205,1.794-3.999,3.999-3.999\n                c2.206,0,4.001,1.794,4.001,3.999h1.303c0.552,0,1-0.447,1-1v-3.587C28.844,18.361,28.396,17.914,27.844,17.914z M24.924,17.5\n                l-0.002,0.002h-3.339L21.58,17.5c-0.274-0.002-0.497-0.225-0.497-0.5v-4.542c0-0.276,0.224-0.5,0.5-0.5h0.001h1.666\n                c0.226,0,0.408,0.152,0.471,0.356c0,0,1.701,4.596,1.701,4.685C25.422,17.275,25.199,17.499,24.924,17.5z" style=fill:{{vehicle.color}} /></g></svg><!--Vehicle Icon--> <span class=subtitle>{{vehicle.name}}</span></div><div class=driver-info><span class=name ng-show=vehicle.driver>{{vehicle.driver.name}}</span> <span class="name sp-tracking-driver-item-empty" ng-show=!vehicle.driver translate=Driver.without_assigned_driver></span></div><span ng-show="vehicle.routes.length === 0" class=sp-tracking-driver-item-empty translate=Driver.driver_without_routes></span></div><div class="text-muted sp-tracking-driver-item-alert"><b>{{vehicle.countFailedVisits}} </b><i class=sp-icon-flag-notification ng-class="{\'sp-icon-on\': vehicle.hasFailedVisits}"></i></div></div><div class="progress sp-tracking-driver-item-progress" ng-show=vehicle.routes.length tooltip-placement=bottom uib-tooltip="{{vehicle.madeVisits}} / {{vehicle.totalVisits}}"><div class=progress-container><div class=progress-bar role=progressbar aria-valuenow={{vehicle.progress}} aria-valuemin=0 aria-valuemax=100 style="height: 5px; width:{{vehicle.progress}}%; background-color:{{::vehicle.color}}"></div></div></div></div></div></div><!-- end list-group --><div ng-show="(vm.vehicles.length === 0) && !vm.loadingData" class=sp-tracking-scrollable-empty-data><h3 translate=Vehicle.without_vehicle_title></h3><img ng-src=/assets/images/sin-vehiculos-tracking.svg></div><!-- end empty-data --><!--Loading Data--><div class=sp-container-loading ng-if=vm.loadingData><img src=/assets/images/loading.gif></div>'),e.put("app/uprofile/account/account.html",'<div class=sp-uprofile-content-title><h2 translate=Uprofile.Account.title></h2></div><div class=sp-uprofile-content-account-body><form class="form-horizontal sp-form"><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Account.fullname></label><div class=col-sm-9><p class=form-control-static>{{vm.user.name}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Account.email></label><div class=col-sm-9><p class=form-control-static>{{vm.user.email}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Account.business></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.name}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Account.country></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.country}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Account.token></label><div class=col-sm-9><p class="form-control-static token">{{vm.user.api_token}}</p></div></div></form><center><a ui-sref=.change-password translate=Uprofile.Account.change_password></a></center></div><div class=sp-uprofile-content-account-footer><!-- <a href="" class="editing" ng-click="vm.enableEditing(true)" ng-show="!vm.editing">Editar</a>\n	<a href="" class="btn btn-success save" ng-click="vm.saveInfAccount()" ng-show="vm.editing">Guardar</a>\n	<a href="" class="btn btn-default" ng-click="vm.enableEditing(false)" ng-show="vm.editing">Cancelar</a> --></div>'),e.put("app/uprofile/change-password/change-password.html",'<div class=sp-uprofile-content-title><h2 translate=Uprofile.ChangePassword.title></h2></div><div class=sp-uprofile-content-account-body><form class="form-horizontal sp-form" name=vm.formChangePassword ng-submit="vm.formChangePassword.$valid && vm.saveData()" novalidate><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.fullname></label><div class=col-sm-9><p class=form-control-static>{{vm.user.name}}</p><!-- <input type="text" class="form-control" name="name" ng-model="vm.user.name" readonly required> --></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.email></label><div class=col-sm-9><p class=form-control-static>{{vm.user.email}}</p><!-- <input type="email" class="form-control" name="email" ng-model="vm.user.email" readonly required> --></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.business></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.name}}</p><!-- <input type="text" class="form-control" name="company" ng-model="vm.user.account.name" readonly required> --></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.country></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.country}}</p><!-- <input type="text" class="form-control" name="country" ng-model="vm.user.account.country" readonly required> --></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.token></label><div class=col-sm-9><p class="form-control-static token">{{vm.user.api_token}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.actual_password></label><div class="col-sm-9 sp-block-relative"><input class=form-control name=password ng-attr-type={{vm.password.type}} ng-model=vm.password.value ng-minlength=0 ng-maxlength=15 required> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=vm.changeTypeInput(vm.password)><span class=sp-icon-show-hide></span></button></span></div><ng-messages for=vm.formChangePassword.password.$error class=sp-form-messages role=alert ng-if=vm.formChangePassword.password.$dirty><ng-message class=sp-error-txt when=required translate=Uprofile.ChangePassword.required_password></ng-message><ng-message class=sp-error-txt when=minlength translate=Uprofile.ChangePassword.too_short_password></ng-message><ng-message class=sp-error-txt when=maxlength translate=Uprofile.ChangePassword.too_long_password></ng-message></ng-messages></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.new_password></label><div class="col-sm-9 sp-block-relative"><input class=form-control name=new_password ng-attr-type={{vm.new_password.type}} ng-model=vm.new_password.value ng-minlength=5 ng-maxlength=15 required> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=vm.changeTypeInput(vm.new_password)><span class=sp-icon-show-hide></span></button></span></div><ng-messages for=vm.formChangePassword.new_password.$error class=sp-form-messages role=alert ng-if=vm.formChangePassword.new_password.$dirty><ng-message class=sp-error-txt when=required translate=Uprofile.ChangePassword.required_password></ng-message><ng-message class=sp-error-txt when=minlength translate=Uprofile.ChangePassword.too_short_password></ng-message><ng-message class=sp-error-txt when=maxlength translate=Uprofile.ChangePassword.too_long_password></ng-message></ng-messages></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.ChangePassword.repeat_new_password></label><div class="col-sm-9 sp-block-relative"><input class=form-control name=password_repeat ng-attr-type={{vm.confirm_password.type}} ng-model=vm.confirm_password.value ng-minlength=5 ng-maxlength=15 required> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=vm.changeTypeInput(vm.confirm_password)><span class=sp-icon-show-hide></span></button></span></div><ng-messages for=vm.formChangePassword.password_repeat.$error class=sp-form-messages role=alert ng-if=vm.formChangePassword.password_repeat.$dirty><ng-message class=sp-error-txt when=required translate=Uprofile.ChangePassword.required_password></ng-message><ng-message class=sp-error-txt when=minlength translate=Uprofile.ChangePassword.too_short_password></ng-message><ng-message class=sp-error-txt when=maxlength translate=Uprofile.ChangePassword.too_long_password></ng-message></ng-messages></div><center><div ng-if=vm.error_match_password><p class=sp-error-txt translate=Uprofile.ChangePassword.passwords_not_equal></p></div><div ng-if=vm.error_invalid_password><p class=sp-error-txt translate=Uprofile.ChangePassword.actual_password_invalid></p></div><div ng-if=vm.success_change_password><p class=success-payment translate=Uprofile.ChangePassword.password_changed_successfully></p></div></center><button class="btn btn-success pull-right" ng-disabled=vm.formChangePassword.$invalid translate=Uprofile.ChangePassword.change_password></button> <button class="btn btn-default pull-right" ng-click=vm.goBack() translate=Uprofile.ChangePassword.cancel></button></form></div>'),e.put("app/uprofile/confirm-cancel-subscription/cancel-subscription.html",'<!-- <div class="sp-modal-content">\n  <div class="modal-header modal-header-danger">\n    <button type="button" class="close" data-dismiss="modal" ng-click="$dismiss()" aria-hidden="true">&times;</button>\n    <h2 class="modal-title" translate="Uprofile.CCSubscription.cancel_subscription"></h2>\n  </div>\n  <div class="modal-body">\n    <p translate="Uprofile.CCSubscription.really_want_cancel"></p>\n  </div>\n  <div class="modal-footer modal-subscription">\n    <button type="button" class="btn btn-default" ng-click="$dismiss()" translate="Uprofile.CCSubscription.close"></button>\n    <button type="button" class="btn btn-success" ng-click="vm.cancelSubscription()">Ok</button>\n  </div>\n</div> --><div class=sp-modal-content><div class="modal-header modal-header-danger"><h3 class=modal-title translate=Uprofile.CCSubscription.cancel_subscription></h3></div><div class=modal-body><p translate=Uprofile.CCSubscription.really_want_cancel></p></div><div class=sp-modal-buttons><button type=button class="btn btn-default" ng-click=closeThisDialog(0) translate=Uprofile.CCSubscription.close></button> <button type=button class="btn btn-danger" ng-click="cancelSubscription(); closeThisDialog(0)">Ok</button></div></div>'),e.put("app/uprofile/payment/add-payment.html",'<noscript><div style=display:inline><img height=1 width=1 style=border-style:none alt="" src="//www.googleadservices.com/pagead/conversion/944253981/?label=DBn0CL_umG0QndigwgM&amp;guid=ON&amp;script=0"></div></noscript><div class=active><h4 class=title translate=Uprofile.Payment.payment_method></h4><form class="form-horizontal sp-form" name=vm.paymentForm stripe-form=stripeCallback><div class=form-group><label class="col-sm-3 control-label editing" translate=Uprofile.Payment.payment_vehicles></label><div class="col-sm-9 payment-vehicle"><input type=number class=form-control name=quantity_vehicle ng-model=vm.planQuantity min={{vm.minVehicle}} max=1000 required><p class=form-control-static>{{vm.planQuantity * vm.AMOUNT_PER_VEHICLE | currency:"USD$"}}</p></div><div class=form-group ng-show=vm.paymentForm.quantity_vehicle.$error><div class="col-sm-offset-2 col-sm-10 text-muted"><small class=sp-error-txt ng-show=vm.paymentForm.quantity_vehicle.$error.min><i class="fa fa-question-circle"></i> <span translate=Uprofile.Payment.to_select_plan></span> <a ui-sref=settings.vehicles.list translate=Uprofile.Payment.delete_vehicles></a>. </small><small class=sp-error-txt ng-show=vm.paymentForm.quantity_vehicle.$error.max><i class="fa fa-question-circle"></i> <span translate=Uprofile.Payment.maxium_vehicles></span></small></div></div></div><div class=form-group><label class="col-sm-3 control-label editing" translate=Uprofile.Payment.card></label><div class=col-sm-9><input class=form-control name=card ng-model=number placeholder="Card Number" payments-format=card payments-validate=card required></div><div class=sp-error-txt ng-if="vm.paymentForm.card.$invalid && vm.paymentForm.card.$dirty" translate=Uprofile.Payment.invalid_card_number></div></div><div class=form-group><label class="col-sm-3 control-label editing" translate=Uprofile.Payment.due_date></label><div class=col-sm-9><input class=form-control name=expiry ng-model=expiry placeholder="MM / YY" payments-format=expiry payments-validate=expiry required></div><div class=sp-error-txt ng-if="vm.paymentForm.expiry.$invalid && vm.paymentForm.expiry.$dirty" translate=Uprofile.Payment.invalid_expiry></div><div class=sp-error-txt ng-if=vm.expiry_invalid translate=Uprofile.Payment.expiration_year_invalid></div></div><div class=form-group><label class="col-sm-3 control-label editing" translate=Uprofile.Payment.security_code></label><div class=col-sm-9><input class=form-control name=cvc ng-model=cvc placeholder=CVC payments-format=cvc payments-validate=cvc required></div><div class=sp-error-txt ng-if="vm.paymentForm.cvc.$invalid && vm.paymentForm.cvc.$dirty" translate=Uprofile.Payment.cvc_invalid></div></div><div class=form-group><label class="col-sm-3 control-label editing" translate=Uprofile.Payment.discount_code></label><div class=col-sm-1><input type=checkbox class=sp-checkbox-discount name=enable_discount_code ng-model=vm.enable_discount_code></div><div class=col-sm-8 ng-show=vm.enable_discount_code><input class=form-control name=discount_code ng-model=vm.discount_code ng-required=vm.enable_discount_code></div><div class=sp-error-txt ng-if="vm.paymentForm.discount_code.$invalid && vm.paymentForm.discount_code.$dirty" translate=Uprofile.Payment.discount_code_invalid></div></div><div class=success-payment ng-if=vm.successPayment translate=Uprofile.Payment.success_msg></div><div class=sp-error-txt ng-if=vm.errorPayment translate=Uprofile.Payment.error_msg></div><div class=sp-error-txt ng-if=vm.errorCoupon translate=Uprofile.Payment.error_coupon_msg></div><button type=submit class="btn btn-success pull-right" ng-disabled=vm.paymentForm.$invalid translate=Uprofile.Payment.save ng-hide=vm.successPayment></button> <button class="btn btn-default pull-right" ng-click=vm.goBack() translate=Uprofile.Payment.cancel ng-hide=vm.successPayment></button></form></div><div id=loadScript></div>'),e.put("app/uprofile/payment/payment-success-modal.html",'<div class="info modal-content sp-finish-modal"><div class="modal-header modal-header-success"><h3 class=modal-title translate=Uprofile.Payment_success.title></h3></div><div class=modal-body><div class=sp-confirm-plan><div class=sp-icon-success-container><i class="sp-icon-check sp-icon-check-uprofile"></i></div><div class="sp-modal-options sp-modal-options-uprofile"><div class="sp-modal-options-block text-center"><div class=row><div class=col-sm-12><span><span translate="{{\'Uprofile.Payment_success.msg\'}}"></span></span></div></div><div class=row><div class=col-sm-12><button class="btn btn-lg btn-success sp-btn-margin-top-15" ng-click=closeThisDialog(0)><span translate="{{\'Uprofile.Payment_success.accept\'}}"></span></button></div></div></div></div></div></div></div><!-- end modal-content -->'),e.put("app/uprofile/payment/payment.html",'<div class=active ng-show="vm.user.account.status === \'trialing\' || vm.user.account.status === \'canceled\'"><p translate=Uprofile.Payment.not_payment_method></p></div><div class=active ng-show="vm.user.account.status === \'active\' || vm.user.account.status === \'past_due\'"><h4 class=title translate=Uprofile.Payment.payment_method></h4><form class="form-horizontal sp-form"><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Payment.payment_vehicles></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.plan_quantity}}</p></div></div><div class=form-group><label class="col-sm-3 control-label" translate=Uprofile.Payment.card></label><div class=col-sm-9><p class=form-control-static>xxxx xxxx xxxx {{vm.user.account.card_last4}}</p></div></div><div class=form-group ng-show=vm.user.account.coupon><label class="col-sm-3 control-label" translate=Uprofile.Payment.discount_code></label><div class=col-sm-9><p class=form-control-static>{{vm.user.account.coupon}}</p></div></div></form><a ui-sref=.add-payment ng-show="(vm.user.account.status === \'active\' || vm.user.account.status === \'past_due\') && vm.user.is_owner" translate=Uprofile.Payment.edit></a></div>'),e.put("app/shared/html/events-templates/base.html","<div ng-include=getTemplate()></div>"),e.put("app/shared/html/events-templates/route_finished.html",'<div class=left uib-tooltip={{event.data.vehicle_name}}><!--Vehicle Icon--> <svg class=img version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=vehiculos><g><circle style=fill:{{event.data.vehicle_color}} cx=22.54 cy=23.501 r=2.499 /><circle style=fill:{{event.data.vehicle_color}} cx=9.452 cy=23.501 r=2.499 /></g><path d="M27.844,17.914l-2.584-7.308l-0.006-0.004c-0.144-0.364-0.492-0.62-0.905-0.629l-0.021-0.015h-3.245V8\n                c0-1.104-0.969-2-2.165-2H5.165C3.969,6,3,6.896,3,8v9.914c0,0.201,0.042,0.393,0.102,0.576C3.041,18.62,3,18.761,3,18.914v3.587\n                c0,0.553,0.448,1,1,1h1.452c0-2.205,1.794-3.999,4-3.999s4,1.794,4,3.999h5.089c0-2.205,1.794-3.999,3.999-3.999\n                c2.206,0,4.001,1.794,4.001,3.999h1.303c0.552,0,1-0.447,1-1v-3.587C28.844,18.361,28.396,17.914,27.844,17.914z M24.924,17.5\n                l-0.002,0.002h-3.339L21.58,17.5c-0.274-0.002-0.497-0.225-0.497-0.5v-4.542c0-0.276,0.224-0.5,0.5-0.5h0.001h1.666\n                c0.226,0,0.408,0.152,0.471,0.356c0,0,1.701,4.596,1.701,4.685C25.422,17.275,25.199,17.499,24.924,17.5z" style=fill:{{event.data.vehicle_color}} /></g></svg><!--Vehicle Icon--></div><div class=center><div class=title><div class=truncate>{{event.data.vehicle_name}}</div><span class=visit-text translate=Events.route_finished></span></div><div class=others-indicators><div ng-if=showdriver><i class="indicator-icon sp-icon-user"></i> <span>{{event.data.driver_name}}</span></div></div></div><div class=right>{{event.occurred_on}}</div>'),
e.put("app/shared/html/events-templates/route_started.html",'<div class=left uib-tooltip={{event.data.vehicle_name}}><!--Vehicle Icon--> <svg class=img version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=vehiculos><g><circle style=fill:{{event.data.vehicle_color}} cx=22.54 cy=23.501 r=2.499 /><circle style=fill:{{event.data.vehicle_color}} cx=9.452 cy=23.501 r=2.499 /></g><path d="M27.844,17.914l-2.584-7.308l-0.006-0.004c-0.144-0.364-0.492-0.62-0.905-0.629l-0.021-0.015h-3.245V8\n                c0-1.104-0.969-2-2.165-2H5.165C3.969,6,3,6.896,3,8v9.914c0,0.201,0.042,0.393,0.102,0.576C3.041,18.62,3,18.761,3,18.914v3.587\n                c0,0.553,0.448,1,1,1h1.452c0-2.205,1.794-3.999,4-3.999s4,1.794,4,3.999h5.089c0-2.205,1.794-3.999,3.999-3.999\n                c2.206,0,4.001,1.794,4.001,3.999h1.303c0.552,0,1-0.447,1-1v-3.587C28.844,18.361,28.396,17.914,27.844,17.914z M24.924,17.5\n                l-0.002,0.002h-3.339L21.58,17.5c-0.274-0.002-0.497-0.225-0.497-0.5v-4.542c0-0.276,0.224-0.5,0.5-0.5h0.001h1.666\n                c0.226,0,0.408,0.152,0.471,0.356c0,0,1.701,4.596,1.701,4.685C25.422,17.275,25.199,17.499,24.924,17.5z" style=fill:{{event.data.vehicle_color}} /></g></svg><!--Vehicle Icon--></div><div class=center><div class=title><div class=truncate>{{event.data.vehicle_name}}</div><span class=visit-text translate=Events.route_started></span></div><div class=others-indicators><div ng-if=showdriver><i class="indicator-icon sp-icon-user"></i> <span>{{event.data.driver_name}}</span></div></div></div><div class=right>{{event.occurred_on}}</div>'),e.put("app/shared/html/events-templates/visit_checkout.html",'<div class=left uib-tooltip={{event.data.vehicle_name}}><!--Vehicle Icon--> <svg class=img version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=vehiculos><g><circle style=fill:{{event.data.vehicle_color}} cx=22.54 cy=23.501 r=2.499 /><circle style=fill:{{event.data.vehicle_color}} cx=9.452 cy=23.501 r=2.499 /></g><path d="M27.844,17.914l-2.584-7.308l-0.006-0.004c-0.144-0.364-0.492-0.62-0.905-0.629l-0.021-0.015h-3.245V8\n                c0-1.104-0.969-2-2.165-2H5.165C3.969,6,3,6.896,3,8v9.914c0,0.201,0.042,0.393,0.102,0.576C3.041,18.62,3,18.761,3,18.914v3.587\n                c0,0.553,0.448,1,1,1h1.452c0-2.205,1.794-3.999,4-3.999s4,1.794,4,3.999h5.089c0-2.205,1.794-3.999,3.999-3.999\n                c2.206,0,4.001,1.794,4.001,3.999h1.303c0.552,0,1-0.447,1-1v-3.587C28.844,18.361,28.396,17.914,27.844,17.914z M24.924,17.5\n                l-0.002,0.002h-3.339L21.58,17.5c-0.274-0.002-0.497-0.225-0.497-0.5v-4.542c0-0.276,0.224-0.5,0.5-0.5h0.001h1.666\n                c0.226,0,0.408,0.152,0.471,0.356c0,0,1.701,4.596,1.701,4.685C25.422,17.275,25.199,17.499,24.924,17.5z" style=fill:{{event.data.vehicle_color}} /></g></svg><!--Vehicle Icon--></div><div class=center><div class=title><span class=visit-text translate=Events.visit></span><div class=truncate><a href="" ng-click=openModal(event.data.visit_id)>{{event.data.visit_title}}</a></div><span ng-if="event.data.visit_status === \'completed\'" translate=Events.completed></span> <span ng-if="event.data.visit_status === \'failed\'" translate=Events.failed></span> <i class="icon indicator-icon sp-icon-ventana-horaria" ng-if=!event.data.isCheckoutOnTime uib-tooltip="{{\'Events.window_broken\' | translate}}"></i></div><div class=others-indicators><!--<div>--><!--<i class="indicator-icon sp-icon-tiempo-servicio"></i>--><!--<span>{{event.data.service_time}} min</span>--><!--</div>--><div ng-if=showdriver><i class="indicator-icon sp-icon-user"></i> <span>{{event.data.driver_name}}</span></div><div ng-if=event.data.has_attachments uib-tooltip="{{\'Events.file_attached\' | translate}}"><!--File icon--> <svg class=indicator-icon version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px width=32px height=32px viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space=preserve><g id=adjunto><path d="M27.626,5.877c-1.543-1.543-3.618-2.397-5.812-2.375c-2.203,0.011-4.271,0.874-5.826,2.428l-7.178,7.178L3.836,18.08\n              c-2.418,2.42-2.461,6.312-0.097,8.675c1.165,1.165,2.699,1.744,4.247,1.744c1.593,0,3.199-0.615,4.426-1.842l9.073-9.072\n              c0.001,0,0.001-0.002,0.002-0.002l3.126-3.127c0.814-0.813,1.271-1.891,1.285-3.035c0.015-1.152-0.417-2.228-1.22-3.03\n              c-1.653-1.654-4.375-1.626-6.066,0.063L7.648,19.418c-0.328,0.329-0.328,0.86,0,1.188c0.165,0.164,0.379,0.246,0.594,0.246\n              c0.216,0,0.431-0.082,0.594-0.246L19.8,9.642c1.034-1.036,2.69-1.064,3.689-0.064c0.479,0.479,0.737,1.125,0.729,1.82\n              c-0.01,0.703-0.291,1.367-0.792,1.868l-3.239,3.239c-0.001,0.001-0.001,0.002-0.002,0.003l-8.961,8.96\n              c-1.763,1.763-4.587,1.806-6.297,0.099c-1.708-1.71-1.666-4.535,0.098-6.299l0.56-0.559c0-0.001,0.002-0.001,0.002-0.003\n              L17.177,7.118c1.238-1.24,2.89-1.928,4.646-1.936c1.75,0.012,3.394,0.659,4.615,1.883c2.539,2.539,2.516,6.695-0.053,9.263\n              l-9.533,9.531c-0.328,0.328-0.328,0.859,0,1.188c0.163,0.164,0.38,0.246,0.594,0.246c0.215,0,0.431-0.082,0.595-0.246l9.532-9.532\n              C30.796,14.292,30.82,9.071,27.626,5.877z"/></g></svg><!--File icon--></div></div></div><div class=right>{{event.occurred_on}}</div>')}]);
//# sourceMappingURL=../maps/scripts/app-50451bc874.js.map
